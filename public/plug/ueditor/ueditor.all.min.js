/*!
 * ueditor
 * version: 1.4.3
 * build: Mon Feb 26 2018 12:01:04 GMT+0800 (涓浗鏍囧噯鏃堕棿)
 */
var $jscomp = {
	scope: {},
	findInternal: function(A, H, D) {
		A instanceof String && (A = String(A));
		for (var q = A.length, E = 0; E < q; E++) {
			var t = A[E];
			if (H.call(D, t, E, A)) return {
				i: E,
				v: t
			}
		}
		return {
			i: -1,
			v: void 0
		}
	}
};
$jscomp.defineProperty = "function" == typeof Object.defineProperties ? Object.defineProperty : function(A, H, D) {
	if (D.get || D.set) throw new TypeError("ES3 does not support getters and setters.");
	A != Array.prototype && A != Object.prototype && (A[H] = D.value)
};
$jscomp.getGlobal = function(A) {
	return "undefined" != typeof window && window === A ? A : "undefined" != typeof global ? global : A
};
$jscomp.global = $jscomp.getGlobal(this);
$jscomp.polyfill = function(A, H, D, q) {
	if (H) {
		D = $jscomp.global;
		A = A.split(".");
		for (q = 0; q < A.length - 1; q++) {
			var E = A[q];
			E in D || (D[E] = {});
			D = D[E]
		}
		A = A[A.length - 1];
		q = D[A];
		H = H(q);
		H != q && null != H && $jscomp.defineProperty(D, A, {
			configurable: !0,
			writable: !0,
			value: H
		})
	}
};
$jscomp.polyfill("Array.prototype.find", function(A) {
	return A ? A : function(A, D) {
		return $jscomp.findInternal(this, A, D).v
	}
}, "es6-impl", "es3");
$jscomp.checkStringArgs = function(A, H, D) {
	if (null == A) throw new TypeError("The 'this' value for String.prototype." + D + " must not be null or undefined");
	if (H instanceof RegExp) throw new TypeError("First argument to String.prototype." + D + " must not be a regular expression");
	return A + ""
};
$jscomp.polyfill("String.prototype.repeat", function(A) {
	return A ? A : function(A) {
		var D = $jscomp.checkStringArgs(this, null, "repeat");
		if (0 > A || 1342177279 < A) throw new RangeError("Invalid count value");
		A |= 0;
		for (var q = ""; A;)
			if (A & 1 && (q += D), A >>>= 1) D += D;
		return q
	}
}, "es6-impl", "es3");
(function() {
	function A(c, a, e) {
		var d;
		a = a.toLowerCase();
		return (d = c.__allListeners || e && (c.__allListeners = {})) && (d[a] || e && (d[a] = []))
	}

	function H(c, a, e, d, b, h) {
		d = d && c[a];
		var f;
		for (!d && (d = c[e]); !d && (f = (f || c).parentNode);) {
			if ("BODY" == f.tagName || h && !h(f)) return null;
			d = f[e]
		}
		return d && b && !b(d) ? H(d, a, e, !1, b) : d
	}

	function D(c) {
		var a = 0,
			e = !1;
		c.children().each(function() {
			jQuery(this).data("width") && "fix" != jQuery(this).data("width") ? (this.style.width = jQuery(this).data("width"), e = !0) : "" == this.style.width || 0 < this.style.width.search("%") || "fix" == jQuery(this).data("width") || 0 < this.style.width.search("em") ? e = !0 : a += parseInt(this.style.width.replace("px", ""))
		});
		0 == e && 360 < a && c.children().each(function() {
			this.style.width = 100 * parseInt(this.style.width.replace("px", "")) / a + "%"
		})
	}
	UEDITOR_CONFIG = window.UEDITOR_CONFIG || {};
	var q = window.baidu || {};



	window.baidu = q;
	window.UE = q.editor = {
		plugins: {},
		commands: {},
		instants: {},
		I18N: {},
		_customizeUI: {},
		version: "1.5.0"
	};


	var E = UE.dom = {},
		t = UE.browser = function() {
			var c = navigator.userAgent.toLowerCase(),
				a = window.opera,
				e = {
					ie: /(msie\s|trident.*rv:)([\w.]+)/i.test(c),
					opera: !!a && a.version,
					webkit: -1 < c.indexOf(" applewebkit/"),
					mac: -1 < c.indexOf("macintosh"),
					quirks: "BackCompat" == document.compatMode
				};
			e.gecko = "Gecko" == navigator.product && !e.webkit && !e.opera && !e.ie;
			var d = 0;
			if (e.ie) {
				var d = c.match(/(?:msie\s([\w.]+))/),
					b = c.match(/(?:trident.*rv:([\w.]+))/),
					d = d && b && d[1] && b[1] ? Math.max(1 * d[1], 1 * b[1]) : d && d[1] ? 1 * d[1] : b && b[1] ? 1 * b[1] : 0;
				e.ie11Compat = 11 == document.documentMode;
				e.ie9Compat = 9 == document.documentMode;
				e.ie8 = !!document.documentMode;
				e.ie8Compat = 8 == document.documentMode;
				e.ie7Compat = 7 == d && !document.documentMode || 7 == document.documentMode;
				e.ie6Compat = 7 > d || e.quirks;
				e.ie9above = 8 < d;
				e.ie9below = 9 > d;
				e.ie11above = 10 < d;
				e.ie11below = 11 > d
			}
			e.gecko && (b = c.match(/rv:([\d\.]+)/)) && (b = b[1].split("."), d = 1E4 * b[0] + 100 * (b[1] || 0) + 1 * (b[2] || 0));
			/chrome\/(\d+\.\d)/i.test(c) && (e.chrome = +RegExp.$1);
			/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(c) && !/chrome/i.test(c) && (e.safari = +(RegExp.$1 || RegExp.$2));
			e.opera && (d = parseFloat(a.version()));
			e.webkit && (d = parseFloat(c.match(/ applewebkit\/(\d+)/)[1]));
			e.version = d;
			e.isCompatible = !e.mobile && (e.ie && 6 <= d || e.gecko && 10801 <= d || e.opera && 9.5 <= d || e.air && 1 <= d || e.webkit && 522 <= d || !1);
			return e
		}(),
		O = t.ie,
		ka = t.opera,

		p = UE.utils = {
			each: function(c, a, e) {
				if (null != c)
					if (c.length === +c.length)
						for (var d = 0, b = c.length; d < b; d++) {
							if (!1 === a.call(e, c[d], d, c)) return !1
						} else
							for (d in c)
								if (c.hasOwnProperty(d) && !1 === a.call(e, c[d], d, c)) return !1
			},
			makeInstance: function(c) {
				var a = new Function;
				a.prototype = c;
				c = new a;
				a.prototype = null;
				return c
			},
			extend: function(c, a, e) {
				if (a)
					for (var d in a) e && c.hasOwnProperty(d) || (c[d] = a[d]);
				return c
			},
			extend2: function(c) {
				for (var a = arguments, e = 1; e < a.length; e++) {
					var d = a[e],
						b;
					for (b in d) c.hasOwnProperty(b) || (c[b] = d[b])
				}
				return c
			},
			inherits: function(c, a) {
				var e = c.prototype,
					d = p.makeInstance(a.prototype);
				p.extend(d, e, !0);
				c.prototype = d;
				return d.constructor = c
			},
			bind: function(c, a) {
				return function() {
					return c.apply(a, arguments)
				}
			},
			defer: function(c, a, e) {
				var d;
				return function() {
					e && clearTimeout(d);
					d = setTimeout(c, a)
				}
			},
			indexOf: function(c, a, e) {
				var d = -1;
				e = this.isNumber(e) ? e : 0;
				this.each(c, function(b, h) {
					if (h >= e && b === a) return d = h, !1
				});
				return d
			},
			removeItem: function(c, a) {
				for (var e = 0, d = c.length; e < d; e++) c[e] === a && (c.splice(e, 1), e--)
			},
			trim: function(c) {
				return c.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g, "")
			},
			listToMap: function(c) {
				if (!c) return {};
				c = p.isArray(c) ? c : c.split(",");
				for (var a = 0, e, d = {}; e = c[a++];) d[e.toUpperCase()] = d[e] = 1;
				return d
			},
			unhtml: function(c, a) {
				return c ? c.replace(a || /[&<">'](?:(amp|lt|quot|gt|#39|nbsp|#\d+);)?/g, function(a, d) {
					return d ? a : {
						"<": "&lt;",
						"&": "&amp;",
						'"': "&quot;",
						">": "&gt;",
						"'": "&#39;"
					}[a]
				}) : ""
			},
			html: function(c) {
				return c ? c.replace(/&((g|l|quo)t|amp|#39|nbsp);/g, function(a) {
					return {
						"&lt;": "<",
						"&amp;": "&",
						"&quot;": '"',
						"&gt;": ">",
						"&#39;": "'",
						"&nbsp;": " "
					}[a]
				}) : ""
			},
			cssStyleToDomStyle: function() {
				var c = document.createElement("div").style,
					a = {
						"float": void 0 != c.cssFloat ? "cssFloat" : void 0 != c.styleFloat ? "styleFloat" : "float"
					};
				return function(e) {
					return a[e] || (a[e] = e.toLowerCase().replace(/-./g, function(a) {
						return a.charAt(1).toUpperCase()
					}))
				}
			}(),
			loadFile: function() {
				function c(e, d) {
					try {
						for (var b = 0, h; h = a[b++];)
							if (h.doc === e && h.url == (d.src || d.href)) return h
					} catch (f) {
						return null
					}
				}
				var a = [];
				return function(e, d, b) {
					var h = c(e, d);
					if (h) h.ready ? b && b() : h.funs.push(b);
					else if (a.push({
							doc: e,
							url: d.src || d.href,
							funs: [b]
						}), !e.body) {
						b = [];
						for (var f in d) "tag" != f && b.push(f + '="' + d[f] + '"');
						e.write("<" + d.tag + " " + b.join(" ") + " ></" + d.tag + ">")
					} else if (!d.id || !e.getElementById(d.id)) {
						var l = e.createElement(d.tag);
						delete d.tag;
						for (f in d) l.setAttribute(f, d[f]);
						l.onload = l.onreadystatechange = function() {
							if (!this.readyState || /loaded|complete/.test(this.readyState)) {
								h = c(e, d);
								if (0 < h.funs.length) {
									h.ready = 1;
									for (var a; a = h.funs.pop();) a()
								}
								l.onload = l.onreadystatechange = null
							}
						};
						l.onerror = function() {
							throw Error("The load " + (d.href || d.src) + " fails,check the url settings of file ueditor.config.js ");
						};
						e.getElementsByTagName("head")[0].appendChild(l)
					}
				}
			}(),
			isEmptyObject: function(c) {
				if (null == c) return !0;
				if (this.isArray(c) || this.isString(c)) return 0 === c.length;
				for (var a in c)
					if (c.hasOwnProperty(a)) return !1;
				return !0
			},
			fixColor: function(c, a) {
				if (/color/i.test(c) && /rgba?/.test(a)) {
					var e = a.split(",");
					if (3 < e.length) return "";
					a = "#";
					for (var d = 0, b; b = e[d++];) b = parseInt(b.replace(/[^\d]/gi, ""), 10).toString(16), a += 1 == b.length ? "0" + b : b;
					a = a.toUpperCase()
				}
				return a
			},
			optCss: function(c) {
				function a(a, d) {
					if (!a) return "";
					var f = a.top,
						b = a.bottom,
						k = a.left,
						h = a.right,
						e = "";
					if (f && k && b && h) e += ";" + d + ":" + (f == b && b == k && k == h ? f : f == b && k == h ? f + " " + k : k == h ? f + " " + k + " " + b : f + " " + h + " " + b + " " + k) + ";";
					else
						for (var c in a) e += ";" + d + "-" + c + ":" + a[c] + ";";
					return e
				}
				var e, d;
				c = c.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi, function(a, h, f, l) {
					if (1 == l.split(" ").length) switch (h) {
						case "padding":
							return !e && (e = {}), e[f] = l, "";
						case "margin":
							return !d && (d = {}), d[f] = l, "";
						case "border":
							return "initial" == l ? "" : a
					}
					return a
				});
				c += a(e, "padding") + a(d, "margin");
				return c.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/, "").replace(/;([ \n\r\t]+)|\1;/g, ";").replace(/(&((l|g)t|quot|#39))?;{2,}/g, function(a, d) {
					return d ? d + ";;" : ";"
				})
			},
			clone: function(c, a) {
				var e;
				a = a || {};
				for (var d in c) c.hasOwnProperty(d) && (e = c[d], "object" == typeof e ? (a[d] = p.isArray(e) ? [] : {}, p.clone(c[d], a[d])) : a[d] = e);
				return a
			},
			transUnitToPx: function(c) {
				if (!/(pt|cm)/.test(c)) return c;
				var a;
				c.replace(/([\d.]+)(\w+)/, function(e, d, b) {
					c = d;
					a = b
				});
				switch (a) {
					case "cm":
						c = 25 * parseFloat(c);
						break;
					case "pt":
						c = Math.round(96 * parseFloat(c) / 72)
				}
				return c + (c ? "px" : "")
			},
			domReady: function() {
				function c(e) {
					for (e.isReady = !0; e = a.pop(); e());
				}
				var a = [];
				return function(e, d) {
					d = d || window;
					var b = d.document;
					e && a.push(e);
					"complete" === b.readyState ? c(b) : (b.isReady && c(b), t.ie && 11 != t.version ? (function() {
						if (!b.isReady) {
							try {
								b.documentElement.doScroll("left")
							} catch (h) {
								setTimeout(arguments.callee, 0);
								return
							}
							c(b)
						}
					}(), d.attachEvent("onload", function() {
						c(b)
					})) : (b.addEventListener("DOMContentLoaded", function() {
						b.removeEventListener("DOMContentLoaded", arguments.callee, !1);
						c(b)
					}, !1), d.addEventListener("load", function() {
						c(b)
					}, !1)))
				}
			}(),
			cssRule: t.ie && 11 != t.version ?
				function(c, a, e) {
					var d, b;
					if (void 0 === a || a && a.nodeType && 9 == a.nodeType) {
						if (e = a && a.nodeType && 9 == a.nodeType ? a : e || document, d = e.indexList || (e.indexList = {}), b = d[c], void 0 !== b) return e.styleSheets[b].cssText
					} else {
						e = e || document;
						d = e.indexList || (e.indexList = {});
						b = d[c];
						if ("" === a) return void 0 !== b ? (e.styleSheets[b].cssText = "", delete d[c], !0) : !1;
						void 0 !== b ? sheetStyle = e.styleSheets[b] : (sheetStyle = e.createStyleSheet("", b = e.styleSheets.length), d[c] = b);
						sheetStyle.cssText = a
					}
				} : function(c, a, e) {
					var d;
					if (void 0 === a || a && a.nodeType && 9 == a.nodeType) return e = a && a.nodeType && 9 == a.nodeType ? a : e || document, (d = e.getElementById(c)) ? d.innerHTML : void 0;
					e = e || document;
					d = e.getElementById(c);
					if ("" === a) return d ? (d.parentNode.removeChild(d), !0) : !1;
					d ? d.innerHTML = a : (d = e.createElement("style"), d.id = c, d.innerHTML = a, e.getElementsByTagName("head")[0].appendChild(d))
				},
			sort: function(c, a) {
				a = a ||
					function(a, f) {
						return a.localeCompare(f)
					};
				for (var e = 0, d = c.length; e < d; e++)
					for (var b = e, h = c.length; b < h; b++)
						if (0 < a(c[e], c[b])) {
							var f = c[e];
							c[e] = c[b];
							c[b] = f
						}
				return c
			},
			serializeParam: function(c) {
				var a = [],
					e;
				for (e in c)
					if ("method" != e && "timeout" != e && "async" != e)
						if ("function" != (typeof c[e]).toLowerCase() && "object" != (typeof c[e]).toLowerCase()) a.push(encodeURIComponent(e) + "=" + encodeURIComponent(c[e]));
						else if (p.isArray(c[e]))
					for (var d = 0; d < c[e].length; d++) a.push(encodeURIComponent(e) + "[]=" + encodeURIComponent(c[e][d]));
				return a.join("&")
			},
			formatUrl: function(c) {
				c = c.replace(/&&/g, "&");
				c = c.replace(/\?&/g, "?");
				c = c.replace(/&$/g, "");
				c = c.replace(/&#/g, "#");
				return c = c.replace(/&+/g, "&")
			},
			isCrossDomainUrl: function(c) {
				var a = document.createElement("a");
				a.href = c;
				t.ie && (a.href = a.href);
				return !(a.protocol == location.protocol && a.hostname == location.hostname && (a.port == location.port || "80" == a.port && "" == location.port || "" == a.port && "80" == location.port))
			},
			clearEmptyAttrs: function(c) {
				for (var a in c) "" === c[a] && delete c[a];
				return c
			},
			str2json: function(c) {
				return p.isString(c) ? window.JSON ? JSON.parse(c) : (new Function("return " + p.trim(c || "")))() : null
			},
			json2str: function() {
				if (window.JSON) return JSON.stringify;
				var c = function(a) {
						return 10 > a ? "0" + a : a
					},
					a = function(a) {
						/["\\-]/.test(a) && (a = a.replace(/["\\-]/g, function(a) {
							var b = e[a];
							if (b) return b;
							b = a.charCodeAt();
							return "\\u00" + Math.floor(b / 16).toString(16) + (b % 16).toString(16)
						}));
						return '"' + a + '"'
					},
					e = {
						"\b": "\\b",
						"\t": "\\t",
						"\n": "\\n",
						"\f": "\\f",
						"\r": "\\r",
						'"': '\\"',
						"\\": "\\\\"
					};
				return function(d) {
					switch (typeof d) {
						case "undefined":
							return "undefined";
						case "number":
							return isFinite(d) ? String(d) : "null";
						case "string":
							return a(d);
						case "boolean":
							return String(d);
						default:
							if (null === d) return "null";
							if (p.isArray(d)) {
								var b = ["["],
									h = d.length,
									f, l, k;
								for (l = 0; l < h; l++) switch (k = d[l], typeof k) {
									case "undefined":
									case "function":
									case "unknown":
										break;
									default:
										f && b.push(","), b.push(p.json2str(k)), f = 1
								}
								b.push("]");
								return b.join("")
							}
							if (p.isDate(d)) return '"' + d.getFullYear() + "-" + c(d.getMonth() + 1) + "-" + c(d.getDate()) + "T" + c(d.getHours()) + ":" + c(d.getMinutes()) + ":" + c(d.getSeconds()) + '"';
							f = ["{"];
							l = p.json2str;
							for (h in d)
								if (Object.prototype.hasOwnProperty.call(d, h)) switch (k = d[h], typeof k) {
									case "undefined":
									case "unknown":
									case "function":
										break;
									default:
										b && f.push(","), b = 1, f.push(l(h) + ":" + l(k))
								}
							f.push("}");
							return f.join("")
					}
				}
			}()
		};
	var dom = E;

	p.each("String Function Array Number RegExp Object Date".split(" "), function(c) {
		UE.utils["is" + c] = function(a) {
			return Object.prototype.toString.apply(a) == "[object " + c + "]"
		}
	});
	var utils = UE.utils;
	var ba = UE.EventBase = function() {};
	ba.prototype = {
		addListener: function(c, a) {
			c = p.trim(c).split(/\s+/);
			for (var e = 0, d; d = c[e++];) A(this, d, !0).push(a)
		},
		on: function(c, a) {
			return this.addListener(c, a)
		},
		off: function(c, a) {
			return this.removeListener(c, a)
		},
		trigger: function() {
			return this.fireEvent.apply(this, arguments)
		},
		removeListener: function(c, a) {
			c = p.trim(c).split(/\s+/);
			for (var e = 0, d; d = c[e++];) p.removeItem(A(this, d) || [], a)
		},
		fireEvent: function() {
			for (var c = arguments[0], c = p.trim(c).split(" "), a = 0, e; e = c[a++];) {
				var d = A(this, e),
					b, h, f;
				if (d)
					for (f = d.length; f--;)
						if (d[f]) {
							h = d[f].apply(this, arguments);
							if (!0 === h) return h;
							void 0 !== h && (b = h)
						}
				if (h = this["on" + e.toLowerCase()]) b = h.apply(this, arguments)
			}
			return b
		}
	};
	var y = E.dtd = function() {
			function c(a) {
				for (var f in a) a[f.toUpperCase()] = a[f];
				return a
			}
			var a = p.extend2,
				e = c({
					isindex: 1,
					fieldset: 1
				}),
				d = c({
					input: 1,
					button: 1,
					select: 1,
					textarea: 1,
					label: 1
				}),
				b = a(c({
					a: 1
				}), d),
				h = a({
					iframe: 1
				}, b),
				f = c({
					hr: 1,
					ul: 1,
					menu: 1,
					div: 1,
					blockquote: 1,
					noscript: 1,
					table: 1,
					center: 1,
					address: 1,
					dir: 1,
					pre: 1,
					h5: 1,
					dl: 1,
					h4: 1,
					noframes: 1,
					h6: 1,
					ol: 1,
					h1: 1,
					h3: 1,
					h2: 1
				}),
				l = c({
					ins: 1,
					del: 1,
					script: 1,
					style: 1
				}),
				k = a(c({
					mark: 1,
					b: 1,
					acronym: 1,
					bdo: 1,
					"var": 1,
					"#": 1,
					abbr: 1,
					code: 1,
					br: 1,
					i: 1,
					cite: 1,
					kbd: 1,
					u: 1,
					strike: 1,
					s: 1,
					tt: 1,
					strong: 1,
					q: 1,
					samp: 1,
					em: 1,
					dfn: 1,
					span: 1
				}), l),
				n = a(c({
					sub: 1,
					img: 1,
					embed: 1,
					object: 1,
					sup: 1,
					basefont: 1,
					map: 1,
					applet: 1,
					font: 1,
					big: 1,
					small: 1
				}), k),
				m = a(c({
					p: 1
				}), n),
				d = a(c({
					iframe: 1
				}), n, d),
				n = c({
					img: 1,
					embed: 1,
					noscript: 1,
					br: 1,
					kbd: 1,
					center: 1,
					button: 1,
					basefont: 1,
					h5: 1,
					h4: 1,
					samp: 1,
					h6: 1,
					ol: 1,
					h1: 1,
					h3: 1,
					h2: 1,
					form: 1,
					font: 1,
					"#": 1,
					select: 1,
					menu: 1,
					ins: 1,
					abbr: 1,
					label: 1,
					code: 1,
					table: 1,
					script: 1,
					cite: 1,
					input: 1,
					iframe: 1,
					strong: 1,
					textarea: 1,
					noframes: 1,
					big: 1,
					small: 1,
					span: 1,
					hr: 1,
					sub: 1,
					bdo: 1,
					"var": 1,
					div: 1,
					object: 1,
					sup: 1,
					strike: 1,
					dir: 1,
					map: 1,
					dl: 1,
					applet: 1,
					del: 1,
					isindex: 1,
					fieldset: 1,
					ul: 1,
					b: 1,
					acronym: 1,
					a: 1,
					blockquote: 1,
					i: 1,
					u: 1,
					s: 1,
					tt: 1,
					address: 1,
					q: 1,
					pre: 1,
					p: 1,
					em: 1,
					dfn: 1
				}),
				g = a(c({
					a: 0
				}), d),
				v = c({
					tr: 1
				}),
				u = c({
					"#": 1
				}),
				x = a(c({
					param: 1
				}), n),
				w = a(c({
					form: 1
				}), e, h, f, m),
				F = c({
					li: 1,
					ol: 1,
					ul: 1
				}),
				I = c({
					style: 1,
					script: 1
				}),
				Q = c({
					base: 1,
					link: 1,
					meta: 1,
					title: 1
				}),
				I = a(Q, I),
				U = c({
					head: 1,
					body: 1
				}),
				la = c({
					html: 1
				}),
				q = c({
					address: 1,
					blockquote: 1,
					center: 1,
					dir: 1,
					div: 1,
					dl: 1,
					fieldset: 1,
					form: 1,
					h1: 1,
					h2: 1,
					h3: 1,
					h4: 1,
					h5: 1,
					h6: 1,
					hr: 1,
					isindex: 1,
					menu: 1,
					noframes: 1,
					ol: 1,
					p: 1,
					pre: 1,
					table: 1,
					ul: 1
				}),
				t = c({
					area: 1,
					base: 1,
					basefont: 1,
					br: 1,
					col: 1,
					command: 1,
					dialog: 1,
					hr: 1,
					img: 1,
					input: 1,
					isindex: 1,
					keygen: 1,
					link: 1,
					meta: 1,
					param: 1,
					source: 1,
					track: 1,
					wbr: 1
				});
			return c({
				$nonBodyContent: a(la, U, Q),
				$block: q,
				$inline: g,
				$inlineWithA: a(c({
					a: 1
				}), g),
				$body: a(c({
					script: 1,
					style: 1
				}), q),
				$cdata: c({
					script: 1,
					style: 1
				}),
				$empty: t,
				$nonChild: c({
					iframe: 1,
					textarea: 1,
					embed: 1
				}),
				$listItem: c({
					dd: 1,
					dt: 1,
					li: 1
				}),
				$list: c({
					ul: 1,
					ol: 1,
					dl: 1
				}),
				$isNotEmpty: c({
					table: 1,
					ul: 1,
					ol: 1,
					dl: 1,
					iframe: 1,
					area: 1,
					base: 1,
					col: 1,
					hr: 1,
					img: 1,
					embed: 1,
					input: 1,
					link: 1,
					meta: 1,
					param: 1,
					h1: 1,
					h2: 1,
					h3: 1,
					h4: 1,
					h5: 1,
					h6: 1
				}),
				$removeEmpty: c({
					a: 1,
					abbr: 1,
					acronym: 1,
					address: 1,
					b: 1,
					bdo: 1,
					big: 1,
					cite: 1,
					code: 1,
					del: 1,
					dfn: 1,
					em: 1,
					font: 1,
					i: 1,
					ins: 1,
					label: 1,
					kbd: 1,
					q: 1,
					s: 1,
					samp: 1,
					small: 1,
					span: 1,
					strike: 1,
					strong: 1,
					sub: 1,
					sup: 1,
					tt: 1,
					u: 1,
					"var": 1
				}),
				$removeEmptyBlock: c({
					p: 1,
					div: 1
				}),
				$tableContent: c({
					caption: 1,
					col: 1,
					colgroup: 1,
					tbody: 1,
					td: 1,
					tfoot: 1,
					th: 1,
					thead: 1,
					tr: 1,
					table: 1
				}),
				$notTransContent: c({
					pre: 1,
					script: 1,
					style: 1,
					textarea: 1
				}),
				html: U,
				head: I,
				style: u,
				script: u,
				body: w,
				base: {},
				link: {},
				meta: {},
				title: u,
				col: {},
				tr: c({
					td: 1,
					th: 1
				}),
				img: {},
				embed: {},
				colgroup: c({
					thead: 1,
					col: 1,
					tbody: 1,
					tr: 1,
					tfoot: 1
				}),
				noscript: w,
				td: w,
				br: {},
				th: w,
				center: w,
				kbd: g,
				button: a(m, f),
				basefont: {},
				h5: g,
				h4: g,
				samp: g,
				h6: g,
				ol: F,
				h1: g,
				h3: g,
				option: u,
				h2: g,
				form: a(e, h, f, m),
				select: c({
					optgroup: 1,
					option: 1
				}),
				font: g,
				ins: g,
				menu: F,
				abbr: g,
				label: g,
				table: c({
					thead: 1,
					col: 1,
					tbody: 1,
					tr: 1,
					colgroup: 1,
					caption: 1,
					tfoot: 1
				}),
				code: g,
				tfoot: v,
				cite: g,
				li: w,
				input: {},
				iframe: w,
				strong: g,
				textarea: u,
				noframes: w,
				big: g,
				small: g,
				span: c({
					"#": 1,
					br: 1,
					b: 1,
					strong: 1,
					u: 1,
					i: 1,
					em: 1,
					sub: 1,
					sup: 1,
					strike: 1,
					span: 1
				}),
				hr: g,
				dt: g,
				sub: g,
				optgroup: c({
					option: 1
				}),
				param: {},
				bdo: g,
				"var": g,
				div: w,
				object: x,
				sup: g,
				dd: w,
				strike: g,
				area: {},
				dir: F,
				map: a(c({
					area: 1,
					form: 1,
					p: 1
				}), e, l, f),
				applet: x,
				dl: c({
					dt: 1,
					dd: 1
				}),
				del: g,
				isindex: {},
				fieldset: a(c({
					legend: 1
				}), n),
				thead: v,
				ul: F,
				acronym: g,
				b: g,
				a: a(c({
					a: 1
				}), d),
				blockquote: a(c({
					td: 1,
					tr: 1,
					tbody: 1,
					li: 1
				}), w),
				caption: g,
				i: g,
				u: g,
				tbody: v,
				s: g,
				address: a(h, m),
				tt: g,
				legend: g,
				q: g,
				pre: a(k, b),
				p: a(c({
					a: 1
				}), g),
				em: g,
				dfn: g,
				mark: g
			})
		}(),
		ga = O && 9 > t.version ? {
			tabindex: "tabIndex",
			readonly: "readOnly",
			"for": "htmlFor",
			"class": "className",
			maxlength: "maxLength",
			cellspacing: "cellSpacing",
			cellpadding: "cellPadding",
			rowspan: "rowSpan",
			colspan: "colSpan",
			usemap: "useMap",
			frameborder: "frameBorder"
		} : {
			tabindex: "tabIndex",
			readonly: "readOnly"
		},
		na = p.listToMap("-webkit-box -moz-box block list-item table table-row-group table-header-group table-footer-group table-row table-column-group table-column table-cell table-caption".split(" ")),
		g = E.domUtils = {
			NODE_ELEMENT: 1,
			NODE_DOCUMENT: 9,
			NODE_TEXT: 3,
			NODE_COMMENT: 8,
			NODE_DOCUMENT_FRAGMENT: 11,
			POSITION_IDENTICAL: 0,
			POSITION_DISCONNECTED: 1,
			POSITION_FOLLOWING: 2,
			POSITION_PRECEDING: 4,
			POSITION_IS_CONTAINED: 8,
			POSITION_CONTAINS: 16,
			fillChar: O && "6" == t.version ? "﻿" : "​",
			keys: {
				8: 1,
				46: 1,
				16: 1,
				17: 1,
				18: 1,
				37: 1,
				38: 1,
				39: 1,
				40: 1,
				13: 1
			},
			getPosition: function(c, a) {
				if (c === a) return 0;
				var e, d = [c],
					b = [a];
				for (e = c; e = e.parentNode;) {
					if (e === a) return 10;
					d.push(e)
				}
				for (e = a; e = e.parentNode;) {
					if (e === c) return 20;
					b.push(e)
				}
				d.reverse();
				b.reverse();
				if (d[0] !== b[0]) return 1;
				for (e = -1; e++, d[e] === b[e];);
				c = d[e];
				for (a = b[e]; c = c.nextSibling;)
					if (c === a) return 4;
				return 2
			},
			getNodeIndex: function(c, a) {
				for (var e = c, d = 0; e = e.previousSibling;) a && 3 == e.nodeType ? e.nodeType != e.nextSibling.nodeType && d++ : d++;
				return d
			},
			inDoc: function(c, a) {
				return 10 == g.getPosition(c, a)
			},
			findParent: function(c, a, e) {
				if (c && !g.isBody(c))
					for (c = e ? c : c.parentNode; c;) {
						if (!a || a(c) || g.isBody(c)) return a && !a(c) && g.isBody(c) ? null : c;
						c = c.parentNode
					}
				return null
			},
			findParentByTagName: function(c, a, e, d) {
				a = p.listToMap(p.isArray(a) ? a : [a]);
				return g.findParent(c, function(b) {
					return a[b.tagName] && !(d && d(b))
				}, e)
			},
			findParents: function(c, a, e, d) {
				for (a = a && (e && e(c) || !e) ? [c] : []; c = g.findParent(c, e);) a.push(c);
				return d ? a : a.reverse()
			},
			insertAfter: function(c, a) {
				return c.nextSibling ? c.parentNode.insertBefore(a, c.nextSibling) : c.parentNode.appendChild(a)
			},
			remove: function(c, a) {
				var e = c.parentNode,
					d;
				if (e) {
					if (a && c.hasChildNodes())
						for (; d = c.firstChild;) e.insertBefore(d, c);
					e.removeChild(c)
				}
				return c
			},
			getNextDomNode: function(c, a, e, d) {
				return H(c, "firstChild", "nextSibling", a, e, d)
			},
			getPreDomNode: function(c, a, e, d) {
				return H(c, "lastChild", "previousSibling", a, e, d)
			},
			isBookmarkNode: function(c) {
				return 1 == c.nodeType && c.id && /^_baidu_bookmark_/i.test(c.id)
			},
			getWindow: function(c) {
				c = c.ownerDocument || c;
				return c.defaultView || c.parentWindow
			},
			getCommonAncestor: function(c, a) {
				if (c === a) return c;
				for (var e = [c], d = [a], b = c, h = -1; b = b.parentNode;) {
					if (b === a) return b;
					e.push(b)
				}
				for (b = a; b = b.parentNode;) {
					if (b === c) return b;
					d.push(b)
				}
				e.reverse();
				for (d.reverse(); h++, e[h] === d[h];);
				return 0 == h ? null : e[h - 1]
			},
			clearEmptySibling: function(c, a, e) {
				function d(a, d) {
					for (var f; a && !g.isBookmarkNode(a) && (g.isEmptyInlineElement(a) || !(new RegExp("[^\t\n\r" + g.fillChar + "]")).test(a.nodeValue));) f = a[d], g.remove(a), a = f
				}!a && d(c.nextSibling, "nextSibling");
				!e && d(c.previousSibling, "previousSibling")
			},
			split: function(c, a) {
				var e = c.ownerDocument;
				if (t.ie && a == c.nodeValue.length) {
					var d = e.createTextNode("");
					return g.insertAfter(c, d)
				}
				d = c.splitText(a);
				t.ie8 && (e = e.createTextNode(""), g.insertAfter(d, e), g.remove(e));
				return d
			},
			isWhitespace: function(c) {
				return !(new RegExp("[^ \t\n\r" + g.fillChar + "]")).test(c.nodeValue)
			},
			getXY: function(c) {
				for (var a = 0, e = 0; c.offsetParent;) e += c.offsetTop, a += c.offsetLeft, c = c.offsetParent;
				return {
					x: a,
					y: e
				}
			},
			on: function(c, a, e) {
				var d = p.isArray(a) ? a : p.trim(a).split(/\s+/),
					b = d.length;
				if (b)
					for (; b--;)
						if (a = d[b], c.addEventListener) c.addEventListener(a, e, !1);
						else {
							e._d || (e._d = {
								els: []
							});
							var h = a + e.toString(),
								f = p.indexOf(e._d.els, c);
							e._d[h] && -1 != f || (-1 == f && e._d.els.push(c), e._d[h] || (e._d[h] = function(a) {
								return e.call(a.srcElement, a || window.event)
							}), c.attachEvent("on" + a, e._d[h]))
						}
				c = null
			},
			un: function(c, a, e) {
				var d = p.isArray(a) ? a : p.trim(a).split(/\s+/),
					b = d.length;
				if (b)
					for (; b--;)
						if (a = d[b], c.removeEventListener) c.removeEventListener(a, e, !1);
						else {
							var h = a + e.toString();
							try {
								c.detachEvent("on" + a, e._d ? e._d[h] : e)
							} catch (f) {}
							e._d && e._d[h] && (a = p.indexOf(e._d.els, c), -1 != a && e._d.els.splice(a, 1), 0 == e._d.els.length && delete e._d[h])
						}
			},
			isSameElement: function(c, a) {
				if (c.tagName != a.tagName) return !1;
				var e = c.attributes,
					d = a.attributes;
				if (!O && e.length != d.length) return !1;
				for (var b, h, f = 0, l = 0, k = 0; b = e[k++];) {
					if ("style" == b.nodeName)
						if (b.specified && f++, g.isSameStyle(c, a)) continue;
						else return !1;
					if (O)
						if (b.specified) f++, h = d.getNamedItem(b.nodeName);
						else continue;
					else h = a.attributes[b.nodeName];
					if (!h.specified || b.nodeValue != h.nodeValue) return !1
				}
				if (O) {
					for (k = 0; h = d[k++];) h.specified && l++;
					if (f != l) return !1
				}
				return !0
			},
			isSameStyle: function(c, a) {
				var e = c.style.cssText.replace(/( ?; ?)/g, ";").replace(/( ?: ?)/g, ":"),
					d = a.style.cssText.replace(/( ?; ?)/g, ";").replace(/( ?: ?)/g, ":");
				if (t.opera) {
					e = c.style;
					d = a.style;
					if (e.length != d.length) return !1;
					for (var b in e)
						if (!/^(\d+|csstext)$/i.test(b) && e[b] != d[b]) return !1;
					return !0
				}
				if (!e || !d) return e == d;
				e = e.split(";");
				d = d.split(";");
				if (e.length != d.length) return !1;
				b = 0;
				for (var h; h = e[b++];)
					if (-1 == p.indexOf(d, h)) return !1;
				return !0
			},
			isBlockElm: function(c) {
				return 1 == c.nodeType && (y.$block[c.tagName] || na[g.getComputedStyle(c, "display")]) && !y.$nonChild[c.tagName]
			},
			isBody: function(c) {
				return c && 1 == c.nodeType && "body" == c.tagName.toLowerCase()
			},
			breakParent: function(c, a) {
				var e, d = c,
					b = c,
					h, f;
				do {
					d = d.parentNode;
					h ? (e = d.cloneNode(!1), e.appendChild(h), h = e, e = d.cloneNode(!1), e.appendChild(f), f = e) : (h = d.cloneNode(!1), f = h.cloneNode(!1));
					for (; e = b.previousSibling;) h.insertBefore(e, h.firstChild);
					for (; e = b.nextSibling;) f.appendChild(e);
					b = d
				} while (a !== d);
				e = a.parentNode;
				e.insertBefore(h, a);
				e.insertBefore(f, a);
				e.insertBefore(c, f);
				g.remove(a);
				return c
			},
			isEmptyInlineElement: function(c) {
				if (1 != c.nodeType || !y.$removeEmpty[c.tagName]) return 0;
				for (c = c.firstChild; c;) {
					if (g.isBookmarkNode(c) || 1 == c.nodeType && !g.isEmptyInlineElement(c) || 3 == c.nodeType && !g.isWhitespace(c)) return 0;
					c = c.nextSibling
				}
				return 1
			},
			trimWhiteTextNode: function(c) {
				function a(a) {
					for (var d;
						(d = c[a]) && 3 == d.nodeType && g.isWhitespace(d);) c.removeChild(d)
				}
				a("firstChild");
				a("lastChild")
			},
			mergeChild: function(c, a, e) {
				a = g.getElementsByTagName(c, c.tagName.toLowerCase());
				for (var d = 0, b; b = a[d++];)
					if (b.parentNode && !g.isBookmarkNode(b))
						if ("span" == b.tagName.toLowerCase()) {
							if (c === b.parentNode && (g.trimWhiteTextNode(c), 1 == c.childNodes.length)) {
								c.style.cssText = b.style.cssText + ";" + c.style.cssText;
								g.remove(b, !0);
								continue
							}
							b.style.cssText = c.style.cssText + ";" + b.style.cssText;
							if (e) {
								var h = e.style;
								if (h)
									for (var h = h.split(";"), f = 0, l; l = h[f++];) b.style[p.cssStyleToDomStyle(l.split(":")[0])] = l.split(":")[1]
							}
							g.isSameStyle(b, c) && g.remove(b, !0)
						} else g.isSameElement(c, b) && g.remove(b, !0)
			},
			getElementsByTagName: function(c, a, e) {
				if (e && p.isString(e)) {
					var d = e;
					e = function(a) {
						return g.hasClass(a, d)
					}
				}
				a = p.trim(a).replace(/[ ]{2,}/g, " ").split(" ");
				for (var b = [], h = 0, f; f = a[h++];) {
					f = c.getElementsByTagName(f);
					for (var l = 0, k; k = f[l++];) e && !e(k) || b.push(k)
				}
				return b
			},
			mergeToParent: function(c) {
				for (var a = c.parentNode; a && y.$removeEmpty[a.tagName];) {
					if (a.tagName == c.tagName || "A" == a.tagName) {
						g.trimWhiteTextNode(a);
						if ("SPAN" == a.tagName && !g.isSameStyle(a, c) || "A" == a.tagName && "SPAN" == c.tagName)
							if (1 < a.childNodes.length || a !== c.parentNode) {
								c.style.cssText = a.style.cssText + ";" + c.style.cssText;
								a = a.parentNode;
								continue
							} else a.style.cssText += ";" + c.style.cssText, "A" == a.tagName && (a.style.textDecoration = "underline");
						if ("A" != a.tagName) {
							a === c.parentNode && g.remove(c, !0);
							break
						}
					}
					a = a.parentNode
				}
			},
			mergeSibling: function(c, a, e) {
				function d(a, d, f) {
					var b;
					if ((b = f[a]) && !g.isBookmarkNode(b) && 1 == b.nodeType && g.isSameElement(f, b)) {
						for (; b.firstChild;) "firstChild" == d ? f.insertBefore(b.lastChild, f.firstChild) : f.appendChild(b.firstChild);
						g.remove(b)
					}
				}!a && d("previousSibling", "firstChild", c);
				!e && d("nextSibling", "lastChild", c)
			},
			unSelectable: O && t.ie9below || t.opera ?
				function(c) {
					c.onselectstart = function() {
						return !1
					};
					c.onclick = c.onkeyup = c.onkeydown = function() {
						return !1
					};
					c.unselectable = "on";
					c.setAttribute("unselectable", "on");
					for (var a = 0, e; e = c.all[a++];) switch (e.tagName.toLowerCase()) {
						case "iframe":
						case "textarea":
						case "input":
						case "select":
							break;
						default:
							e.unselectable = "on", c.setAttribute("unselectable", "on")
					}
				} : function(c) {
					c.style.MozUserSelect = c.style.webkitUserSelect = c.style.msUserSelect = c.style.KhtmlUserSelect = "none"
				},
			removeAttributes: function(c, a) {
				a = p.isArray(a) ? a : p.trim(a).replace(/[ ]{2,}/g, " ").split(" ");
				for (var e = 0, d; d = a[e++];) {
					d = ga[d] || d;
					switch (d) {
						case "className":
							c[d] = "";
							break;
						case "style":
							c.style.cssText = "";
							var b = c.getAttributeNode("style");
							!t.ie && b && c.removeAttributeNode(b)
					}
					c.removeAttribute(d)
				}
			},
			createElement: function(c, a, e) {
				return g.setAttributes(c.createElement(a), e)
			},
			setAttributes: function(c, a) {
				for (var e in a)
					if (a.hasOwnProperty(e)) {
						var d = a[e];
						switch (e) {
							case "class":
								c.className = d;
								break;
							case "style":
								c.style.cssText = c.style.cssText + ";" + d;
								break;
							case "innerHTML":
								c[e] = d;
								break;
							case "value":
								c.value = d;
								break;
							default:
								c.setAttribute(ga[e] || e, d)
						}
					}
				return c
			},
			getComputedStyle: function(c, a) {
				if (-1 < "width height top left".indexOf(a)) return c["offset" + a.replace(/^\w/, function(a) {
					return a.toUpperCase()
				})] + "px";
				3 == c.nodeType && (c = c.parentNode);
				if (t.ie && 9 > t.version && "font-size" == a && !c.style.fontSize && !y.$empty[c.tagName] && !y.$nonChild[c.tagName]) {
					var e = c.ownerDocument.createElement("span");
					e.style.cssText = "padding:0;border:0;font-family:simsun;";
					e.innerHTML = ".";
					c.appendChild(e);
					var d = e.offsetHeight;
					c.removeChild(e);
					e = null;
					return d + "px"
				}
				try {
					e = g.getStyle(c, a) || (window.getComputedStyle ? g.getWindow(c).getComputedStyle(c, "").getPropertyValue(a) : (c.currentStyle || c.style)[p.cssStyleToDomStyle(a)])
				} catch (b) {
					return ""
				}
				return p.transUnitToPx(p.fixColor(a, e))
			},
			removeClasses: function(c, a) {
				a = p.isArray(a) ? a : p.trim(a).replace(/[ ]{2,}/g, " ").split(" ");
				for (var e = 0, d, b = c.className; d = a[e++];) b = b.replace(new RegExp("\\b" + d + "\\b"), "");
				(b = p.trim(b).replace(/[ ]{2,}/g, " ")) ? c.className = b: g.removeAttributes(c, ["class"])
			},
			addClass: function(c, a) {
				if (c) {
					a = p.trim(a).replace(/[ ]{2,}/g, " ").split(" ");
					for (var e = 0, d, b = c.className; d = a[e++];)(new RegExp("\\b" + d + "\\b")).test(b) || (b += " " + d);
					c.className = p.trim(b)
				}
			},
			hasClass: function(c, a) {
				if (p.isRegExp(a)) return a.test(c.className);
				a = p.trim(a).replace(/[ ]{2,}/g, " ").split(" ");
				for (var e = 0, d, b = c.className; d = a[e++];)
					if (!(new RegExp("\\b" + d + "\\b", "i")).test(b)) return !1;
				return e - 1 == a.length
			},
			preventDefault: function(c) {
				c.preventDefault ? c.preventDefault() : c.returnValue = !1
			},
			removeStyle: function(c, a) {
				t.ie ? ("color" == a && (a = "(^|;)" + a), c.style.cssText = c.style.cssText.replace(new RegExp(a + "[^:]*:[^;]+;?", "ig"), "")) : c.style.removeProperty ? c.style.removeProperty(a) : c.style.removeAttribute(p.cssStyleToDomStyle(a));
				c.style.cssText || g.removeAttributes(c, ["style"])
			},
			getStyle: function(c, a) {
				var e = c.style[p.cssStyleToDomStyle(a)];
				return p.fixColor(a, e)
			},
			setStyle: function(c, a, e) {
				c.style[p.cssStyleToDomStyle(a)] = e;
				p.trim(c.style.cssText) || this.removeAttributes(c, "style")
			},
			setStyles: function(c, a) {
				for (var e in a) a.hasOwnProperty(e) && g.setStyle(c, e, a[e])
			},
			removeDirtyAttr: function(c) {
				for (var a = 0, e, d = c.getElementsByTagName("*"); e = d[a++];) e.removeAttribute("_moz_dirty");
				c.removeAttribute("_moz_dirty")
			},
			getChildCount: function(c, a) {
				var e = 0,
					d = c.firstChild;
				for (a = a ||
					function() {
						return 1
					}; d;) a(d) && e++, d = d.nextSibling;
				return e
			},
			isEmptyNode: function(c) {
				return !c.firstChild || 0 == g.getChildCount(c, function(a) {
					return !g.isBr(a) && !g.isBookmarkNode(a) && !g.isWhitespace(a)
				})
			},
			clearSelectedArr: function(c) {
				for (var a; a = c.pop();) g.removeAttributes(a, ["class"])
			},
			scrollToView: function(c, a, e) {
				var d = function() {
					var b = a.document,
						d = "CSS1Compat" == b.compatMode;
					return {
						width: (d ? b.documentElement.clientWidth : b.body.clientWidth) || 0,
						height: (d ? b.documentElement.clientHeight : b.body.clientHeight) || 0
					}
				}().height;
				e = -1 * d + e + (c.offsetHeight || 0);
				c = g.getXY(c);
				e += c.y;
				c = function(a) {
					if ("pageXOffset" in a) return {
						x: a.pageXOffset || 0,
						y: a.pageYOffset || 0
					};
					a = a.document;
					return {
						x: a.documentElement.scrollLeft || a.body.scrollLeft || 0,
						y: a.documentElement.scrollTop || a.body.scrollTop || 0
					}
				}(a).y;
				(e > c || e < c - d) && a.scrollTo(0, e + (0 > e ? -20 : 20))
			},
			isBr: function(c) {
				return 1 == c.nodeType && "BR" == c.tagName
			},
			isFillChar: function(c, a) {
				if (3 != c.nodeType) return !1;
				var e = c.nodeValue;
				return a ? (new RegExp("^" + g.fillChar)).test(e) : !e.replace(new RegExp(g.fillChar, "g"), "").length
			},
			isStartInblock: function(c) {
				c = c.cloneRange();
				var a = 0,
					e = c.startContainer,
					d;
				if (1 == e.nodeType && e.childNodes[c.startOffset])
					for (var e = e.childNodes[c.startOffset], b = e.previousSibling; b && g.isFillChar(b);) e = b, b = b.previousSibling;
				this.isFillChar(e, !0) && 1 == c.startOffset && (c.setStartBefore(e), e = c.startContainer);
				for (; e && g.isFillChar(e);) d = e, e = e.previousSibling;
				d && (c.setStartBefore(d), e = c.startContainer);
				for (1 == e.nodeType && g.isEmptyNode(e) && 1 == c.startOffset && c.setStart(e, 0).collapse(!0); !c.startOffset;) {
					e = c.startContainer;
					if (g.isBlockElm(e) || g.isBody(e)) {
						a = 1;
						break
					}
					var b = c.startContainer.previousSibling,
						h;
					if (b) {
						for (; b && g.isFillChar(b);) h = b, b = b.previousSibling;
						h ? c.setStartBefore(h) : c.setStartBefore(c.startContainer)
					} else c.setStartBefore(c.startContainer)
				}
				return a && !g.isBody(c.startContainer) ? 1 : 0
			},
			isEmptyBlock: function(c, a) {
				if (1 != c.nodeType) return 0;
				a = a || new RegExp("[  \t\r\n" + g.fillChar + "]", "g");
				if (0 < c[t.ie ? "innerText" : "textContent"].replace(a, "").length) return 0;
				for (var e in y.$isNotEmpty)
					if (c.getElementsByTagName(e).length) return 0;
				return 1
			},
			setViewportOffset: function(c, a) {
				var e = parseInt(c.style.left) | 0,
					d = parseInt(c.style.top) | 0,
					b = c.getBoundingClientRect(),
					h = a.left - b.left,
					b = a.top - b.top;
				h && (c.style.left = e + h + "px");
				b && (c.style.top = d + b + "px")
			},
			fillNode: function(c, a) {
				var e = t.ie ? c.createTextNode(g.fillChar) : c.createElement("br");
				a.innerHTML = "";
				a.appendChild(e)
			},
			moveChild: function(c, a, e) {
				for (; c.firstChild;) e && a.firstChild ? a.insertBefore(c.lastChild, a.firstChild) : a.appendChild(c.firstChild)
			},
			hasNoAttributes: function(c) {
				return t.ie ? /^<\w+\s*?>/.test(c.outerHTML) : 0 == c.attributes.length
			},
			isCustomeNode: function(c) {
				return 1 == c.nodeType && c.getAttribute("_ue_custom_node_")
			},
			isTagNode: function(c, a) {
				return 1 == c.nodeType && (new RegExp("\\b" + c.tagName + "\\b", "i")).test(a)
			},
			filterNodeList: function(c, a, e) {
				var d = [];
				if (!p.isFunction(a)) {
					var b = a;
					a = function(a) {
						return a && a.tagName ? -1 != p.indexOf(p.isArray(b) ? b : b.split(" "), a.tagName.toLowerCase()) : !1
					}
				}
				p.each(c, function(b) {
					a(b) && d.push(b)
				});
				return 0 == d.length ? null : 1 != d.length && e ? d : d[0]
			},
			isInNodeEndBoundary: function(c, a) {
				var e = c.startContainer;
				if (3 == e.nodeType && c.startOffset != e.nodeValue.length || 1 == e.nodeType && c.startOffset != e.childNodes.length) return 0;
				for (; e !== a;) {
					if (e.nextSibling) return 0;
					e = e.parentNode
				}
				return 1
			},
			isBoundaryNode: function(c, a) {
				for (var e; !g.isBody(c);)
					if (e = c, c = c.parentNode, e !== c[a]) return !1;
				return !0
			},
			fillHtml: t.ie11below ? "&nbsp;" : "<br/>"
		},
		S = new RegExp(g.fillChar, "g");
	window.domUtils = g;
	window.dtd = y;
	(function() {
		function c(a) {
			return !a.collapsed && 1 == a.startContainer.nodeType && a.startContainer === a.endContainer && 1 == a.endOffset - a.startOffset
		}

		function a(a, f, k, b) {
			1 == f.nodeType && (y.$empty[f.tagName] || y.$nonChild[f.tagName]) && (k = g.getNodeIndex(f) + (a ? 0 : 1), f = f.parentNode);
			a ? (b.startContainer = f, b.startOffset = k, b.endContainer || b.collapse(!0)) : (b.endContainer = f, b.endOffset = k, b.startContainer || b.collapse(!1));
			b.collapsed = b.startContainer && b.endContainer && b.startContainer === b.endContainer && b.startOffset == b.endOffset;
			return b
		}

		function e(a, f) {
			var b = a.startContainer,
				k = a.endContainer,
				d = a.startOffset,
				l = a.endOffset,
				h = a.document,
				e = h.createDocumentFragment(),
				c, m;
			1 == b.nodeType && (b = b.childNodes[d] || (c = b.appendChild(h.createTextNode(""))));
			1 == k.nodeType && (k = k.childNodes[l] || (m = k.appendChild(h.createTextNode(""))));
			if (b === k && 3 == b.nodeType) return e.appendChild(h.createTextNode(b.substringData(d, l - d))), f && (b.deleteData(d, l - d), a.collapse(!0)), e;
			for (var n, p, q = e, t = g.findParents(b, !0), M = g.findParents(k, !0), J = 0; t[J] == M[J];) J++;
			for (var K = J, C; C = t[K]; K++) {
				n = C.nextSibling;
				C == b ? c || (3 == a.startContainer.nodeType ? (q.appendChild(h.createTextNode(b.nodeValue.slice(d))), f && b.deleteData(d, b.nodeValue.length - d)) : q.appendChild(f ? b : b.cloneNode(!0))) : (p = C.cloneNode(!1), q.appendChild(p));
				for (; n && n !== k && n !== M[K];) C = n.nextSibling, q.appendChild(f ? n : n.cloneNode(!0)), n = C;
				q = p
			}
			q = e;
			t[J] || (q.appendChild(t[J - 1].cloneNode(!1)), q = q.firstChild);
			for (K = J; d = M[K]; K++) {
				n = d.previousSibling;
				d == k ? m || 3 != a.endContainer.nodeType || (q.appendChild(h.createTextNode(k.substringData(0, l))), f && k.deleteData(0, l)) : (p = d.cloneNode(!1), q.appendChild(p));
				if (K != J || !t[J])
					for (; n && n !== b;) d = n.previousSibling, q.insertBefore(f ? n : n.cloneNode(!0), q.firstChild), n = d;
				q = p
			}
			f && a.setStartBefore(M[J] ? t[J] ? M[J] : t[J - 1] : M[J - 1]).collapse(!0);
			c && g.remove(c);
			m && g.remove(m);
			return e
		}

		function d(a, f) {
			try {
				if (l && g.inDoc(l, a))
					if (l.nodeValue.replace(S, "").length) l.nodeValue = l.nodeValue.replace(S, "");
					else {
						var b = l.parentNode;
						for (g.remove(l); b && g.isEmptyInlineElement(b) && (t.safari ? !(g.getPosition(b, f) & g.POSITION_CONTAINS) : !b.contains(f));) l = b.parentNode, g.remove(b), b = l
					}
			} catch (v) {}
		}

		function b(a, f) {
			var b;
			for (a = a[f]; a && g.isFillChar(a);) b = a[f], g.remove(a), a = b
		}
		var h = 0,
			f = g.fillChar,
			l, k = E.Range = function(a) {
				this.startContainer = this.startOffset = this.endContainer = this.endOffset = null;
				this.document = a;
				this.collapsed = !0
			};
		k.prototype = {
			cloneContents: function() {
				return this.collapsed ? null : e(this, 0)
			},
			deleteContents: function() {
				var a;
				this.collapsed || e(this, 1);
				t.webkit && (a = this.startContainer, 3 != a.nodeType || a.nodeValue.length || (this.setStartBefore(a).collapse(!0), g.remove(a)));
				return this
			},
			extractContents: function() {
				return this.collapsed ? null : e(this, 2)
			},
			setStart: function(f, b) {
				return a(!0, f, b, this)
			},
			setEnd: function(f, b) {
				return a(!1, f, b, this)
			},
			setStartAfter: function(a) {
				return this.setStart(a.parentNode, g.getNodeIndex(a) + 1)
			},
			setStartBefore: function(a) {
				return this.setStart(a.parentNode, g.getNodeIndex(a))
			},
			setEndAfter: function(a) {
				return this.setEnd(a.parentNode, g.getNodeIndex(a) + 1)
			},
			setEndBefore: function(a) {
				return this.setEnd(a.parentNode, g.getNodeIndex(a))
			},
			setStartAtFirst: function(a) {
				return this.setStart(a, 0)
			},
			setStartAtLast: function(a) {
				return this.setStart(a, 3 == a.nodeType ? a.nodeValue.length : a.childNodes.length)
			},
			setEndAtFirst: function(a) {
				return this.setEnd(a, 0)
			},
			setEndAtLast: function(a) {
				return this.setEnd(a, 3 == a.nodeType ? a.nodeValue.length : a.childNodes.length)
			},
			selectNode: function(a) {
				return this.setStartBefore(a).setEndAfter(a)
			},
			selectNodeContents: function(a) {
				return this.setStart(a, 0).setEndAtLast(a)
			},
			cloneRange: function() {
				return (new k(this.document)).setStart(this.startContainer, this.startOffset).setEnd(this.endContainer, this.endOffset)
			},
			collapse: function(a) {
				a ? (this.endContainer = this.startContainer, this.endOffset = this.startOffset) : (this.startContainer = this.endContainer, this.startOffset = this.endOffset);
				this.collapsed = !0;
				return this
			},
			shrinkBoundary: function(a) {
				function f(a) {
					return 1 == a.nodeType && !g.isBookmarkNode(a) && !y.$empty[a.tagName] && !y.$nonChild[a.tagName]
				}
				for (var b, k = this.collapsed; 1 == this.startContainer.nodeType && (b = this.startContainer.childNodes[this.startOffset]) && f(b);) this.setStart(b, 0);
				if (k) return this.collapse(!0);
				if (!a)
					for (; 1 == this.endContainer.nodeType && 0 < this.endOffset && (b = this.endContainer.childNodes[this.endOffset - 1]) && f(b);) this.setEnd(b, b.childNodes.length);
				return this
			},
			getCommonAncestor: function(a, b) {
				var f = this.startContainer,
					k = this.endContainer;
				return f === k ? a && c(this) && (f = f.childNodes[this.startOffset], 1 == f.nodeType) ? f : b && 3 == f.nodeType ? f.parentNode : f : g.getCommonAncestor(f, k)
			},
			trimBoundary: function(a) {
				this.txtToElmBoundary();
				var f = this.startContainer,
					b = this.startOffset,
					k = this.collapsed,
					d = this.endContainer;
				if (3 == f.nodeType) {
					if (0 == b) this.setStartBefore(f);
					else if (b >= f.nodeValue.length) this.setStartAfter(f);
					else {
						var l = g.split(f, b);
						f === d ? this.setEnd(l, this.endOffset - b) : f.parentNode === d && (this.endOffset += 1);
						this.setStartBefore(l)
					}
					if (k) return this.collapse(!0)
				}
				a || (b = this.endOffset, d = this.endContainer, 3 == d.nodeType && (0 == b ? this.setEndBefore(d) : (b < d.nodeValue.length && g.split(d, b), this.setEndAfter(d))));
				return this
			},
			txtToElmBoundary: function(a) {
				function f(a, f) {
					var b = a[f + "Container"],
						k = a[f + "Offset"];
					if (3 == b.nodeType)
						if (!k) a["set" + f.replace(/(\w)/, function(a) {
							return a.toUpperCase()
						}) + "Before"](b);
						else if (k >= b.nodeValue.length) a["set" + f.replace(/(\w)/, function(a) {
						return a.toUpperCase()
					}) + "After"](b)
				}
				if (a || !this.collapsed) f(this, "start"), f(this, "end");
				return this
			},
			insertNode: function(a) {
				var f = a,
					b = 1;
				11 == a.nodeType && (f = a.firstChild, b = a.childNodes.length);
				this.trimBoundary(!0);
				var k = this.startContainer,
					d = k.childNodes[this.startOffset];
				d ? k.insertBefore(a, d) : k.appendChild(a);
				f.parentNode === this.endContainer && (this.endOffset += b);
				return this.setStartBefore(f)
			},
			setCursor: function(a, f) {
				return this.collapse(!a).select(f)
			},
			createBookmark: function(a, f) {
				var b, k = this.document.createElement("span");
				k.style.cssText = "display:none;line-height:0px;";
				k.appendChild(this.document.createTextNode("‍"));
				k.id = "_baidu_bookmark_start_" + (f ? "" : h++);
				this.collapsed || (b = k.cloneNode(!0), b.id = "_baidu_bookmark_end_" + (f ? "" : h++));
				this.insertNode(k);
				b && this.collapse().insertNode(b).setEndBefore(b);
				this.setStartAfter(k);
				return {
					start: a ? k.id : k,
					end: b ? a ? b.id : b : null,
					id: a
				}
			},
			moveToBookmark: function(a) {
				var f = a.id ? this.document.getElementById(a.start) : a.start;
				a = a.end && a.id ? this.document.getElementById(a.end) : a.end;
				this.setStartBefore(f);
				g.remove(f);
				a ? (this.setEndBefore(a), g.remove(a)) : this.collapse(!0);
				return this
			},
			enlarge: function(a, f) {
				var b = g.isBody,
					k, d, l = this.document.createTextNode("");
				if (a) {
					d = this.startContainer;
					1 == d.nodeType ? d.childNodes[this.startOffset] ? k = d = d.childNodes[this.startOffset] : (d.appendChild(l), k = d = l) : k = d;
					for (;;) {
						if (g.isBlockElm(d)) {
							for (d = k;
								(k = d.previousSibling) && !g.isBlockElm(k);) d = k;
							this.setStartBefore(d);
							break
						}
						k = d;
						d = d.parentNode
					}
					d = this.endContainer;
					1 == d.nodeType ? ((k = d.childNodes[this.endOffset]) ? d.insertBefore(l, k) : d.appendChild(l), k = d = l) : k = d;
					for (;;) {
						if (g.isBlockElm(d)) {
							for (d = k;
								(k = d.nextSibling) && !g.isBlockElm(k);) d = k;
							this.setEndAfter(d);
							break
						}
						k = d;
						d = d.parentNode
					}
					l.parentNode === this.endContainer && this.endOffset--;
					g.remove(l)
				}
				if (!this.collapsed) {
					for (; !(0 != this.startOffset || f && f(this.startContainer) || b(this.startContainer));) this.setStartBefore(this.startContainer);
					for (; !(this.endOffset != (1 == this.endContainer.nodeType ? this.endContainer.childNodes.length : this.endContainer.nodeValue.length) || f && f(this.endContainer) || b(this.endContainer));) this.setEndAfter(this.endContainer)
				}
				return this
			},
			enlargeToBlockElm: function(a) {
				for (; !g.isBlockElm(this.startContainer);) this.setStartBefore(this.startContainer);
				if (!a)
					for (; !g.isBlockElm(this.endContainer);) this.setEndAfter(this.endContainer);
				return this
			},
			adjustmentBoundary: function() {
				if (!this.collapsed) {
					for (; !g.isBody(this.startContainer) && this.startOffset == this.startContainer[3 == this.startContainer.nodeType ? "nodeValue" : "childNodes"].length && this.startContainer[3 == this.startContainer.nodeType ? "nodeValue" : "childNodes"].length;) this.setStartAfter(this.startContainer);
					for (; !g.isBody(this.endContainer) && !this.endOffset && this.endContainer[3 == this.endContainer.nodeType ? "nodeValue" : "childNodes"].length;) this.setEndBefore(this.endContainer)
				}
				return this
			},
			applyInlineStyle: function(a, f, b) {
				if (this.collapsed) return this;
				this.trimBoundary().enlarge(!1, function(a) {
					return 1 == a.nodeType && g.isBlockElm(a)
				}).adjustmentBoundary();
				for (var k = this.createBookmark(), d = k.end, l = function(a) {
						return 1 == a.nodeType ? "br" != a.tagName.toLowerCase() : !g.isWhitespace(a)
					}, h = g.getNextDomNode(k.start, !1, l), e, c, m = this.cloneRange(); h && g.getPosition(h, d) & g.POSITION_PRECEDING;)
					if (3 == h.nodeType || y[a][h.tagName]) {
						m.setStartBefore(h);
						for (e = h; e && (3 == e.nodeType || y[a][e.tagName]) && e !== d;) c = e, e = g.getNextDomNode(e, 1 == e.nodeType, null, function(f) {
							return y[a][f.tagName]
						});
						var h = m.setEndAfter(c).extractContents(),
							n;
						if (b && 0 < b.length) {
							var r;
							r = n = b[0].cloneNode(!1);
							for (var q = 1, t; t = b[q++];) n.appendChild(t.cloneNode(!1)), n = n.firstChild
						} else n = m.document.createElement(a);
						f && g.setAttributes(n, f);
						n.appendChild(h);
						"SPAN" == n.tagName && f && f.style && p.each(n.getElementsByTagName("span"), function(a) {
							a.style.cssText = a.style.cssText + ";" + f.style
						});
						m.insertNode(b ? r : n);
						var M;
						"span" == a && f.style && /text\-decoration/.test(f.style) && (M = g.findParentByTagName(n, "a", !0)) ? (g.setAttributes(M, f), g.remove(n, !0), n = M) : (g.mergeSibling(n), g.clearEmptySibling(n));
						g.mergeChild(n, f);
						h = g.getNextDomNode(n, !1, l);
						g.mergeToParent(n);
						if (e === d) break
					} else h = g.getNextDomNode(h, !0, l);
				return this.moveToBookmark(k)
			},
			removeInlineStyle: function(a) {
				if (this.collapsed) return this;
				a = p.isArray(a) ? a : [a];
				this.shrinkBoundary().adjustmentBoundary();
				for (var f = this.startContainer, b = this.endContainer;;) {
					if (1 == f.nodeType) {
						if (-1 < p.indexOf(a, f.tagName.toLowerCase())) break;
						if ("body" == f.tagName.toLowerCase()) {
							f = null;
							break
						}
					}
					f = f.parentNode
				}
				for (;;) {
					if (1 == b.nodeType) {
						if (-1 < p.indexOf(a, b.tagName.toLowerCase())) break;
						if ("body" == b.tagName.toLowerCase()) {
							b = null;
							break
						}
					}
					b = b.parentNode
				}
				var k = this.createBookmark(),
					d, l;
				f && (l = this.cloneRange().setEndBefore(k.start).setStartBefore(f), d = l.extractContents(), l.insertNode(d), g.clearEmptySibling(f, !0), f.parentNode.insertBefore(k.start, f));
				b && (l = this.cloneRange().setStartAfter(k.end).setEndAfter(b), d = l.extractContents(), l.insertNode(d), g.clearEmptySibling(b, !1, !0), b.parentNode.insertBefore(k.end, b.nextSibling));
				for (f = g.getNextDomNode(k.start, !1, function(a) {
						return 1 == a.nodeType
					}); f && f !== k.end;) b = g.getNextDomNode(f, !0, function(a) {
					return 1 == a.nodeType
				}), -1 < p.indexOf(a, f.tagName.toLowerCase()) && g.remove(f, !0), f = b;
				return this.moveToBookmark(k)
			},
			getClosedNode: function() {
				var a;
				if (!this.collapsed) {
					var f = this.cloneRange().adjustmentBoundary().shrinkBoundary();
					c(f) && (f = f.startContainer.childNodes[f.startOffset]) && 1 == f.nodeType && (y.$empty[f.tagName] || y.$nonChild[f.tagName]) && (a = f)
				}
				return a
			},
			select: t.ie ?
				function(a, k) {
					var h;
					this.collapsed || this.shrinkBoundary();
					var e = this.getClosedNode();
					if (e && !k) {
						try {
							h = this.document.body.createControlRange(), h.addElement(e), h.select()
						} catch (F) {}
						return this
					}
					var e = this.createBookmark(),
						c = e.start;
					h = this.document.body.createTextRange();
					h.moveToElementText(c);
					h.moveStart("character", 1);
					if (!this.collapsed) {
						var m = this.document.body.createTextRange(),
							c = e.end;
						m.moveToElementText(c);
						h.setEndPoint("EndToEnd", m)
					} else if (!a && 3 != this.startContainer.nodeType) {
						var m = this.document.createTextNode(f),
							n = this.document.createElement("span");
						n.appendChild(this.document.createTextNode(f));
						c.parentNode.insertBefore(n, c);
						c.parentNode.insertBefore(m, c);
						d(this.document, m);
						l = m;
						b(n, "previousSibling");
						b(c, "nextSibling");
						h.moveStart("character", -1);
						h.collapse(!0)
					}
					this.moveToBookmark(e);
					n && g.remove(n);
					try {
						h.select()
					} catch (F) {}
					return this
				} : function(a) {
					function k(a) {
						function f(f, b, k) {
							3 == f.nodeType && f.nodeValue.length < b && (a[k + "Offset"] = f.nodeValue.length)
						}
						f(a.startContainer, a.startOffset, "start");
						f(a.endContainer, a.endOffset, "end")
					}
					var h = g.getWindow(this.document),
						e = h.getSelection();
					t.gecko ? this.document.body.focus() : h.focus();
					if (e) {
						e.removeAllRanges();
						this.collapsed && !a && (a = h = this.startContainer, 1 == h.nodeType && (a = h.childNodes[this.startOffset]), 3 == h.nodeType && this.startOffset || (a ? a.previousSibling && 3 == a.previousSibling.nodeType : h.lastChild && 3 == h.lastChild.nodeType) || (a = this.document.createTextNode(f), this.insertNode(a), d(this.document, a), b(a, "previousSibling"), b(a, "nextSibling"), l = a, this.setStart(a, t.webkit ? 1 : 0).collapse(!0)));
						h = this.document.createRange();
						if (this.collapsed && t.opera && 1 == this.startContainer.nodeType)
							if (a = this.startContainer.childNodes[this.startOffset]) {
								for (; a && g.isBlockElm(a);)
									if (1 == a.nodeType && a.childNodes[0]) a = a.childNodes[0];
									else break;
								a && this.setStartBefore(a).collapse(!0)
							} else(a = this.startContainer.lastChild) && g.isBr(a) && this.setStartBefore(a).collapse(!0);
						k(this);
						h.setStart(this.startContainer, this.startOffset);
						h.setEnd(this.endContainer, this.endOffset);
						e.addRange(h)
					}
					return this
				},
			scrollToView: function(a, f) {
				a = a ? window : g.getWindow(this.document);
				var b = this.document.createElement("span");
				b.innerHTML = "&nbsp;";
				this.cloneRange().insertNode(b);
				g.scrollToView(b, a, f);
				g.remove(b);
				return this
			},
			inFillChar: function() {
				var a = this.startContainer;
				return this.collapsed && 3 == a.nodeType && a.nodeValue.replace(new RegExp("^" + g.fillChar), "").length + 1 == a.nodeValue.length ? !0 : !1
			},
			createAddress: function(a, f) {
				function b(a) {
					for (var b = a ? d.startContainer : d.endContainer, k = g.findParents(b, !0, function(a) {
							return !g.isBody(a)
						}), l = [], h = 0, e; e = k[h++];) l.push(g.getNodeIndex(e, f));
					k = 0;
					if (f)
						if (3 == b.nodeType) {
							for (b = b.previousSibling; b && 3 == b.nodeType;) k += b.nodeValue.replace(S, "").length, b = b.previousSibling;
							k += a ? d.startOffset : d.endOffset
						} else if (b = b.childNodes[a ? d.startOffset : d.endOffset]) k = g.getNodeIndex(b, f);
					else
						for (b = a ? d.startContainer : d.endContainer, a = b.firstChild; a;)
							if (g.isFillChar(a)) a = a.nextSibling;
							else if (k++, 3 == a.nodeType)
						for (; a && 3 == a.nodeType;) a = a.nextSibling;
					else a = a.nextSibling;
					else k = a ? g.isFillChar(b) ? 0 : d.startOffset : d.endOffset;
					0 > k && (k = 0);
					l.push(k);
					return l
				}
				var k = {},
					d = this;
				k.startAddress = b(!0);
				a || (k.endAddress = d.collapsed ? [].concat(k.startAddress) : b());
				return k
			},
			moveToAddress: function(a, f) {
				function b(a, f) {
					for (var b = k.document.body, d, l, h = 0, e, c = a.length; h < c; h++)
						if (e = a[h], d = b, b = b.childNodes[e], !b) {
							l = e;
							break
						}
					f ? b ? k.setStartBefore(b) : k.setStart(d, l) : b ? k.setEndBefore(b) : k.setEnd(d, l)
				}
				var k = this;
				b(a.startAddress, !0);
				!f && a.endAddress && b(a.endAddress);
				return k
			},
			equals: function(a) {
				for (var f in this)
					if (this.hasOwnProperty(f) && this[f] !== a[f]) return !1;
				return !0
			},
			traversal: function(a, f) {
				if (this.collapsed) return this;
				for (var b = this.createBookmark(), k = b.end, d = g.getNextDomNode(b.start, !1, f); d && d !== k && g.getPosition(d, k) & g.POSITION_PRECEDING;) {
					var l = g.getNextDomNode(d, !1, f);
					a(d);
					d = l
				}
				return this.moveToBookmark(b)
			}
		}
	})();
	(function() {
		function c(a, b) {
			var d = g.getNodeIndex;
			a = a.duplicate();
			a.collapse(b);
			var f = a.parentElement();
			if (!f.hasChildNodes()) return {
				container: f,
				offset: 0
			};
			for (var l = f.children, k, e = a.duplicate(), c = 0, r = l.length - 1, v = -1; c <= r;) {
				v = Math.floor((c + r) / 2);
				k = l[v];
				e.moveToElementText(k);
				var u = e.compareEndPoints("StartToStart", a);
				if (0 < u) r = v - 1;
				else if (0 > u) c = v + 1;
				else return {
					container: f,
					offset: d(k)
				}
			}
			if (-1 == v) {
				e.moveToElementText(f);
				e.setEndPoint("StartToStart", a);
				e = e.text.replace(/(\r\n|\r)/g, "\n").length;
				l = f.childNodes;
				if (!e) return k = l[l.length - 1], {
					container: k,
					offset: k.nodeValue.length
				};
				for (d = l.length; 0 < e;) e -= l[--d].nodeValue.length;
				return {
					container: l[d],
					offset: -e
				}
			}
			e.collapse(0 < u);
			e.setEndPoint(0 < u ? "StartToStart" : "EndToStart", a);
			e = e.text.replace(/(\r\n|\r)/g, "\n").length;
			if (!e) return y.$empty[k.tagName] || y.$nonChild[k.tagName] ? {
				container: f,
				offset: d(k) + (0 < u ? 0 : 1)
			} : {
				container: k,
				offset: 0 < u ? 0 : k.childNodes.length
			};
			for (; 0 < e;) try {
				l = k, k = k[0 < u ? "previousSibling" : "nextSibling"], e -= k.nodeValue.length
			} catch (x) {
				return {
					container: f,
					offset: d(l)
				}
			}
			return {
				container: k,
				offset: 0 < u ? -e : k.nodeValue.length + e
			}
		}

		function a(a, b) {
			if (a.item) b.selectNode(a.item(0));
			else {
				var d = c(a, !0);
				b.setStart(d.container, d.offset);
				0 != a.compareEndPoints("StartToEnd", a) && (d = c(a, !1), b.setEnd(d.container, d.offset))
			}
			return b
		}

		function e(a) {
			var b;
			try {
				b = a.getNative().createRange()
			} catch (f) {
				return null
			}
			var d = b.item ? b.item(0) : b.parentElement();
			return (d.ownerDocument || d) === a.document ? b : null
		}(E.Selection = function(a) {
			var b = this;
			b.document = a;
			t.ie9below && (a = g.getWindow(a).frameElement, g.on(a, "beforedeactivate", function() {
				b._bakIERange = b.getIERange()
			}), g.on(a, "activate", function() {
				try {
					!e(b) && b._bakIERange && b._bakIERange.select()
				} catch (h) {}
				b._bakIERange = null
			}));
			a = a = null
		}).prototype = {
			rangeInBody: function(a, b) {
				var d = t.ie9below || b ? a.item ? a.item() : a.parentElement() : a.startContainer;
				return d === this.document.body || g.inDoc(d, this.document)
			},
			getNative: function() {
				var a = this.document;
				try {
					return a ? t.ie9below ? a.selection : g.getWindow(a).getSelection() : null
				} catch (b) {
					return null
				}
			},
			getIERange: function() {
				var a = e(this);
				return !a && this._bakIERange ? this._bakIERange : a
			},
			cache: function() {
				this.clear();
				this._cachedRange = this.getRange();
				this._cachedStartElement = this.getStart();
				this._cachedStartElementPath = this.getStartElementPath()
			},
			getStartElementPath: function() {
				if (this._cachedStartElementPath) return this._cachedStartElementPath;
				var a = this.getStart();
				return a ? g.findParents(a, !0, null, !0) : []
			},
			clear: function() {
				this._cachedStartElementPath = this._cachedRange = this._cachedStartElement = null
			},
			isFocus: function() {
				try {
					if (t.ie9below) {
						var a = e(this);
						return !(!a || !this.rangeInBody(a))
					}
					return !!this.getNative().rangeCount
				} catch (b) {
					return !1
				}
			},
			getRange: function() {
				function d(a) {
					for (var f = b.document.body.firstChild, k = a.collapsed; f && f.firstChild;) a.setStart(f, 0), f = f.firstChild;
					a.startContainer || a.setStart(b.document.body, 0);
					k && a.collapse(!0)
				}
				var b = this;
				if (null != b._cachedRange) return this._cachedRange;
				var h = new q.editor.dom.Range(b.document);
				if (t.ie9below) {
					var f = b.getIERange();
					if (f) try {
						a(f, h)
					} catch (k) {
						d(h)
					} else d(h)
				} else {
					var l = b.getNative();
					if (l && l.rangeCount) f = l.getRangeAt(0), l = l.getRangeAt(l.rangeCount - 1), h.setStart(f.startContainer, f.startOffset).setEnd(l.endContainer, l.endOffset), h.collapsed && g.isBody(h.startContainer) && !h.startOffset && d(h);
					else {
						if (this._bakRange && g.inDoc(this._bakRange.startContainer, this.document)) return this._bakRange;
						d(h)
					}
				}
				return this._bakRange = h
			},
			getStart: function() {
				if (this._cachedStartElement) return this._cachedStartElement;
				var a = t.ie9below ? this.getIERange() : this.getRange(),
					b, h;
				if (t.ie9below) {
					if (!a) return this.document.body.firstChild;
					if (a.item) return a.item(0);
					b = a.duplicate();
					0 < b.text.length && b.moveStart("character", 1);
					b.collapse(1);
					b = b.parentElement();
					for (h = a = a.parentElement(); a = a.parentNode;)
						if (a == b) {
							b = h;
							break
						}
				} else if (a.shrinkBoundary(), b = a.startContainer, 1 == b.nodeType && b.hasChildNodes() && (b = b.childNodes[Math.min(b.childNodes.length - 1, a.startOffset)]), 3 == b.nodeType) return b.parentNode;
				return b
			},
			getText: function() {
				var a;
				return this.isFocus() && (a = this.getNative()) ? (a = t.ie9below ? a.createRange() : a.getRangeAt(0), t.ie9below ? a.text : a.toString()) : ""
			},
			clearRange: function() {
				this.getNative()[t.ie9below ? "empty" : "removeAllRanges"]()
			}
		}
	})();
	(function() {
		function c(a, b) {
			var f;
			if (b.textarea)
				if (p.isString(b.textarea))
					for (var d = 0, l, h = g.getElementsByTagName(a, "textarea"); l = h[d++];) {
						if (l.id == "ueditor_textarea_" + b.options.textarea) {
							f = l;
							break
						}
					} else f = b.textarea;
			f || (a.appendChild(f = g.createElement(document, "textarea", {
				name: b.options.textarea,
				id: "ueditor_textarea_" + b.options.textarea,
				style: "display:none"
			})), b.textarea = f);
			!f.getAttribute("name") && f.setAttribute("name", b.options.textarea);
			f.value = b.hasContents() ? b.options.allHtmlEnabled ? b.getAllHtml() : b.getContent(null, null, !0) : ""
		}

		function a(a) {
			for (var f in a) return f
		}

		function e(a) {
			a.langIsReady = !0;
			a.fireEvent("langReady")
		}
		var d = 0,
			b, h = UE.Editor = function(f) {
				var b = this;
				b.uid = d++;
				ba.call(b);
				b.commands = {};
				b.options = p.extend(p.clone(f || {}), UEDITOR_CONFIG, !0);
				b.shortcutkeys = {};
				b.currentSelection = {};
				b.inputRules = [];
				b.outputRules = [];
				b.current_active_135item = null;
				b.is_paid_user = !1;
				b.setOpt(h.defaultOptions(b));
				b.loadServerConfig();
				p.isEmptyObject(UE.I18N) ? p.loadFile(document, {
					src: b.options.langPath + b.options.lang + "/" + b.options.lang + ".js",
					tag: "script",
					type: "text/javascript",
					defer: "defer"
				}, function() {
					UE.plugin.load(b);
					e(b)
				}) : (b.options.lang = a(UE.I18N), UE.plugin.load(b), e(b));
				UE.instants["ueditorInstant" + b.uid] = b
			};
		h.prototype = {
			registerCommand: function(a, b) {
				this.commands[a] = b
			},
			ready: function(a) {
				a && (this.isReady ? a.apply(this) : this.addListener("ready", a))
			},
			currentActive135Item: function() {
				return this.current_active_135item
			},
			backuprange: function() {
				var a = this.selection.getRange();
				this.currentSelection = {
					startContainer: a.startContainer,
					startOffset: a.startOffset,
					endContainer: a.endContainer,
					endOffset: a.endOffset
				}
			},
			restorerange: function() {
				var a = this.selection;
				a.clearRange();
				var b = this.document.createRange();
				b.setStart(this.currentSelection.startContainer, this.currentSelection.startOffset);
				b.setEnd(this.currentSelection.endContainer, this.currentSelection.endOffset);
				a.getNative().addRange(b);
				a.getRange().select()
			},
			setOpt: function(a, b) {
				var f = {};
				p.isString(a) ? f[a] = b : f = a;
				p.extend(this.options, f, !0)
			},
			getOpt: function(a) {
				return this.options[a]
			},
			destroy: function() {
				this.fireEvent("destroy");
				var a = this.container.parentNode,
					b = this.textarea;
				b ? b.style.display = "" : (b = document.createElement("textarea"), a.parentNode.insertBefore(b, a));
				b.style.width = this.iframe.offsetWidth + "px";
				b.style.height = this.iframe.offsetHeight + "px";
				b.value = this.getContent();
				b.id = this.key;
				a.innerHTML = "";
				g.remove(a);
				var a = this.key,
					k;
				for (k in this) this.hasOwnProperty(k) && delete this[k];
				UE.delEditor(a)
			},
			render: function(a) {
				var b = this.options;
				p.isString(a) && (a = document.getElementById(a));
				if (a) {
					b.minFrameWidth = b.initialFrameWidth ? b.initialFrameWidth : b.initialFrameWidth = a.offsetWidth;
					b.initialFrameHeight ? b.minFrameHeight = b.initialFrameHeight : b.initialFrameHeight = b.minFrameHeight = a.offsetHeight;
					a.style.width = /%$/.test(b.initialFrameWidth) ? "100%" : b.initialFrameWidth - parseInt(g.getComputedStyle(a, "padding-left")) - parseInt(g.getComputedStyle(a, "padding-right")) + "px";
					a.style.height = /%$/.test(b.initialFrameHeight) ? "100%" : b.initialFrameHeight - parseInt(g.getComputedStyle(a, "padding-top")) - parseInt(g.getComputedStyle(a, "padding-bottom")) + "px";
					a.style.zIndex = b.zIndex;
					var f = (O && 9 > t.version ? "" : "<!DOCTYPE html>") + "<html lang='en'><head><meta name='referrer' content='never'><meta name='viewport' content='width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no'>" + (b.iframeCssUrl ? "<link rel='stylesheet' type='text/css' href='" + p.unhtml(b.iframeCssUrl) + "'/>" : "") + (b.initialStyle ? "<style>" + b.initialStyle + "</style>" : "") + "<style type='text/css'>.guide{background-image:none !important;}.view{padding:0;word-wrap:break-word;cursor:text;}\nbody{margin:8px;font-family:"+defaultFontName+";font-size:"+defaultFontSize+"px;letter-spacing:"+defaultWordSpace+"px;}p{line-height: "+(defaultLineSpace == '1'?'normal':(defaultLineSpace+'em'))+";margin-top: "+defaultDistanceBeforeParagraph+"px;margin-bottom: "+defaultDistanceAfterParagraph+"px}.zwf{display:none;[type='zwf']{display:none;}</style></head><body class='view' id='bjqView' ></body><script type='text/javascript' " + (O ? "defer='defer'" : "") + " id='_initialScript'>setTimeout(function(){editor = window.parent.UE.instants['ueditorInstant" + this.uid + "'];editor._setup(document);},0);var _tmpScript = document.getElementById('_initialScript');_tmpScript.parentNode.removeChild(_tmpScript);</script>" + (b.iframeJsUrl ? "<script type='text/javascript' src='" + p.unhtml(b.iframeJsUrl) + "'></script>" : "") + "</html>";
					a.appendChild(g.createElement(document, "iframe", {
						id: "ueditor_" + this.uid,
						width: "100%",
						height: "100%",
						frameborder: "0",
						src: "javascript:void(function(){document.open();" + (b.customDomain && document.domain != location.hostname ? 'document.domain="' + document.domain + '";' : "") + 'document.write("' + f + '");document.close();}())'
					}));
					a.style.overflow = "hidden";
					setTimeout(function() {
						/%$/.test(b.initialFrameWidth) && (b.minFrameWidth = b.initialFrameWidth = a.offsetWidth);
						/%$/.test(b.initialFrameHeight) && (b.minFrameHeight = b.initialFrameHeight = a.offsetHeight, a.style.height = b.initialFrameHeight + "px")
					})
				}
			},
			_setup: function(a) {
				var b = this,
					f = b.options;
				O ? (a.body.disabled = !0, a.body.contentEditable = !0, a.body.disabled = !1) : a.body.contentEditable = !0;
				a.body.spellcheck = !1;
				b.document = a;
				b.window = a.defaultView || a.parentWindow;
				b.iframe = b.window.frameElement;
				b.body = a.body;
				b.selection = new E.Selection(a);
				var d;
				t.gecko && (d = this.selection.getNative()) && d.removeAllRanges();
				this._initEvents();
				for (var h = this.iframe.parentNode; !g.isBody(h); h = h.parentNode)
					if ("FORM" == h.tagName) {
						b.form = h;
						if (b.options.autoSyncData) g.on(b.window, "blur", function() {
							c(h, b)
						});
						else g.on(h, "submit", function() {
							c(this, b)
						});
						break
					}
				if (f.initialContent)
					if (f.autoClearinitialContent) {
						var e = b.execCommand;
						b.execCommand = function() {
							b.fireEvent("firstBeforeExecCommand");
							return e.apply(b, arguments)
						};
						this._setDefaultContent(f.initialContent)
					} else this.setContent(f.initialContent, !1, !0);
				g.isEmptyNode(b.body) && (b.body.innerHTML = "<p>" + (t.ie ? "" : "<br/>") + "</p>");
				f.focus && setTimeout(function() {
					b.focus(b.options.focusInEnd);
					!b.options.autoClearinitialContent && b._selectionChange()
				}, 0);
				b.container || (b.container = this.iframe.parentNode);
				f.fullscreen && b.ui && b.ui.setFullScreen(!0);
				try {
					b.document.execCommand("2D-position", !1, !1)
				} catch (v) {}
				try {
					b.document.execCommand("enableInlineTableEditing", !1, !1)
				} catch (v) {}
				try {
					b.document.execCommand("enableObjectResizing", !1, !1)
				} catch (v) {}
				b._bindshortcutKeys();
				b.isReady = 1;
				b.fireEvent("ready");
				f.onready && f.onready.call(b);
				if (!t.ie9below) g.on(b.window, ["blur", "focus"], function(a) {
					if ("blur" == a.type) {
						b._bakRange = b.selection.getRange();
						try {
							b._bakNativeRange = b.selection.getNative().getRangeAt(0), b.selection.getNative().removeAllRanges()
						} catch (u) {
							b._bakNativeRange = null
						}
					} else try {
						b._bakRange && b._bakRange.select()
					} catch (u) {}
				});
				t.gecko && 10902 >= t.version && (b.body.contentEditable = !1, setTimeout(function() {
					b.body.contentEditable = !0
				}, 100), setInterval(function() {
					b.body.style.height = b.iframe.offsetHeight - 20 + "px"
				}, 100));
				!f.isShow && b.setHide();
				f.readonly && b.setDisabled()
			},
			sync: function(a) {
				a = a ? document.getElementById(a) : g.findParent(this.iframe.parentNode, function(a) {
					return "FORM" == a.tagName
				}, !0);
				console.log("sync form");
				a && c(a, this)
			},
			setHeight: function(a, b) {
				a !== parseInt(this.iframe.parentNode.style.height) && (this.iframe.parentNode.style.height = a + "px");
				!b && (this.options.minFrameHeight = this.options.initialFrameHeight = a);
				this.body.style.height = a + "px";
				!b && this.trigger("setHeight")
			},
			addshortcutkey: function(a, b) {
				var f = {};
				b ? f[a] = b : f = a;
				p.extend(this.shortcutkeys, f)
			},
			_bindshortcutKeys: function() {
				var a = this,
					b = this.shortcutkeys;
				a.addListener("keydown", function(f, d) {
					var k = d.keyCode || d.which,
						h;
					for (h in b)
						for (var e = b[h].split(","), l = 0, c; c = e[l++];) {
							c = c.split(":");
							var n = c[0];
							c = c[1];
							if (/^(ctrl)(\+shift)?\+(\d+)$/.test(n.toLowerCase()) || /^(\d+)$/.test(n))
								if ("ctrl" == RegExp.$1 && (d.ctrlKey || d.metaKey) && ("" != RegExp.$2 ? d[RegExp.$2.slice(1) + "Key"] : 1) && k == RegExp.$3 || k == RegExp.$1) - 1 != a.queryCommandState(h, c) && a.execCommand(h, c), g.preventDefault(d)
						}
				})
			},
			getContent: function(a, b, k, d, h) {
				a && p.isFunction(a) && (b = a, a = "");
				if (b ? !b() : !this.hasContents()) return "";
				this.fireEvent("beforegetcontent");
				b = UE.htmlparser(this.body.innerHTML, d);
				this.filterOutputRule(b);
				this.fireEvent("aftergetcontent", a, b);
               	return '<div style="font-family:'+defaultFontName+';font-size:'+defaultFontSize+'px;letter-spacing:'+defaultWordSpace+'px;line-height: '+(defaultLineSpace == '1'?'normal':(defaultLineSpace+'em'))+'em;margin-top: '+defaultDistanceBeforeParagraph+'px;margin-bottom: '+defaultDistanceAfterParagraph+'px" id="editWrap">' + b.toHtml(c) + '</div>';
			},
			getAllHtml: function() {
				var a = [];
				this.fireEvent("getAllHtml", a);
				if (t.ie && 8 < t.version) {
					var b = "";
					p.each(this.document.styleSheets, function(a) {
						b += a.href ? '<link rel="stylesheet" type="text/css" href="' + a.href + '" />' : "<style>" + a.cssText + "</style>"
					});
					p.each(this.document.getElementsByTagName("script"), function(a) {
						b += a.outerHTML
					})
				}
				return "<html><head>" + (this.options.charset ? '<meta http-equiv="Content-Type" content="text/html; charset=' + this.options.charset + '"/>' : "") + (b || this.document.getElementsByTagName("head")[0].innerHTML) + a.join("\n") + "</head><body " + (O && 9 > t.version ? 'class="view"' : "") + ">" + this.getContent(null, null, !0) + "</body></html>"
			},
			getPlainTxt: function() {
				var a = new RegExp(g.fillChar, "g"),
					b = this.body.innerHTML.replace(/[\n\r]/g, ""),
					b = b.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi, "\n").replace(/<br\/?>/gi, "\n").replace(/<[^>/]+>/g, "").replace(/(\n)?<\/([^>]+)>/g, function(a, b, f) {
						return y.$block[f] ? "\n" : b ? b : ""
					});
				return b.replace(a, "").replace(/ /g, " ").replace(/&nbsp;/g, " ")
			},
			getContentTxt: function() {
				return this.body[t.ie ? "innerText" : "textContent"].replace(new RegExp(g.fillChar, "g"), "").replace(/ /g, " ")
			},
			setContent: function(a, b, k) {
				  var a = jQuery('<div>'+a+'</div>').find('#editWrap').length ? jQuery('<div>'+a+'</div>').find('#editWrap').html() : a;
				this.fireEvent("beforesetcontent", a);
				a = UE.htmlparser(a);
				this.filterInputRule(a);
				a = a.toHtml();
				this.body.innerHTML = (b ? this.body.innerHTML : "") + a;
				if ("p" == this.options.enterTag)
					if (b = this.body.firstChild, !b || 1 == b.nodeType && (y.$cdata[b.tagName] || "DIV" == b.tagName && b.getAttribute("cdata_tag") || g.isCustomeNode(b)) && b === this.body.lastChild) this.body.innerHTML = "<p>" + (t.ie ? "&nbsp;" : "<br/>") + "</p>" + this.body.innerHTML;
					else
						for (var f = this.document.createElement("p"); b;) {
							for (; b && (3 == b.nodeType || 1 == b.nodeType && y.p[b.tagName] && !y.$cdata[b.tagName]);) a = b.nextSibling, f.appendChild(b), b = a;
							if (f.firstChild)
								if (b) b.parentNode.insertBefore(f, b), f = this.document.createElement("p");
								else {
									this.body.appendChild(f);
									break
								}
							b = b.nextSibling
						}
				this.fireEvent("aftersetcontent");
				this.fireEvent("contentchange");
				!k && this._selectionChange();
				this._bakRange = this._bakIERange = this._bakNativeRange = null;
				var d;
				t.gecko && (d = this.selection.getNative()) && d.removeAllRanges();
				this.options.autoSyncData && this.form && c(this.form, this)
			},
			focus: function(a) {
				try {
					var b = this.selection.getRange();
					if (a) {
						var f = this.body.lastChild;
						f && 1 == f.nodeType && !y.$empty[f.tagName] && (g.isEmptyBlock(f) ? b.setStartAtFirst(f) : b.setStartAtLast(f), b.collapse(!0));
						b.setCursor(!0)
					} else !b.collapsed && g.isBody(b.startContainer) && 0 == b.startOffset && (f = this.body.firstChild) && 1 == f.nodeType && !y.$empty[f.tagName] && b.setStartAtFirst(f).collapse(!0), b.select(!0);
					this.fireEvent("focus selectionchange")
				} catch (n) {}
			},
			isFocus: function() {
				return this.selection.isFocus()
			},
			blur: function() {
				var a = this.selection.getNative();
				if (a.empty && t.ie) {
					var b = document.body.createTextRange();
					b.moveToElementText(document.body);
					b.collapse(!0);
					b.select();
					a.empty()
				} else a.removeAllRanges()
			},
			_initEvents: function() {
				var a = this,
					b = a.document,
					d = a.window;
				a._proxyDomEvent = p.bind(a._proxyDomEvent, a);
				g.on(b, "click contextmenu mousedown keydown keyup keypress mouseup mouseover mouseout selectstart".split(" "), a._proxyDomEvent);
				g.on(d, ["focus", "blur"], a._proxyDomEvent);
				g.on(a.body, "drop", function(b) {
					t.gecko && b.stopPropagation && b.stopPropagation();
					a.fireEvent("contentchange")
				});
				g.on(b, ["mouseup", "keydown"], function(b) {
					"keydown" == b.type && (b.ctrlKey || b.metaKey || b.shiftKey || b.altKey) || 2 != b.button && a._selectionChange(250, b)
				})
			},
			_proxyDomEvent: function(a) {
				return !1 === this.fireEvent("before" + a.type.replace(/^on/, "").toLowerCase()) || !1 === this.fireEvent(a.type.replace(/^on/, ""), a) ? !1 : this.fireEvent("after" + a.type.replace(/^on/, "").toLowerCase())
			},
			_selectionChange: function(a, d) {
				var f = this,
					h = !1,
					e, c;
				t.ie && 9 > t.version && d && "mouseup" == d.type && !this.selection.getRange().collapsed && (h = !0, e = d.clientX, c = d.clientY);
				clearTimeout(b);
				b = setTimeout(function() {
					if (f.selection && f.selection.getNative()) {
						var a;
						if (h && "None" == f.selection.getNative().type) {
							a = f.document.body.createTextRange();
							try {
								a.moveToPoint(e, c)
							} catch (x) {
								a = null
							}
						}
						var b;
						a && (b = f.selection.getIERange, f.selection.getIERange = function() {
							return a
						});
						f.selection.cache();
						b && (f.selection.getIERange = b);
						f.selection._cachedRange && f.selection._cachedStartElement && (f.fireEvent("beforeselectionchange"), f.fireEvent("selectionchange", !!d), f.fireEvent("afterselectionchange"), f.selection.clear())
					}
				}, a || 50)
			},
			_callCmdFn: function(a, b) {
				var f = b[0].toLowerCase(),
					d;
				d = (f = this.commands[f] || UE.commands[f]) && f[a];
				if (!(f && d || "queryCommandState" != a)) return 0;
				if (d) return d.apply(this, b)
			},
			execCommand: function(a) {
				a = a.toLowerCase();
				var b, f = this.commands[a] || UE.commands[a];
				if (!f || !f.execCommand) return null;
				f.notNeedUndo || this.__hasEnterExecCommand ? (b = this._callCmdFn("execCommand", arguments), this.__hasEnterExecCommand || f.ignoreContentChange || this._ignoreContentChange || this.fireEvent("contentchange")) : (this.__hasEnterExecCommand = !0, -1 != this.queryCommandState.apply(this, arguments) && (this.fireEvent("saveScene"), this.fireEvent.apply(this, ["beforeexeccommand", a].concat(arguments)), b = this._callCmdFn("execCommand", arguments), this.fireEvent.apply(this, ["afterexeccommand", a].concat(arguments)), this.fireEvent("saveScene")), this.__hasEnterExecCommand = !1);
				this.__hasEnterExecCommand || f.ignoreContentChange || this._ignoreContentChange || this._selectionChange();
				return b
			},
			queryCommandState: function(a) {
				return this._callCmdFn("queryCommandState", arguments)
			},
			queryCommandValue: function(a) {
				return this._callCmdFn("queryCommandValue", arguments)
			},
			hasContents: function(a) {
				if (a)
					for (var b = 0, f; f = a[b++];)
						if (0 < this.document.getElementsByTagName(f).length) return !0;
				if (!g.isEmptyBlock(this.body)) return !0;
				if ("<p><br></p>" == this.body.innerHTML || '<section data-role="paragraph" class="_135editor"><p><br/></p></section>' == this.body.innerHTML || "<p><br/></p>" == this.body.innerHTML) return !1;
				a = ["div"];
				for (b = 0; f = a[b++];) {
					f = g.getElementsByTagName(this.document, f);
					for (var d = 0, h; h = f[d++];)
						if (g.isCustomeNode(h)) return !0
				}
				return !1
			},
			reset: function() {
				this.fireEvent("reset")
			},
			setEnabled: function() {
				var a;
				if ("false" == this.body.contentEditable) {
					this.body.contentEditable = !0;
					a = this.selection.getRange();
					try {
						a.moveToBookmark(this.lastBk), delete this.lastBk
					} catch (l) {
						a.setStartAtFirst(this.body).collapse(!0)
					}
					a.select(!0);
					this.bkqueryCommandState && (this.queryCommandState = this.bkqueryCommandState, delete this.bkqueryCommandState);
					this.bkqueryCommandValue && (this.queryCommandValue = this.bkqueryCommandValue, delete this.bkqueryCommandValue);
					this.fireEvent("selectionchange")
				}
			},
			enable: function() {
				return this.setEnabled()
			},
			setDisabled: function(a) {
				var b = this;
				a = a ? p.isArray(a) ? a : [a] : [];
				"true" == b.body.contentEditable && (b.lastBk || (b.lastBk = b.selection.getRange().createBookmark(!0)), b.body.contentEditable = !1, b.bkqueryCommandState = b.queryCommandState, b.bkqueryCommandValue = b.queryCommandValue, b.queryCommandState = function(f) {
					return -1 != p.indexOf(a, f) ? b.bkqueryCommandState.apply(b, arguments) : -1
				}, b.queryCommandValue = function(f) {
					return -1 != p.indexOf(a, f) ? b.bkqueryCommandValue.apply(b, arguments) : null
				}, b.fireEvent("selectionchange"))
			},
			disable: function(a) {
				return this.setDisabled(a)
			},
			_setDefaultContent: function() {
				function a() {
					var b = this;
					b.document.getElementById("initContent") && (b.body.innerHTML = '<section class="135editor"><p>' + (O ? "" : "<br/>") + "</p></section>", b.removeListener("firstBeforeExecCommand focus", a), setTimeout(function() {
						b.focus();
						b._selectionChange()
					}, 0))
				}
				return function(b) {
					this.body.innerHTML = '<p id="initContent">' + b + "</p>";
					this.addListener("firstBeforeExecCommand focus", a)
				}
			}(),
			setShow: function() {
				var a = this.selection.getRange();
				if ("none" == this.container.style.display) {
					try {
						a.moveToBookmark(this.lastBk), delete this.lastBk
					} catch (l) {
						a.setStartAtFirst(this.body).collapse(!0)
					}
					setTimeout(function() {
						a.select(!0)
					}, 100);
					this.container.style.display = ""
				}
			},
			show: function() {
				return this.setShow()
			},
			setHide: function() {
				this.lastBk || (this.lastBk = this.selection.getRange().createBookmark(!0));
				this.container.style.display = "none"
			},
			hide: function() {
				return this.setHide()
			},
			getLang: function(a) {
				var b = UE.I18N[this.options.lang];
				if (!b) throw Error("not import language file");
				a = (a || "").split(".");
				for (var f = 0, d;
					(d = a[f++]) && (b = b[d], b););
				return b
			},
			getContentLength: function(a, b) {
				var f;
				if (a) {
					b = (b || []).concat(["hr", "img", "iframe"]);
					f = this.getContentTxt().replace(/[\t\r\n]+/g, "").length;
					for (var d = 0, h; h = b[d++];) f += this.document.getElementsByTagName(h).length
				} else f = this.getContent(!1, !1, !0).length;
				return f
			},
			getTagLength: function(a) {
				var b = 0;
				a = this.document.getElementsByTagName(a);
				for (var f = 0; f < a.length; f++) g.hasClass(a[f], "assistant") || b++;
				return b
			},
			addInputRule: function(a) {
				this.inputRules.push(a)
			},
			filterInputRule: function(a) {
				for (var b = 0, f; f = this.inputRules[b++];) f.call(this, a)
			},
			addOutputRule: function(a) {
				this.outputRules.push(a)
			},
			filterOutputRule: function(a) {
				for (var b = 0, f; f = this.outputRules[b++];) f.call(this, a)
			},
			getActionUrl: function(a) {
				a = this.getOpt(a) || a;
				var b = this.getOpt("imageUrl"),
					f = this.getOpt("serverUrl");
				!f && b && (f = b.replace(/^(.*[\/]).+([\.].+)$/, "$1controller$2"));
				return f ? (f = f + (-1 == f.indexOf("?") ? "?" : "&") + "action=" + (a || ""), p.formatUrl(f)) : ""
			}
		};
		p.inherits(h, ba)
	})();
	UE.Editor.defaultOptions = function(c) {
		c = c.options.UEDITOR_HOME_URL;
		return {
			isShow: !0,
			initialContent: "",
			initialStyle: "",
			autoClearinitialContent: !1,
			iframeCssUrl: "./themes/iframe.css",
			textarea: "editorValue",
			focus: !1,
			focusInEnd: !0,
			autoClearEmptyNode: !0,
			fullscreen: !1,
			readonly: !1,
			zIndex: 999,
			imagePopup: !0,
			enterTag: "p",
			customDomain: !1,
			lang: "zh-cn",
			langPath: c + "lang/",
			theme: "default",
			themePath: c + "themes/",
			allHtmlEnabled: !1,
			scaleEnabled: !1,
			tableNativeEditInFF: !1,
			autoSyncData: !0,
			fileNameFormat: "{time}{rand:6}"
		}
	};
	(function() {
		UE.Editor.prototype.loadServerConfig = function() {
			function c(a) {
				console && console.error(a)
			}
			var a = this;
			setTimeout(function() {
				try {
					a.options.imageUrl && a.setOpt("serverUrl", a.options.imageUrl.replace(/^(.*[\/]).+([\.].+)$/, "$1controller$2"));
					var e = a.getOpt("configUrl") ? a.getOpt("configUrl") : a.getActionUrl("config"),
						d = p.isCrossDomainUrl(e);
					a._serverConfigLoaded = !1;
					e && UE.ajax.request(e, {
						method: "GET",
						dataType: d ? "jsonp" : "",
						onsuccess: function(b) {
							try {
								var h = d ? b : eval("(" + b.responseText + ")");
								p.extend(a.options, h);
								a.fireEvent("serverConfigLoaded");
								a._serverConfigLoaded = !0
							} catch (f) {
								c(a.getLang("loadconfigFormatError"))
							}
						},
						onerror: function() {
							c(a.getLang("loadconfigHttpError"))
						}
					})
				} catch (b) {
					c(a.getLang("loadconfigError"))
				}
			})
		};
		UE.Editor.prototype.isServerConfigLoaded = function() {
			return this._serverConfigLoaded || !1
		};
		UE.Editor.prototype.afterConfigReady = function(c) {
			if (c && p.isFunction(c)) {
				var a = this,
					e = function() {
						c.apply(a, arguments);
						a.removeListener("serverConfigLoaded", e)
					};
				a.isServerConfigLoaded() ? c.call(a, "serverConfigLoaded") : a.addListener("serverConfigLoaded", e)
			}
		}
	})();
	UE.ajax = function() {
		function c(a) {
			var b = [],
				d;
			for (d in a)
				if ("method" != d && "timeout" != d && "async" != d && "dataType" != d && "callback" != d && void 0 != a[d] && null != a[d])
					if ("function" != (typeof a[d]).toLowerCase() && "object" != (typeof a[d]).toLowerCase()) b.push(encodeURIComponent(d) + "=" + encodeURIComponent(a[d]));
					else if (p.isArray(a[d]))
				for (var k = 0; k < a[d].length; k++) b.push(encodeURIComponent(d) + "[]=" + encodeURIComponent(a[d][k]));
			return b.join("&")
		}

		function a(a, d) {
			var f = b(),
				k = !1,
				h = {
					method: "POST",
					timeout: 5E3,
					async: !0,
					data: {},
					onsuccess: function() {},
					onerror: function() {}
				};
			"object" === typeof a && (d = a, a = d.url);
			if (f && a) {
				var e = d ? p.extend(h, d) : h,
					h = c(e);
				p.isEmptyObject(e.data) || (h += (h ? "&" : "") + c(e.data));
				var g = setTimeout(function() {
						4 != f.readyState && (k = !0, f.abort(), clearTimeout(g))
					}, e.timeout),
					v = e.method.toUpperCase(),
					u = a + (-1 == a.indexOf("?") ? "?" : "&") + ("POST" == v ? "" : h + "&noCache=" + +new Date);
				f.open(v, u, e.async);
				f.onreadystatechange = function() {
					if (4 == f.readyState)
						if (k || 200 != f.status) e.onerror(f);
						else e.onsuccess(f)
				};
				"POST" == v ? (f.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"), f.send(h)) : f.send(null)
			}
		}

		function e(a, b) {
			function d(a) {
				return function() {
					try {
						if (a) e.onerror && e.onerror();
						else try {
							clearTimeout(w), f.apply(window, arguments)
						} catch (U) {}
					} catch (U) {
						e.onerror && e.onerror.call(window, U)
					} finally {
						e.oncomplete && e.oncomplete.apply(window, arguments);
						h.parentNode && h.parentNode.removeChild(h);
						window[u] = null;
						try {
							delete window[u]
						} catch (U) {}
					}
				}
			}
			var f = b.onsuccess ||
				function() {},
				h = document.createElement("SCRIPT"),
				e = b || {},
				g = e.charset,
				v = e.jsonp || "callback",
				u, x = e.timeOut || 0,
				w, F = new RegExp("(\\?|&)" + v + "=([^&]*)"),
				I;
			if (p.isFunction(f)) u = "bd__editor__" + Math.floor(2147483648 * Math.random()).toString(36), window[u] = d(0);
			else if (p.isString(f)) u = f;
			else if (I = F.exec(a)) u = I[2];
			a = a.replace(F, "$1" + v + "=" + u);
			0 > a.search(F) && (a += (0 > a.indexOf("?") ? "?" : "&") + v + "=" + u);
			v = c(b);
			p.isEmptyObject(b.data) || (v += (v ? "&" : "") + c(b.data));
			v && (a = a.replace(/\?/, "?" + v + "&"));
			h.onerror = d(1);
			x && (w = setTimeout(d(1), x));
			(function(a, b, d) {
				a.setAttribute("type", "text/javascript");
				a.setAttribute("defer", "defer");
				d && a.setAttribute("charset", d);
				a.setAttribute("src", b);
				document.getElementsByTagName("head")[0].appendChild(a)
			})(h, a, g)
		}
		var d = "XMLHttpRequest()";
		try {
			new ActiveXObject("Msxml2.XMLHTTP"), d = "ActiveXObject('Msxml2.XMLHTTP')"
		} catch (h) {
			try {
				new ActiveXObject("Microsoft.XMLHTTP"), d = "ActiveXObject('Microsoft.XMLHTTP')"
			} catch (f) {}
		}
		var b = new Function("return new " + d);
		return {
			request: function(b, d) {
				d && "jsonp" == d.dataType ? e(b, d) : a(b, d)
			},
			getJSONP: function(a, b, d) {
				e(a, {
					data: b,
					oncomplete: d
				})
			}
		}
	}();
	UE.filterWord = function() {
		function c(a) {
			return a = a.replace(/[\d.]+\w+/g, function(a) {
				return p.transUnitToPx(a)
			})
		}

		function a(a) {
			return a.replace(/[\t\r\n]+/g, " ").replace(/<!--[\s\S]*?-->/ig, "").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi, function(a) {
				if (t.opera) return "";
				try {
					if (/Bitmap/i.test(a)) return "";
					var b = a.match(/width:([ \d.]*p[tx])/i)[1],
						d = a.match(/height:([ \d.]*p[tx])/i)[1],
						f = a.match(/src=\s*"([^"]*)"/i)[1];
					return '<img width="' + c(b) + '" height="' + c(d) + '" src="' + f + '" />'
				} catch (l) {
					return ""
				}
			}).replace(/<\/?div[^>]*>/g, "").replace(/v:\w+=(["']?)[^'"]+\1/g, "").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi, "").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi, "<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)([\w-]+)\2/ig, function(a, b, h, f) {
				return "class" == b && "MsoListParagraph" == f ? a : ""
			}).replace(/<(font|span)[^>]*>(\s*)<\/\1>/gi, function(a, b, h) {
				return h.replace(/[\t\r\n ]+/g, " ")
			}).replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi, function(a, b, h, f) {
				a = [];
				f = f.replace(/^\s+|\s+$/, "").replace(/&#39;/g, "'").replace(/&quot;/gi, "'").replace(/[\d.]+(cm|pt)/g, function(a) {
					return p.transUnitToPx(a)
				}).split(/;\s*/g);
				h = 0;
				for (var d; d = f[h]; h++) {
					var k, e = d.split(":");
					if (2 == e.length && (d = e[0].toLowerCase(), k = e[1].toLowerCase(), !(/^(background)\w*/.test(d) && 0 == k.replace(/(initial|\s)/g, "").length || /^(margin)\w*/.test(d) && /^0\w+$/.test(k)))) {
						switch (d) {
							case "mso-padding-alt":
							case "mso-padding-top-alt":
							case "mso-padding-right-alt":
							case "mso-padding-bottom-alt":
							case "mso-padding-left-alt":
							case "mso-margin-alt":
							case "mso-margin-top-alt":
							case "mso-margin-right-alt":
							case "mso-margin-bottom-alt":
							case "mso-margin-left-alt":
							case "mso-height":
							case "mso-width":
							case "mso-vertical-align-alt":
								/<table/.test(b) || (a[h] = d.replace(/^mso-|-alt$/g, "") + ":" + c(k));
								continue;
							case "horiz-align":
								a[h] = "text-align:" + k;
								continue;
							case "vert-align":
								a[h] = "vertical-align:" + k;
								continue;
							case "font-color":
							case "mso-foreground":
								a[h] = "color:" + k;
								continue;
							case "mso-background":
							case "mso-highlight":
								a[h] = "background:" + k;
								continue;
							case "mso-default-height":
								a[h] = "min-height:" + c(k);
								continue;
							case "mso-default-width":
								a[h] = "min-width:" + c(k);
								continue;
							case "mso-padding-between-alt":
								a[h] = "border-collapse:separate;border-spacing:" + c(k);
								continue;
							case "text-line-through":
								if ("single" == k || "double" == k) a[h] = "text-decoration:line-through";
								continue;
							case "mso-zero-height":
								"yes" == k && (a[h] = "display:none");
								continue;
							case "margin":
								if (!/[1-9]/.test(k)) continue
						}
						/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(d) || /text\-indent|padding|margin/.test(d) && /\-[\d.]+/.test(k) || (a[h] = d + ":" + e[1])
					}
				}
				return b + (a.length ? ' style="' + a.join(";").replace(/;{2,}/g, ";") + '"' : "")
			})
		}
		return function(e) {
			return /(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<(v|o):|lang=)/ig.test(e) ? a(e) : e
		}
	}();
	(function() {
		function c(a, b, d) {
			a.push("\n");
			return b + (d ? 1 : -1)
		}

		function a(a, b) {
			for (var d = 0; d < b; d++) a.push("    ")
		}

		function e(b, f, k, h) {
			switch (b.type) {
				case "root":
					for (var l = 0, m; m = b.children[l++];) k && "element" == m.type && !y.$inlineWithA[m.tagName] && 1 < l && (c(f, h, !0), a(f, h)), e(m, f, k, h);
					break;
				case "text":
					"pre" == b.parentNode.tagName ? f.push(b.data) : f.push(g[b.parentNode.tagName] ? p.html(b.data) : b.data.replace(/[ ]{2}/g, " "));//以前是'&nbsp')
					break;
				case "element":
					d(b, f, k, h);
					break;
				case "comment":
					f.push("<!--" + b.data + "-->")
			}
			return f
		}

		function d(b, d, f, h) {
			var l = "";
			if (b.attrs) {
				var l = [],
					g = b.attrs,
					m;
				for (m in g) l.push(m + (void 0 !== g[m] ? '="' + (k[m] ? p.html(g[m]).replace(/["]/g, function(a) {
					return "&quot;"
				}) : p.unhtml(g[m])) + '"' : ""));
				l = l.join(" ")
			}
			d.push("<" + b.tagName + (l ? " " + l : "") + (y.$empty[b.tagName] ? "/" : "") + ">");
			f && !y.$inlineWithA[b.tagName] && "pre" != b.tagName && b.children && b.children.length && (h = c(d, h, !0), a(d, h));
			if (b.children && b.children.length)
				for (l = 0; g = b.children[l++];) f && "element" == g.type && !y.$inlineWithA[g.tagName] && 1 < l && (c(d, h), a(d, h)), e(g, d, f, h);
			y.$empty[b.tagName] || (f && !y.$inlineWithA[b.tagName] && "pre" != b.tagName && b.children && b.children.length && (h = c(d, h), a(d, h)), d.push("</" + b.tagName + ">"))
		}

		function b(a, d) {
			var f;
			if ("element" == a.type && a.getAttr("id") == d) return a;
			if (a.children && a.children.length)
				for (var k = 0; f = a.children[k++];)
					if (f = b(f, d)) return f
		}

		function h(a, b, d) {
			"element" == a.type && a.tagName == b && d.push(a);
			if (a.children && a.children.length)
				for (var f = 0, k; k = a.children[f++];) h(k, b, d)
		}

		function f(a, b) {
			if (a.children && a.children.length)
				for (var d = 0, k; k = a.children[d];) f(k, b), k.parentNode && (k.children && k.children.length && b(k), k.parentNode && d++);
			else b(a)
		}
		var l = UE.uNode = function(a) {
				this.type = a.type;
				this.data = a.data;
				this.tagName = a.tagName;
				this.parentNode = a.parentNode;
				this.attrs = a.attrs || {};
				this.children = a.children
			},
			k = {
				href: 1,
				src: 1,
				_src: 1,
				_href: 1,
				cdata_data: 1
			},
			g = {
				style: 1,
				script: 1
			};
		l.createElement = function(a) {
			return /[<>]/.test(a) ? UE.htmlparser(a).children[0] : new l({
				type: "element",
				children: [],
				tagName: a
			})
		};
		l.createText = function(a, b) {
			return new UE.uNode({
				type: "text",
				data: b ? a : p.unhtml(a || "")
			})
		};
		l.prototype = {
			toHtml: function(a) {
				var b = [];
				e(this, b, a, 0);
				return b.join("")
			},
			innerHTML: function(a) {
				if ("element" != this.type || y.$empty[this.tagName]) return this;
				if (p.isString(a)) {
					if (this.children)
						for (var b = 0, d; d = this.children[b++];) d.parentNode = null;
					this.children = [];
					a = UE.htmlparser(a);
					for (b = 0; d = a.children[b++];) this.children.push(d), d.parentNode = this;
					return this
				}
				a = new UE.uNode({
					type: "root",
					children: this.children
				});
				return a.toHtml()
			},
			innerText: function(a, b) {
				if ("element" != this.type || y.$empty[this.tagName]) return this;
				if (a) {
					if (this.children)
						for (var d = 0, f; f = this.children[d++];) f.parentNode = null;
					this.children = [];
					this.appendChild(l.createText(a, b));
					return this
				}
				return this.toHtml().replace(/<[^>]+>/g, "")
			},
			getData: function() {
				return "element" == this.type ? "" : this.data
			},
			firstChild: function() {
				return this.children ? this.children[0] : null
			},
			lastChild: function() {
				return this.children ? this.children[this.children.length - 1] : null
			},
			previousSibling: function() {
				for (var a = this.parentNode, b = 0, d; d = a.children[b]; b++)
					if (d === this) return 0 == b ? null : a.children[b - 1]
			},
			nextSibling: function() {
				for (var a = this.parentNode, b = 0, d; d = a.children[b++];)
					if (d === this) return a.children[b]
			},
			replaceChild: function(a, b) {
				if (this.children) {
					a.parentNode && a.parentNode.removeChild(a);
					for (var d = 0, f; f = this.children[d]; d++)
						if (f === b) return this.children.splice(d, 1, a), b.parentNode = null, a.parentNode = this, a
				}
			},
			appendChild: function(a) {
				if ("root" == this.type || "element" == this.type && !y.$empty[this.tagName]) {
					this.children || (this.children = []);
					a.parentNode && a.parentNode.removeChild(a);
					for (var b = 0, d; d = this.children[b]; b++)
						if (d === a) {
							this.children.splice(b, 1);
							break
						}
					this.children.push(a);
					a.parentNode = this;
					return a
				}
			},
			insertBefore: function(a, b) {
				if (this.children) {
					a.parentNode && a.parentNode.removeChild(a);
					for (var d = 0, f; f = this.children[d]; d++)
						if (f === b) return this.children.splice(d, 0, a), a.parentNode = this, a
				}
			},
			insertAfter: function(a, b) {
				if (this.children) {
					a.parentNode && a.parentNode.removeChild(a);
					for (var d = 0, f; f = this.children[d]; d++)
						if (f === b) return this.children.splice(d + 1, 0, a), a.parentNode = this, a
				}
			},
			removeChild: function(a, b) {
				if (this.children)
					for (var d = 0, f; f = this.children[d]; d++)
						if (f === a) {
							this.children.splice(d, 1);
							f.parentNode = null;
							if (b && f.children && f.children.length)
								for (var k = 0, h; h = f.children[k]; k++) this.children.splice(d + k, 0, h), h.parentNode = this;
							return f
						}
			},
			getAttr: function(a) {
				return this.attrs && this.attrs[a.toLowerCase()]
			},
			setAttr: function(a, b) {
				if (a)
					if (this.attrs || (this.attrs = {}), p.isObject(a))
						for (var d in a) a[d] ? this.attrs[d.toLowerCase()] = a[d] : delete this.attrs[d];
					else b ? this.attrs[a.toLowerCase()] = b : delete this.attrs[a];
				else delete this.attrs
			},
			getIndex: function() {
				for (var a = this.parentNode, b = 0, d; d = a.children[b]; b++)
					if (d === this) return b;
				return -1
			},
			getNodeById: function(a) {
				var d;
				if (this.children && this.children.length)
					for (var f = 0; d = this.children[f++];)
						if (d = b(d, a)) return d
			},
			getNodesByTagName: function(a) {
				a = p.trim(a).replace(/[ ]{2,}/g, " ").split(" ");
				var b = [],
					d = this;
				p.each(a, function(a) {
					if (d.children && d.children.length)
						for (var f = 0, k; k = d.children[f++];) h(k, a, b)
				});
				return b
			},
			getStyle: function(a) {
				var b = this.getAttr("style");
				return b ? (a = b.match(new RegExp("(^|;)\\s*" + a + ":([^;]+)", "i"))) && a[0] ? a[2] : "" : ""
			},
			setStyle: function(a, b) {
				function d(a, b) {
					f = f.replace(new RegExp("(^|;)\\s*" + a + ":([^;]+;?)", "gi"), "$1");
					b && (f = a + ":" + p.unhtml(b) + ";" + f)
				}
				var f = this.getAttr("style");
				f || (f = "");
				if (p.isObject(a))
					for (var k in a) d(k, a[k]);
				else d(a, b);
				this.setAttr("style", p.trim(f))
			},
			traversal: function(a) {
				this.children && this.children.length && f(this, a);
				return this
			}
		}
	})();
	UE.htmlparser = function(c, a) {
		function e(a, b) {
			if (m[a.tagName]) {
				var d = k.createElement(m[a.tagName]);
				a.appendChild(d);
				d.appendChild(k.createText(b))
			} else a.appendChild(k.createText(b))
		}

		function d(a, b, f) {
			var e;
			if (e = n[b]) {
				for (var c = a, g;
					"root" != c.type;) {
					if (p.isArray(e) ? -1 != p.indexOf(e, c.tagName) : e == c.tagName) {
						a = c;
						g = !0;
						break
					}
					c = c.parentNode
				}
				g || (a = d(a, p.isArray(e) ? e[0] : e))
			}
			e = new k({
				parentNode: a,
				type: "element",
				tagName: b.toLowerCase(),
				children: y.$empty[b] ? null : []
			});
			if (f) {
				for (c = {}; g = h.exec(f);) c[g[1].toLowerCase()] = l[g[1].toLowerCase()] ? g[2] || g[3] || g[4] : p.unhtml(g[2] || g[3] || g[4]);
				e.attrs = c
			}
			a.children.push(e);
			return y.$empty[b] ? a : e
		}
		var b = /<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/<>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,
			h = /([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,
			f = {
				b: 1,
				code: 1,
				i: 1,
				u: 1,
				strike: 1,
				s: 1,
				tt: 1,
				strong: 1,
				q: 1,
				samp: 1,
				em: 1,
				span: 1,
				sub: 1,
				img: 1,
				sup: 1,
				font: 1,
				big: 1,
				small: 1,
				iframe: 1,
				a: 1,
				br: 1,
				pre: 1
			};
		c = c.replace(new RegExp(g.fillChar, "g"), "");
		a || (c = c.replace(new RegExp("[\\r\\t\\n" + (a ? "" : " ") + "]*</?(\\w+)\\s*(?:[^>]*)>[\\r\\t\\n" + (a ? "" : " ") + "]*", "g"), function(b, d) {
			return d && f[d.toLowerCase()] ? b.replace(/(^[\n\r]+)|([\n\r]+$)/g, "") : b.replace(new RegExp("^[\\r\\n" + (a ? "" : " ") + "]+"), "").replace(new RegExp("[\\r\\n" + (a ? "" : " ") + "]+$"), "")
		}));
		for (var l = {
				href: 1,
				src: 1
			}, k = UE.uNode, n = {
				td: "tr",
				tr: ["tbody", "thead", "tfoot"],
				tbody: "table",
				th: "tr",
				thead: "table",
				tfoot: "table",
				caption: "table",
				li: ["ul", "ol"],
				dt: "dl",
				dd: "dl",
				option: "select"
			}, m = {
				ol: "li",
				ul: "li"
			}, r, v = 0, u = 0, x = new k({
				type: "root",
				children: []
			}), w = x; r = b.exec(c);) {
			v = r.index;
			try {
				if (v > u && e(w, c.slice(u, v)), r[3]) y.$cdata[w.tagName] ? e(w, r[0]) : w = d(w, r[3].toLowerCase(), r[4]);
				else if (r[1]) {
					if ("root" != w.type)
						if (y.$cdata[w.tagName] && !y.$cdata[r[1]]) e(w, r[0]);
						else {
							for (v = w;
								"element" == w.type && w.tagName != r[1].toLowerCase();)
								if (w = w.parentNode, "root" == w.type) throw w = v, "break";
							w = w.parentNode
						}
				} else r[2] && w.children.push(new k({
					type: "comment",
					data: r[2],
					parentNode: w
				}))
			} catch (F) {}
			u = b.lastIndex
		}
		u < c.length && e(w, c.slice(u));
		return x
	};
	UE.filterNode = function() {
		function c(a, e) {
			switch (a.type) {
				case "element":
					var d;
					if (d = e[a.tagName])
						if ("-" === d) a.parentNode.removeChild(a);
						else if (p.isFunction(d)) {
						var b = a.parentNode,
							h = a.getIndex();
						d(a);
						if (a.parentNode) {
							if (a.children)
								for (d = 0; h = a.children[d];) c(h, e), h.parentNode && d++
						} else
							for (d = h; h = b.children[d];) c(h, e), h.parentNode && d++
					} else {
						if ((d = d.$) && a.attrs) {
							var h = {},
								f;
							for (b in d) {
								f = a.getAttr(b);
								if ("style" == b && p.isArray(d[b])) {
									var l = [];
									p.each(d[b], function(b) {
										var d;
										(d = a.getStyle(b)) && l.push(b + ":" + d)
									});
									f = l.join(";")
								}
								f && (h[b] = f)
							}
							a.attrs = h
						}
						if (a.children)
							for (d = 0; h = a.children[d];) c(h, e), h.parentNode && d++
					} else if (y.$cdata[a.tagName]) a.parentNode.removeChild(a);
					else
						for (b = a.parentNode, h = a.getIndex(), a.parentNode.removeChild(a, !0), d = h; h = b.children[d];) c(h, e), h.parentNode && d++;
					break;
				case "comment":
					a.parentNode.removeChild(a)
			}
		}
		return function(a, e) {
			if (p.isEmptyObject(e)) return a;
			var d;
			(d = e["-"]) && p.each(d.split(" "), function(a) {
				e[a] = "-"
			});
			d = 0;
			for (var b; b = a.children[d];) c(b, e), b.parentNode && d++;
			return a
		}
	}();
	UE.plugin = function() {
		var c = {};
		return {
			register: function(a, e, d, b) {
				d && p.isFunction(d) && (b = d, d = null);
				c[a] = {
					optionName: d || a,
					execFn: e,
					afterDisabled: b
				}
			},
			load: function(a) {
				p.each(c, function(e) {
					var d = e.execFn.call(a);
					!1 !== a.options[e.optionName] ? d && p.each(d, function(b, d) {
						switch (d.toLowerCase()) {
							case "shortcutkey":
								a.addshortcutkey(b);
								break;
							case "bindevents":
								p.each(b, function(b, d) {
									a.addListener(d, b)
								});
								break;
							case "bindmultievents":
								p.each(p.isArray(b) ? b : [b], function(b) {
									var d = p.trim(b.type).split(/\s+/);
									p.each(d, function(d) {
										a.addListener(d, b.handler)
									})
								});
								break;
							case "commands":
								p.each(b, function(b, d) {
									a.commands[d] = b
								});
								break;
							case "outputrule":
								a.addOutputRule(b);
								break;
							case "inputrule":
								a.addInputRule(b);
								break;
							case "defaultoptions":
								a.setOpt(b)
						}
					}) : e.afterDisabled && e.afterDisabled.call(a)
				});
				p.each(UE.plugins, function(e) {
					e.call(a)
				})
			},
			run: function(a, e) {
				var d = c[a];
				d && d.exeFn.call(e)
			}
		}
	}();
	var fa = UE.keymap = {
			Backspace: 8,
			Tab: 9,
			Enter: 13,
			Shift: 16,
			Control: 17,
			Alt: 18,
			CapsLock: 20,
			Esc: 27,
			Spacebar: 32,
			PageUp: 33,
			PageDown: 34,
			End: 35,
			Home: 36,
			Left: 37,
			Up: 38,
			Right: 39,
			Down: 40,
			Insert: 45,
			Del: 46,
			NumLock: 144,
			Cmd: 91,
			"=": 187,
			"-": 189,
			b: 66,
			i: 73,
			z: 90,
			y: 89,
			v: 86,
			x: 88,
			s: 83,
			n: 78
		},
		V = UE.LocalStorage = function() {
			function c() {
				var a = document.createElement("div");
				a.style.display = "none";
				if (!a.addBehavior) return null;
				a.addBehavior("#default#userdata");
				return {
					getItem: function(b) {
						var d = null;
						try {
							document.body.appendChild(a), a.load(e), d = a.getAttribute(b), document.body.removeChild(a)
						} catch (f) {}
						return d
					},
					setItem: function(b, d) {
						document.body.appendChild(a);
						a.setAttribute(b, d);
						a.save(e);
						document.body.removeChild(a)
					},
					removeItem: function(b) {
						document.body.appendChild(a);
						a.removeAttribute(b);
						a.save(e);
						document.body.removeChild(a)
					}
				}
			}
			var a = window.localStorage || c() || null,
				e = "localStorage";
			return {
				saveLocalData: function(d, b) {
					return a && b ? (a.setItem(d, b), !0) : !1
				},
				getLocalData: function(d) {
					return a ? a.getItem(d) : null
				},
				removeItem: function(d) {
					a && a.removeItem(d)
				}
			}
		}();
	(function() {
		UE.Editor.prototype.setPreferences = function(c, a) {
			var e = {};
			p.isString(c) ? e[c] = a : e = c;
			var d = V.getLocalData("ueditor_preference");
			d && (d = p.str2json(d)) ? p.extend(d, e) : d = e;
			d && V.saveLocalData("ueditor_preference", p.json2str(d))
		};
		UE.Editor.prototype.getPreferences = function(c) {
			var a = V.getLocalData("ueditor_preference");
			return a && (a = p.str2json(a)) ? c ? a[c] : a : null
		};
		UE.Editor.prototype.removePreferences = function(c) {
			var a = V.getLocalData("ueditor_preference");
			a && (a = p.str2json(a)) && (a[c] = void 0, delete a[c]);
			a && V.saveLocalData("ueditor_preference", p.json2str(a))
		}
	})();
	p.extend(UE.Editor.prototype, {
		setValue: function(c, a) {
			var e;
			if (a.textarea)
				if (p.isString(a.textarea))
					for (var d = 0, b, h = g.getElementsByTagName(c, "textarea"); b = h[d++];) {
						if (b.id == "ueditor_textarea_" + a.options.textarea) {
							e = b;
							break
						}
					} else e = a.textarea;
			jQuery(a.selection.document).find("p").each(function() {
				"&nbsp;" == jQuery.trim(jQuery(this).html()) && jQuery(this).html("<br/>");
				"" != jQuery.trim(jQuery(this).text()) || 0 < jQuery(this).find("img").size() || (0 < jQuery(this).find("br").size() ? jQuery(this).html("<br/>") : "both" != this.style.clear && jQuery(this).remove())
			});
			e || (c.appendChild(e = g.createElement(document, "textarea", {
				name: a.options.textarea,
				id: "ueditor_textarea_" + a.options.textarea,
				style: "display:none"
			})), a.textarea = e);
			!e.getAttribute("name") && e.setAttribute("name", a.options.textarea);
			d = a.hasContents() ? a.options.allHtmlEnabled ? a.getAllHtml() : a.getContent(null, null, !0) : "";
			"" != d && (e.value = d)
		},
		parseWxHtml: function(c) {
			var a = this;
			c = jQuery("<div>" + c + " </div>");
			jQuery(c).find("*").each(function() {
				if ("undefined" != typeof this.tagName) {
					var e = jQuery(this).css("font-family");
					jQuery(this).css("font-family", e.replace("&quot;", "&#39;").replace('"', "'"));
					if ("SECTION" == this.tagName.toUpperCase() && (e = jQuery(this).attr("style")) && 0 <= e.indexOf("border-image"))
						if ((e = e.replace("&amp;", "&")) && 0 <= e.indexOf("http://remote.wx135.com/oss/view?d=")) {
							var e = e.replace("&free=1", ""),
								d = null,
								b = null,
								h = /['|"]\s*(http:\/\/remote\.wx135\.com\/oss\/view\?d=([^;\\)]+?))['|"]/i;
							(h = e.match(h)) && h[0] ? (d = h[1], b = decodeURIComponent(h[2])) : (h = /\(\s*(http:\/\/remote\.wx135\.com\/oss\/view\?d=([^;\\)]+?))\)/i, (h = e.match(h)) && h[0] && (d = h[1], b = decodeURIComponent(h[2])));
							a.getOpt("hd_image") && (b = b.replace(/\?wx_fmt=/g, "."));
							d && b && 0 <= b.indexOf("mmbiz.qlogo.cn") && jQuery(this).attr("style", e.replace(d, b))
						} else e && 0 <= e.indexOf(".135editor.com/cache/remote/") ? (b = d = null, h = /['|"]\s*(http:\/\/\w+\.135editor\.com\/cache\/remote\/([^;\\)]+?))['|"]/i, (h = e.match(h)) && h[0] ? (d = h[1], b = "function" == typeof window.strip_imgthumb_opr ? base64_decode(window.strip_imgthumb_opr(h[2])) : base64_decode(h[2])) : (h = /\(\s*(http:\/\/\w+\.135editor\.com\/cache\/remote\/([^;\\)]+?))\)/i, (h = e.match(h)) && h[0] && (d = h[1], b = "function" == typeof window.strip_imgthumb_opr ? base64_decode(window.strip_imgthumb_opr(h[2])) : base64_decode(h[2]))), d && b && (0 <= b.indexOf("mmbiz.qlogo.cn") || 0 <= b.indexOf("mmbiz.qpic.cn")) && (b = b.replace("http://mmbiz.qpic.cn", "https://mmbiz.qpic.cn"), b = b.replace("https://mmbiz.qlogo.cn", "https://mmbiz.qpic.cn"), a.getOpt("hd_image") && (b = b.replace(/\?wx_fmt=/g, ".")), jQuery(this).attr("style", e.replace(d, b)))) : e && (0 <= e.indexOf(".135editor.com/mmbiz") || 0 <= e.indexOf(".135editor.com/mmocbiz")) ? jQuery(this).attr("style", e.replace("http://mpt.135editor.com", "https://mmbiz.qlogo.cn")) : e && 0 <= e.indexOf(".135editor.com/mmsns") && jQuery(this).attr("style", e.replace("http://mpt.135editor.com", "http://mmsns.qpic.cn"));
					this.style.transform && a.setElementTransform(this, this.style.transform)
				}
			});
			c = jQuery.trim(c.html());
			return "" == c ? "" : c
		},
		getWxContent: function(c, a, e, d, b) {
			c = this.getContent(c, a, e, d, b);
			return this.parseWxHtml(c)
		},
		parseInsertPasteSetHtml: function(c) {
			var a = this;
			"function" == typeof strip_stack_span && (c = strip_stack_span(c));
			c = jQuery("<div>" + c + "</div>");
			do c.find(".article135:first,[data-role=outer]:first").each(function() {
				jQuery(this).css("background-color") || jQuery(this).css("background-image") ? jQuery(this).removeAttr("class").removeAttr("data-use") : jQuery(this).replaceWith(jQuery(this).html())
			});
			while (0 < c.find(".article135,[data-role=outer]").size());
			c.find("[donone]").removeAttr("label").removeAttr("id").removeAttr("donone").attr("class", "_135editor");
			c.find(".shifubrush").removeAttr("class");
			c.find("[powered-by]").removeAttr("powered-by").attr("class", "_135editor");
			c.find("blockquote.tn-Powered-by-XIUMI").attr("class", "_135editor");
			c.find(".135editor").removeClass("135editor").addClass("_135editor");
			c.find("section.tn-Powered-by-XIUMI").each(function() {
				var a = jQuery(this),
					d = !1;
				a.find("section:not(.tn-Powered-by-XIUMI)").each(function() {
					"both" == jQuery(this).css("clear") && "0px" == jQuery(this).css("width") && "0px" == jQuery(this).css("height") && (d = !0)
				});
				d && a.attr("class", "_135editor")
			});
			c.find(".tn-Powered-by-XIUMI").removeAttr("class");
			c.find("section.Powered-by-XIUMI,blockquote.Powered-by-XIUMI").each(function() {
				jQuery(this).attr("class", "_135editor")
			});
			this.isPaidUser();
			if (a.getOpt("open_editor")) return c.html();
			D(c);
			c.find("*").each(function() {
				this.style.transform && a.setElementTransform(this, this.style.transform);
				D(jQuery(this))
			});
			return c.html()
		},
		isPaidUser: function() {
			return this.is_paid_user
		},
		setPaidUser: function(c) {
			this.is_paid_user = c
		},
		setElementTransform: function(c, a) {
			if ("none" != a) {
				var e = jQuery(c).attr("style"),
					e = e.replace(/\s*\-[a-z]+\-transform\s*:[A-Za-z0-9_%,.\-\(\)\s]*;/gim, ""),
					e = e.replace(/[;]?\s*transform\s*:[A-Za-z0-9_%,.\-\(\)\s]*;/gim, ";"),
					e = (e + ";" + ("transform: " + a + ";-webkit-transform: " + a + ";-moz-transform: " + a + ";-o-transform: " + a + ";")).replace(";;", ";");
				jQuery(c).attr("style", e)
			}
		}
	}, !1);
	var W = null,
		ha = null;
	UE.plugins.defaultfilter = function() {
		var c = this;
		c.setOpt({
			allowDivTransToP: !0,
			disabledTableInTable: !0,
			rgb2Hex: !0
		});
		c.addInputRule(function(a) {
			function e(a) {
				for (; a && "element" == a.type;) {
					if ("td" == a.tagName) return !0;
					a = a.parentNode
				}
				return !1
			}
			var d = this.options.allowDivTransToP,
				b;
			a.traversal(function(a) {
				if ("element" == a.type)
					if (y.$cdata[a.tagName] || !c.options.autoClearEmptyNode || !y.$inline[a.tagName] || y.$empty[a.tagName] || a.attrs && !p.isEmptyObject(a.attrs)) switch (a.tagName) {
						case "style":
						case "script":
							a.setAttr({
								cdata_tag: a.tagName,
								cdata_data: a.innerHTML() || "",
								_ue_custom_node_: "true"
							});
							a.tagName = "div";
							a.innerHTML("");
							break;
						case "a":
							(b = a.getAttr("href")) && a.setAttr("_href", b);
							break;
						case "img":
							if ((b = a.getAttr("src")) && /^data:/.test(b)) {
								a.parentNode.removeChild(a);
								break
							}
							a.setAttr("_src", a.getAttr("src"));
							break;
						case "span":
							t.webkit && (b = a.getStyle("white-space")) && /nowrap|normal/.test(b) && (a.setStyle("white-space", ""), c.options.autoClearEmptyNode && p.isEmptyObject(a.attrs) && a.parentNode.removeChild(a, !0));
							(b = a.getAttr("id")) && /^_baidu_bookmark_/i.test(b) && a.parentNode.removeChild(a);
							break;
						case "p":
							if (b = a.getAttr("align")) a.setAttr("align"), a.setStyle("text-align", b);
							p.each(a.children, function(b) {
								if ("element" == b.type && "p" == b.tagName) {
									var d = b.nextSibling();
									for (a.parentNode.insertAfter(b, a); d;) {
										var f = d.nextSibling();
										a.parentNode.insertAfter(d, b);
										b = d;
										d = f
									}
									return !1
								}
							});
							a.firstChild() || a.innerHTML(t.ie ? "&nbsp;" : "<br/>");
							break;
						case "div":
							if (a.getAttr("cdata_tag")) break;
							if ((b = a.getAttr("class")) && /^line number\d+/.test(b)) break;
							if (!d) break;
							for (var f, h = UE.uNode.createElement("p"); f = a.firstChild();) "text" != f.type && UE.dom.dtd.$block[f.tagName] ? h.firstChild() ? (a.parentNode.insertBefore(h, a), h = UE.uNode.createElement("p")) : a.parentNode.insertBefore(f, a) : h.appendChild(f);
							h.firstChild() && a.parentNode.insertBefore(h, a);
							a.parentNode.removeChild(a);
							break;
						case "dl":
							a.tagName = "ul";
							break;
						case "dt":
						case "dd":
							a.tagName = "li";
							break;
						case "li":
							(f = a.getAttr("class")) && /list\-/.test(f) || a.setAttr();
							f = a.getNodesByTagName("ol ul");
							UE.utils.each(f, function(b) {
								a.parentNode.insertAfter(b, a)
							});
							break;
						case "td":
						case "th":
						case "caption":
							a.children && a.children.length || a.appendChild(t.ie11below ? UE.uNode.createText(" ") : UE.uNode.createElement("br"));
							break;
						case "table":
							c.options.disabledTableInTable && e(a) && (a.parentNode.insertBefore(UE.uNode.createText(a.innerText()), a), a.parentNode.removeChild(a))
					} else a.firstChild() ? "span" != a.tagName || a.attrs && !p.isEmptyObject(a.attrs) || a.parentNode.removeChild(a, !0) : a.parentNode.removeChild(a)
			})
		});
		c.addOutputRule(function(a) {
			var e;
			a.traversal(function(a) {
				if ("element" == a.type)
					if (!c.options.autoClearEmptyNode || !y.$inline[a.tagName] || y.$empty[a.tagName] || a.attrs && !p.isEmptyObject(a.attrs)) switch (a.tagName) {
						case "div":
							if (e = a.getAttr("cdata_tag")) a.tagName = e, a.appendChild(UE.uNode.createText(a.getAttr("cdata_data"))), a.setAttr({
								cdata_tag: "",
								cdata_data: "",
								_ue_custom_node_: ""
							});
							break;
						case "a":
							(e = a.getAttr("_href")) && a.setAttr({
								href: p.html(e),
								_href: ""
							});
							break;
						case "span":
							(e = a.getAttr("id")) && /^_baidu_bookmark_/i.test(e) && a.parentNode.removeChild(a);
							if (c.getOpt("rgb2Hex")) {
								var b = a.getAttr("style");
								b && a.setAttr("style", b.replace(/rgba?\(([\d,\s]+)\)/g, function(a, b) {
									var d = b.split(",");
									if (3 < d.length) return "";
									b = "#";
									for (var f = 0, e; e = d[f++];) e = parseInt(e.replace(/[^\d]/gi, ""), 10).toString(16), b += 1 == e.length ? "0" + e : e;
									return b.toUpperCase()
								}))
							}
							break;
						case "img":
							(e = a.getAttr("_src")) && a.setAttr({
								src: a.getAttr("_src"),
								_src: ""
							})
					} else a.firstChild() ? "span" != a.tagName || a.attrs && !p.isEmptyObject(a.attrs) || a.parentNode.removeChild(a, !0) : a.parentNode.removeChild(a)
			})
		})
	};
	UE.commands.inserthtml = {
		execCommand: function(c, a, e) {
			var d = this,
				b;
			if (a && !0 !== d.fireEvent("beforeinserthtml", a)) {
				b = d.selection.getRange();
				c = b.document.createElement("div");
				c.style.display = "inline";
				e || (e = UE.htmlparser(a), d.options.filterRules && UE.filterNode(e, d.options.filterRules), d.filterInputRule(e), a = e.toHtml());
				c.innerHTML = p.trim(a);
				if (!b.collapsed && (e = b.startContainer, g.isFillChar(e) && b.setStartBefore(e), e = b.endContainer, g.isFillChar(e) && b.setEndAfter(e), b.txtToElmBoundary(), b.endContainer && 1 == b.endContainer.nodeType && (e = b.endContainer.childNodes[b.endOffset]) && g.isBr(e) && b.setEndAfter(e), 0 == b.startOffset && (e = b.startContainer, g.isBoundaryNode(e, "firstChild") && (e = b.endContainer, b.endOffset == (3 == e.nodeType ? e.nodeValue.length : e.childNodes.length) && g.isBoundaryNode(e, "lastChild") && (d.body.innerHTML = "<p>" + (t.ie ? "" : "<br/>") + "</p>", b.setStart(d.body.firstChild, 0).collapse(!0)))), !b.collapsed && b.deleteContents(), 1 == b.startContainer.nodeType)) {
					var h = b.startContainer.childNodes[b.startOffset],
						f;
					if (h && g.isBlockElm(h) && (f = h.previousSibling) && g.isBlockElm(f)) {
						for (b.setEnd(f, f.childNodes.length).collapse(); h.firstChild;) f.appendChild(h.firstChild);
						g.remove(h)
					}
				}
				var l, k;
				e = 0;
				var n;
				b.inFillChar() && (h = b.startContainer, g.isFillChar(h) ? (b.setStartBefore(h).collapse(!0), g.remove(h)) : g.isFillChar(h, !0) && (h.nodeValue = h.nodeValue.replace(S, ""), b.startOffset--, b.collapsed && b.collapse(!0)));
				var m = g.findParentByTagName(b.startContainer, "li", !0);
				if (m) {
					for (var r; h = c.firstChild;) {
						for (; h && (3 == h.nodeType || !g.isBlockElm(h) || "HR" == h.tagName);) l = h.nextSibling, b.insertNode(h).collapse(), r = h, h = l;
						if (h)
							if (/^(ol|ul)$/i.test(h.tagName)) {
								for (; h.firstChild;) r = h.firstChild, g.insertAfter(m, h.firstChild), m = m.nextSibling;
								g.remove(h)
							} else l = h.nextSibling, f = d.document.createElement("li"), g.insertAfter(m, f), f.appendChild(h), r = h, h = l, m = f
					}
					m = g.findParentByTagName(b.startContainer, "li", !0);
					g.isEmptyBlock(m) && g.remove(m);
					r && b.setStartAfter(r).collapse(!0).select(!0)
				} else {
					r = 0;
					(h = g.findParentByTagName(b.startContainer, "section", !0)) && g.hasClass(h, "_135editor") && "paragraph" == h.getAttribute("data-role") && g.isEmptyBlock(h) && 0 < jQuery(c).find("._135editor").size() && (r = d.document.createElement("p"), h.parentNode.insertBefore(r, h), g.fillNode(d.document, r), b.setStart(r, 0).setCursor(), r = 1);
					for (; h = c.firstChild;) {
						b.insertNode(h);
						n = h.nextSibling;
						if (!e && h.nodeType == g.NODE_ELEMENT && g.isBlockElm(h) && (l = g.findParent(h, function(a) {
								return g.isBlockElm(a)
							})) && "body" != l.tagName.toLowerCase() && y[l.tagName] && (!y[l.tagName][h.nodeName] || h.parentNode !== l)) {
							if (y[l.tagName][h.nodeName])
								for (k = h.parentNode; k !== l;) f = k, k = k.parentNode;
							else f = l;
							g.breakParent(h, f || k);
							f = h.previousSibling;
							g.trimWhiteTextNode(f);
							f.childNodes.length || g.remove(f);
							e = 1
						}
						l = h.nextSibling;
						if (!c.firstChild && l && g.isBlockElm(l)) {
							b.setStart(l, 0).collapse(!0);
							break
						}
						b.setEndAfter(h).collapse()
					}
					h = b.startContainer;
					n && g.isBr(n) && g.remove(n);
					if (g.isBlockElm(h) && g.isEmptyNode(h))
						if (r) {
							if (n = h.nextSibling) b.setStart(n, 0).collapse(!0).shrinkBoundary(), g.remove(h)
						} else try {
							h.innerHTML = t.ie ? g.fillChar : "<br/>"
						} catch (v) {
							b.setStartBefore(h), g.remove(h)
						}
					try {
						b.select(!0)
					} catch (v) {}
				}
				setTimeout(function() {
					b = d.selection.getRange();
					b.scrollToView(d.autoHeightEnabled, d.autoHeightEnabled ? g.getXY(d.iframe).y : 0);
					d.fireEvent("afterinserthtml", a)
				}, 200)
			}
		}
	};
	UE.plugins.autotypeset = function() {
		var _this = this;
		function c(a, b) {
			if (!a || 3 == a.nodeType) return 0;
			if (g.isBr(a)) return 1;
			if (a && a.parentNode && l[a.tagName.toLowerCase()]) return k && k.contains(a) || a.getAttribute("pagebreak") ? 0 : b ? !g.isEmptyBlock(a) : g.isEmptyBlock(a, new RegExp("[\\s" + g.fillChar + "]", "g"))
		}

		function a(a) {
			a.style.cssText || (g.removeAttributes(a, ["style"]), "span" == a.tagName.toLowerCase() && g.hasNoAttributes(a) && g.remove(a, !0))
		}

		function e(d, e) {
			var l;
			if (e) {
				if (!b.pasteFilter) return;
				l = this.document.createElement("div");
				l.innerHTML = e.html
			} else l = this.document.body;
			for (var m = g.getElementsByTagName(l, "*"), n = 0, x; x = m[n++];)
				if (!0 !== this.fireEvent("excludeNodeinautotype", x)) {
					b.clearFontSize && x.style.fontSize && (g.removeStyle(x, "font-size"), a(x));
					b.clearFontFamily && x.style.fontFamily && (g.removeStyle(x, "font-family"), a(x));
					if (c(x)) {
						if (b.mergeEmptyline)
							for (var w = x.nextSibling, F, I = g.isBr(x); c(w);) {
								F = w;
								w = F.nextSibling;
								if (I && (!w || w && !g.isBr(w))) break;
								g.remove(F)
							}
						if (b.removeEmptyline && g.inDoc(x, l) && !f[x.parentNode.tagName.toLowerCase()]) {
							if (g.isBr(x) && (w = x.nextSibling) && !g.isBr(w)) continue;
							g.remove(x);
							continue
						}
					}
					c(x, !0) && "SPAN" != x.tagName && (b.indent && (x.style.textIndent = b.indentValue), b.textAlign && (x.style.textAlign = b.textAlign));
					if (b.removeClass && x.className && !h[x.className.toLowerCase()]) {
						if(_this.options.whitListClass.indexOf(x.className) != -1){continue;}
						if (k && k.contains(x)) continue;
						g.removeAttributes(x, ["class"])
					}
					if (b.imageBlockLine && "img" == x.tagName.toLowerCase() && !x.getAttribute("emotion"))
						if (e) switch (I = x, b.imageBlockLine) {
							case "left":
							case "right":
							case "none":
								for (var w = I.parentNode, Q; y.$inline[w.tagName] || "A" == w.tagName;) w = w.parentNode;
								F = w;
								if ("P" == F.tagName && "center" == g.getStyle(F, "text-align") && !g.isBody(F) && 1 == g.getChildCount(F, function(a) {
										return !g.isBr(a) && !g.isWhitespace(a)
									}))
									if (Q = F.previousSibling, w = F.nextSibling, Q && w && 1 == Q.nodeType && 1 == w.nodeType && Q.tagName == w.tagName && g.isBlockElm(Q)) {
										for (Q.appendChild(F.firstChild); w.firstChild;) Q.appendChild(w.firstChild);
										g.remove(F);
										g.remove(w)
									} else g.setStyle(F, "text-align", "");
								g.setStyle(I, "float", b.imageBlockLine);
								break;
							case "center":
								if ("center" != this.queryCommandValue("imagefloat")) {
									w = I.parentNode;
									g.setStyle(I, "float", "none");
									for (F = I; w && 1 == g.getChildCount(w, function(a) {
											return !g.isBr(a) && !g.isWhitespace(a)
										}) && (y.$inline[w.tagName] || "A" == w.tagName);) F = w, w = w.parentNode;
									w = this.document.createElement("p");
									g.setAttributes(w, {
										style: "text-align:center"
									});
									F.parentNode.insertBefore(w, F);
									w.appendChild(F);
									g.setStyle(F, "float", "")
								}
						} else this.selection.getRange().selectNode(x).select(), this.execCommand("imagefloat", b.imageBlockLine);
					b.removeEmptyNode && b.removeTagNames[x.tagName.toLowerCase()] && g.hasNoAttributes(x) && g.isEmptyBlock(x) && g.remove(x)
				}
			b.tobdc && (m = UE.htmlparser(l.innerHTML), m.traversal(function(a) {
				if ("text" == a.type) {
					for (var b = a.data, b = p.html(b), d = "", f = 0; f < b.length; f++) d = 32 == b.charCodeAt(f) ? d + String.fromCharCode(12288) : 127 > b.charCodeAt(f) ? d + String.fromCharCode(b.charCodeAt(f) + 65248) : d + b.charAt(f);
					a.data = d
				}
			}), l.innerHTML = m.toHtml());
			b.bdc2sb && (m = UE.htmlparser(l.innerHTML), m.traversal(function(a) {
				if ("text" == a.type) {
					for (var b = a.data, d = "", f = 0; f < b.length; f++) var k = b.charCodeAt(f),
						d = 65281 <= k && 65373 >= k ? d + String.fromCharCode(b.charCodeAt(f) - 65248) : 12288 == k ? d + String.fromCharCode(b.charCodeAt(f) - 12288 + 32) : d + b.charAt(f);
					a.data = d
				}
			}), l.innerHTML = m.toHtml());
			e && (e.html = l.innerHTML)
		}
		this.setOpt({
			autotypeset: {
				mergeEmptyline: !0,
				removeClass: !1,
				removeEmptyline: !1,
				textAlign: "left",
				imageBlockLine: "center",
				pasteFilter: !1,
				clearFontSize: !1,
				clearFontFamily: !1,
				removeEmptyNode: !1,
				removeTagNames: p.extend({
					div: 1
				}, y.$removeEmpty),
				indent: !1,
				indentValue: "2em",
				bdc2sb: !1,
				tobdc: !1
			}
		});
		var d = this,
			b = d.options.autotypeset,
			h = {
				selectTdClass: 1,
				pagebreak: 1,
				anchorclass: 1
			},
			f = {
				li: 1
			},
			l = {
				div: 1,
				p: 1,
				blockquote: 1,
				center: 1,
				h1: 1,
				h2: 1,
				h3: 1,
				h4: 1,
				h5: 1,
				h6: 1,
				span: 1
			},
			k;
		b && (function() {
			var a = d.getPreferences("autotypeset");
			p.extend(d.options.autotypeset, a)
		}(), b.pasteFilter = !1, b.removeEmptyNode = !1, b.pasteFilter && d.addListener("beforepaste", e), d.commands.autotypeset = {
			execCommand: function() {
				d.removeListener("beforepaste", e);
				b.pasteFilter && d.addListener("beforepaste", e);
				e.call(d)
			}
		})
	};
	UE.plugin.register("autosubmit", function() {
		return {
			shortcutkey: {
				autosubmit: "ctrl+13"
			},
			commands: {
				autosubmit: {
					execCommand: function() {
						var c = g.findParentByTagName(this.iframe, "form", !1);
						c && !1 !== this.fireEvent("beforesubmit") && (this.sync(), c.submit())
					}
				}
			}
		}
	});
	UE.plugin.register("background", function() {
		function c(a) {
			var b = {};
			a = a.split(";");
			p.each(a, function(a) {
				var d = a.indexOf(":"),
					f = p.trim(a.substr(0, d)).toLowerCase();
				f && (b[f] = p.trim(a.substr(d + 1) || ""))
			});
			return b
		}

		function a(a) {
			if (a) {
				var b = [],
					d;
				for (d in a) a.hasOwnProperty(d) && b.push(d + ":" + a[d] + "; ");
				p.cssRule("editor_background", b.length ? "body{" + b.join("") + "}" : "", e.document)
			} else p.cssRule("editor_background", "", e.document)
		}
		var e = this,
			d, b = /body[\s]*\{(.+)\}/i,
			h = e.hasContents;
		e.hasContents = function() {
			return e.queryCommandValue("background") ? !0 : h.apply(e, arguments)
		};
		return {
			bindEvents: {
				getAllHtml: function(a, b) {
					var d = this.body,
						f = g.getComputedStyle(d, "background-image"),
						h;
					h = 0 < f.indexOf(e.options.imagePath) ? f.substring(f.indexOf(e.options.imagePath), f.length - 1).replace(/"|\(|\)/ig, "") : "none" != f ? f.replace(/url\("?|"?\)/ig, "") : "";
					var f = '<style type="text/css">body{',
						d = {
							"background-color": g.getComputedStyle(d, "background-color") || "#ffffff",
							"background-image": h ? "url(" + h + ")" : "",
							"background-repeat": g.getComputedStyle(d, "background-repeat") || "",
							"background-position": t.ie ? g.getComputedStyle(d, "background-position-x") + " " + g.getComputedStyle(d, "background-position-y") : g.getComputedStyle(d, "background-position"),
							height: g.getComputedStyle(d, "height")
						},
						c;
					for (c in d) d.hasOwnProperty(c) && (f += c + ":" + d[c] + "; ");
					b.push(f + "}</style> ")
				},
				aftersetcontent: function() {
					0 == d && a()
				}
			},
			inputRule: function(b) {
				d = !1;
				p.each(b.getNodesByTagName("p"), function(b) {
					var f = b.getAttr("data-background");
					f && (d = !0, a(c(f)), b.parentNode.removeChild(b))
				})
			},
			outputRule: function(a) {
				var d = (p.cssRule("editor_background", this.document) || "").replace(/[\n\r]+/g, "").match(b);
				d && a.appendChild(UE.uNode.createElement('<p style="display:none;" data-background="' + p.trim(d[1].replace(/"/g, "").replace(/[\s]+/g, " ")) + '"><br/></p>'))
			},
			commands: {
				background: {
					execCommand: function(b, d) {
						a(d)
					},
					queryCommandValue: function() {
						var a = (p.cssRule("editor_background", this.document) || "").replace(/[\n\r]+/g, "").match(b);
						return a ? c(a[1]) : null
					},
					notNeedUndo: !0
				}
			}
		}
	});


	UE.commands.imagefloat = {
		execCommand: function(c, a) {
			var e = this.selection.getRange();
			if (!e.collapsed) {
				var d = e.getClosedNode();
				if (d && "IMG" == d.tagName) switch (a) {
					case "left":
					case "right":
					case "none":
						for (var b = d.parentNode, h, f; y.$inline[b.tagName] || "A" == b.tagName;) b = b.parentNode;
						h = b;
						if ("P" == h.tagName && "center" == g.getStyle(h, "text-align")) {
							if (!g.isBody(h) && 1 == g.getChildCount(h, function(a) {
									return !g.isBr(a) && !g.isWhitespace(a)
								}))
								if (b = h.previousSibling, f = h.nextSibling, b && f && 1 == b.nodeType && 1 == f.nodeType && b.tagName == f.tagName && g.isBlockElm(b)) {
									for (b.appendChild(h.firstChild); f.firstChild;) b.appendChild(f.firstChild);
									g.remove(h);
									g.remove(f)
								} else g.setStyle(h, "text-align", "");
							e.selectNode(d).select()
						}
						g.setStyle(d, "float", "none" == a ? "" : a);
						"none" == a && g.removeAttributes(d, "align");
						break;
					case "center":
						if ("center" != this.queryCommandValue("imagefloat")) {
							b = d.parentNode;
							g.setStyle(d, "float", "");
							g.removeAttributes(d, "align");
							for (h = d; b && 1 == g.getChildCount(b, function(a) {
									return !g.isBr(a) && !g.isWhitespace(a)
								}) && (y.$inline[b.tagName] || "A" == b.tagName);) h = b, b = b.parentNode;
							e.setStartBefore(h).setCursor(!1);
							b = this.document.createElement("div");
							b.appendChild(h);
							g.setStyle(h, "float", "");
							this.execCommand("insertHtml", '<p id="_img_parent_tmp" style="text-align:center">' + b.innerHTML + "</p>");
							h = this.document.getElementById("_img_parent_tmp");
							h.removeAttribute("id");
							h = h.firstChild;
							e.selectNode(h).select();
							(f = h.parentNode.nextSibling) && g.isEmptyNode(f) && g.remove(f)
						}
				}
			}
		},
		queryCommandValue: function() {
			var c = this.selection.getRange(),
				a;
			return c.collapsed ? "none" : (c = c.getClosedNode()) && 1 == c.nodeType && "IMG" == c.tagName ? (a = g.getComputedStyle(c, "float") || c.getAttribute("align"), "none" == a && (a = "center" == g.getComputedStyle(c.parentNode, "text-align") ? "center" : a), {
				left: 1,
				right: 1,
				center: 1
			}[a] ? a : "none") : "none"
		},
		queryCommandState: function() {
			var c = this.selection.getRange();
			return c.collapsed ? -1 : (c = c.getClosedNode()) && 1 == c.nodeType && "IMG" == c.tagName ? 0 : -1
		}
	};
	UE.commands.insertimage = {
		execCommand: function(c, a) {
			a = p.isArray(a) ? a : [a];
			if (a.length) {
				var e = this.selection.getRange(),
					d = e.getClosedNode();
				if (!0 !== this.fireEvent("beforeinsertimage", a)) {
					if (!d || !/img/i.test(d.tagName) || "edui-faked-video" == d.className && -1 == d.className.indexOf("edui-upload-video") || d.getAttribute("word_img")) {
						var e = [],
							b;
						b = a[0];
						if (1 == a.length) d = '<img src="' + b.src + '" ' + (b._src ? ' _src="' + b._src + '" ' : "") + (b.width ? 'width="' + b.width + '" ' : "") + (b.height ? ' height="' + b.height + '" ' : "") + (b.aid ? ' aid="' + b.aid + '" ' : "") + (b.id ? ' id="' + b.id + '" ' : "") + ("left" == b.floatStyle || "right" == b.floatStyle ? ' style="float:' + b.floatStyle + ';"' : "") + (b.title && "" != b.title ? ' title="' + b.title + '"' : "") + (b.border && "0" != b.border ? ' border="' + b.border + '"' : "") + (b.alt && "" != b.alt ? ' alt="' + b.alt + '"' : "") + (b.hspace && "0" != b.hspace ? ' hspace = "' + b.hspace + '"' : "") + (b.vspace && "0" != b.vspace ? ' vspace = "' + b.vspace + '"' : "") + "/>", "center" == b.floatStyle && (d = '<p style="text-align: center">' + d + "</p>"), e.push(d);
						else
							for (var h = 0; b = a[h++];) d = "<p " + ("center" == b.floatStyle ? 'style="text-align: center" ' : "") + '><img src="' + b.src + '" ' + (b.width ? 'width="' + b.width + '" ' : "") + (b._src ? ' _src="' + b._src + '" ' : "") + (b.height ? ' height="' + b.height + '" ' : "") + (b.aid ? ' aid="' + b.aid + '" ' : "") + (b.id ? ' id="' + b.id + '" ' : "") + ' style="' + (b.floatStyle && "center" != b.floatStyle ? "float:" + b.floatStyle + ";" : "") + (b.border || "") + '" ' + (b.title ? ' title="' + b.title + '"' : "") + " /></p>", e.push(d);
						this.execCommand("insertHtml", e.join(""))
					} else b = a.shift(), h = b.floatStyle, delete b.floatStyle, g.setAttributes(d, b), this.execCommand("imagefloat", h), 0 < a.length && (e.setStartAfter(d).setCursor(!1, !0), this.execCommand("insertimage", a));
					this.fireEvent("afterinsertimage", a)
				}
			}
		}
	};
	UE.plugins.justify = function() {
		var c = g.isBlockElm,
			a = {
				left: 1,
				right: 1,
				center: 1,
				justify: 1
			},
			e = function(a, b) {
				var d = a.createBookmark(),
					f = function(a) {
						return 1 == a.nodeType ? "br" != a.tagName.toLowerCase() && !g.isBookmarkNode(a) : !g.isWhitespace(a)
					};
				a.enlarge(!0);
				for (var e = a.createBookmark(), k = g.getNextDomNode(e.start, !1, f), n = a.cloneRange(), m; k && !(g.getPosition(k, e.end) & g.POSITION_FOLLOWING);)
					if (3 != k.nodeType && c(k)) k = g.getNextDomNode(k, !0, f);
					else {
						for (n.setStartBefore(k); k && k !== e.end && !c(k);) m = k, k = g.getNextDomNode(k, !1, null, function(a) {
							return !c(a)
						});
						n.setEndAfter(m);
						k = n.getCommonAncestor();
						if (!g.isBody(k) && c(k)) g.setStyles(k, p.isString(b) ? {
							"text-align": b
						} : b);
						else {
							k = a.document.createElement("p");
							g.setStyles(k, p.isString(b) ? {
								"text-align": b
							} : b);
							var r = n.extractContents();
							k.appendChild(r);
							n.insertNode(k)
						}
						k = g.getNextDomNode(k, !1, f)
					}
				return a.moveToBookmark(e).moveToBookmark(d)
			};
		UE.commands.justify = {
			execCommand: function(a, b) {
				var d = this.selection.getRange(),
					f;
				d.collapsed && (f = this.document.createTextNode("p"), d.insertNode(f));
				e(d, b);
				f && (d.setStartBefore(f).collapse(!0), g.remove(f));
				d.select();
				return !0
			},
			queryCommandValue: function() {
				var d = this.selection.getStart(),
					d = g.getComputedStyle(d, "text-align");
				return a[d] ? d : "left"
			},
			queryCommandState: function() {
				var a = this.selection.getStart();
				return a && g.findParentByTagName(a, ["td", "th", "caption"], !0) ? -1 : 0
			}
		}
	};
	UE.plugins.font = function() {
		function c(a) {
			for (var b; b = a.parentNode;)
				if ("SPAN" == b.tagName && 1 == g.getChildCount(b, function(a) {
						return !g.isBookmarkNode(a) && !g.isBr(a)
					})) b.style.cssText += a.style.cssText, g.remove(a, !0), a = b;
				else break
		}

		function a(a, b, d) {
			if (h[b] && (a.adjustmentBoundary(), !a.collapsed && 1 == a.startContainer.nodeType)) {
				var f = a.startContainer.childNodes[a.startOffset];
				if (f && g.isTagNode(f, "span")) {
					var k = a.createBookmark();
					p.each(g.getElementsByTagName(f, "span"), function(a) {
						!a.parentNode || g.isBookmarkNode(a) || "backcolor" == b && g.getComputedStyle(a, "background-color").toLowerCase() === d || (g.removeStyle(a, h[b]), 0 == a.style.cssText.replace(/^\s+$/, "").length && g.remove(a, !0))
					});
					a.moveToBookmark(k)
				}
			}
		}

		function e(b, d, f) {
			var k = b.collapsed,
				e = b.createBookmark();
			if (k)
				for (k = e.start.parentNode; y.$inline[k.tagName];) k = k.parentNode;
			else k = g.getCommonAncestor(e.start, e.end);
			p.each(g.getElementsByTagName(k, "span"), function(a) {
				if (a.parentNode && !g.isBookmarkNode(a))
					if (/\s*border\s*:\s*none;?\s*/i.test(a.style.cssText)) / ^ \s * border\s * : \s * none; ? \s * $ /.test(a.style.cssText) ? g.remove(a, !0) : g.removeStyle(a, "border");
					else {
						/border/i.test(a.style.cssText) && "SPAN" == a.parentNode.tagName && /border/i.test(a.parentNode.style.cssText) && (a.style.cssText = a.style.cssText.replace(/border[^:]*:[^;]+;?/gi, ""));
						if ("fontborder" != d || "none" != f)
							for (var b = a.nextSibling; b && 1 == b.nodeType && "SPAN" == b.tagName;) {
								if (g.isBookmarkNode(b) && "fontborder" == d) a.appendChild(b);
								else if (b.style.cssText == a.style.cssText && (g.moveChild(b, a), g.remove(b)), a.nextSibling === b) break;
								b = a.nextSibling
							}
						c(a);
						t.ie && 8 < t.version && (b = g.findParent(a, function(a) {
							return "SPAN" == a.tagName && /background-color/.test(a.style.cssText)
						})) && !/background-color/.test(a.style.cssText) && (a.style.backgroundColor = b.style.backgroundColor)
					}
			});
			b.moveToBookmark(e);
			a(b, d, f)
		}
		var d = {
				forecolor: "color",
				shadowcolor: "text-shadow",
				backcolor: "background-color",
				fontsize: "font-size",
				fontfamily: "font-family",
				underline: "text-decoration",
				strikethrough: "text-decoration",
				fontborder: "border"
			},
			b = {
				underline: 1,
				strikethrough: 1,
				fontborder: 1
			},
			h = {
				forecolor: "color",
				shadowcolor: "text-shadow",
				backcolor: "background-color",
				fontsize: "font-size",
				fontfamily: "font-family"
			};
		this.setOpt({
			fontfamily: [{
				name: "songti",
				val: "宋体,SimSun"
			}, {
				name: "yahei",
				val: "微软雅黑,Microsoft YaHei"
			}, {
				name: "kaiti",
				val: "楷体,楷体_GB2312, SimKai"
			}, {
				name: "heiti",
				val: "黑体, SimHei"
			}, {
				name: "lishu",
				val: "隶书, SimLi"
			}, {
				name: "andaleMono",
				val: "andale mono"
			}, {
				name: "arial",
				val: "arial, helvetica,sans-serif"
			}, {
				name: "arialBlack",
				val: "arial black,avant garde"
			}, {
				name: "comicSansMs",
				val: "comic sans ms"
			}, {
				name: "impact",
				val: "impact,chicago"
			}, {
				name: "timesNewRoman",
				val: "times new roman"
			}],
			fontsize: [8, 10, 12, 14, 15, 16, 18, 22, 24, 26, 36, 42],
            fontsizehtx: ['小五', '五号', '小四', '四号', '小三', '三号', '小二', '二号', '小一', '一号', '小初', '初号']
		});
		this.addInputRule(function(a) {
			p.each(a.getNodesByTagName("u s del font strike"), function(a) {
				if ("font" == a.tagName) {
					var b = [],
						d;
					for (d in a.attrs) switch (d) {
						case "size":
							b.push("font-size:" + ({
								1: "10",
								2: "12",
								3: "16",
								4: "18",
								5: "24",
								6: "32",
								7: "48"
							}[a.attrs[d]] || a.attrs[d]) + "px");
							break;
						case "color":
							b.push("color:" + a.attrs[d]);
							break;
						case "face":
							b.push("font-family:" + a.attrs[d]);
							break;
						case "style":
							b.push(a.attrs[d])
					}
					a.attrs = {
						style: b.join(";")
					}
				} else b = "u" == a.tagName ? "underline" : "line-through", a.attrs = {
					style: (a.getAttr("style") || "") + "text-decoration:" + b + ";"
				};
				a.tagName = "span"
			})
		});
		for (var f in d)(function(a, d) {
			UE.commands[a] = {
				execCommand: function(f, k) {
					k = k || (this.queryCommandState(f) ? "none" : "underline" == f ? "underline" : "fontborder" == f ? "1px solid #000" : "line-through");
					var h = this.selection.getRange(),
						c;
					if ("default" == k) h.collapsed && (c = this.document.createTextNode("font"), h.insertNode(c).select()), this.execCommand("removeFormat", "span,a", d), c && (h.setStartBefore(c).collapse(!0), g.remove(c)), e(h, f, k), h.select();
					else if (h.collapsed) {
						var l = g.findParentByTagName(h.startContainer, "span", !0);
						c = this.document.createTextNode("font");
						if (!l || l.children.length || l[t.ie ? "innerText" : "textContent"].replace(S, "").length) {
							h.insertNode(c);
							h.selectNode(c).select();
							l = h.document.createElement("span");
							if (b[a]) {
								if (g.findParentByTagName(c, "a", !0)) {
									h.setStartBefore(c).setCursor();
									g.remove(c);
									return
								}
								this.execCommand("removeFormat", "span,a", d)
							}
							l.style.cssText = d + ":" + k;
							c.parentNode.insertBefore(l, c);
							if (!t.ie || t.ie && 9 == t.version)
								for (var m = l.parentNode; !g.isBlockElm(m);) "SPAN" == m.tagName && (l.style.cssText = m.style.cssText + ";" + l.style.cssText), m = m.parentNode;
							ka ? setTimeout(function() {
								h.setStart(l, 0).collapse(!0);
								e(h, f, k);
								h.select()
							}) : (h.setStart(l, 0).collapse(!0), e(h, f, k), h.select())
						} else h.insertNode(c), b[a] && (h.selectNode(c).select(), this.execCommand("removeFormat", "span,a", d, null), l = g.findParentByTagName(c, "span", !0), h.setStartBefore(c)), l && (l.style.cssText += ";" + d + ":" + k), h.collapse(!0).select();
						g.remove(c)
					} else b[a] && this.queryCommandValue(a) && this.execCommand("removeFormat", "span,a", d), h = this.selection.getRange(), h.applyInlineStyle("span", {
						style: d + ":" + k
					}), e(h, f, k), h.select();
					return !0
				},
				queryCommandValue: function(a) {
					var b = this.selection.getStart();
					if ("underline" == a || "strikethrough" == a) {
						for (var f = b; f && !g.isBlockElm(f) && !g.isBody(f);) {
							if (1 == f.nodeType && (a = g.getComputedStyle(f, d), "none" != a)) return a;
							f = f.parentNode
						}
						return "none"
					}
					if ("fontborder" == a) {
						for (a = b; a && y.$inline[a.tagName];) {
							if ((f = g.getComputedStyle(a, "border")) && /1px/.test(f) && /solid/.test(f)) return f;
							a = a.parentNode
						}
						return ""
					}
					return "FontSize" == a ? (f = g.getComputedStyle(b, d), (a = /^([\d\.]+)(\w+)$/.exec(f)) ? Math.floor(a[1]) + a[2] : f) : g.getComputedStyle(b, d)
				},
				queryCommandState: function(a) {
					if (!b[a]) return 0;
					var d = this.queryCommandValue(a);
					return "fontborder" == a ? /1px/.test(d) && /solid/.test(d) : "underline" == a ? /underline/.test(d) : /line\-through/.test(d)
				}
			}
		})(f, d[f])
	};
	UE.plugins.link = function() {
		function c(a) {
			var e = a.startContainer,
				d = a.endContainer;
			(e = g.findParentByTagName(e, "a", !0)) && a.setStartBefore(e);
			(d = g.findParentByTagName(d, "a", !0)) && a.setEndAfter(d)
		}
		UE.commands.unlink = {
			execCommand: function() {
				var a = this.selection.getRange(),
					e;
				if (!a.collapsed || g.findParentByTagName(a.startContainer, "a", !0)) e = a.createBookmark(), c(a), a.removeInlineStyle("a").moveToBookmark(e).select()
			},
			queryCommandState: function() {
				return !this.highlight && this.queryCommandValue("link") ? 0 : -1
			}
		};
		UE.commands.link = {
			execCommand: function(a, e) {
				var d;
				e._href && (e._href = p.unhtml(e._href, /[<">]/g));
				e.href && (e.href = p.unhtml(e.href, /[<">]/g));
				e.textValue && (e.textValue = p.unhtml(e.textValue, /[<">]/g));
				var b = d = this.selection.getRange(),
					h = b.cloneRange(),
					f = this.queryCommandValue("link");
				c(b = b.adjustmentBoundary());
				var l = b.startContainer;
				1 == l.nodeType && f && (l = l.childNodes[b.startOffset]) && 1 == l.nodeType && "A" == l.tagName && /^(?:https?|ftp|file)\s*:\s*\/\//.test(l[t.ie ? "innerText" : "textContent"]) && (l[t.ie ? "innerText" : "textContent"] = p.html(e.textValue || e.href));
				if (!h.collapsed || f) b.removeInlineStyle("a"), h = b.cloneRange();
				if (h.collapsed) {
					var f = b.document.createElement("a"),
						k;
					e.textValue ? (k = p.html(e.textValue), delete e.textValue) : k = p.html(e.href);
					g.setAttributes(f, e);
					(l = g.findParentByTagName(h.startContainer, "a", !0)) && g.isInNodeEndBoundary(h, l) && b.setStartAfter(l).collapse(!0);
					f[t.ie ? "innerText" : "textContent"] = k;
					b.insertNode(f).selectNode(f)
				} else b.applyInlineStyle("a", e);
				d.collapse().select(!0)
			},
			queryCommandValue: function() {
				var a = this.selection.getRange(),
					e;
				if (a.collapsed) {
					if (e = a.startContainer, (e = 1 == e.nodeType ? e : e.parentNode) && (e = g.findParentByTagName(e, "a", !0)) && !g.isInNodeEndBoundary(a, e)) return e
				} else {
					a.shrinkBoundary();
					var d = 3 != a.startContainer.nodeType && a.startContainer.childNodes[a.startOffset] ? a.startContainer.childNodes[a.startOffset] : a.startContainer,
						b = 3 == a.endContainer.nodeType || 0 == a.endOffset ? a.endContainer : a.endContainer.childNodes[a.endOffset - 1],
						a = a.getCommonAncestor();
					e = g.findParentByTagName(a, "a", !0);
					if (!e && 1 == a.nodeType)
						for (var a = a.getElementsByTagName("a"), h, f, c = 0, k; k = a[c++];)
							if (h = g.getPosition(k, d), f = g.getPosition(k, b), (h & g.POSITION_FOLLOWING || h & g.POSITION_CONTAINS) && (f & g.POSITION_PRECEDING || f & g.POSITION_CONTAINS)) {
								e = k;
								break
							}
					return e
				}
			},
			queryCommandState: function() {
				var a = this.selection.getRange().getClosedNode();
				return !a || "edui-faked-video" != a.className && -1 == a.className.indexOf("edui-upload-video") ? 0 : -1
			}
		}
	};

	UE.plugins.removeformat = function() {
		this.setOpt({
			removeFormatTags: "b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",
			removeFormatAttributes: "class,style,lang,width,height,align,hspace,valign"
		});
		this.commands.removeformat = {
			execCommand: function(c, a, e, d, b) {
				function h(a) {
					if (3 == a.nodeType || "span" != a.tagName.toLowerCase()) return 0;
					if (t.ie) {
						var b = a.attributes;
						if (b.length) {
							a = 0;
							for (var d = b.length; a < d; a++) if (b[a].specified) return 0;
							return 1
						}
					}
					return !a.attributes.length
				}
				var f = new RegExp("^(?:" + (a || this.options.removeFormatTags).replace(/,/g, "|") + ")$", "i"),
					l = e ? [] : (d || this.options.removeFormatAttributes).split(",");
				c = new E.Range(this.document);
				var k, n, m = function(a) {
						return 1 == a.nodeType
					};
				c = this.selection.getRange();
				(function(a) {
					var d = a.createBookmark();
					a.collapsed && a.enlarge(!0);
					if (!b) {
						var c = g.findParentByTagName(a.startContainer, "a", !0);
						c && a.setStartBefore(c);
						(c = g.findParentByTagName(a.endContainer, "a", !0)) && a.setEndAfter(c)
					}
					k = a.createBookmark();
					for (c = k.start;
					(n = c.parentNode) && !g.isBlockElm(n);) g.breakParent(c, n), g.clearEmptySibling(c);
					if (k.end) {
						for (c = k.end;
						(n = c.parentNode) && !g.isBlockElm(n);) g.breakParent(c, n), g.clearEmptySibling(c);
						for (var c = g.getNextDomNode(k.start, !1, m), r; c && c != k.end;) r = g.getNextDomNode(c, !0, m), y.$empty[c.tagName.toLowerCase()] || g.isBookmarkNode(c) || (f.test(c.tagName) ? e ? (g.removeStyle(c, e), h(c) && "text-decoration" != e && g.remove(c, !0)) : g.remove(c, !0) : y.$tableContent[c.tagName] || y.$list[c.tagName] || (g.removeAttributes(c, l), h(c) && g.remove(c, !0))), c = r
					}
					c = k.start.parentNode;
					!g.isBlockElm(c) || y.$tableContent[c.tagName] || y.$list[c.tagName] || g.removeAttributes(c, l);
					c = k.end.parentNode;
					k.end && g.isBlockElm(c) && !y.$tableContent[c.tagName] && !y.$list[c.tagName] && g.removeAttributes(c, l);
					a.moveToBookmark(k).moveToBookmark(d);
					c = a.startContainer;
					for (r = a.collapsed; 1 == c.nodeType && g.isEmptyNode(c) && y.$removeEmpty[c.tagName];) d = c.parentNode, a.setStartBefore(c), a.startContainer === a.endContainer && a.endOffset--, g.remove(c), c = d;
					if (!r) for (c = a.endContainer; 1 == c.nodeType && g.isEmptyNode(c) && y.$removeEmpty[c.tagName];) d = c.parentNode, a.setEndBefore(c), g.remove(c), c = d
				})(c);
				c.select()
			}
		}
	};


	UE.plugins.blockquote = function() {
		this.commands.blockquote = {
			execCommand: function(c, a) {
				var e = this.selection.getRange(),
					d = g.filterNodeList(this.selection.getStartElementPath(), "blockquote"),
					b = y.blockquote,
					h = e.createBookmark();
				if (d) {
					var b = e.startContainer,
						b = g.isBlockElm(b) ? b : g.findParent(b, function(a) {
							return g.isBlockElm(a)
						}),
						f = e.endContainer,
						f = g.isBlockElm(f) ? f : g.findParent(f, function(a) {
							return g.isBlockElm(a)
						}),
						b = g.findParentByTagName(b, "li", !0) || b,
						f = g.findParentByTagName(f, "li", !0) || f;
					"LI" == b.tagName || "TD" == b.tagName || b === d || g.isBody(b) ? g.remove(d, !0) : g.breakParent(b, d);
					b !== f && (d = g.findParentByTagName(f, "blockquote")) && ("LI" == f.tagName || "TD" == f.tagName || g.isBody(f) ? d.parentNode && g.remove(d, !0) : g.breakParent(f, d));
					for (var l = g.getElementsByTagName(this.document, "blockquote"), d = 0, k; k = l[d++];) k.childNodes.length ? g.getPosition(k, b) & g.POSITION_FOLLOWING && g.getPosition(k, f) & g.POSITION_PRECEDING && g.remove(k, !0) : g.remove(k)
				} else {
					d = e.cloneRange();
					l = f = 1 == d.startContainer.nodeType ? d.startContainer : d.startContainer.parentNode;
					for (k = 1;;) {
						if (g.isBody(f)) {
							l !== f ? e.collapsed ? (d.selectNode(l), k = 0) : d.setStartBefore(l) : d.setStart(f, 0);
							break
						}
						if (!b[f.tagName]) {
							e.collapsed ? d.selectNode(l) : d.setStartBefore(l);
							break
						}
						l = f;
						f = f.parentNode
					}
					if (k)
						for (l = f = f = 1 == d.endContainer.nodeType ? d.endContainer : d.endContainer.parentNode;;) {
							if (g.isBody(f)) {
								l !== f ? d.setEndAfter(l) : d.setEnd(f, f.childNodes.length);
								break
							}
							if (!b[f.tagName]) {
								d.setEndAfter(l);
								break
							}
							l = f;
							f = f.parentNode
						}
					f = e.document.createElement("blockquote");
					g.setAttributes(f, a);
					f.appendChild(d.extractContents());
					d.insertNode(f);
					b = g.getElementsByTagName(f, "blockquote");
					for (d = 0; f = b[d++];) f.parentNode && g.remove(f, !0)
				}
				e.moveToBookmark(h).select()
			},
			queryCommandState: function() {
				return g.filterNodeList(this.selection.getStartElementPath(), "blockquote") ? 1 : 0
			}
		}
	};
	UE.commands.touppercase = UE.commands.tolowercase = {
		execCommand: function(c) {
			var a = this.selection.getRange();
			if (a.collapsed) return a;
			for (var e = a.createBookmark(), d = e.end, b = function(a) {
					return !g.isBr(a) && !g.isWhitespace(a)
				}, h = g.getNextDomNode(e.start, !1, b); h && g.getPosition(h, d) & g.POSITION_PRECEDING && (3 == h.nodeType && (h.nodeValue = h.nodeValue["touppercase" == c ? "toUpperCase" : "toLowerCase"]()), h = g.getNextDomNode(h, !0, b), h !== d););
			a.moveToBookmark(e).select()
		}
	};
	UE.commands.indent = {
		execCommand: function() {
			var c = this.queryCommandState("indent") ? "0em" : this.options.indentValue || "2em";
			this.execCommand("Paragraph", "p", {
				style: "text-indent:" + c
			})
		},
		queryCommandState: function() {
			var c = g.filterNodeList(this.selection.getStartElementPath(), "p h1 h2 h3 h4 h5 h6");
			return c && c.style.textIndent && parseInt(c.style.textIndent) ? 1 : 0
		}
	};
	UE.commands.print = {
		execCommand: function() {
			this.window.print()
		},
		notNeedUndo: 1
	};
	UE.commands.preview = {
		execCommand: function() {
			var c = window.open("", "_blank", "").document;
			c.open();
			c.write('<!DOCTYPE html><html><head><meta charset="utf-8"/><script src="' + this.options.UEDITOR_HOME_URL + "ueditor.parse.js\"></script><script>setTimeout(function(){uParse('div',{rootPath: '" + this.options.UEDITOR_HOME_URL + "'})},300)</script></head><body><div>" + this.getContent(null, null, !0) + "</div></body></html>");
			c.close()
		},
		notNeedUndo: 1
	};
	UE.plugins.selectall = function() {
		this.commands.selectall = {
			execCommand: function() {
				var c = this.body,
					a = this.selection.getRange();
				a.selectNodeContents(c);
				g.isEmptyBlock(c) && (t.opera && c.firstChild && 1 == c.firstChild.nodeType && a.setStartAtFirst(c.firstChild), a.collapse(!0));
				a.select(!0)
			},
			notNeedUndo: 1
		};
		this.addshortcutkey({
			selectAll: "ctrl+65"
		})
	};
	UE.plugins.paragraph = function() {
		var c = g.isBlockElm,
			a = ["TD", "LI", "PRE"],
			e = function(d, b, e, f) {
				var h = d.createBookmark(),
					k = function(a) {
						return 1 == a.nodeType ? "br" != a.tagName.toLowerCase() && !g.isBookmarkNode(a) : !g.isWhitespace(a)
					},
					n;
				d.enlarge(!0);
				var m = d.createBookmark();
				n = g.getNextDomNode(m.start, !1, k);
				for (var r = d.cloneRange(), v; n && !(g.getPosition(n, m.end) & g.POSITION_FOLLOWING);)
					if (3 != n.nodeType && c(n)) n = g.getNextDomNode(n, !0, k);
					else {
						for (r.setStartBefore(n); n && n !== m.end && !c(n);) v = n, n = g.getNextDomNode(n, !1, null, function(a) {
							return !c(a)
						});
						r.setEndAfter(v);
						n = d.document.createElement(b);
						e && (g.setAttributes(n, e), f && "customstyle" == f && e.style && (n.style.cssText = e.style));
						n.appendChild(r.extractContents());
						g.isEmptyNode(n) && g.fillChar(d.document, n);
						r.insertNode(n);
						var u = n.parentNode;
						c(u) && !g.isBody(n.parentNode) && -1 == p.indexOf(a, u.tagName) && (f && "customstyle" == f || (u.getAttribute("dir") && n.setAttribute("dir", u.getAttribute("dir")), u.style.cssText && (n.style.cssText = u.style.cssText + ";" + n.style.cssText), u.style.textAlign && !n.style.textAlign && (n.style.textAlign = u.style.textAlign), u.style.textIndent && !n.style.textIndent && (n.style.textIndent = u.style.textIndent), u.style.padding && !n.style.padding && (n.style.padding = u.style.padding)), e && /h\d/i.test(u.tagName) && !/h\d/i.test(n.tagName) ? (g.setAttributes(u, e), f && "customstyle" == f && e.style && (u.style.cssText = e.style), g.remove(n.parentNode, !0), n = u) : g.remove(n.parentNode, !0));
						n = -1 != p.indexOf(a, u.tagName) ? u : n;
						n = g.getNextDomNode(n, !1, k)
					}
				return d.moveToBookmark(m).moveToBookmark(h)
			};
		this.setOpt("paragraph", {
			p: "",
			h1: "",
			h2: "",
			h3: "",
			h4: "",
			h5: "",
			h6: ""
		});
		this.commands.paragraph = {
			execCommand: function(a, b, c, f) {
				a = this.selection.getRange();
				if (a.collapsed) {
					var d = this.document.createTextNode("p");
					a.insertNode(d);
					if (t.ie) {
						var k = d.previousSibling;
						k && g.isWhitespace(k) && g.remove(k);
						(k = d.nextSibling) && g.isWhitespace(k) && g.remove(k)
					}
				}
				a = e(a, b, c, f);
				d && (a.setStartBefore(d).collapse(!0), pN = d.parentNode, g.remove(d), g.isBlockElm(pN) && g.isEmptyNode(pN) && g.fillNode(this.document, pN));
				t.gecko && a.collapsed && 1 == a.startContainer.nodeType && (c = a.startContainer.childNodes[a.startOffset]) && 1 == c.nodeType && c.tagName.toLowerCase() == b && a.setStart(c, 0).collapse(!0);
				a.select();
				return !0
			},
			queryCommandValue: function() {
				var a = g.filterNodeList(this.selection.getStartElementPath(), "p h1 h2 h3 h4 h5 h6");
				return a ? a.tagName.toLowerCase() : ""
			}
		}
	};
	(function() {
		var c = g.isBlockElm,
			a = function(a) {
				return g.filterNodeList(a.selection.getStartElementPath(), function(a) {
					return a && 1 == a.nodeType && a.getAttribute("dir")
				})
			},
			e = function(d, b, e) {
				var f = function(a) {
					return 1 == a.nodeType ? !g.isBookmarkNode(a) : !g.isWhitespace(a)
				};
				if ((b = a(b)) && d.collapsed) return b.setAttribute("dir", e), d;
				b = d.createBookmark();
				d.enlarge(!0);
				for (var h = d.createBookmark(), k = g.getNextDomNode(h.start, !1, f), n = d.cloneRange(), m; k && !(g.getPosition(k, h.end) & g.POSITION_FOLLOWING);)
					if (3 != k.nodeType && c(k)) k = g.getNextDomNode(k, !0, f);
					else {
						for (n.setStartBefore(k); k && k !== h.end && !c(k);) m = k, k = g.getNextDomNode(k, !1, null, function(a) {
							return !c(a)
						});
						n.setEndAfter(m);
						k = n.getCommonAncestor();
						if (!g.isBody(k) && c(k)) k.setAttribute("dir", e);
						else {
							k = d.document.createElement("p");
							k.setAttribute("dir", e);
							var r = n.extractContents();
							k.appendChild(r);
							n.insertNode(k)
						}
						k = g.getNextDomNode(k, !1, f)
					}
				return d.moveToBookmark(h).moveToBookmark(b)
			};
		UE.commands.directionality = {
			execCommand: function(a, b) {
				var d = this.selection.getRange();
				if (d.collapsed) {
					var f = this.document.createTextNode("d");
					d.insertNode(f)
				}
				e(d, this, b);
				f && (d.setStartBefore(f).collapse(!0), g.remove(f));
				d.select();
				return !0
			},
			queryCommandValue: function() {
				var d = a(this);
				return d ? d.getAttribute("dir") : "ltr"
			}
		}
	})();
	UE.plugins.horizontal = function() {
		this.commands.horizontal = {
			execCommand: function(c) {
				if (-1 !== this.queryCommandState(c)) {
					this.execCommand("insertHtml", "<hr>");
					c = this.selection.getRange();
					var a = c.startContainer;
					if (1 == a.nodeType && !a.childNodes[c.startOffset]) {
						var e;
						(e = a.childNodes[c.startOffset - 1]) && 1 == e.nodeType && "HR" == e.tagName && ("p" == this.options.enterTag ? (e = this.document.createElement("p"), c.insertNode(e), c.setStart(e, 0).setCursor()) : (e = this.document.createElement("br"), c.insertNode(e), c.setStartBefore(e).setCursor()))
					}
					return !0
				}
			},
			queryCommandState: function() {
				return g.filterNodeList(this.selection.getStartElementPath(), "table") ? -1 : 0
			}
		};
		this.addListener("delkeydown", function(c, a) {
			var e = this.selection.getRange();
			e.txtToElmBoundary(!0);
			if (g.isStartInblock(e)) {
				var d = e.startContainer.previousSibling;
				if (d && g.isTagNode(d, "hr")) return g.remove(d), e.select(), g.preventDefault(a), !0
			}
		})
	};
	UE.plugins.rowspacing = function() {
		this.setOpt({
			rowspacingtop: ["5", "10", "15", "20", "25"],
			rowspacingbottom: ["5", "10", "15", "20", "25"]
		});
		this.commands.rowspacing = {
			execCommand: function(c, a, e) {
				this.execCommand("paragraph", "p", {
					style: "margin-" + e + ":" + a + "px"
				});
				return !0
			},
			queryCommandValue: function(c, a) {
				var e = g.filterNodeList(this.selection.getStartElementPath(), function(a) {
					return g.isBlockElm(a)
				});
				return e ? (e = g.getComputedStyle(e, "margin-" + a).replace(/[^\d]/g, "")) ? e : 0 : 0
			}
		}
	};
	UE.plugins.lineheight = function() {
		this.setOpt({
			lineheight: "1 1.5 1.75 2 3 4 5".split(" ")
		});
		this.commands.lineheight = {
			execCommand: function(c, a) {
				this.execCommand("paragraph", "p", {
					style: "line-height:" + ("1" == a ? "normal" : a + "em")
				});
				return !0
			},
			queryCommandValue: function() {
				var c = g.filterNodeList(this.selection.getStartElementPath(), function(a) {
					return g.isBlockElm(a)
				});
				if (c) {
					var a = g.getComputedStyle(c, "line-height");
					if (0 < a.indexOf("px")) {
						c = g.getComputedStyle(c, "font-size");
						if (0 < c.indexOf("px")) return c == a ? 1 : a = Math.round(100 * parseInt(a) / parseInt(c)) / 100;
						if (0 < c.indexOf("em")) return a = Math.round(100 * parseInt(a) / (16 * parseInt(c))) / 100
					}
					return "normal" == a ? 1 : a.replace(/[^\d.]*/ig, "")
				}
			}
		}
	};
	UE.plugins.letterspacing = function() {
		this.setOpt({
			letterspacing: "2 3 4 5".split(" ")
		});
		this.commands.letterspacing = {
			execCommand: function(c, a) {
				this.execCommand("paragraph", "p", {
					style: "letter-spacing:" + a + "px"
				});
				return !0
			},
			queryCommandValue: function() {
				var c = g.filterNodeList(this.selection.getStartElementPath(), function(a) {
					return g.isBlockElm(a)
				});
				if (c) return g.getComputedStyle(c, "letter-spacing").replace(/[^\d.]*/ig, "")
			}
		}
	};
	UE.plugins.outpadding = function() {
		var c = this;
		c.setOpt({
			outpadding: "0 5 10 15 20 25 30 35 40 45 50".split(" ")
		});
		c.commands.outpadding = {
			execCommand: function(a, e, d) {
				c.undoManger.save();
				c.selection.getRange();
				if ("" != getSelectionHtml()) return c.execCommand("paragraph", "p", {
					style: "margin-left:" + e + "px;margin-right:" + e + "px"
				}, "outpadding"), !0;
				if (1 == d) {
					var b = c.currentActive135Item();
					b && (c.undoManger.save(), b.css("padding", "0 " + e + "px"))
				} else if (a = "", d = c.getContent(), d = jQuery("<div>" + d + " </div>"), 1 == d.find("> *").length && d.find("> *:first").hasClass("article135")) $(c.document).find(".article135:first").css("padding", "0 " + e + "px");
				else {
					if (0 < d.find(".article135").size()) {
						var h = d.find(".article135:first").eq(0).style;
						for (b in h) "padding" != b && (a += b + ":" + h[b] + ";");
						d.find(".article135").each(function() {
							jQuery(this).replaceWith(jQuery(this).html())
						})
					}
					b = jQuery.trim(d.html());
					"" == b && (b = "<p><br/></p>");
					c.setContent('<section class="article135" style="' + (a + ("padding:0 " + e + "px;")) + '">' + b + "</section>")
				}
				c.undoManger.save();
				return !0
			},
			queryCommandValue: function() {
				var a = c.currentActive135Item();
				return a ? (a = a.css("padding-left"), a.replace(/[^\d.]*/ig, "")) : 0 < jQuery(c.document).find(".article135").size() ? (a = jQuery(c.document).find(".article135:first").css("padding-left"), a.replace(/[^\d.]*/ig, "")) : 0
			}
		}
	};
	UE.commands.cleardoc = {
		execCommand: function(c) {
			var a = this;
			c = a.options.enterTag;
			var e = a.selection.getRange();
			"br" == c ? (a.body.innerHTML = "<br/>", e.setStart(a.body, 0).setCursor()) : (a.body.innerHTML = '<section data-role="paragraph" class="_135editor"><p><br/></p></section>', e.setStart(a.body.firstChild.firstChild, 0).setCursor(!1, !0));
			setTimeout(function() {
				a.fireEvent("clearDoc")
			}, 0)
		}
	};
	UE.plugins.wordcount = function() {
		var c = this;
		c.setOpt("wordCount", !0);
		c.addListener("contentchange", function() {
			c.fireEvent("wordcount")
		});
		var a;
		c.addListener("ready", function() {
			var e = this;
			g.on(e.body, "keyup", function(d) {
				(d.keyCode || d.which) in {
					16: 1,
					18: 1,
					20: 1,
					37: 1,
					38: 1,
					39: 1,
					40: 1
				} || (clearTimeout(a), a = setTimeout(function() {
					e.fireEvent("wordcount")
				}, 200))
			})
		})
	};
	UE.plugins.pagebreak = function() {
		function c(a) {
			if (g.isEmptyBlock(a)) {
				for (var b = a.firstChild, d; b && 1 == b.nodeType && g.isEmptyBlock(b);) d = b, b = b.firstChild;
				!d && (d = a);
				g.fillNode(e.document, d)
			}
		}

		function a(a) {
			return a && 1 == a.nodeType && "HR" == a.tagName && "pagebreak" == a.className
		}
		var e = this,
			d = ["td"];
		e.setOpt("pageBreakTag", "_ueditor_page_break_tag_");
		e.ready(function() {
			p.cssRule("pagebreak", ".pagebreak{display:block;clear:both !important;cursor:default !important;width: 100% !important;margin:0;}", e.document)
		});
		e.addInputRule(function(a) {
			a.traversal(function(a) {
				if ("text" == a.type && a.data == e.options.pageBreakTag) {
					var b = UE.uNode.createElement('<hr class="pagebreak" noshade="noshade" size="5" style="-webkit-user-select: none;">');
					a.parentNode.insertBefore(b, a);
					a.parentNode.removeChild(a)
				}
			})
		});
		e.addOutputRule(function(a) {
			p.each(a.getNodesByTagName("hr"), function(a) {
				if ("pagebreak" == a.getAttr("class")) {
					var b = UE.uNode.createText(e.options.pageBreakTag);
					a.parentNode.insertBefore(b, a);
					a.parentNode.removeChild(a)
				}
			})
		});
		e.commands.pagebreak = {
			execCommand: function() {
				var b = e.selection.getRange(),
					h = e.document.createElement("hr");
				g.setAttributes(h, {
					"class": "pagebreak",
					noshade: "noshade",
					size: "5"
				});
				g.unSelectable(h);
				var f = g.findParentByTagName(b.startContainer, d, !0);
				if (f) switch (f.tagName) {
					case "TD":
						f = f.parentNode, f.previousSibling ? (f.parentNode.insertBefore(h, f), b = g.findParents(h)) : (b = g.findParentByTagName(f, "table"), b.parentNode.insertBefore(h, b), b = g.findParents(h, !0)), f = b[1], h !== f && g.breakParent(h, f), e.fireEvent("afteradjusttable", e.document)
				} else {
					if (!b.collapsed)
						for (b.deleteContents(), f = b.startContainer; !g.isBody(f) && g.isBlockElm(f) && g.isEmptyNode(f);) b.setStartBefore(f).collapse(!0), g.remove(f), f = b.startContainer;
					b.insertNode(h);
					for (f = h.parentNode; !g.isBody(f);) g.breakParent(h, f), (f = h.nextSibling) && g.isEmptyBlock(f) && g.remove(f), f = h.parentNode;
					var f = h.nextSibling,
						l = h.previousSibling;
					a(l) ? g.remove(l) : l && c(l);
					f ? (a(f) ? g.remove(f) : c(f), b.setEndAfter(h).collapse(!1)) : (f = e.document.createElement("p"), h.parentNode.appendChild(f), g.fillNode(e.document, f), b.setStart(f, 0).collapse(!0));
					b.select(!0)
				}
			}
		}
	};
	UE.plugin.register("wordimage", function() {
		var c = this,
			a = [];
		return {
			commands: {
				wordimage: {
					execCommand: function() {
						for (var a = g.getElementsByTagName(c.body, "img"), d = [], b = 0, h; h = a[b++];)(h = h.getAttribute("word_img")) && d.push(h);
						return d
					},
					queryCommandState: function() {
						a = g.getElementsByTagName(c.body, "img");
						for (var e = 0, d; d = a[e++];)
							if (d.getAttribute("word_img")) return 1;
						return -1
					},
					notNeedUndo: !0
				}
			},
			inputRule: function(a) {
				p.each(a.getNodesByTagName("img"), function(a) {
					var b = a.attrs,
						d = 128 > parseInt(b.width) || 43 > parseInt(b.height),
						f = c.options,
						e = f.UEDITOR_HOME_URL + "themes/default/images/spacer.gif";
					b.src && /^(?:(file:\/+))/.test(b.src) && a.setAttr({
						width: b.width,
						height: b.height,
						alt: b.alt,
						word_img: b.src,
						src: e,
						style: "background:url(" + (d ? f.themePath + f.theme + "/images/word.gif" : f.langPath + f.lang + "/images/localimage.png") + ") no-repeat center center;border:1px solid #ddd"
					})
				})
			}
		}
	});
	UE.plugins.dragdrop = function() {
		var c = this;
		c.ready(function() {
			g.on(this.body, "dragend", function() {
				var a = c.selection.getRange(),
					e = a.getClosedNode() || c.selection.getStart();
				if (e && "IMG" == e.tagName) {
					for (var d = e.previousSibling, b;
						(b = e.nextSibling) && 1 == b.nodeType && "SPAN" == b.tagName && !b.firstChild;) g.remove(b);
					(!d || 1 != d.nodeType || g.isEmptyBlock(d)) && d || b && (!b || g.isEmptyBlock(b)) || (d && "P" == d.tagName && !g.isEmptyBlock(d) ? (d.appendChild(e), g.moveChild(b, d), g.remove(b)) : b && "P" == b.tagName && !g.isEmptyBlock(b) && b.insertBefore(e, b.firstChild), d && "P" == d.tagName && g.isEmptyBlock(d) && g.remove(d), b && "P" == b.tagName && g.isEmptyBlock(b) && g.remove(b), a.selectNode(e).select(), c.fireEvent("saveScene"))
				}
			})
		});
		c.addListener("keyup", function(a, e) {
			if (13 == (e.keyCode || e.which)) {
				var d = c.selection.getRange(),
					b;
				(b = g.findParentByTagName(d.startContainer, "p", !0)) && "center" == g.getComputedStyle(b, "text-align") && g.removeStyle(b, "text-align")
			}
		})
	};
	UE.plugins.undo = function() {
		function c(a, b) {
			if (a.length != b.length) return 0;
			for (var d = 0, f = a.length; d < f; d++)
				if (a[d] != b[d]) return 0;
			return 1
		}
		var a, e = this,
			d = e.options.maxUndoCount || 20,
			b = e.options.maxInputCount || 20,
			h = new RegExp(g.fillChar + "|</hr>", "gi"),
			f = {
				ol: 1,
				ul: 1,
				table: 1,
				tbody: 1,
				tr: 1,
				body: 1
			},
			l = e.options.autoClearEmptyNode;
		e.undoManger = new function() {
			this.list = [];
			this.index = 0;
			this.hasRedo = this.hasUndo = !1;
			this.undo = function() {
				if (this.hasUndo)
					if (this.list[this.index - 1] || 1 != this.list.length) {
						for (; this.list[this.index].content == this.list[this.index - 1].content;)
							if (this.index--, 0 == this.index) return this.restore(0);
						this.restore(--this.index)
					} else this.reset()
			};
			this.redo = function() {
				if (this.hasRedo) {
					for (; this.list[this.index].content == this.list[this.index + 1].content;)
						if (this.index++, this.index == this.list.length - 1) return this.restore(this.index);
					this.restore(++this.index)
				}
			};
			this.restore = function() {
				var a = this.editor,
					b = this.list[this.index],
					d = UE.htmlparser(b.content.replace(h, ""));
				a.options.autoClearEmptyNode = !1;
				a.filterInputRule(d);
				a.options.autoClearEmptyNode = l;
				a.document.body.innerHTML = d.toHtml();
				a.fireEvent("afterscencerestore");
				t.ie && p.each(g.getElementsByTagName(a.document, "td th caption p"), function(b) {
					g.isEmptyNode(b) && g.fillNode(a.document, b)
				});
				try {
					var k = (new E.Range(a.document)).moveToAddress(b.address);
					k.select(f[k.startContainer.nodeName.toLowerCase()])
				} catch (F) {}
				this.update();
				this.clearKey();
				a.fireEvent("reset", !0)
			};
			this.getScene = function() {
				var a = this.editor,
					b = a.selection.getRange().createAddress(!1, !0);
				a.fireEvent("beforegetscene");
				var d = UE.htmlparser(a.body.innerHTML);
				a.options.autoClearEmptyNode = !1;
				a.filterOutputRule(d);
				a.options.autoClearEmptyNode = l;
				d = d.toHtml();
				a.fireEvent("aftergetscene");
				return {
					address: b,
					content: d
				}
			};
			this.save = function(b, f) {
				clearTimeout(a);
				var k = this.getScene(f),
					h = this.list[this.index];
				h && h.content != k.content && e.trigger("contentchange");
				var l;
				if (l = h && h.content == k.content) b ? h = 1 : (h = h.address, l = k.address, h = h.collapsed != l.collapsed ? 0 : c(h.startAddress, l.startAddress) && c(h.endAddress, l.endAddress) ? 1 : 0), l = h;
				l || (this.list = this.list.slice(0, this.index + 1), this.list.push(k), this.list.length > d && this.list.shift(), this.index = this.list.length - 1, this.clearKey(), this.update())
			};
			this.update = function() {
				this.hasRedo = !!this.list[this.index + 1];
				this.hasUndo = !!this.list[this.index - 1]
			};
			this.reset = function() {
				this.list = [];
				this.index = 0;
				this.hasRedo = this.hasUndo = !1;
				this.clearKey()
			};
			this.clearKey = function() {
				n = 0
			}
		};
		e.undoManger.editor = e;
		e.addListener("saveScene", function() {
			var a = Array.prototype.splice.call(arguments, 1);
			this.undoManger.save.apply(this.undoManger, a)
		});
		e.addListener("reset", function(a, b) {
			b || this.undoManger.reset()
		});
		e.commands.redo = e.commands.undo = {
			execCommand: function(a) {
				this.undoManger[a]()
			},
			queryCommandState: function(a) {
				return this.undoManger["has" + ("undo" == a.toLowerCase() ? "Undo" : "Redo")] ? 0 : -1
			},
			notNeedUndo: 1
		};
		var k = {
				16: 1,
				17: 1,
				18: 1,
				37: 1,
				38: 1,
				39: 1,
				40: 1
			},
			n = 0,
			m = !1;
		e.addListener("ready", function() {
			g.on(this.body, "compositionstart", function() {
				m = !0
			});
			g.on(this.body, "compositionend", function() {
				m = !1
			})
		});
		e.addshortcutkey({
			Undo: "ctrl+90",
			Redo: "ctrl+89"
		});
		var r = !0;
		e.addListener("keydown", function(d, f) {
			var e = this;
			if (!(k[f.keyCode || f.which] || f.ctrlKey || f.metaKey || f.shiftKey || f.altKey)) {
				var c = function(a) {
					a.undoManger.save(!1, !0);
					a.fireEvent("selectionchange")
				};
				m || (e.selection.getRange().collapsed ? (0 == e.undoManger.list.length && e.undoManger.save(!0), clearTimeout(a), a = setTimeout(function() {
					if (m) var a = setInterval(function() {
						m || (c(e), clearInterval(a))
					}, 300);
					else c(e)
				}, 200), n++, n >= b && c(e)) : (e.undoManger.save(!1, !0), r = !1))
			}
		});
		e.addListener("keyup", function(a, b) {
			k[b.keyCode || b.which] || b.ctrlKey || b.metaKey || b.shiftKey || b.altKey || m || r || (this.undoManger.save(!1, !0), r = !0)
		});
		e.stopCmdUndo = function() {
			e.__hasEnterExecCommand = !0
		};
		e.startCmdUndo = function() {
			e.__hasEnterExecCommand = !1
		}
	};
	UE.plugin.register("copy", function() {
		function c() {
			ZeroClipboard.config({
				debug: !1,
				swfPath: a.options.UEDITOR_HOME_URL + "third-party/zeroclipboard/ZeroClipboard.swf"
			});
			var e = a.zeroclipboard = new ZeroClipboard;
			e.on("copy", function(d) {
				d = d.client;
				var b = a.selection.getRange(),
					e = document.createElement("div");
				e.appendChild(b.cloneContents());
				d.setText(e.innerText || e.textContent);
				d.setHtml(e.innerHTML);
				console.log(e.innerHTML);
				b.select()
			});
			e.on("mouseover mouseout", function(a) {
				var b = a.target;
				b && ("mouseover" == a.type ? g.addClass(b, "edui-state-hover") : "mouseout" == a.type && g.removeClasses(b, "edui-state-hover"))
			});
			e.on("wrongflash noflash", function() {
				ZeroClipboard.destroy()
			});
			a.fireEvent("zeroclipboardready", e)
		}
		var a = this;
		return {
			bindEvents: {
				ready: function() {
					t.ie || (window.ZeroClipboard ? c() : p.loadFile(document, {
						src: a.options.UEDITOR_HOME_URL + "third-party/zeroclipboard/ZeroClipboard.js",
						tag: "script",
						type: "text/javascript",
						defer: "defer"
					}, function() {
						c()
					}))
				}
			},
			commands: {
				copy: {
					execCommand: function(e) {
						a.document.execCommand("copy") || alert(a.getLang("copymsg"))
					}
				}
			}
		}
	});
	UE.plugins.paste = function() {
		function c(a) {
			var b = this.document;
			if (!b.getElementById("baidu_pastebin")) {
				var d = this.selection.getRange(),
					f = d.createBookmark(),
					e = b.createElement("div");
				e.id = "baidu_pastebin";
				t.webkit && e.appendChild(b.createTextNode(g.fillChar + g.fillChar));
				b.body.appendChild(e);
				f.start.style.display = "";
				e.style.cssText = "position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:" + g.getXY(f.start).y + "px";
				d.selectNodeContents(e).select(!0);
				setTimeout(function() {
					if (t.webkit)
						for (var k = 0, c = b.querySelectorAll("#baidu_pastebin"), h; h = c[k++];)
							if (g.isEmptyNode(h)) g.remove(h);
							else {
								e = h;
								break
							}
					try {
						e.parentNode.removeChild(e)
					} catch (w) {}
					d.moveToBookmark(f).select(!0);
					a(e)
				}, 0)
			}
		}

		function a(a) {
			return a.replace(/<(\/?)([\w\-]+)([^>]*)>/gi, function(a, b, d, f) {
				d = d.toLowerCase();
				if ({
						img: 1
					}[d]) return a;
				f = f.replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi, function(a, b, d) {
					return {
						src: 1,
						href: 1,
						name: 1
					}[b.toLowerCase()] ? b + "=" + d + " ": ""
				});
				return {
					span: 1,
					div: 1
				}[d] ? "" : "<" + b + d + " " + p.trim(f) + ">"
			})
		}

		function e(e) {
			var k;
			if (e.firstChild) {
				var c = g.getElementsByTagName(e, "span");
				k = 0;
				for (var l; l = c[k++];) "_baidu_cut_start" != l.id && "_baidu_cut_end" != l.id || g.remove(l);
				if (t.webkit) {
					l = e.querySelectorAll("div br");
					for (k = 0; c = l[k++];) c = c.parentNode, "DIV" == c.tagName && 1 == c.childNodes.length && (c.innerHTML = "<p><br/></p>", g.remove(c));
					c = e.querySelectorAll("#baidu_pastebin");
					for (k = 0; l = c[k++];) {
						var r = d.document.createElement("p");
						for (l.parentNode.insertBefore(r, l); l.firstChild;) r.appendChild(l.firstChild);
						g.remove(l)
					}
					l = e.querySelectorAll("meta");
					for (k = 0; c = l[k++];) g.remove(c);
					l = e.querySelectorAll("br");
					for (k = 0; c = l[k++];) / ^ apple - /i.test(c.className) && g.remove(c)
				}
				if (t.gecko)
					for (l = e.querySelectorAll("[_moz_dirty]"),
						k = 0; c = l[k++];) c.removeAttribute("_moz_dirty");
				if (!t.ie)
					for (l = e.querySelectorAll("span.Apple-style-span"), k = 0; c = l[k++];) g.remove(c, !0);
				k = e.innerHTML;
				k = UE.filterWord(k);
				e = UE.htmlparser(k);
				d.options.filterRules && UE.filterNode(e, d.options.filterRules);
				d.filterInputRule(e);
				t.webkit && ((k = e.lastChild()) && "element" == k.type && "br" == k.tagName && e.removeChild(k), p.each(d.body.querySelectorAll("div"), function(a) {
					g.isEmptyBlock(a) && g.remove(a, !0)
				}));
				k = {
					html: e.toHtml()
				};
				d.fireEvent("beforepaste", k, e);
				k.html && (e =
					UE.htmlparser(k.html, !0), 1 === d.queryCommandState("pasteplain") ? d.execCommand("insertHtml", UE.filterNode(e, d.options.filterTxtRules).toHtml(), !0) : (UE.filterNode(e, d.options.filterTxtRules), b = e.toHtml(), h = k.html, f = d.selection.getRange().createAddress(!0), d.execCommand("insertHtml", !0 === d.getOpt("retainOnlyLabelPasted") ? a(h) : h, !0)), d.fireEvent("afterpaste", k))
			}
		}
		var d = this;
		d.setOpt({
			retainOnlyLabelPasted: !1
		});
		var b, h, f;
		d.addListener("pasteTransfer", function(e, k) {
			if (f && b && h && b != h) {
				var c = d.selection.getRange();
				c.moveToAddress(f, !0);
				if (!c.collapsed) {
					for (; !g.isBody(c.startContainer);) {
						var l = c.startContainer;
						if (1 == l.nodeType) {
							l = l.childNodes[c.startOffset];
							if (!l) {
								c.setStartBefore(c.startContainer);
								continue
							}(l = l.previousSibling) && 3 == l.nodeType && (new RegExp("^[\n\r\t " + g.fillChar + "]*$")).test(l.nodeValue) && c.setStartBefore(l)
						}
						if (0 == c.startOffset) c.setStartBefore(c.startContainer);
						else break
					}
					for (; !g.isBody(c.endContainer);) {
						l = c.endContainer;
						if (1 == l.nodeType) {
							l = l.childNodes[c.endOffset];
							if (!l) {
								c.setEndAfter(c.endContainer);
								continue
							}(l = l.nextSibling) && 3 == l.nodeType && (new RegExp("^[\n\r\t" + g.fillChar + "]*$")).test(l.nodeValue) && c.setEndAfter(l)
						}
						if (c.endOffset == c.endContainer[3 == c.endContainer.nodeType ? "nodeValue" : "childNodes"].length) c.setEndAfter(c.endContainer);
						else break
					}
				}
				c.deleteContents();
				c.select(!0);
				d.__hasEnterExecCommand = !0;
				c = h;
				2 === k ? c = a(c) : k && (c = b);
				d.execCommand("inserthtml", c, !0);
				d.__hasEnterExecCommand = !1;
				for (c = d.selection.getRange(); !g.isBody(c.startContainer) && !c.startOffset && c.startContainer[3 == c.startContainer.nodeType ?
						"nodeValue" : "childNodes"].length;) c.setStartBefore(c.startContainer);
				c = c.createAddress(!0);
				f.endAddress = c.startAddress
			}
		});
		d.addListener("ready", function() {
			g.on(d.body, "cut", function() {
				!d.selection.getRange().collapsed && d.undoManger && d.undoManger.save()
			});
			g.on(d.body, t.ie || t.opera ? "keydown" : "paste", function(a) {
				(!t.ie && !t.opera || (a.ctrlKey || a.metaKey) && "86" == a.keyCode) && c.call(d, function(a) {
					e(a)
				})
			})
		});
		d.commands.paste = {
			execCommand: function(a) {

				t.ie ? (c.call(d, function(a) {
						e(a)
					}), d.document.execCommand("paste")) :
					alert(d.getLang("pastemsg"))
			}
		}
	};
	UE.plugins.pasteplain = function() {
		this.setOpt({
			pasteplain: !1,
			filterTxtRules: function() {
				function a(a) {
					a.tagName = "p";
					a.setStyle()
				}

				function e(a) {
					a.parentNode.removeChild(a, !0)
				}
				return {
					"-": "script style object iframe embed input select",
					p: {
						$: {}
					},
					br: {
						$: {}
					},
					div: function(a) {
						for (var b, d = UE.uNode.createElement("p"); b = a.firstChild();) "text" != b.type && UE.dom.dtd.$block[b.tagName] ? d.firstChild() ? (a.parentNode.insertBefore(d, a), d = UE.uNode.createElement("p")) : a.parentNode.insertBefore(b,
							a) : d.appendChild(b);
						d.firstChild() && a.parentNode.insertBefore(d, a);
						a.parentNode.removeChild(a)
					},
					ol: e,
					ul: e,
					dl: e,
					dt: e,
					dd: e,
					li: e,
					caption: a,
					th: a,
					tr: a,
					h1: a,
					h2: a,
					h3: a,
					h4: a,
					h5: a,
					h6: a,
					td: function(a) {
						a.innerText() && a.parentNode.insertAfter(UE.uNode.createText(" &nbsp; &nbsp;"), a);
						a.parentNode.removeChild(a, a.innerText())
					}
				}
			}()
		});
		var c = this.options.pasteplain;
		this.commands.pasteplain = {
			queryCommandState: function() {
				return c ? 1 : 0
			},
			execCommand: function() {
				c = !c | 0
			},
			notNeedUndo: 1
		}
	};
	UE.plugins.list = function() {
		function c(a) {
			var b =
				[],
				d;
			for (d in a) b.push(d);
			return b
		}

		function a(a) {
			var b = a.className;
			return g.hasClass(a, /custom_ /) ? b.match(/custom_(\w+)/)[1] : g.getStyle(a, "list-style-type")
		}

		function e(f, e) {
			p.each(g.getElementsByTagName(f, "ol ul"), function(c) {
				if (g.inDoc(c, f)) {
					var k = c.parentNode;
					if (k.tagName == c.tagName) {
						var h = a(c) || ("OL" == c.tagName ? "decimal" : "disc"),
							l = a(k) || ("OL" == k.tagName ? "decimal" : "disc");
						h == l && (h = p.indexOf(m[c.tagName], h), h = h + 1 == m[c.tagName].length ? 0 : h + 1, b(c, m[c.tagName][h]))
					}
					var r = 0,
						h = 2;
					g.hasClass(c, /custom_/) ? /[ou]l/i.test(k.tagName) && g.hasClass(k, /custom_/) || (h = 1) : /[ou]l/i.test(k.tagName) && g.hasClass(k, /custom_/) && (h = 3);
					(k = g.getStyle(c, "list-style-type")) && (c.style.cssText = "list-style-type:" + k);
					c.className = p.trim(c.className.replace(/list-paddingleft-\w+/, "")) + " list-paddingleft-" + h;
					p.each(g.getElementsByTagName(c, "li"), function(b) {
						b.style.cssText && (b.style.cssText = "");
						if (!b.firstChild) g.remove(b);
						else if (b.parentNode === c) {
							r++;
							if (g.hasClass(c, /custom_/)) {
								var d = 1,
									f = a(c);
								if ("OL" == c.tagName) {
									if (f) switch (f) {
										case "cn":
										case "cn1":
										case "cn2":
											10 < r && (0 == r % 10 || 10 < r && 20 > r) ? d = 2 : 20 < r && (d = 3);
											break;
										case "num2":
											9 < r && (d = 2)
									}
									b.className = "list-" + n[f] + r + " list-" + f + "-paddingleft-" + d
								} else b.className = "list-" + n[f] + " list-" + f + "-paddingleft"
							} else b.className = b.className.replace(/list-[\w\-]+/gi, "");
							d = b.getAttribute("class");
							null === d || d.replace(/\s/g, "") || g.removeAttributes(b, "class")
						}
					});
					!e && d(c, c.tagName.toLowerCase(), a(c) || g.getStyle(c, "list-style-type"), !0)
				}
			})
		}

		function d(b, d, f, c) {
			var k = b.nextSibling;
			k && 1 == k.nodeType && k.tagName.toLowerCase() == d && (a(k) || g.getStyle(k, "list-style-type") || ("ol" == d ? "decimal" : "disc")) == f && (g.moveChild(k, b), 0 == k.childNodes.length && g.remove(k));
			k && g.isFillChar(k) && g.remove(k);
			(k = b.previousSibling) && 1 == k.nodeType && k.tagName.toLowerCase() == d && (a(k) || g.getStyle(k, "list-style-type") || ("ol" == d ? "decimal" : "disc")) == f && g.moveChild(b, k);
			k && g.isFillChar(k) && g.remove(k);
			!c && g.isEmptyBlock(b) && g.remove(b);
			a(b) && e(b.ownerDocument, !0)
		}

		function b(a, b) {
			n[b] && (a.className = "custom_" + b);
			try {
				g.setStyle(a, "list-style-type", b)
			} catch (w) {}
		}

		function h(a) {
			var b = a.previousSibling;
			b && g.isEmptyBlock(b) && g.remove(b);
			(b = a.nextSibling) && g.isEmptyBlock(b) && g.remove(b)
		}

		function f(a) {
			for (; a && !g.isBody(a);) {
				if ("TABLE" == a.nodeName) return null;
				if ("LI" == a.nodeName) return a;
				a = a.parentNode
			}
		}
		var l = this,
			k = {
				TD: 1,
				PRE: 1,
				BLOCKQUOTE: 1
			},
			n = {
				cn: "cn-1-",
				cn1: "cn-2-",
				cn2: "cn-3-",
				num: "num-1-",
				num1: "num-2-",
				num2: "num-3-",
				dash: "dash",
				dot: "dot"
			};
		l.setOpt({
			autoTransWordToList: !1,
			insertorderedlist: {
				num: "",
				num1: "",
				num2: "",
				cn: "",
				cn1: "",
				cn2: "",
				decimal: "",
				"lower-alpha": "",
				"lower-roman": "",
				"upper-alpha": "",
				"upper-roman": ""
			},
			insertunorderedlist: {
				circle: "",
				disc: "",
				square: "",
				dash: "",
				dot: ""
			},
			listDefaultPaddingLeft: "30",
			listiconpath: "http://bs.baidu.com/listicon/",
			maxListLevel: -1,
			disablePInList: !1
		});
		var m = {
				OL: c(l.options.insertorderedlist),
				UL: c(l.options.insertunorderedlist)
			},
			r = l.options.listiconpath,
			v;
		for (v in n) l.options.insertorderedlist.hasOwnProperty(v) || l.options.insertunorderedlist.hasOwnProperty(v) || delete n[v];
		l.ready(function() {
			var a = [],
				b;
			for (b in n) {
				if ("dash" == b || "dot" == b) a.push("li.list-" + n[b] + "{background-image:url(" + r + n[b] + ".gif)}"), a.push("ul.custom_" + b + "{list-style:none;}ul.custom_" + b + " li{background-position:0 3px;background-repeat:no-repeat}");
				else {
					for (var d = 0; 99 > d; d++) a.push("li.list-" + n[b] + d + "{background-image:url(" + r + "list-" + n[b] + d + ".gif)}");
					a.push("ol.custom_" + b + "{list-style:none;}ol.custom_" + b + " li{background-position:0 3px;background-repeat:no-repeat}")
				}
				switch (b) {
					case "cn":
						a.push("li.list-" + b + "-paddingleft-1{padding-left:25px}");
						a.push("li.list-" + b + "-paddingleft-2{padding-left:40px}");
						a.push("li.list-" + b + "-paddingleft-3{padding-left:55px}");
						break;
					case "cn1":
						a.push("li.list-" + b + "-paddingleft-1{padding-left:30px}");
						a.push("li.list-" + b + "-paddingleft-2{padding-left:40px}");
						a.push("li.list-" + b + "-paddingleft-3{padding-left:55px}");
						break;
					case "cn2":
						a.push("li.list-" + b + "-paddingleft-1{padding-left:40px}");
						a.push("li.list-" + b + "-paddingleft-2{padding-left:55px}");
						a.push("li.list-" + b + "-paddingleft-3{padding-left:68px}");
						break;
					case "num":
					case "num1":
						a.push("li.list-" + b + "-paddingleft-1{padding-left:25px}");
						break;
					case "num2":
						a.push("li.list-" + b + "-paddingleft-1{padding-left:35px}");
						a.push("li.list-" + b + "-paddingleft-2{padding-left:40px}");
						break;
					case "dash":
						a.push("li.list-" + b + "-paddingleft{padding-left:35px}");
						break;
					case "dot":
						a.push("li.list-" + b + "-paddingleft{padding-left:20px}")
				}
			}
			a.push(".list-paddingleft-1{padding-left:0}");
			a.push(".list-paddingleft-2{padding-left:" + l.options.listDefaultPaddingLeft + "px}");
			a.push(".list-paddingleft-3{padding-left:" + 2 * l.options.listDefaultPaddingLeft + "px}");
			p.cssRule("list", "ol,ul{margin:0;pading:0;" + (t.ie ? "" : "width:95%") + "}" + a.join("\n"), l.document)
		});
		l.ready(function() {
			g.on(l.body, "cut", function() {
				setTimeout(function() {
					var a = l.selection.getRange(),
						b;
					if (!a.collapsed && (b = g.findParentByTagName(a.startContainer, "li", !0)) && !b.nextSibling && g.isEmptyBlock(b)) {
						b = b.parentNode;
						var d;
						(d = b.previousSibling) ? (g.remove(b), a.setStartAtLast(d).collapse(!0)) : (d = b.nextSibling) ? (g.remove(b), a.setStartAtFirst(d).collapse(!0)) : (d = l.document.createElement("p"), g.fillNode(l.document, d), b.parentNode.insertBefore(d, b), g.remove(b), a.setStart(d, 0).collapse(!0));
						a.select(!0)
					}
				})
			})
		});
		l.addListener("beforepaste", function(b, d) {
			var f = this.selection.getRange(),
				c = UE.htmlparser(d.html, !0);
			if (f = g.findParentByTagName(f.startContainer, "li", !0)) {
				var e = f.parentNode;
				p.each(c.getNodesByTagName("OL" == e.tagName ? "ul" : "ol"), function(d) {
					d.tagName = e.tagName;
					d.setAttr();
					if (d.parentNode === c) b = a(e) || ("OL" == e.tagName ? "decimal" : "disc");
					else {
						var f = d.parentNode.getAttr("class");
						(b = f && /custom_/.test(f) ? f.match(/custom_(\w+)/)[1] : d.parentNode.getStyle("list-style-type")) || (b = "OL" == e.tagName ? "decimal" : "disc")
					}
					f = p.indexOf(m[e.tagName], b);
					d.parentNode !== c && (f = f + 1 == m[e.tagName].length ? 0 : f + 1);
					f = m[e.tagName][f];
					n[f] ? d.setAttr("class", "custom_" + f) : d.setStyle("list-style-type", f)
				})
			}
			d.html = c.toHtml()
		});
		!0 === l.getOpt("disablePInList") && l.addOutputRule(function(a) {
			p.each(a.getNodesByTagName("li"), function(a) {
				var b = [],
					d = 0;
				p.each(a.children, function(f) {
					if ("p" == f.tagName) {
						for (var c; c = f.children.pop();) b.splice(d, 0, c), c.parentNode = a, lastNode = c;
						c = b[b.length - 1];
						c && "element" == c.type && "br" == c.tagName || (f = UE.uNode.createElement("br"), f.parentNode = a, b.push(f));
						d = b.length
					}
				});
				b.length && (a.children = b)
			})
		});
		l.addInputRule(function(a) {
			p.each(a.getNodesByTagName("li"), function(a) {
				for (var b = UE.uNode.createElement("p"), d = 0, f; f = a.children[d];) "text" == f.type || y.p[f.tagName] ? b.appendChild(f) : b.firstChild() ? (a.insertBefore(b, f), b = UE.uNode.createElement("p"), d += 2) : d++;
				(b.firstChild() && !b.parentNode || !a.firstChild()) && a.appendChild(b);
				b.firstChild() || b.innerHTML(t.ie ? "&nbsp;" : "<br/>");
				a = a.firstChild();
				(b = a.lastChild()) && "text" == b.type && /^\s*$/.test(b.data) && a.removeChild(b)
			});
			if (l.options.autoTransWordToList) {
				var b = function(a, b) {
						var c = b.firstChild();
						if (c && "element" == c.type && "span" == c.tagName && /Wingdings|Symbol/.test(c.getStyle("font-family"))) {
							for (var e in f)
								if (f[e] == c.data) return e;
							return "disc"
						}
						for (e in d)
							if (d[e].test(a)) return e
					},
					d = {
						num1: /^\d+\)/,
						decimal: /^\d+\./,
						"lower-alpha": /^[a-z]+\)/,
						"upper-alpha": /^[A-Z]+\./,
						cn: /^[一二三四六五七八九]+[、]/,
						cn2: /^\([一二三四六五七八九]+\)/
					},
					f = {
						square: "n"
					};
				p.each(a.getNodesByTagName("p"), function(a) {
					if ("MsoListParagraph" == a.getAttr("class")) {
						a.setStyle("margin", "");
						a.setStyle("margin-left", "");
						a.setAttr("class", "");
						var f, c, e = a;
						if ("li" != a.parentNode.tagName && (c = b(a.innerText(), a))) {
							var k = UE.uNode.createElement(l.options.insertorderedlist.hasOwnProperty(c) ? "ol" : "ul");
							for (n[c] ? k.setAttr("class", "custom_" + c) : k.setStyle("list-style-type", c); a && "li" != a.parentNode.tagName && b(a.innerText(), a);) {
								(f = a.nextSibling()) || a.parentNode.insertBefore(k, a);
								var h = k,
									g = c;
								if ("ol" == h.tagName)
									if (t.ie) {
										var m = a.firstChild();
										"element" == m.type && "span" == m.tagName && d[g].test(m.innerText()) && a.removeChild(m)
									} else a.innerHTML(a.innerHTML().replace(d[g], ""));
								else a.removeChild(a.firstChild());
								g = UE.uNode.createElement("li");
								g.appendChild(a);
								h.appendChild(g);
								a = f
							}!k.parentNode && a && a.parentNode && a.parentNode.insertBefore(k, a)
						}(f = e.firstChild()) && "element" == f.type && "span" == f.tagName && /^\s*(&nbsp;)+\s*$/.test(f.innerText()) && f.parentNode.removeChild(f)
					}
				})
			}
		});
		l.addListener("contentchange", function() {
			e(l.document)
		});
		l.addListener("keydown", function(a, b) {
			function d() {
				b.preventDefault ? b.preventDefault() : b.returnValue = !1;
				l.fireEvent("contentchange");
				l.undoManger && l.undoManger.save()
			}

			function f(a, b) {
				for (; a && !g.isBody(a) && !b(a);) {
					if (1 == a.nodeType && /[ou]l/i.test(a.tagName)) return a;
					a = a.parentNode
				}
				return null
			}
			var c = b.keyCode || b.which;
			if (13 == c && !b.shiftKey) {
				var e = l.selection.getRange(),
					k = g.findParent(e.startContainer, function(a) {
						return g.isBlockElm(a)
					}, !0),
					m = g.findParentByTagName(e.startContainer, "li", !0);
				k && "PRE" != k.tagName && !m && (m = k.innerHTML.replace(new RegExp(g.fillChar, "g"), ""), /^\s*1\s*\.[^\d]/.test(m) && (k.innerHTML = m.replace(/^\s*1\s*\./, ""), e.setStartAtLast(k).collapse(!0).select(), l.__hasEnterExecCommand = !0, l.execCommand("insertorderedlist"), l.__hasEnterExecCommand = !1));
				e = l.selection.getRange();
				k = f(e.startContainer, function(a) {
					return "TABLE" == a.tagName
				});
				m = e.collapsed ? k : f(e.endContainer, function(a) {
					return "TABLE" == a.tagName
				});
				if (k && m && k === m) {
					if (!e.collapsed)
						if (k = g.findParentByTagName(e.startContainer, "li", !0), m = g.findParentByTagName(e.endContainer, "li", !0), k && m && k === m) {
							if (e.deleteContents(), (m = g.findParentByTagName(e.startContainer, "li", !0)) && g.isEmptyBlock(m)) {
								u = m.previousSibling;
								next = m.nextSibling;
								k = l.document.createElement("p");
								g.fillNode(l.document, k);
								r = m.parentNode;
								u && next ? (e.setStart(next, 0).collapse(!0).select(!0), g.remove(m)) : ((u || next) && u ? m.parentNode.parentNode.insertBefore(k, r.nextSibling) : r.parentNode.insertBefore(k, r), g.remove(m), r.firstChild || g.remove(r), e.setStart(k, 0).setCursor());
								d();
								return
							}
						} else {
							var k = e.cloneRange(),
								n = k.collapse(!1).createBookmark();
							e.deleteContents();
							k.moveToBookmark(n);
							m = g.findParentByTagName(k.startContainer, "li", !0);
							h(m);
							k.select();
							d();
							return
						}
					if (m = g.findParentByTagName(e.startContainer, "li", !0)) {
						if (g.isEmptyBlock(m)) {
							var n = e.createBookmark(),
								r = m.parentNode;
							m !== r.lastChild ? (g.breakParent(m, r), h(m)) : (r.parentNode.insertBefore(m, r.nextSibling), g.isEmptyNode(r) && g.remove(r));
							if (!y.$list[m.parentNode.tagName])
								if (g.isBlockElm(m.firstChild)) g.remove(m, !0);
								else {
									k = l.document.createElement("p");
									for (m.parentNode.insertBefore(k, m); m.firstChild;) k.appendChild(m.firstChild);
									g.remove(m)
								}
							e.moveToBookmark(n).select()
						} else {
							k = m.firstChild;
							if (!k || !g.isBlockElm(k)) {
								k = l.document.createElement("p");
								for (!m.firstChild && g.fillNode(l.document, k); m.firstChild;) k.appendChild(m.firstChild);
								m.appendChild(k)
							}
							n = l.document.createElement("span");
							e.insertNode(n);
							g.breakParent(n, m);
							u = n.nextSibling;
							k = u.firstChild;
							k || (k = l.document.createElement("p"), g.fillNode(l.document, k), u.appendChild(k));
							g.isEmptyNode(k) && (k.innerHTML = "", g.fillNode(l.document, k));
							e.setStart(k, 0).collapse(!0).shrinkBoundary().select();
							g.remove(n);
							var u = u.previousSibling;
							u && g.isEmptyBlock(u) && (u.innerHTML = "<p></p>", g.fillNode(l.document, u.firstChild))
						}
						d()
					}
				}
			}
			if (8 == c && (e = l.selection.getRange(), e.collapsed && g.isStartInblock(e) && (k = e.cloneRange().trimBoundary(), (m = g.findParentByTagName(e.startContainer, "li", !0)) && g.isStartInblock(k))))
				if ((k = g.findParentByTagName(e.startContainer, "p", !0)) && k !== m.firstChild) r = g.findParentByTagName(k, ["ol", "ul"]), g.breakParent(k, r), h(k), l.fireEvent("contentchange"), e.setStart(k, 0).setCursor(!1, !0), l.fireEvent("saveScene"), g.preventDefault(b);
				else if (m && (u = m.previousSibling)) {
				if (46 != c || !m.childNodes.length) {
					y.$list[u.tagName] && (u = u.lastChild);
					l.undoManger && l.undoManger.save();
					k = m.firstChild;
					if (g.isBlockElm(k))
						if (g.isEmptyNode(k))
							for (u.appendChild(k), e.setStart(k, 0).setCursor(!1, !0); m.firstChild;) u.appendChild(m.firstChild);
						else n = l.document.createElement("span"), e.insertNode(n), g.isEmptyBlock(u) && (u.innerHTML = ""), g.moveChild(m, u), e.setStartBefore(n).collapse(!0).select(!0), g.remove(n);
					else if (g.isEmptyNode(m)) k = l.document.createElement("p"), u.appendChild(k), e.setStart(k, 0).setCursor();
					else
						for (e.setEnd(u, u.childNodes.length).collapse().select(!0); m.firstChild;) u.appendChild(m.firstChild);
					g.remove(m);
					l.fireEvent("contentchange");
					l.fireEvent("saveScene");
					g.preventDefault(b)
				}
			} else if (m && !m.previousSibling) {
				r = m.parentNode;
				n = e.createBookmark();
				if (g.isTagNode(r.parentNode, "ol ul")) r.parentNode.insertBefore(m, r);
				else {
					for (; m.firstChild;) r.parentNode.insertBefore(m.firstChild, r);
					g.remove(m)
				}
				g.isEmptyNode(r) && g.remove(r);
				e.moveToBookmark(n).setCursor(!1, !0);
				l.fireEvent("contentchange");
				l.fireEvent("saveScene");
				g.preventDefault(b)
			}
		});
		l.addListener("keyup", function(b, f) {
			if (8 == (f.keyCode || f.which)) {
				var e = l.selection.getRange(),
					c;
				(c = g.findParentByTagName(e.startContainer, ["ol", "ul"], !0)) && d(c, c.tagName.toLowerCase(), a(c) || g.getComputedStyle(c, "list-style-type"), !0)
			}
		});
		l.addListener("tabkeydown", function() {
			function f(a) {
				if (-1 != l.options.maxListLevel) {
					a = a.parentNode;
					for (var b = 0;
						/[ou]l/i.test(a.tagName);) b++, a = a.parentNode;
					if (b >= l.options.maxListLevel) return !0
				}
			}
			var c = l.selection.getRange(),
				e = g.findParentByTagName(c.startContainer, "li", !0);
			if (e) {
				var k;
				if (c.collapsed) {
					if (f(e)) return !0;
					var h = e.parentNode,
						n = l.document.createElement(h.tagName),
						r = p.indexOf(m[n.tagName], a(h) || g.getComputedStyle(h, "list-style-type")),
						r = r + 1 == m[n.tagName].length ? 0 : r + 1,
						r = m[n.tagName][r];
					b(n, r);
					if (g.isStartInblock(c)) return l.fireEvent("saveScene"), k = c.createBookmark(), h.insertBefore(n, e), n.appendChild(e), d(n, n.tagName.toLowerCase(), r), l.fireEvent("contentchange"), c.moveToBookmark(k).select(!0), !0
				} else {
					l.fireEvent("saveScene");
					k = c.createBookmark();
					for (var h = 0, v, n = g.findParents(e), q; q = n[h++];)
						if (g.isTagNode(q, "ol ul")) {
							v = q;
							break
						}
					q = e;
					if (k.end)
						for (; q && !(g.getPosition(q, k.end) & g.POSITION_FOLLOWING);)
							if (f(q)) q = g.getNextDomNode(q, !1, null, function(a) {
								return a !== v
							});
							else {
								h = q.parentNode;
								n = l.document.createElement(h.tagName);
								r = p.indexOf(m[n.tagName], a(h) || g.getComputedStyle(h, "list-style-type"));
								r = m[n.tagName][r + 1 == m[n.tagName].length ? 0 : r + 1];
								b(n, r);
								for (h.insertBefore(n, q); q && !(g.getPosition(q, k.end) & g.POSITION_FOLLOWING);) {
									e = q.nextSibling;
									n.appendChild(q);
									if (!e || g.isTagNode(e, "ol ul")) {
										if (e)
											for (;
												(e = e.firstChild) && "LI" != e.tagName;);
										else e = g.getNextDomNode(q, !1, null, function(a) {
											return a !== v
										});
										break
									}
									q = e
								}
								d(n, n.tagName.toLowerCase(), r);
								q = e
							}
					l.fireEvent("contentchange");
					c.moveToBookmark(k).select();
					return !0
				}
			}
		});
		l.commands.insertorderedlist = l.commands.insertunorderedlist = {
			execCommand: function(e, c) {
				c || (c = "insertorderedlist" == e.toLowerCase() ? "decimal" : "disc");
				var h = this.selection.getRange(),
					l = function(a) {
						return 1 == a.nodeType ? "br" != a.tagName.toLowerCase() : !g.isWhitespace(a)
					},
					m = "insertorderedlist" == e.toLowerCase() ? "ol" : "ul",
					n = this.document.createDocumentFragment();
				h.adjustmentBoundary().shrinkBoundary();
				var r = h.createBookmark(!0),
					u = f(this.document.getElementById(r.start)),
					v = 0,
					x = f(this.document.getElementById(r.end)),
					p = 0,
					q, t, C, B;
				if (u || x) {
					u && (q = u.parentNode);
					r.end || (x = u);
					x && (t = x.parentNode);
					if (q === t) {
						for (; u !== x;) {
							B = u;
							u = u.nextSibling;
							if (!g.isBlockElm(B.firstChild)) {
								for (l = this.document.createElement("p"); B.firstChild;) l.appendChild(B.firstChild);
								B.appendChild(l)
							}
							n.appendChild(B)
						}
						B = this.document.createElement("span");
						q.insertBefore(B, x);
						if (!g.isBlockElm(x.firstChild)) {
							for (l = this.document.createElement("p"); x.firstChild;) l.appendChild(x.firstChild);
							x.appendChild(l)
						}
						n.appendChild(x);
						g.breakParent(B, q);
						g.isEmptyNode(B.previousSibling) && g.remove(B.previousSibling);
						g.isEmptyNode(B.nextSibling) && g.remove(B.nextSibling);
						l = a(q) || g.getComputedStyle(q, "list-style-type") || ("insertorderedlist" == e.toLowerCase() ? "decimal" : "disc");
						if (q.tagName.toLowerCase() == m && l == c) {
							x = 0;
							for (x = this.document.createDocumentFragment(); l = n.firstChild;)
								if (g.isTagNode(l, "ol ul")) x.appendChild(l);
								else
									for (; l.firstChild;) x.appendChild(l.firstChild), g.remove(l);
							B.parentNode.insertBefore(x, B)
						} else C = this.document.createElement(m), b(C, c), C.appendChild(n), B.parentNode.insertBefore(C, B);
						g.remove(B);
						C && d(C, m, c);
						h.moveToBookmark(r).select();
						return
					}
					if (u) {
						for (; u;) {
							B = u.nextSibling;
							if (g.isTagNode(u, "ol ul")) n.appendChild(u);
							else {
								C = this.document.createDocumentFragment();
								for (var A = 0; u.firstChild;) g.isBlockElm(u.firstChild) && (A = 1), C.appendChild(u.firstChild);
								A ? n.appendChild(C) : (A = this.document.createElement("p"), A.appendChild(C), n.appendChild(A));
								g.remove(u)
							}
							u = B
						}
						q.parentNode.insertBefore(n, q.nextSibling);
						g.isEmptyNode(q) ? (h.setStartBefore(q), g.remove(q)) : h.setStartAfter(q);
						v = 1
					}
					if (x && g.inDoc(t, this.document)) {
						for (u = t.firstChild; u && u !== x;) {
							B = u.nextSibling;
							if (g.isTagNode(u, "ol ul")) n.appendChild(u);
							else {
								C = this.document.createDocumentFragment();
								for (A = 0; u.firstChild;) g.isBlockElm(u.firstChild) && (A = 1), C.appendChild(u.firstChild);
								A ? n.appendChild(C) : (A = this.document.createElement("p"), A.appendChild(C), n.appendChild(A));
								g.remove(u)
							}
							u = B
						}
						B = g.createElement(this.document, "div", {
							tmpDiv: 1
						});
						g.moveChild(x, B);
						n.appendChild(B);
						g.remove(x);
						t.parentNode.insertBefore(n, t);
						h.setEndBefore(t);
						g.isEmptyNode(t) && g.remove(t);
						p = 1
					}
				}
				v || h.setStartBefore(this.document.getElementById(r.start));
				r.end && !p && h.setEndAfter(this.document.getElementById(r.end));
				h.enlarge(!0, function(a) {
					return k[a.tagName]
				});
				n = this.document.createDocumentFragment();
				x = h.createBookmark();
				q = g.getNextDomNode(x.start, !1, l);
				C = h.cloneRange();
				for (v = g.isBlockElm; q && q !== x.end && g.getPosition(q, x.end) & g.POSITION_PRECEDING;)
					if (3 == q.nodeType || y.li[q.tagName])
						if (1 == q.nodeType && y.$list[q.tagName]) {
							for (; q.firstChild;) n.appendChild(q.firstChild);
							u = g.getNextDomNode(q, !1, l);
							g.remove(q);
							q = u
						} else {
							u = q;
							for (C.setStartBefore(q); q && q !== x.end && (!v(q) || g.isBookmarkNode(q));) u = q, q = g.getNextDomNode(q, !1, null, function(a) {
								return !k[a.tagName]
							});
							q && v(q) && (B = g.getNextDomNode(u, !1, l)) && g.isBookmarkNode(B) && (q = g.getNextDomNode(B, !1, l), u = B);
							C.setEndAfter(u);
							q = g.getNextDomNode(u, !1, l);
							B = h.document.createElement("li");
							B.appendChild(C.extractContents());
							if (g.isEmptyNode(B)) {
								for (u = h.document.createElement("p"); B.firstChild;) u.appendChild(B.firstChild);
								B.appendChild(u)
							}
							n.appendChild(B)
						}
				else q = g.getNextDomNode(q, !0, l);
				h.moveToBookmark(x).collapse(!0);
				C = this.document.createElement(m);
				b(C, c);
				C.appendChild(n);
				h.insertNode(C);
				d(C, m, c);
				x = 0;
				for (m = g.getElementsByTagName(C, "div"); l = m[x++];) l.getAttribute("tmpDiv") && g.remove(l, !0);
				h.moveToBookmark(r).select()
			},
			queryCommandState: function(a) {
				a = "insertorderedlist" == a.toLowerCase() ? "ol" : "ul";
				for (var b = this.selection.getStartElementPath(), d = 0, f;
					(f = b[d++]) && "TABLE" != f.nodeName;)
					if (a == f.nodeName.toLowerCase()) return 1;
				return 0
			},
			queryCommandValue: function(b) {
				b = "insertorderedlist" == b.toLowerCase() ? "ol" : "ul";
				for (var d = this.selection.getStartElementPath(), f, e = 0, c; c = d[e++];) {
					if ("TABLE" == c.nodeName) {
						f = null;
						break
					}
					if (b == c.nodeName.toLowerCase()) {
						f = c;
						break
					}
				}
				return f ? a(f) || g.getComputedStyle(f, "list-style-type") : null
			}
		}
	};
	(function() {
		var c = {
			textarea: function(a, e) {
				var d = e.ownerDocument.createElement("textarea");
				d.style.cssText = "position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;";
				t.ie && 8 > t.version && (d.style.width = e.offsetWidth + "px", d.style.height = e.offsetHeight + "px", e.onresize = function() {
					d.style.width = e.offsetWidth + "px";
					d.style.height = e.offsetHeight + "px"
				});
				e.appendChild(d);
				return {
					setContent: function(a) {
						d.value = a
					},
					getContent: function() {
						return d.value
					},
					select: function() {
						var a;
						t.ie ? (a = d.createTextRange(), a.collapse(!0), a.select()) : (d.setSelectionRange(0, 0), d.focus())
					},
					dispose: function() {
						e.removeChild(d);
						e = d = e.onresize = null
					}
				}
			},
			codemirror: function(a, e) {
				var d = window.CodeMirror(e, {
						mode: "text/html",
						tabMode: "indent",
						lineNumbers: !0,
						lineWrapping: !0
					}),
					b = d.getWrapperElement();
				b.style.cssText = 'position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,"Courier new",monospace;font-size:13px;';
				d.getScrollerElement().style.cssText = "position:absolute;left:0;top:0;width:100%;height:100%;";
				d.refresh();
				return {
					getCodeMirror: function() {
						return d
					},
					setContent: function(a) {
						d.setValue(a)
					},
					getContent: function() {
						return d.getValue()
					},
					select: function() {
						d.focus()
					},
					dispose: function() {
						e.removeChild(b);
						d = b = null
					}
				}
			}
		};
		UE.plugins.source = function() {
			var a = this,
				e = this.options,
				d = !1,
				b, h;
			e.sourceEditor = t.ie ? "textarea" : e.sourceEditor || "codemirror";
			a.setOpt({
				sourceEditorFirst: !1
			});
			var f, l, k;
			a.commands.source = {
				execCommand: function() {
					if (d = !d) {
						k = a.selection.getRange().createAddress(!1, !0);
						a.undoManger && a.undoManger.save(!0);
						t.gecko && (a.body.contentEditable = !1);
						f = a.iframe.style.cssText;
						a.iframe.style.cssText += "position:absolute;left:-32768px;top:-32768px;";
						a.fireEvent("beforegetcontent");
						var m = UE.htmlparser(a.body.innerHTML);
						a.filterOutputRule(m);
						m.traversal(function(a) {
							if ("element" == a.type) switch (a.tagName) {
								case "td":
								case "th":
								case "caption":
									a.children && 1 == a.children.length && "br" == a.firstChild().tagName && a.removeChild(a.firstChild());
									break;
								case "pre":
									a.innerText(a.innerText().replace(/&nbsp;/g, " "))
							}
						});
						a.fireEvent("aftergetcontent");
						m = m.toHtml(!0);
						b = c["codemirror" == e.sourceEditor && window.CodeMirror ? "codemirror" : "textarea"](a, a.iframe.parentNode);
						b.setContent(m);
						h = a.setContent;
						a.setContent = function(d) {
							d = UE.htmlparser(d);
							a.filterInputRule(d);
							d = d.toHtml();
							b.setContent(d)
						};
						setTimeout(function() {
							b.select();
							a.addListener("fullscreenchanged", function() {
								try {
									b.getCodeMirror().refresh()
								} catch (v) {}
							})
						});
						l = a.getContent;
						a.getContent = function() {
							return b.getContent() || '<section data-role="paragraph" class="_135editor"><p>' + (t.ie ? "" : "<br/>") + "</p></section>"
						}
					} else if (a.iframe.style.cssText = f, m = b.getContent() || '<section data-role="paragraph" class="_135editor"><p>' + (t.ie ? "" : "<br/>") + "</p></section>", m = m.replace(RegExp("[\\r\\t\\n ]*</?(\\w+)\\s*(?:[^>]*)>", "g"), function(a, b) {
							return b && !y.$inlineWithA[b.toLowerCase()] ? a.replace(/(^[\n\r\t ]*)|([\n\r\t ]*$)/g, "") : a.replace(/(^[\n\r\t]*)|([\n\r\t]*$)/g, "")
						}), a.setContent = h, a.setContent(m), b.dispose(), b = null, a.getContent = l, m = a.body.firstChild.firstChild, m || (a.body.innerHTML = '<section data-role="paragraph" class="_135editor"><p>' + (t.ie ? "" : "<br/>") + "</p></section>", m = a.body.firstChild.firstChild), a.undoManger && a.undoManger.save(!0), t.gecko) {
						var n = document.createElement("input");
						n.style.cssText = "position:absolute;left:0;top:-32768px";
						document.body.appendChild(n);
						a.body.contentEditable = !1;
						setTimeout(function() {
							g.setViewportOffset(n, {
								left: -32768,
								top: 0
							});
							n.focus();
							setTimeout(function() {
								a.body.contentEditable = !0;
								a.selection.getRange().moveToAddress(k).select(!0);
								g.remove(n)
							})
						})
					} else try {
						a.selection.getRange().moveToAddress(k).select(!0)
					} catch (v) {}
					this.fireEvent("sourcemodechanged", d)
				},
				queryCommandState: function() {
					return d | 0
				},
				notNeedUndo: 1
			};
			var n = a.queryCommandState;
			a.queryCommandState = function(a) {
				a = a.toLowerCase();
				return d ? a in {
					source: 1,
					fullscreen: 1
				} ? 1 : -1 : n.apply(this, arguments)
			};
			"codemirror" == e.sourceEditor && a.addListener("ready", function() {
				p.loadFile(document, {
					src: e.codeMirrorJsUrl || e.UEDITOR_HOME_URL + "third-party/codemirror/codemirror.js",
					tag: "script",
					type: "text/javascript",
					defer: "defer"
				}, function() {
					e.sourceEditorFirst && setTimeout(function() {
						a.execCommand("source")
					}, 0)
				});
				p.loadFile(document, {
					tag: "link",
					rel: "stylesheet",
					type: "text/css",
					href: e.codeMirrorCssUrl || e.UEDITOR_HOME_URL + "third-party/codemirror/codemirror.css"
				})
			})
		}
	})();
	UE.plugins.enterkey = function() {
		var c, a = this,
			e = a.options.enterTag;
		a.addListener("keyup", function(d, b) {
			if (13 == (b.keyCode || b.which)) {
				var e = a.selection.getRange(),
					f = e.startContainer,
					l;
				if (t.ie) a.fireEvent("saveScene", !0, !0);
				else {
					if (/h\d/i.test(c)) {
						if (t.gecko) g.findParentByTagName(f, "h1 h2 h3 h4 h5 h6 blockquote caption table".split(" "), !0) || (a.document.execCommand("formatBlock", !1, "<p>"), l = 1);
						else if (1 == f.nodeType) {
							var f = a.document.createTextNode(""),
								k;
							e.insertNode(f);
							if (k = g.findParentByTagName(f, "div", !0)) {
								for (l = a.document.createElement("p"); k.firstChild;) l.appendChild(k.firstChild);
								k.parentNode.insertBefore(l, k);
								g.remove(k);
								e.setStartBefore(f).setCursor();
								l = 1
							}
							g.remove(f)
						}
						a.undoManger && l && a.undoManger.save()
					}
					t.opera && e.select()
				}
			}
		});
		a.addListener("keydown", function(d, b) {
			if (13 == (b.keyCode || b.which))
				if (a.fireEvent("beforeenterkeydown")) g.preventDefault(b);
				else {
					a.fireEvent("saveScene", !0, !0);
					c = "";
					var h = a.selection.getRange();
					if (!h.collapsed) {
						var f = h.startContainer,
							l = h.endContainer,
							f = g.findParentByTagName(f, "td", !0),
							l = g.findParentByTagName(l, "td", !0);
						if (f && l && f !== l || !f && l || f && !l) {
							b.preventDefault ? b.preventDefault() : b.returnValue = !1;
							return
						}
					}
					if ("p" == e) t.ie || ((f = g.findParentByTagName(h.startContainer, "ol ul p h1 h2 h3 h4 h5 h6 blockquote caption".split(" "), !0)) || t.opera ? (c = f.tagName, "p" == f.tagName.toLowerCase() && t.gecko && g.removeDirtyAttr(f)) : (a.document.execCommand("formatBlock", !1, "<p>"), t.gecko && (h = a.selection.getRange(), (f = g.findParentByTagName(h.startContainer, "p", !0)) && g.removeDirtyAttr(f))));
					else if (b.preventDefault ? b.preventDefault() : b.returnValue = !1, h.collapsed) l = h.document.createElement("br"), h.insertNode(l), l.parentNode.lastChild === l ? (l.parentNode.insertBefore(l.cloneNode(!0), l), h.setStartBefore(l)) : h.setStartAfter(l), h.setCursor();
					else if (h.deleteContents(), f = h.startContainer, 1 == f.nodeType && (f = f.childNodes[h.startOffset])) {
						for (; 1 == f.nodeType;) {
							if (y.$empty[f.tagName]) return h.setStartBefore(f).setCursor(), a.undoManger && a.undoManger.save(), !1;
							if (!f.firstChild) return l = h.document.createElement("br"), f.appendChild(l), h.setStart(f, 0).setCursor(), a.undoManger && a.undoManger.save(), !1;
							f = f.firstChild
						}
						f === h.startContainer.childNodes[h.startOffset] ? (l = h.document.createElement("br"), h.insertNode(l).setCursor()) : h.setStart(f, 0).setCursor()
					} else l = h.document.createElement("br"), h.insertNode(l).setStartAfter(l).setCursor()
				}
		})
	};
	UE.plugins.keystrokes = function() {
		var c = this,
			a = !0;
		c.addListener("keydown", function(e, d) {
			var b = d.keyCode || d.which,
				h = c.selection.getRange();
			if (!(h.collapsed || d.ctrlKey || d.shiftKey || d.altKey || d.metaKey) && (65 <= b && 90 >= b || 48 <= b && 57 >= b || 96 <= b && 111 >= b || {
					13: 1,
					8: 1,
					46: 1
				}[b])) {
				var f = h.startContainer;
				g.isFillChar(f) && h.setStartBefore(f);
				f = h.endContainer;
				g.isFillChar(f) && h.setEndAfter(f);
				h.txtToElmBoundary();
				h.endContainer && 1 == h.endContainer.nodeType && (f = h.endContainer.childNodes[h.endOffset]) && g.isBr(f) && h.setEndAfter(f);
				if (0 == h.startOffset && (f = h.startContainer, g.isBoundaryNode(f, "firstChild") && (f = h.endContainer, h.endOffset == (3 == f.nodeType ? f.nodeValue.length : f.childNodes.length) && g.isBoundaryNode(f, "lastChild")))) {
					c.fireEvent("saveScene");
					c.body.innerHTML = "<p>" + (t.ie ? "" : "<br/>") + "</p>";
					h.setStart(c.body.firstChild, 0).setCursor(!1, !0);
					c._selectionChange();
					return
				}
			}
			if (b == fa.Backspace) {
				h = c.selection.getRange();
				a = h.collapsed;
				if (c.fireEvent("delkeydown", d)) return;
				var l, k;
				h.collapsed && h.inFillChar() && (l = h.startContainer, g.isFillChar(l) ? (h.setStartBefore(l).shrinkBoundary(!0).collapse(!0), g.remove(l)) : (l.nodeValue = l.nodeValue.replace(new RegExp("^" + g.fillChar), ""), h.startOffset--, h.collapse(!0).select(!0)));
				if (l = h.getClosedNode()) {
					c.fireEvent("saveScene");
					h.setStartBefore(l);
					g.remove(l);
					h.setCursor();
					c.fireEvent("saveScene");
					g.preventDefault(d);
					return
				}
				if (!t.ie && (l = g.findParentByTagName(h.startContainer, "table", !0), k = g.findParentByTagName(h.endContainer, "table", !0), l && !k || !l && k || l !== k)) {
					d.preventDefault();
					return
				}
			}
			if (b == fa.Tab) {
				var n = {
					ol: 1,
					ul: 1,
					table: 1
				};
				if (c.fireEvent("tabkeydown", d)) {
					g.preventDefault(d);
					return
				}
				h = c.selection.getRange();
				c.fireEvent("saveScene");
				var f = 0,
					m = "";
				l = c.options.tabSize || 4;
				for (k = c.options.tabNode || "&nbsp;"; f < l; f++) m += k;
				f = c.document.createElement("span");
				f.innerHTML = m + g.fillChar;
				if (h.collapsed) h.insertNode(f.cloneNode(!0).firstChild).setCursor(!0);
				else if (m = function(a) {
						return g.isBlockElm(a) && !n[a.tagName.toLowerCase()]
					}, l = g.findParent(h.startContainer, m, !0), k = g.findParent(h.endContainer, m, !0), l && k && l === k) h.deleteContents(), h.insertNode(f.cloneNode(!0).firstChild).setCursor(!0);
				else {
					l = h.createBookmark();
					h.enlarge(!0);
					k = h.createBookmark();
					for (var r = g.getNextDomNode(k.start, !1, m); r && !(g.getPosition(r, k.end) & g.POSITION_FOLLOWING);) r.insertBefore(f.cloneNode(!0).firstChild, r.firstChild), r = g.getNextDomNode(r, !1, m);
					h.moveToBookmark(k).moveToBookmark(l).select()
				}
				g.preventDefault(d)
			}
			if (t.gecko && 46 == b && (h = c.selection.getRange(), h.collapsed && (l = h.startContainer, g.isEmptyBlock(l)))) {
				for (b = l.parentNode; 1 == g.getChildCount(b) && !g.isBody(b);) l = b, b = b.parentNode;
				l === b.lastChild && d.preventDefault();
				return
			}
			t.chrome && c.on("keydown", function(a, b) {
				var d = b.keyCode || b.which;
				if ((b.metaKey && b.altKey || b.ctrlKey && b.shiftKey) && 73 == d) return !0
			})
		});
		c.addListener("keyup", function(e, d) {
			var b;
			if ((d.keyCode || d.which) == fa.Backspace && !this.fireEvent("delkeyup")) {
				b = this.selection.getRange();
				if (b.collapsed) {
					var c;
					if ((c = g.findParentByTagName(b.startContainer, "h1 h2 h3 h4 h5 h6".split(" "), !0)) && g.isEmptyBlock(c)) {
						var f = c.previousSibling;
						if (f && "TABLE" != f.nodeName) {
							g.remove(c);
							b.setStartAtLast(f).setCursor(!1, !0);
							return
						}
						if ((f = c.nextSibling) && "TABLE" != f.nodeName) {
							g.remove(c);
							b.setStartAtFirst(f).setCursor(!1, !0);
							return
						}
					}
					g.isBody(b.startContainer) && (c = g.createElement(this.document, "p", {
						innerHTML: t.ie ? g.fillChar : "<br/>"
					}), b.insertNode(c).setStart(c, 0).setCursor(!1, !0))
				}!a && (3 == b.startContainer.nodeType || 1 == b.startContainer.nodeType && g.isEmptyBlock(b.startContainer)) && (t.ie ? (c = b.document.createElement("span"), b.insertNode(c).setStartBefore(c).collapse(!0), b.select(), g.remove(c)) : b.select())
			}
		})
	};
	UE.plugins.fiximgclick = function() {
		function c() {
			this.cover = this.resizer = this.editor = null;
			this.doc = document;
			this.prePos = {
				x: 0,
				y: 0
			};
			this.startPos = {
				x: 0,
				y: 0
			}
		}
		var a = !1;
		(function() {
			var e = [
				[0, 0, -1, -1],
				[0, 0, 0, -1],
				[0, 0, 1, -1],
				[0, 0, -1, 0],
				[0, 0, 1, 0],
				[0, 0, -1, 1],
				[0, 0, 0, 1],
				[0, 0, 1, 1]
			];
			c.prototype = {
				init: function(a) {
					var b = this;
					b.editor = a;
					b.startPos = this.prePos = {
						x: 0,
						y: 0
					};
					b.dragId = -1;
					a = [];
					var d = b.cover = document.createElement("div"),
						f = b.resizer = document.createElement("div");
					d.id = b.editor.ui.id + "_imagescale_cover";
					d.style.cssText = "position:absolute;display:none;z-index:" + b.editor.options.zIndex + ";filter:alpha(opacity=0); opacity:0;background:#CCC;";
					g.on(d, "mousedown click", function() {
						b.hide();
						b.editor.selection.clearRange()
					});
					for (i = 0; 8 > i; i++) a.push('<span class="edui-editor-imagescale-hand' + i + '"></span>');
					f.id = b.editor.ui.id + "_imagescale";
					f.className = "edui-editor-imagescale";
					f.innerHTML = a.join("");
					f.style.cssText += ";display:none;border:1px solid #43B548;z-index:" + b.editor.options.zIndex + ";";
					b.editor.ui.getDom().appendChild(d);
					b.editor.ui.getDom().appendChild(f);
					b.initStyle();
					b.initEvents()
				},
				initStyle: function() {
					p.cssRule("imagescale", ".edui-editor-imagescale{display:none;position:absolute;border:1px solid #43B548;cursor:hand;-webkit-box-sizing: content-box;-moz-box-sizing: content-box;box-sizing: content-box;}.edui-editor-imagescale span{position:absolute;width:6px;height:6px;overflow:hidden;font-size:0px;display:block;background-color:#43B548;}.edui-editor-imagescale .edui-editor-imagescale-hand0{cursor:nw-resize;top:0;margin-top:-4px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand1{cursor:n-resize;top:0;margin-top:-4px;left:50%;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand2{cursor:ne-resize;top:0;margin-top:-4px;left:100%;margin-left:-3px;}.edui-editor-imagescale .edui-editor-imagescale-hand3{cursor:w-resize;top:50%;margin-top:-4px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand4{cursor:e-resize;top:50%;margin-top:-4px;left:100%;margin-left:-3px;}.edui-editor-imagescale .edui-editor-imagescale-hand5{cursor:sw-resize;top:100%;margin-top:-3px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand6{cursor:s-resize;top:100%;margin-top:-3px;left:50%;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand7{cursor:se-resize;top:100%;margin-top:-3px;left:100%;margin-left:-3px;}")
				},
				initEvents: function() {
					this.startPos.x = this.startPos.y = 0;
					this.isDraging = !1
				},
				_eventHandler: function(d) {
					switch (d.type) {
						case "mousedown":
							var b = d.target || d.srcElement; - 1 != b.className.indexOf("edui-editor-imagescale-hand") && -1 == this.dragId && (this.dragId = b.className.slice(-1), this.startPos.x = this.prePos.x = d.clientX, this.startPos.y = this.prePos.y = d.clientY, g.on(this.doc, "mousemove", this.proxy(this._eventHandler, this)));
							break;
						case "mousemove":
							if (-1 != this.dragId) {
								this.updateContainerStyle(this.dragId, {
									x: d.clientX - this.prePos.x,
									y: d.clientY - this.prePos.y
								});
								this.prePos.x = d.clientX;
								this.prePos.y = d.clientY;
								a = !0;
								this.updateTargetElement();
								try {
									(new UE.dom.Selection(this.doc)).getNative().removeAllRanges()
								} catch (h) {}
							}
							break;
						case "mouseup":
							-1 != this.dragId && (this.updateContainerStyle(this.dragId, {
								x: d.clientX - this.prePos.x,
								y: d.clientY - this.prePos.y
							}), this.updateTargetElement(), this.target.parentNode && this.attachTo(this.target), this.dragId = -1), g.un(this.doc, "mousemove", this.proxy(this._eventHandler, this)), a && (a = !1, this.editor.fireEvent("contentchange")), this.dragId = -1
					}
				},
				updateTargetElement: function() {
					g.setStyles(this.target, {
						width: this.resizer.style.width,
						height: this.resizer.style.height
					});
					this.target.width = parseInt(this.resizer.style.width);
					this.target.height = parseInt(this.resizer.style.height);
					this.attachTo(this.target)
				},
				updateContainerStyle: function(a, b) {
					var d = this.resizer,
						f;
					0 != e[a][0] && (f = parseInt(d.style.left) + b.x, d.style.left = this._validScaledProp("left", f) + "px");
					0 != e[a][1] && (f = parseInt(d.style.top) + b.y, d.style.top = this._validScaledProp("top", f) + "px");
					0 != e[a][2] && (f = parseInt(d.style.width) + e[a][2] * b.x, 50 < f && (d.style.width = this._validScaledProp("width", f) + "px", 0 != e[a][3] && (f = parseInt(d.style.height) + e[a][3] * b.y, d.style.height = this._validScaledProp("height", f) + "px")))
				},
				_validScaledProp: function(a, b) {
					var d = this.resizer,
						f = document;
					b = isNaN(b) ? 0 : b;
					switch (a) {
						case "left":
							return 0 > b ? 0 : b + d.clientWidth > f.clientWidth ? f.clientWidth - d.clientWidth : b;
						case "top":
							return 0 > b ? 0 : b + d.clientHeight > f.clientHeight ? f.clientHeight - d.clientHeight : b;
						case "width":
							return 0 >= b ? 1 : b + d.offsetLeft > f.clientWidth ? f.clientWidth - d.offsetLeft : b;
						case "height":
							return 0 >= b ? 1 : b + d.offsetTop > f.clientHeight ? f.clientHeight - d.offsetTop : b
					}
				},
				hideCover: function() {
					this.cover.style.display = "none"
				},
				showCover: function() {
					var a = g.getXY(this.editor.ui.getDom()),
						b = g.getXY(this.editor.iframe);
					g.setStyles(this.cover, {
						width: this.editor.iframe.offsetWidth + "px",
						height: this.editor.iframe.offsetHeight + "px",
						top: b.y - a.y + "px",
						left: b.x - a.x + "px",
						position: "absolute",
						display: ""
					})
				},
				show: function(a) {
					this.resizer.style.display = "block";
					a && this.attachTo(a);
					g.on(this.resizer, "mousedown", this.proxy(this._eventHandler, this));
					g.on(this.doc, "mouseup", this.proxy(this._eventHandler, this));
					this.showCover();
					this.editor.fireEvent("afterscaleshow", this);
					this.editor.fireEvent("saveScene")
				},
				hide: function() {
					this.hideCover();
					this.resizer.style.display = "none";
					g.un(this.resizer, "mousedown", this.proxy(this._eventHandler, this));
					g.un(this.doc, "mouseup", this.proxy(this._eventHandler, this));
					this.editor.fireEvent("afterscalehide", this)
				},
				proxy: function(a, b) {
					return function(d) {
						return a.apply(b || this, arguments)
					}
				},
				attachTo: function(a) {
					a = this.target = a;
					var b = this.resizer,
						d = g.getXY(a),
						f = g.getXY(this.editor.iframe),
						c = g.getXY(b.parentNode),
						e = $(this.editor.document).scrollTop();
					g.setStyles(b, {
						width: a.width + "px",
						height: a.height + "px",
						left: f.x + d.x - this.editor.document.body.scrollLeft - c.x - parseInt(b.style.borderLeftWidth) + "px",
						top: f.y + d.y - e - c.y - parseInt(b.style.borderTopWidth) + "px"
					})
				}
			}
		})();
		return function() {
			var a = this,
				d;
			a.setOpt("imageScaleEnabled", !0);
			!t.ie && a.options.imageScaleEnabled && a.addListener("click", function(b, e) {
				e = e || window.event;
				var f = e.target || e.srcElement,
					h = a.selection.getRange(),
					k = h.getClosedNode();
				if (!1 === h.collapsed && "IMG" == f.tagName && k && "IMG" == k.tagName && "false" != a.body.contentEditable) {
					if (!(-1 != k.className.indexOf("edui-faked-music") || k.getAttribute("anchorname") || g.hasClass(k, "loadingclass") || g.hasClass(k, "loaderrorclass"))) {
						if (!d) {
							d = new c;
							d.init(a);
							a.ui.getDom().appendChild(d.resizer);
							var n = function(b) {
									d.hide();
									d.target && a.selection.getRange().selectNode(d.target).select()
								},
								m = function(a) {
									var b = a.target || a.srcElement;
									!b || void 0 !== b.className && -1 != b.className.indexOf("edui-editor-imagescale") || n(a)
								},
								r;
							a.addListener("afterscaleshow", function(b) {
								a.addListener("beforekeydown", n);
								a.addListener("beforemousedown", m);
								g.on(document, "keydown", n);
								g.on(document, "mousedown", m);
								a.selection.getNative().removeAllRanges()
							});
							a.addListener("afterscalehide", function(b) {
								a.removeListener("beforekeydown", n);
								a.removeListener("beforemousedown", m);
								g.un(document, "keydown", n);
								g.un(document, "mousedown", m);
								b = d.target;
								b.parentNode && a.selection.getRange().selectNode(b).select()
							});
							g.on(d.resizer, "mousedown", function(b) {
								a.selection.getNative().removeAllRanges();
								var f = b.target || b.srcElement;
								f && -1 == f.className.indexOf("edui-editor-imagescale-hand") && (r = setTimeout(function() {
									d.hide();
									d.target && a.selection.getRange().selectNode(f).select()
								}, 200))
							});
							g.on(d.resizer, "mouseup", function(a) {
								(a = a.target || a.srcElement) && -1 == a.className.indexOf("edui-editor-imagescale-hand") && clearTimeout(r)
							})
						}
						d.show(k)
					}
				} else d && "none" != d.resizer.style.display && d.hide()
			});
			t.webkit && a.addListener("click", function(b, d) {
				"IMG" == d.target.tagName && "false" != a.body.contentEditable && (new E.Range(a.document)).selectNode(d.target).select()
			})
		}
	}();
	UE.plugin.register("autolink", function() {
		return t.ie ? {} : {
			bindEvents: {
				reset: function() {},
				keydown: function(c, a) {
					var e = a.keyCode || a.which;
					if (32 == e || 13 == e) {
						for (var e = this.selection.getNative(), d = e.getRangeAt(0).cloneRange(), b, h = d.startContainer; 1 == h.nodeType && 0 < d.startOffset;) {
							h = d.startContainer.childNodes[d.startOffset - 1];
							if (!h) break;
							d.setStart(h, 1 == h.nodeType ? h.childNodes.length : h.nodeValue.length);
							d.collapse(!0);
							h = d.startContainer
						}
						do {
							if (0 == d.startOffset) {
								for (h = d.startContainer.previousSibling; h && 1 == h.nodeType;) h = h.lastChild;
								if (!h || g.isFillChar(h)) break;
								b = h.nodeValue.length
							} else h = d.startContainer, b = d.startOffset;
							d.setStart(h, b - 1);
							b = d.toString().charCodeAt(0)
						} while (160 != b && 32 != b);
						if (d.toString().replace(new RegExp(g.fillChar, "g"), "").match(/(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)) {
							for (; d.toString().length && !/^(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i.test(d.toString());) try {
								d.setStart(d.startContainer, d.startOffset + 1)
							} catch (l) {
								for (h = d.startContainer; !(next = h.nextSibling);) {
									if (g.isBody(h)) return;
									h = h.parentNode
								}
								d.setStart(next, 0)
							}
							if (!g.findParentByTagName(d.startContainer, "a", !0)) {
								b = this.document.createElement("a");
								var h = this.document.createTextNode(" "),
									f;
								this.undoManger && this.undoManger.save();
								b.appendChild(d.extractContents());
								b.href = b.innerHTML = b.innerHTML.replace(/<[^>]+>/g, "");
								f = b.getAttribute("href").replace(new RegExp(g.fillChar, "g"), "");
								f = /^(?:https?:\/\/)/ig.test(f) ? f : "http://" + f;
								b.setAttribute("_src", p.html(f));
								b.href = p.html(f);
								d.insertNode(b);
								b.parentNode.insertBefore(h, b.nextSibling);
								d.setStart(h, 0);
								d.collapse(!0);
								e.removeAllRanges();
								e.addRange(d);
								this.undoManger && this.undoManger.save()
							}
						}
					}
				}
			}
		}
	}, function() {
		function c(a) {
			if (3 == a.nodeType) return null;
			if ("A" == a.nodeName) return a;
			for (a = a.lastChild; a;) {
				if ("A" == a.nodeName) return a;
				if (3 == a.nodeType) {
					if (g.isWhitespace(a)) {
						a = a.previousSibling;
						continue
					}
					return null
				}
				a = a.lastChild
			}
		}
		var a = {
			37: 1,
			38: 1,
			39: 1,
			40: 1,
			13: 1,
			32: 1
		};
		t.ie && this.addListener("keyup", function(e, d) {
			var b = d.keyCode;
			if (a[b]) {
				var h = this.selection.getRange(),
					f = h.startContainer;
				if (13 == b) {
					for (; f && !g.isBody(f) && !g.isBlockElm(f);) f = f.parentNode;
					f && !g.isBody(f) && "P" == f.nodeName && (h = f.previousSibling) && 1 == h.nodeType && (h = c(h)) && !h.getAttribute("_href") && g.remove(h, !0)
				} else 32 == b ? 3 == f.nodeType && /^\s$/.test(f.nodeValue) && (f = f.previousSibling) && "A" == f.nodeName && !f.getAttribute("_href") && g.remove(f, !0) : (f = g.findParentByTagName(f, "a", !0)) && !f.getAttribute("_href") && (b = h.createBookmark(), g.remove(f, !0), h.moveToBookmark(b).select(!0))
			}
		})
	});
	UE.plugins.autoheight = function() {
		function c() {
			var a = this;
			clearTimeout(f);
			l || a.queryCommandState && (!a.queryCommandState || 1 == a.queryCommandState("source")) || (f = setTimeout(function() {
				for (var f = a.body.lastChild; f && 1 != f.nodeType;) f = f.previousSibling;
				f && 1 == f.nodeType && (f.style.clear = "both", h = Math.max(g.getXY(f).y + f.offsetHeight + 25, Math.max(b.minFrameHeight, b.initialFrameHeight)), h != d && (h !== parseInt(a.iframe.parentNode.style.height) && (a.iframe.parentNode.style.height = h + "px"), a.body.style.height = h + "px", d = h), g.removeStyle(f, "clear"))
			}, 50))
		}
		var a = this;
		a.autoHeightEnabled = !1 !== a.options.autoHeightEnabled;
		if (a.autoHeightEnabled) {
			var e, d = 0,
				b = a.options,
				h, f, l;
			a.addListener("fullscreenchanged", function(a, b) {
				l = b
			});
			a.addListener("destroy", function() {
				a.removeListener("contentchange afterinserthtml keyup mouseup", c)
			});
			a.enableAutoHeight = function() {
				var a = this;
				if (a.autoHeightEnabled) {
					var b = a.document;
					a.autoHeightEnabled = !0;
					e = b.body.style.overflowY;
					b.body.style.overflowY = "hidden";
					a.addListener("contentchange afterinserthtml keyup mouseup", c);
					setTimeout(function() {
						c.call(a)
					}, t.gecko ? 100 : 0);
					a.fireEvent("autoheightchanged", a.autoHeightEnabled)
				}
			};
			a.disableAutoHeight = function() {
				a.body.style.overflowY = e || "";
				a.removeListener("contentchange", c);
				a.removeListener("keyup", c);
				a.removeListener("mouseup", c);
				a.autoHeightEnabled = !1;
				a.fireEvent("autoheightchanged", a.autoHeightEnabled)
			};
			a.on("setHeight", function() {
				a.disableAutoHeight()
			});
			a.addListener("ready", function() {
				a.enableAutoHeight();
				var b;
				g.on(t.ie ? a.body : a.document, t.webkit ? "dragover" : "drop", function() {
					clearTimeout(b);
					b = setTimeout(function() {
						c.call(a)
					}, 100)
				});
				var d;
				window.onscroll = function() {
					null === d ? d = this.scrollY : 0 == this.scrollY && 0 != d && (a.window.scrollTo(0, 0), d = null)
				}
			})
		}
	};
	UE.plugins.autofloat = function() {
		function c() {
			var a = document.body.style;
			a.backgroundImage = 'url("about:blank")';
			a.backgroundAttachment = "fixed"
		}

		function a() {
			x = !0;
			m.parentNode && m.parentNode.removeChild(m);
			r.style.cssText = n
		}

		function e() {
			var b = u(d.container),
				f = d.options.toolbarTopOffset || 0;
			if (0 > b.top && b.bottom - r.offsetHeight > f) {
				var b = g.getXY(r),
					f = g.getComputedStyle(r, "position"),
					c = g.getComputedStyle(r, "left");
				r.style.width = r.offsetWidth + "px";
				r.style.zIndex = 1 * d.options.zIndex + 1;
				r.parentNode.insertBefore(m, r);
				l || k && t.ie ? ("absolute" != r.style.position && (r.style.position = "absolute"), r.style.top = (document.body.scrollTop || document.documentElement.scrollTop) - v + h + "px") : (t.ie7Compat && x && (x = !1, r.style.left = g.getXY(r).x - document.documentElement.getBoundingClientRect().left + 2 + "px"), "fixed" != r.style.position && (r.style.position = "fixed", r.style.top = h + "px", ("absolute" == f || "relative" == f) && parseFloat(c) && (r.style.left = b.x + "px")))
			} else a()
		}
		var d = this,
			b = d.getLang();
		d.setOpt({
			topOffset: 0
		});
		var h = d.options.topOffset;
		if (!1 !== d.options.autoFloatEnabled) {
			var f = UE.ui.uiUtils,
				l = t.ie && 6 >= t.version,
				k = t.quirks,
				n, m = document.createElement("div"),
				r, v, u, x = !0,
				w = p.defer(function() {
					e()
				}, t.ie ? 200 : 100, !0);
			d.addListener("destroy", function() {
				g.un(window, ["scroll", "resize"], e);
				d.removeListener("keydown", w)
			});
			d.addListener("ready", function() {
				var k;
				UE.ui ? k = 1 : (alert(b.autofloatMsg), k = 0);
				k && d.ui && (u = f.getClientRect, r = d.ui.getDom("toolbarbox"), v = u(r).top, n = r.style.cssText, m.style.height = r.offsetHeight + "px", l && c(), g.on(window, ["scroll", "resize"], e), d.addListener("keydown", w), d.addListener("beforefullscreenchange", function(b, d) {
					d && a()
				}), d.addListener("fullscreenchanged", function(a, b) {
					b || e()
				}), d.addListener("sourcemodechanged", function(a, b) {
					setTimeout(function() {
						e()
					}, 0)
				}), d.addListener("clearDoc", function() {
					setTimeout(function() {
						e()
					}, 0)
				}))
			})
		}
	};
	UE.plugins.video = function() {
		function c(a, b, c, f, l, k, g) {
			var d;
			switch (g) {
				case "image":
					d = "<img " + (f ? 'id="' + f + '"' : "") + ' width="' + b + '" height="' + c + '" _url="' + a + '" class="' + k.replace(/\bvideo-js\b/, "") + '" src="' + e.options.UEDITOR_HOME_URL + 'themes/default/images/spacer.gif" style="background:url(' + e.options.UEDITOR_HOME_URL + "themes/default/images/videologo.gif) no-repeat center center; border:1px solid gray;" + (l ? "float:" + l + ";" : "") + '" />';
					break;
				case "embed":
					d = '<embed type="application/x-shockwave-flash" class="' + k + '" pluginspage="http://www.macromedia.com/go/getflashplayer" src="' + p.html(a) + '" width="' + b + '" height="' + c + '"' + (l ? ' style="float:' + l + '"' : "") + ' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >';
					break;
				case "video":
					g = a.substr(a.lastIndexOf(".") + 1), "ogv" == g && (g = "ogg"), d = "<video" + (f ? ' id="' + f + '"' : "") + ' class="' + k + ' video-js" ' + (l ? ' style="float:' + l + '"' : "") + ' controls preload="none" width="' + b + '" height="' + c + '" src="' + a + '" data-setup="{}"><source src="' + a + '" type="video/' + g + '" /></video>'
			}
			return d
		}

		function a(a, b) {
			p.each(a.getNodesByTagName(b ? "img" : "embed video"), function(a) {
				var d = a.getAttr("class");
				if (d && -1 != d.indexOf("edui-faked-video")) {
					var e = c(b ? a.getAttr("_url") : a.getAttr("src"), a.getAttr("width"), a.getAttr("height"), null, a.getStyle("float") || "", d, b ? "embed" : "image");
					a.parentNode.replaceChild(UE.uNode.createElement(e), a)
				}
				d && -1 != d.indexOf("edui-upload-video") && (e = c(b ? a.getAttr("_url") : a.getAttr("src"), a.getAttr("width"), a.getAttr("height"), null, a.getStyle("float") || "", d, b ? "video" : "image"), a.parentNode.replaceChild(UE.uNode.createElement(e), a))
			})
		}
		var e = this;
		e.addOutputRule(function(d) {
			a(d, !0)
		});
		e.addInputRule(function(d) {
			a(d)
		});
		e.commands.insertvideo = {
			execCommand: function(a, b, h) {
				b = p.isArray(b) ? b : [b];
				if (!0 !== e.fireEvent("beforeinsertvideo", b)) {
					var d = [],
						l;
					a = 0;
					for (var k, n = b.length; a < n; a++) k = b[a], l = "upload" == h ? "edui-upload-video video-js vjs-default-skin" : "edui-faked-video", d.push(c(k.url, k.width || 420, k.height || 280, "tmpVedio" + a, null, l, "image"));
					e.execCommand("inserthtml", d.join(""), !0);
					h = this.selection.getRange();
					a = 0;
					for (n = b.length; a < n; a++) d = this.document.getElementById("tmpVedio" + a), g.removeAttributes(d, "id"), h.selectNode(d).select(), e.execCommand("imagefloat", b[a].align);
					e.fireEvent("afterinsertvideo", b)
				}
			},
			queryCommandState: function() {
				var a = e.selection.getRange().getClosedNode();
				return !a || "edui-faked-video" != a.className && -1 == a.className.indexOf("edui-upload-video") ? 0 : 1
			}
		}
	};
	(function() {
		var c = UE.UETable = function(a) {
			this.table = a;
			this.indexTable = [];
			this.selectedTds = [];
			this.cellsRange = {};
			this.update(a)
		};
		c.removeSelectedClass = function(a) {
			p.each(a, function(a) {
				g.removeClasses(a, "selectTdClass")
			})
		};
		c.addSelectedClass = function(a) {
			p.each(a, function(a) {
				g.addClass(a, "selectTdClass")
			})
		};
		c.isEmptyBlock = function(a) {
			var c = new RegExp(g.fillChar, "g");
			if (0 < a[t.ie ? "innerText" : "textContent"].replace(/^\s*$/, "").replace(c, "").length) return 0;
			for (var d in y.$isNotEmpty)
				if (y.$isNotEmpty.hasOwnProperty(d) && a.getElementsByTagName(d).length) return 0;
			return 1
		};
		c.getWidth = function(a) {
			return a ? parseInt(g.getComputedStyle(a, "width"), 10) : 0
		};
		c.getTableCellAlignState = function(a) {
			!p.isArray(a) && (a = [a]);
			var c = {},
				d = ["align", "valign"],
				b = null,
				h = !0;
			p.each(a, function(a) {
				p.each(d, function(d) {
					b = a.getAttribute(d);
					if (!c[d] && b) c[d] = b;
					else if (!c[d] || b !== c[d]) return h = !1
				});
				return h
			});
			return h ? c : null
		};
		c.getTableItemsByRange = function(a) {
			var c = a.selection.getStart();
			c && c.id && 0 === c.id.indexOf("_baidu_bookmark_start_") && c.nextSibling && (c = c.nextSibling);
			var d = (a = c && g.findParentByTagName(c, ["td", "th"], !0)) && a.parentNode,
				c = c && g.findParentByTagName(c, "caption", !0);
			return {
				cell: a,
				tr: d,
				table: c ? c.parentNode : d && d.parentNode.parentNode,
				caption: c
			}
		};
		c.getUETableBySelected = function(a) {
			return (a = c.getTableItemsByRange(a).table) && a.ueTable && a.ueTable.selectedTds.length ? a.ueTable : null
		};
		c.getDefaultValue = function(a, c) {
			var d = {
					thin: "0px",
					medium: "1px",
					thick: "2px"
				},
				b, e, f;
			if (c) l = c.getElementsByTagName("td")[0], f = g.getComputedStyle(c, "border-left-width"), b = parseInt(d[f] || f, 10), f = g.getComputedStyle(l, "padding-left"), e = parseInt(d[f] || f, 10), f = g.getComputedStyle(l, "border-left-width"), d = parseInt(d[f] || f, 10);
			else {
				c = a.document.createElement("table");
				c.insertRow(0).insertCell(0).innerHTML = "xxx";
				a.body.appendChild(c);
				var l = c.getElementsByTagName("td")[0];
				f = g.getComputedStyle(c, "border-left-width");
				b = parseInt(d[f] || f, 10);
				f = g.getComputedStyle(l, "padding-left");
				e = parseInt(d[f] || f, 10);
				f = g.getComputedStyle(l, "border-left-width");
				d = parseInt(d[f] || f, 10);
				g.remove(c)
			}
			return {
				tableBorder: b,
				tdPadding: e,
				tdBorder: d
			}
		};
		c.getUETable = function(a) {
			var e = a.tagName.toLowerCase();
			a = "td" == e || "th" == e || "caption" == e ? g.findParentByTagName(a, "table", !0) : a;
			a.ueTable || (a.ueTable = new c(a));
			return a.ueTable
		};
		c.cloneCell = function(a, c, d) {
			if (!a || p.isString(a)) return this.table.ownerDocument.createElement(a || "td");
			var b = g.hasClass(a, "selectTdClass");
			b && g.removeClasses(a, "selectTdClass");
			var e = a.cloneNode(!0);
			c && (e.rowSpan = e.colSpan = 1);
			!d && g.removeAttributes(e, "width height");
			!d && g.removeAttributes(e, "style");
			e.style.borderLeftStyle = "";
			e.style.borderTopStyle = "";
			e.style.borderLeftColor = a.style.borderRightColor;
			e.style.borderLeftWidth = a.style.borderRightWidth;
			e.style.borderTopColor = a.style.borderBottomColor;
			e.style.borderTopWidth = a.style.borderBottomWidth;
			b && g.addClass(a, "selectTdClass");
			return e
		};
		c.prototype = {
			getMaxRows: function() {
				for (var a = this.table.rows, c = 1, d = 0, b; b = a[d]; d++) {
					for (var h = 1, f = 0, l; l = b.cells[f++];) h = Math.max(l.rowSpan || 1, h);
					c = Math.max(h + d, c)
				}
				return c
			},
			getMaxCols: function() {
				for (var a = this.table.rows, c = 0, d = {}, b = 0, h; h = a[b]; b++) {
					for (var f = 0, l = 0, k; k = h.cells[l++];)
						if (f += k.colSpan || 1, k.rowSpan && 1 < k.rowSpan)
							for (var g = 1; g < k.rowSpan; g++) d["row_" + (b + g)] ? d["row_" + (b + g)]++ : d["row_" + (b + g)] = k.colSpan || 1;
					f += d["row_" + b] || 0;
					c = Math.max(f, c)
				}
				return c
			},
			getCellColIndex: function(a) {},
			getHSideCell: function(a, c) {
				try {
					var d = this.getCellInfo(a),
						b, e, f = this.selectedTds.length,
						l = this.cellsRange;
					if (!c && (f ? !l.beginColIndex : !d.colIndex) || c && (f ? l.endColIndex == this.colsNum - 1 : d.colIndex == this.colsNum - 1)) return null;
					b = f ? l.beginRowIndex : d.rowIndex;
					e = c ? f ? l.endColIndex + 1 : d.colIndex + 1 : f ? l.beginColIndex - 1 : 1 > d.colIndex ? 0 : d.colIndex - 1;
					return this.getCell(this.indexTable[b][e].rowIndex, this.indexTable[b][e].cellIndex)
				} catch (k) {}
			},
			getTabNextCell: function(a, c) {
				var d = this.getCellInfo(a),
					b = c || d.rowIndex,
					d = d.colIndex + 1 + (d.colSpan - 1),
					e;
				try {
					e = this.getCell(this.indexTable[b][d].rowIndex, this.indexTable[b][d].cellIndex)
				} catch (f) {
					try {
						b = 1 * b + 1, d = 0, e = this.getCell(this.indexTable[b][d].rowIndex, this.indexTable[b][d].cellIndex)
					} catch (l) {}
				}
				return e
			},
			getVSideCell: function(a, c, d) {
				try {
					var b = this.getCellInfo(a),
						e, f, l = this.selectedTds.length && !d,
						k = this.cellsRange;
					if (!c && 0 == b.rowIndex || c && (l ? k.endRowIndex == this.rowsNum - 1 : b.rowIndex + b.rowSpan > this.rowsNum - 1)) return null;
					e = c ? l ? k.endRowIndex + 1 : b.rowIndex + b.rowSpan : l ? k.beginRowIndex - 1 : b.rowIndex - 1;
					f = l ? k.beginColIndex : b.colIndex;
					return this.getCell(this.indexTable[e][f].rowIndex, this.indexTable[e][f].cellIndex)
				} catch (n) {}
			},
			getSameEndPosCells: function(a, c) {
				try {
					for (var d = "x" === c.toLowerCase(), b = g.getXY(a)[d ? "x" : "y"] + a["offset" + (d ? "Width" : "Height")], e = this.table.rows, f = null, l = [], k = 0; k < this.rowsNum; k++)
						for (var f = e[k].cells, n = 0, m; m = f[n++];) {
							var r = g.getXY(m)[d ? "x" : "y"] + m["offset" + (d ? "Width" : "Height")];
							if (r > b && d) break;
							if (a == m || b == r)
								if (1 == m[d ? "colSpan" : "rowSpan"] && l.push(m), d) break
						}
					return l
				} catch (v) {}
			},
			setCellContent: function(a, c) {
				a.innerHTML = c || (t.ie ? g.fillChar : "<br />")
			},
			cloneCell: c.cloneCell,
			getSameStartPosXCells: function(a) {
				try {
					var c = g.getXY(a).x + a.offsetWidth,
						d = this.table.rows,
						b;
					a = [];
					for (var h = 0; h < this.rowsNum; h++) {
						b = d[h].cells;
						for (var f = 0, l; l = b[f++];) {
							var k = g.getXY(l).x;
							if (k > c) break;
							if (k == c && 1 == l.colSpan) {
								a.push(l);
								break
							}
						}
					}
					return a
				} catch (n) {}
			},
			update: function(a) {
				this.table = a || this.table;
				this.selectedTds = [];
				this.cellsRange = {};
				this.indexTable = [];
				a = this.table.rows;
				for (var c = this.getMaxRows(), d = c - a.length, b = this.getMaxCols(); d--;) this.table.insertRow(a.length);
				this.rowsNum = c;
				this.colsNum = b;
				for (var d = 0, h = a.length; d < h; d++) this.indexTable[d] = Array(b);
				for (var d = 0, f; f = a[d]; d++) {
					var h = 0,
						l;
					for (f = f.cells; l = f[h]; h++) {
						l.rowSpan > c && (l.rowSpan = c);
						var k = h,
							n = l.rowSpan || 1;
						for (l = l.colSpan || 1; this.indexTable[d][k];) k++;
						for (var m = 0; m < n; m++)
							for (var r = 0; r < l; r++) this.indexTable[d + m][k + r] = {
								rowIndex: d,
								cellIndex: h,
								colIndex: k,
								rowSpan: n,
								colSpan: l
							}
					}
				}
				for (m = 0; m < c; m++)
					for (r = 0; r < b; r++) void 0 === this.indexTable[m][r] && (f = a[m], l = (l = f.cells[f.cells.length - 1]) ? l.cloneNode(!0) : this.table.ownerDocument.createElement("td"), this.setCellContent(l), 1 !== l.colSpan && (l.colSpan = 1), 1 !== l.rowSpan && (l.rowSpan = 1), f.appendChild(l), this.indexTable[m][r] = {
						rowIndex: m,
						cellIndex: l.cellIndex,
						colIndex: r,
						rowSpan: 1,
						colSpan: 1
					});
				a = g.getElementsByTagName(this.table, "td");
				var v = [];
				p.each(a, function(a) {
					g.hasClass(a, "selectTdClass") && v.push(a)
				});
				v.length && (c = v[v.length - 1], a = this.getCellInfo(v[0]), c = this.getCellInfo(c), this.selectedTds = v, this.cellsRange = {
					beginRowIndex: a.rowIndex,
					beginColIndex: a.colIndex,
					endRowIndex: c.rowIndex + c.rowSpan - 1,
					endColIndex: c.colIndex + c.colSpan - 1
				});
				if (!g.hasClass(this.table.rows[0], "firstRow"))
					for (g.addClass(this.table.rows[0], "firstRow"), d = 1; d < this.table.rows.length; d++) g.removeClasses(this.table.rows[d], "firstRow")
			},
			getCellInfo: function(a) {
				if (a) {
					var c = a.cellIndex;
					a = a.parentNode.rowIndex;
					for (var d = this.indexTable[a], b = this.colsNum, h = c; h < b; h++) {
						var f = d[h];
						if (f.rowIndex === a && f.cellIndex === c) return f
					}
				}
			},
			getCell: function(a, c) {
				return a < this.rowsNum && this.table.rows[a].cells[c] || null
			},
			deleteCell: function(a, c) {
				c = "number" == typeof c ? c : a.parentNode.rowIndex;
				this.table.rows[c].deleteCell(a.cellIndex)
			},
			getCellsRange: function(a, c) {
				function d(a, f, c, e) {
					var k = a,
						h = f,
						l = c,
						g = e,
						m, n, p;
					if (0 < a)
						for (n = f; n < e; n++) m = b.indexTable[a][n], p = m.rowIndex, p < a && (k = Math.min(p, k));
					if (e < b.colsNum)
						for (p = a; p < c; p++) m = b.indexTable[p][e], n = m.colIndex + m.colSpan - 1, n > e && (g = Math.max(n, g));
					if (c < b.rowsNum)
						for (n = f; n < e; n++) m = b.indexTable[c][n], p = m.rowIndex + m.rowSpan - 1, p > c && (l = Math.max(p, l));
					if (0 < f)
						for (p = a; p < c; p++) m = b.indexTable[p][f], n = m.colIndex, n < f && (h = Math.min(m.colIndex, h));
					return k != a || h != f || l != c || g != e ? d(k, h, l, g) : {
						beginRowIndex: a,
						beginColIndex: f,
						endRowIndex: c,
						endColIndex: e
					}
				}
				try {
					var b = this,
						e = b.getCellInfo(a);
					if (a === c) return {
						beginRowIndex: e.rowIndex,
						beginColIndex: e.colIndex,
						endRowIndex: e.rowIndex + e.rowSpan - 1,
						endColIndex: e.colIndex + e.colSpan - 1
					};
					var f = b.getCellInfo(c);
					return d(Math.min(e.rowIndex, f.rowIndex), Math.min(e.colIndex, f.colIndex), Math.max(e.rowIndex + e.rowSpan - 1, f.rowIndex + f.rowSpan - 1), Math.max(e.colIndex + e.colSpan - 1, f.colIndex + f.colSpan - 1))
				} catch (l) {}
			},
			getCells: function(a) {
				this.clearSelected();
				for (var c = a.beginColIndex, d = a.endRowIndex, b = a.endColIndex, h, f, l = {}, k = [], g = a.beginRowIndex; g <= d; g++)
					for (var m = c; m <= b; m++) {
						a = this.indexTable[g][m];
						h = a.rowIndex;
						f = a.colIndex;
						var r = h + "|" + f;
						if (!l[r]) {
							l[r] = 1;
							if (h < g || f < m || h + a.rowSpan - 1 > d || f + a.colSpan - 1 > b) return null;
							k.push(this.getCell(h, a.cellIndex))
						}
					}
				return k
			},
			clearSelected: function() {
				c.removeSelectedClass(this.selectedTds);
				this.selectedTds = [];
				this.cellsRange = {}
			},
			setSelected: function(a) {
				var e = this.getCells(a);
				c.addSelectedClass(e);
				this.selectedTds = e;
				this.cellsRange = a
			},
			isFullRow: function() {
				var a = this.cellsRange;
				return a.endColIndex - a.beginColIndex + 1 == this.colsNum
			},
			isFullCol: function() {
				var a = this.cellsRange,
					c = this.table.getElementsByTagName("th"),
					a = a.endRowIndex - a.beginRowIndex + 1;
				return c.length ? a == this.rowsNum || a == this.rowsNum - 1 : a == this.rowsNum
			},
			getNextCell: function(a, c, d) {
				try {
					var b = this.getCellInfo(a),
						e, f, l = this.selectedTds.length && !d,
						k = this.cellsRange;
					if (!c && 0 == b.rowIndex || c && (l ? k.endRowIndex == this.rowsNum - 1 : b.rowIndex + b.rowSpan > this.rowsNum - 1)) return null;
					e = c ? l ? k.endRowIndex + 1 : b.rowIndex + b.rowSpan : l ? k.beginRowIndex - 1 : b.rowIndex - 1;
					f = l ? k.beginColIndex : b.colIndex;
					return this.getCell(this.indexTable[e][f].rowIndex, this.indexTable[e][f].cellIndex)
				} catch (n) {}
			},
			getPreviewCell: function(a, c) {
				try {
					var d = this.getCellInfo(a),
						b, e, f = this.selectedTds.length,
						l = this.cellsRange;
					if (!c && (f ? !l.beginColIndex : !d.colIndex) || c && (f ? l.endColIndex == this.colsNum - 1 : d.rowIndex > this.colsNum - 1)) return null;
					b = c ? f ? l.beginRowIndex : 1 > d.rowIndex ? 0 : d.rowIndex - 1 : f ? l.beginRowIndex : d.rowIndex;
					e = c ? f ? l.endColIndex + 1 : d.colIndex : f ? l.beginColIndex - 1 : 1 > d.colIndex ? 0 : d.colIndex - 1;
					return this.getCell(this.indexTable[b][e].rowIndex, this.indexTable[b][e].cellIndex)
				} catch (k) {}
			},
			moveContent: function(a, e) {
				if (!c.isEmptyBlock(e))
					if (c.isEmptyBlock(a)) a.innerHTML = e.innerHTML;
					else {
						var d = a.lastChild;
						for (3 != d.nodeType && y.$block[d.tagName] || a.appendChild(a.ownerDocument.createElement("br")); d = e.firstChild;) a.appendChild(d)
					}
			},
			mergeRight: function(a) {
				var c = this.getCellInfo(a),
					d = this.indexTable[c.rowIndex][c.colIndex + c.colSpan],
					b = this.getCell(d.rowIndex, d.cellIndex);
				a.colSpan = c.colSpan + d.colSpan;
				a.removeAttribute("width");
				this.moveContent(a, b);
				this.deleteCell(b, d.rowIndex);
				this.update()
			},
			mergeDown: function(a) {
				var c = this.getCellInfo(a),
					d = this.indexTable[c.rowIndex + c.rowSpan][c.colIndex],
					b = this.getCell(d.rowIndex, d.cellIndex);
				a.rowSpan = c.rowSpan + d.rowSpan;
				a.removeAttribute("height");
				this.moveContent(a, b);
				this.deleteCell(b, d.rowIndex);
				this.update()
			},
			mergeRange: function() {
				var a = this.cellsRange,
					c = this.getCell(a.beginRowIndex, this.indexTable[a.beginRowIndex][a.beginColIndex].cellIndex);
				if ("TH" == c.tagName && a.endRowIndex !== a.beginRowIndex) var d = this.indexTable,
					a = this.getCellInfo(c),
					c = this.getCell(1, d[1][a.colIndex].cellIndex),
					a = this.getCellsRange(c, this.getCell(d[this.rowsNum - 1][a.colIndex].rowIndex, d[this.rowsNum - 1][a.colIndex].cellIndex));
				for (var b = this.getCells(a), d = 0, h; h = b[d++];) h !== c && (this.moveContent(c, h), this.deleteCell(h));
				c.rowSpan = a.endRowIndex - a.beginRowIndex + 1;
				1 < c.rowSpan && c.removeAttribute("height");
				c.colSpan = a.endColIndex - a.beginColIndex + 1;
				1 < c.colSpan && c.removeAttribute("width");
				c.rowSpan == this.rowsNum && 1 != c.colSpan && (c.colSpan = 1);
				if (c.colSpan == this.colsNum && 1 != c.rowSpan) {
					b = c.parentNode.rowIndex;
					if (this.table.deleteRow)
						for (d = b + 1, b += 1, a = c.rowSpan; d < a; d++) this.table.deleteRow(b);
					else
						for (d = 0, a = c.rowSpan - 1; d < a; d++) h = this.table.rows[b + 1], h.parentNode.removeChild(h);
					c.rowSpan = 1
				}
				this.update()
			},
			insertRow: function(a, c) {
				function d(a, b, d) {
					0 == a ? (a = (d.nextSibling || d.previousSibling).cells[a], "TH" == a.tagName && (a = b.ownerDocument.createElement("th"), a.appendChild(b.firstChild), d.insertBefore(a, b), g.remove(b))) : "TH" == b.tagName && (a = b.ownerDocument.createElement("td"), a.appendChild(b.firstChild), d.insertBefore(a, b), g.remove(b))
				}
				var b = this.colsNum,
					e = this.table.insertRow(a),
					f, l = "string" == typeof c && "TH" == c.toUpperCase();
				if (0 == a || a == this.rowsNum)
					for (var k = 0; k < b; k++) f = this.cloneCell(c, !0), this.setCellContent(f), f.getAttribute("vAlign") && f.setAttribute("vAlign", f.getAttribute("vAlign")), e.appendChild(f), l || d(k, f, e);
				else
					for (var n = this.indexTable[a], k = 0; k < b; k++) {
						var m = n[k];
						m.rowIndex < a ? (f = this.getCell(m.rowIndex, m.cellIndex), f.rowSpan = m.rowSpan + 1) : (f = this.cloneCell(c, !0), this.setCellContent(f), e.appendChild(f));
						l || d(k, f, e)
					}
				this.update();
				return e
			},
			deleteRow: function(a) {
				for (var c = this.table.rows[a], d = this.indexTable[a], b = this.colsNum, h = 0, f = 0; f < b;) {
					var l = d[f],
						k = this.getCell(l.rowIndex, l.cellIndex);
					if (1 < k.rowSpan && l.rowIndex == a) {
						l = k.cloneNode(!0);
						l.rowSpan = k.rowSpan - 1;
						l.innerHTML = "";
						k.rowSpan = 1;
						var n = a + 1,
							m = this.table.rows[n],
							n = this.getPreviewMergedCellsNum(n, f) - h;
						n < f ? (n = f - n - 1, g.insertAfter(m.cells[n], l)) : m.cells.length && m.insertBefore(l, m.cells[0]);
						h += 1
					}
					f += k.colSpan || 1
				}
				a = [];
				h = {};
				for (f = 0; f < b; f++) k = d[f].rowIndex, l = d[f].cellIndex, m = k + "_" + l, h[m] || (h[m] = 1, k = this.getCell(k, l), a.push(k));
				var r = [];
				p.each(a, function(a) {
					1 == a.rowSpan ? a.parentNode.removeChild(a) : r.push(a)
				});
				p.each(r, function(a) {
					a.rowSpan--
				});
				c.parentNode.removeChild(c);
				this.update()
			},
			insertCol: function(a, c, d) {
				function b(a, b, d) {
					0 == a ? (a = b.nextSibling || b.previousSibling, "TH" == a.tagName && (a = b.ownerDocument.createElement("th"), a.appendChild(b.firstChild), d.insertBefore(a, b), g.remove(b))) : "TH" == b.tagName && (a = b.ownerDocument.createElement("td"), a.appendChild(b.firstChild), d.insertBefore(a, b), g.remove(b))
				}
				var e = this.rowsNum,
					f = 0,
					l, k, n = parseInt((this.table.offsetWidth - 20 * (this.colsNum + 1) - (this.colsNum + 1)) / (this.colsNum + 1), 10),
					m = "string" == typeof c && "TH" == c.toUpperCase(),
					r;
				if (0 == a || a == this.colsNum)
					for (; f < e; f++) l = this.table.rows[f], r = l.cells[0 == a ? a : l.cells.length], k = this.cloneCell(c, !0), this.setCellContent(k), k.setAttribute("vAlign", k.getAttribute("vAlign")), r && k.setAttribute("width", r.getAttribute("width")), a ? g.insertAfter(l.cells[l.cells.length - 1], k) : l.insertBefore(k, l.cells[0]), m || b(f, k, l);
				else
					for (; f < e; f++) r = this.indexTable[f][a], r.colIndex < a ? (k = this.getCell(r.rowIndex, r.cellIndex), k.colSpan = r.colSpan + 1) : (l = this.table.rows[f], r = l.cells[r.cellIndex], k = this.cloneCell(c, !0), this.setCellContent(k), k.setAttribute("vAlign", k.getAttribute("vAlign")), r && k.setAttribute("width", r.getAttribute("width")), r ? l.insertBefore(k, r) : l.appendChild(k)), m || b(f, k, l);
				this.update();
				this.updateWidth(n, d || {
					tdPadding: 10,
					tdBorder: 1
				})
			},
			updateWidth: function(a, e) {
				var d = this.table,
					b = c.getWidth(d) - 2 * e.tdPadding - e.tdBorder + a;
				b < d.ownerDocument.body.offsetWidth ? d.setAttribute("width", b) : (d = g.getElementsByTagName(this.table, "td th"), p.each(d, function(b) {
					b.setAttribute("width", a)
				}))
			},
			deleteCol: function(a) {
				for (var c = this.indexTable, d = this.table.rows, b = this.table.getAttribute("width"), h = 0, f = this.rowsNum, l = {}, k = 0; k < f;) {
					var g = c[k][a],
						m = g.rowIndex + "_" + g.colIndex;
					l[m] || (l[m] = 1, m = this.getCell(g.rowIndex, g.cellIndex), h || (h = m && parseInt(m.offsetWidth / m.colSpan, 10).toFixed(0)), 1 < m.colSpan ? m.colSpan-- : d[k].deleteCell(g.cellIndex), k += g.rowSpan || 1)
				}
				this.table.setAttribute("width", b - h);
				this.update()
			},
			splitToCells: function(a) {
				var c = this;
				a = this.splitToRows(a);
				p.each(a, function(a) {
					c.splitToCols(a)
				})
			},
			splitToRows: function(a) {
				var c = this.getCellInfo(a),
					d = c.rowIndex,
					b = c.colIndex,
					h = [];
				a.rowSpan = 1;
				h.push(a);
				for (var f = d, l = d + c.rowSpan; f < l; f++)
					if (f != d) {
						var k = this.table.rows[f].insertCell(b - this.getPreviewMergedCellsNum(f, b));
						k.colSpan = c.colSpan;
						this.setCellContent(k);
						k.setAttribute("vAlign", a.getAttribute("vAlign"));
						k.setAttribute("align", a.getAttribute("align"));
						a.style.cssText && (k.style.cssText = a.style.cssText);
						h.push(k)
					}
				this.update();
				return h
			},
			getPreviewMergedCellsNum: function(a, c) {
				for (var d = this.indexTable[a], b = 0, e = 0; e < c;) var f = d[e].colSpan,
					b = b + (f - (d[e].rowIndex == a ? 1 : 0)),
					e = e + f;
				return b
			},
			splitToCols: function(a) {
				var c = (a.offsetWidth / a.colSpan - 22).toFixed(0),
					d = this.getCellInfo(a),
					b = d.rowIndex,
					h = d.colIndex,
					f = [];
				a.colSpan = 1;
				a.setAttribute("width", c);
				f.push(a);
				for (var l = h, k = h + d.colSpan; l < k; l++)
					if (l != h) {
						var n = this.table.rows[b],
							m = n.insertCell(this.indexTable[b][l].cellIndex + 1);
						m.rowSpan = d.rowSpan;
						this.setCellContent(m);
						m.setAttribute("vAlign", a.getAttribute("vAlign"));
						m.setAttribute("align", a.getAttribute("align"));
						m.setAttribute("width", c);
						a.style.cssText && (m.style.cssText = a.style.cssText);
						if ("TH" == a.tagName) {
							var r = a.ownerDocument.createElement("th");
							r.appendChild(m.firstChild);
							r.setAttribute("vAlign", a.getAttribute("vAlign"));
							r.rowSpan = m.rowSpan;
							n.insertBefore(r, m);
							g.remove(m)
						}
						f.push(m)
					}
				this.update();
				return f
			},
			isLastCell: function(a, c, d) {
				c = c || this.rowsNum;
				d = d || this.colsNum;
				a = this.getCellInfo(a);
				return a.rowIndex + a.rowSpan == c && a.colIndex + a.colSpan == d
			},
			getLastCell: function(a) {
				a = a || this.table.getElementsByTagName("td");
				this.getCellInfo(a[0]);
				var c = this,
					d = a[0],
					b = d.parentNode,
					h = 0,
					f = 0,
					l;
				p.each(a, function(a) {
					a.parentNode == b && (f += a.colSpan || 1);
					h += a.rowSpan * a.colSpan || 1
				});
				l = h / f;
				p.each(a, function(a) {
					if (c.isLastCell(a, l, f)) return d = a, !1
				});
				return d
			},
			selectRow: function(a) {
				var c = this.indexTable[a];
				a = this.getCell(c[0].rowIndex, c[0].cellIndex);
				c = this.getCell(c[this.colsNum - 1].rowIndex, c[this.colsNum - 1].cellIndex);
				a = this.getCellsRange(a, c);
				this.setSelected(a)
			},
			selectTable: function() {
				var a = this.table.getElementsByTagName("td"),
					a = this.getCellsRange(a[0], a[a.length - 1]);
				this.setSelected(a)
			},
			setBackground: function(a, c) {
				if ("string" === typeof c) p.each(a, function(a) {
					a.style.backgroundColor = c
				});
				else if ("object" === typeof c) {
					c = p.extend({
						repeat: !0,
						colorList: ["#ddd", "#fff"]
					}, c);
					for (var d = this.getCellInfo(a[0]).rowIndex, b = 0, e = c.colorList, f = function(a, b, d) {
							return a[b] ? a[b] : d ? a[b % a.length] : ""
						}, l = 0, k; k = a[l++];) {
						var g = this.getCellInfo(k);
						k.style.backgroundColor = f(e, d + b == g.rowIndex ? b : ++b, c.repeat)
					}
				}
			},
			removeBackground: function(a) {
				p.each(a, function(a) {
					a.style.backgroundColor = ""
				})
			}
		}
	})();
	(function() {
		function c(b, c) {
			var f = g.getElementsByTagName(b, "td th");
			p.each(f, function(a) {
				a.removeAttribute("width")
			});
			b.setAttribute("width", a(c, !0, d.getDefaultValue(c, b)));
			var e = [];
			setTimeout(function() {
				p.each(f, function(a) {
					1 == a.colSpan && e.push(a.offsetWidth)
				});
				p.each(f, function(a, b) {
					1 == a.colSpan && a.setAttribute("width", e[b] + "")
				})
			}, 0)
		}

		function a(a, b, d) {
			var c = a.body;
			return c.offsetWidth - (b ? 2 * parseInt(g.getComputedStyle(c, "margin-left"), 10) : 0) - 2 * d.tableBorder - (a.options.offsetWidth || 0)
		}

		function e(a) {
			if (a = b(a).cell) {
				var d = h(a);
				return d.selectedTds.length ? d.selectedTds : [a]
			}
			return []
		}
		var d = UE.UETable,
			b = function(a) {
				return d.getTableItemsByRange(a)
			},
			h = function(a) {
				return d.getUETable(a)
			};
		UE.commands.inserttable = {
			queryCommandState: function() {
				return b(this).table ? -1 : 0
			},
			execCommand: function(a, b) {
				b || (b = p.extend({}, {
					numCols: this.options.defaultCols,
					numRows: this.options.defaultRows,
					tdvalign: this.options.tdvalign
				}));
				var c = this.selection.getRange().startContainer,
					c = g.findParent(c, function(a) {
						return g.isBlockElm(a)
					}, !0) || this.body,
					f = d.getDefaultValue(this, void 0),
					c = Math.floor(c.offsetWidth / b.numCols - 2 * f.tdPadding - f.tdBorder);
				!b.tdvalign && (b.tdvalign = this.options.tdvalign);
				this.execCommand("inserthtml", function(a, b) {
					for (var d = [], c = a.numRows, f = a.numCols, k = 0; k < c; k++) {
						d.push("<tr" + (0 == k ? ' class="firstRow"' : "") + ">");
						for (var e = 0; e < f; e++) d.push('<td width="' + b + '"  vAlign="' + a.tdvalign + '" >' + (t.ie && 11 > t.version ? g.fillChar : "<br/>") + "</td>");
						d.push("</tr>")
					}
					return "<table ><tbody>" + d.join("") + "</tbody></table>"
				}(b, c))
			}
		};
		UE.commands.insertparagraphbeforetable = {
			queryCommandState: function() {
				return b(this).cell ? 0 : -1
			},
			execCommand: function() {
				var a = b(this).table;
				if (a) {
					var d = this.document.createElement("p");
					d.innerHTML = t.ie ? "&nbsp;" : "<br />";
					a.parentNode.insertBefore(d, a);
					this.selection.getRange().setStart(d, 0).setCursor()
				}
			}
		};
		UE.commands.deletetable = {
			queryCommandState: function() {
				var a = this.selection.getRange();
				return g.findParentByTagName(a.startContainer, "table", !0) ? 0 : -1
			},
			execCommand: function(a, b) {
				var d = this.selection.getRange();
				if (b = b || g.findParentByTagName(d.startContainer, "table", !0)) {
					var c = b.nextSibling;
					c || (c = g.createElement(this.document, "p", {
						innerHTML: t.ie ? g.fillChar : "<br/>"
					}), b.parentNode.insertBefore(c, b));
					g.remove(b);
					d = this.selection.getRange();
					3 == c.nodeType ? d.setStartBefore(c) : d.setStart(c, 0);
					d.setCursor(!1, !0);
					this.fireEvent("tablehasdeleted")
				}
			}
		};
		UE.commands.cellalign = {
			queryCommandState: function() {
				return e(this).length ? 0 : -1
			},
			execCommand: function(a, b) {
				var d = e(this);
				if (d.length)
					for (var c = 0, f; f = d[c++];) f.setAttribute("align", b)
			}
		};
		UE.commands.cellvalign = {
			queryCommandState: function() {
				return e(this).length ? 0 : -1
			},
			execCommand: function(a, b) {
				var d = e(this);
				if (d.length)
					for (var c = 0, f; f = d[c++];) f.setAttribute("vAlign", b)
			}
		};
		UE.commands.insertcaption = {
			queryCommandState: function() {
				var a = b(this).table;
				return a ? 0 == a.getElementsByTagName("caption").length ? 1 : -1 : -1
			},
			execCommand: function() {
				var a = b(this).table;
				if (a) {
					var d = this.document.createElement("caption");
					d.innerHTML = t.ie ? g.fillChar : "<br/>";
					a.insertBefore(d, a.firstChild);
					this.selection.getRange().setStart(d, 0).setCursor()
				}
			}
		};
		UE.commands.deletecaption = {
			queryCommandState: function() {
				var a = this.selection.getRange();
				return (a = g.findParentByTagName(a.startContainer, "table")) ? 0 == a.getElementsByTagName("caption").length ? -1 : 1 : -1
			},
			execCommand: function() {
				var a = this.selection.getRange();
				if (a = g.findParentByTagName(a.startContainer, "table")) g.remove(a.getElementsByTagName("caption")[0]), this.selection.getRange().setStart(a.rows[0].cells[0], 0).setCursor()
			}
		};
		UE.commands.inserttitle = {
			queryCommandState: function() {
				var a = b(this).table;
				return a ? (a = a.rows[0], "th" != a.cells[a.cells.length - 1].tagName.toLowerCase() ? 0 : -1) : -1
			},
			execCommand: function() {
				var a = b(this).table;
				a && h(a).insertRow(0, "th");
				a = a.getElementsByTagName("th")[0];
				this.selection.getRange().setStart(a, 0).setCursor(!1, !0)
			}
		};
		UE.commands.deletetitle = {
			queryCommandState: function() {
				var a = b(this).table;
				return a ? (a = a.rows[0], "th" == a.cells[a.cells.length - 1].tagName.toLowerCase() ? 0 : -1) : -1
			},
			execCommand: function() {
				var a = b(this).table;
				a && g.remove(a.rows[0]);
				a = a.getElementsByTagName("td")[0];
				this.selection.getRange().setStart(a, 0).setCursor(!1, !0)
			}
		};
		UE.commands.inserttitlecol = {
			queryCommandState: function() {
				var a = b(this).table;
				return a ? a.rows[a.rows.length - 1].getElementsByTagName("th").length ? -1 : 0 : -1
			},
			execCommand: function(a) {
				(a = b(this).table) && h(a).insertCol(0, "th");
				c(a, this);
				a = a.getElementsByTagName("th")[0];
				this.selection.getRange().setStart(a, 0).setCursor(!1, !0)
			}
		};
		UE.commands.deletetitlecol = {
			queryCommandState: function() {
				var a = b(this).table;
				return a ? a.rows[a.rows.length - 1].getElementsByTagName("th").length ? 0 : -1 : -1
			},
			execCommand: function() {
				var a = b(this).table;
				if (a)
					for (var d = 0; d < a.rows.length; d++) g.remove(a.rows[d].children[0]);
				c(a, this);
				a = a.getElementsByTagName("td")[0];
				this.selection.getRange().setStart(a, 0).setCursor(!1, !0)
			}
		};
		UE.commands.mergeright = {
			queryCommandState: function(a) {
				var d = b(this);
				a = d.table;
				d = d.cell;
				if (!a || !d) return -1;
				var c = h(a);
				if (c.selectedTds.length) return -1;
				var f = c.getCellInfo(d),
					e = f.colIndex + f.colSpan;
				if (e >= c.colsNum) return -1;
				c = c.indexTable[f.rowIndex][e];
				return (a = a.rows[c.rowIndex].cells[c.cellIndex]) && d.tagName == a.tagName ? c.rowIndex == f.rowIndex && c.rowSpan == f.rowSpan ? 0 : -1 : -1
			},
			execCommand: function(a) {
				a = this.selection.getRange();
				var d = a.createBookmark(!0),
					c = b(this).cell;
				h(c).mergeRight(c);
				a.moveToBookmark(d).select()
			}
		};
		UE.commands.mergedown = {
			queryCommandState: function(a) {
				var d = b(this);
				a = d.table;
				d = d.cell;
				if (!a || !d) return -1;
				var c = h(a);
				if (c.selectedTds.length) return -1;
				var f = c.getCellInfo(d),
					e = f.rowIndex + f.rowSpan;
				if (e >= c.rowsNum) return -1;
				c = c.indexTable[e][f.colIndex];
				return (a = a.rows[c.rowIndex].cells[c.cellIndex]) && d.tagName == a.tagName ? c.colIndex == f.colIndex && c.colSpan == f.colSpan ? 0 : -1 : -1
			},
			execCommand: function() {
				var a = this.selection.getRange(),
					d = a.createBookmark(!0),
					c = b(this).cell;
				h(c).mergeDown(c);
				a.moveToBookmark(d).select()
			}
		};
		UE.commands.mergecells = {
			queryCommandState: function() {
				return d.getUETableBySelected(this) ? 0 : -1
			},
			execCommand: function() {
				var a = d.getUETableBySelected(this);
				if (a && a.selectedTds.length) {
					var b = a.selectedTds[0];
					a.mergeRange();
					a = this.selection.getRange();
					g.isEmptyBlock(b) ? a.setStart(b, 0).collapse(!0) : a.selectNodeContents(b);
					a.select()
				}
			}
		};
		UE.commands.insertrow = {
			queryCommandState: function() {
				var a = b(this),
					d = a.cell;
				return d && ("TD" == d.tagName || "TH" == d.tagName && a.tr !== a.table.rows[0]) && h(a.table).rowsNum < this.options.maxRowNum ? 0 : -1
			},
			execCommand: function() {
				var a = this.selection.getRange(),
					d = a.createBookmark(!0),
					c = b(this),
					e = c.cell,
					c = c.table,
					g = h(c),
					r = g.getCellInfo(e);
				if (g.selectedTds.length)
					for (var r = g.cellsRange, v = 0, u = r.endRowIndex - r.beginRowIndex + 1; v < u; v++) g.insertRow(r.beginRowIndex, e);
				else g.insertRow(r.rowIndex, e);
				a.moveToBookmark(d).select();
				"enabled" === c.getAttribute("interlaced") && this.fireEvent("interlacetable", c)
			}
		};
		UE.commands.insertrownext = {
			queryCommandState: function() {
				var a = b(this),
					d = a.cell;
				return d && "TD" == d.tagName && h(a.table).rowsNum < this.options.maxRowNum ? 0 : -1
			},
			execCommand: function() {
				var a = this.selection.getRange(),
					d = a.createBookmark(!0),
					c = b(this),
					e = c.cell,
					c = c.table,
					g = h(c),
					r = g.getCellInfo(e);
				if (g.selectedTds.length)
					for (var r = g.cellsRange, v = 0, u = r.endRowIndex - r.beginRowIndex + 1; v < u; v++) g.insertRow(r.endRowIndex + 1, e);
				else g.insertRow(r.rowIndex + r.rowSpan, e);
				a.moveToBookmark(d).select();
				"enabled" === c.getAttribute("interlaced") && this.fireEvent("interlacetable", c)
			}
		};
		UE.commands.deleterow = {
			queryCommandState: function() {
				return b(this).cell ? 0 : -1
			},
			execCommand: function() {
				var a = b(this).cell,
					d = h(a),
					c = d.cellsRange,
					e = d.getCellInfo(a),
					m = d.getVSideCell(a),
					r = d.getVSideCell(a, !0),
					a = this.selection.getRange();
				if (p.isEmptyObject(c)) d.deleteRow(e.rowIndex);
				else
					for (var v = c.beginRowIndex; v < c.endRowIndex + 1; v++) d.deleteRow(c.beginRowIndex);
				v = d.table;
				v.getElementsByTagName("td").length ? 1 == e.rowSpan || e.rowSpan == c.endRowIndex - c.beginRowIndex + 1 ? (r || m) && a.selectNodeContents(r || m).setCursor(!1, !0) : (d = d.getCell(e.rowIndex, d.indexTable[e.rowIndex][e.colIndex].cellIndex)) && a.selectNodeContents(d).setCursor(!1, !0) : (d = v.nextSibling, g.remove(v), d && a.setStart(d, 0).setCursor(!1, !0));
				"enabled" === v.getAttribute("interlaced") && this.fireEvent("interlacetable", v)
			}
		};
		UE.commands.insertcol = {
			queryCommandState: function(a) {
				a = b(this);
				var d = a.cell;
				return d && ("TD" == d.tagName || "TH" == d.tagName && d !== a.tr.cells[0]) && h(a.table).colsNum < this.options.maxColNum ? 0 : -1
			},
			execCommand: function(a) {
				var d = this.selection.getRange(),
					c = d.createBookmark(!0);
				if (-1 != this.queryCommandState(a)) {
					a = b(this).cell;
					var f = h(a),
						e = f.getCellInfo(a);
					if (f.selectedTds.length)
						for (var e = f.cellsRange, g = 0, v = e.endColIndex - e.beginColIndex + 1; g < v; g++) f.insertCol(e.beginColIndex, a);
					else f.insertCol(e.colIndex, a);
					d.moveToBookmark(c).select(!0)
				}
			}
		};
		UE.commands.insertcolnext = {
			queryCommandState: function() {
				var a = b(this);
				return a.cell && h(a.table).colsNum < this.options.maxColNum ? 0 : -1
			},
			execCommand: function() {
				var a = this.selection.getRange(),
					d = a.createBookmark(!0),
					c = b(this).cell,
					e = h(c),
					g = e.getCellInfo(c);
				if (e.selectedTds.length)
					for (var g = e.cellsRange, r = 0, v = g.endColIndex - g.beginColIndex + 1; r < v; r++) e.insertCol(g.endColIndex + 1, c);
				else e.insertCol(g.colIndex + g.colSpan, c);
				a.moveToBookmark(d).select()
			}
		};
		UE.commands.deletecol = {
			queryCommandState: function() {
				return b(this).cell ? 0 : -1
			},
			execCommand: function() {
				var a = b(this).cell,
					d = h(a),
					c = d.cellsRange,
					e = d.getCellInfo(a),
					m = d.getHSideCell(a),
					r = d.getHSideCell(a, !0);
				if (p.isEmptyObject(c)) d.deleteCol(e.colIndex);
				else
					for (e = c.beginColIndex; e < c.endColIndex + 1; e++) d.deleteCol(c.beginColIndex);
				d = d.table;
				c = this.selection.getRange();
				d.getElementsByTagName("td").length ? g.inDoc(a, this.document) ? c.setStart(a, 0).setCursor(!1, !0) : r && g.inDoc(r, this.document) ? c.selectNodeContents(r).setCursor(!1, !0) : m && g.inDoc(m, this.document) && c.selectNodeContents(m).setCursor(!0, !0) : (a = d.nextSibling, g.remove(d), a && c.setStart(a, 0).setCursor(!1, !0))
			}
		};
		UE.commands.splittocells = {
			queryCommandState: function() {
				var a = b(this),
					d = a.cell;
				return !d || 0 < h(a.table).selectedTds.length ? -1 : d && (1 < d.colSpan || 1 < d.rowSpan) ? 0 : -1
			},
			execCommand: function() {
				var a = this.selection.getRange(),
					d = a.createBookmark(!0),
					c = b(this).cell;
				h(c).splitToCells(c);
				a.moveToBookmark(d).select()
			}
		};
		UE.commands.splittorows = {
			queryCommandState: function() {
				var a = b(this),
					d = a.cell;
				return !d || 0 < h(a.table).selectedTds.length ? -1 : d && 1 < d.rowSpan ? 0 : -1
			},
			execCommand: function() {
				var a = this.selection.getRange(),
					d = a.createBookmark(!0),
					c = b(this).cell;
				h(c).splitToRows(c);
				a.moveToBookmark(d).select()
			}
		};
		UE.commands.splittocols = {
			queryCommandState: function() {
				var a = b(this),
					d = a.cell;
				return !d || 0 < h(a.table).selectedTds.length ? -1 : d && 1 < d.colSpan ? 0 : -1
			},
			execCommand: function() {
				var a = this.selection.getRange(),
					d = a.createBookmark(!0),
					c = b(this).cell;
				h(c).splitToCols(c);
				a.moveToBookmark(d).select()
			}
		};
		UE.commands.adaptbytext = UE.commands.adaptbywindow = {
			queryCommandState: function() {
				return b(this).table ? 0 : -1
			},
			execCommand: function(a) {
				var d = b(this).table;
				d && ("adaptbywindow" == a ? c(d, this) : (a = g.getElementsByTagName(d, "td th"), p.each(a, function(a) {
					a.removeAttribute("width")
				}), d.removeAttribute("width")))
			}
		};
		UE.commands.averagedistributecol = {
			queryCommandState: function() {
				var a = d.getUETableBySelected(this);
				return a ? a.isFullRow() || a.isFullCol() ? 0 : -1 : -1
			},
			execCommand: function(a) {
				function b() {
					var a = e.table,
						b = 0,
						c = 0,
						k = d.getDefaultValue(f, a);
					if (e.isFullRow()) b = a.offsetWidth, c = e.colsNum;
					else
						for (var a = e.cellsRange.endColIndex, h, g = e.cellsRange.beginColIndex; g <= a;) h = e.selectedTds[g], b += h.offsetWidth, g += h.colSpan, c += 1;
					return Math.ceil(b / c) - 2 * k.tdBorder - 2 * k.tdPadding
				}

				function c(a) {
					p.each(g.getElementsByTagName(e.table, "th"), function(a) {
						a.setAttribute("width", "")
					});
					var b = e.isFullRow() ? g.getElementsByTagName(e.table, "td") : e.selectedTds;
					p.each(b, function(b) {
						1 == b.colSpan && b.setAttribute("width", a)
					})
				}
				var f = this,
					e = d.getUETableBySelected(f);
				e && e.selectedTds.length && c(b())
			}
		};
		UE.commands.averagedistributerow = {
			queryCommandState: function() {
				var a = d.getUETableBySelected(this);
				return !a || a.selectedTds && /th/ig.test(a.selectedTds[0].tagName) ? -1 : a.isFullRow() || a.isFullCol() ? 0 : -1
			},
			execCommand: function(a) {
				function b() {
					var a, b = 0;
					a = e.table;
					var c = d.getDefaultValue(f, a),
						k = parseInt(g.getComputedStyle(a.getElementsByTagName("td")[0], "padding-top"));
					if (e.isFullCol()) {
						var b = g.getElementsByTagName(a, "caption"),
							h = g.getElementsByTagName(a, "th"),
							l, m;
						0 < b.length && (l = b[0].offsetHeight);
						0 < h.length && (m = h[0].offsetHeight);
						b = a.offsetHeight - (l || 0) - (m || 0);
						a = 0 == h.length ? e.rowsNum : e.rowsNum - 1
					} else {
						m = e.cellsRange.beginRowIndex;
						h = e.cellsRange.endRowIndex;
						l = 0;
						for (a = g.getElementsByTagName(a, "tr"); m <= h; m++) b += a[m].offsetHeight, l += 1;
						a = l
					}
					return t.ie && 9 > t.version ? Math.ceil(b / a) : Math.ceil(b / a) - 2 * c.tdBorder - 2 * k
				}

				function c(a) {
					var b = e.isFullCol() ? g.getElementsByTagName(e.table, "td") : e.selectedTds;
					p.each(b, function(b) {
						1 == b.rowSpan && b.setAttribute("height", a)
					})
				}
				var f = this,
					e = d.getUETableBySelected(f);
				e && e.selectedTds.length && c(b())
			}
		};
		UE.commands.cellalignment = {
			queryCommandState: function() {
				return b(this).table ? 0 : -1
			},
			execCommand: function(a, b) {
				var c = d.getUETableBySelected(this);
				c ? p.each(c.selectedTds, function(a) {
					g.setAttributes(a, b)
				}) : (c = (c = this.selection.getStart()) && g.findParentByTagName(c, ["td", "th", "caption"], !0), /caption/ig.test(c.tagName) ? (c.style.textAlign = b.align, c.style.verticalAlign = b.vAlign) : g.setAttributes(c, b), this.selection.getRange().setCursor(!0))
			},
			queryCommandValue: function(a) {
				(a = b(this).cell) || (a = e(this)[0]);
				if (a) {
					var d = UE.UETable.getUETable(a).selectedTds;
					!d.length && (d = a);
					return UE.UETable.getTableCellAlignState(d)
				}
				return null
			}
		};
		UE.commands.tablealignment = {
			queryCommandState: function() {
				return t.ie && 8 > t.version ? -1 : b(this).table ? 0 : -1
			},
			execCommand: function(a, b) {
				var d = this.selection.getStart();
				(d = d && g.findParentByTagName(d, ["table"], !0)) && d.setAttribute("align", b)
			}
		};
		UE.commands.edittable = {
			queryCommandState: function() {
				return b(this).table ? 0 : -1
			},
			execCommand: function(a, b) {
				var d = this.selection.getRange();
				if (d = g.findParentByTagName(d.startContainer, "table")) d = g.getElementsByTagName(d, "td").concat(g.getElementsByTagName(d, "th"), g.getElementsByTagName(d, "caption")), p.each(d, function(a) {
					a.style.borderColor = b
				})
			}
		};
		UE.commands.edittd = {
			queryCommandState: function() {
				return b(this).table ? 0 : -1
			},
			execCommand: function(a, b) {
				var c = d.getUETableBySelected(this);
				if (c) p.each(c.selectedTds, function(a) {
					a.style.backgroundColor = b
				});
				else if (c = (c = this.selection.getStart()) && g.findParentByTagName(c, ["td", "th", "caption"], !0)) c.style.backgroundColor = b
			}
		};
		UE.commands.settablebackground = {
			queryCommandState: function() {
				return 1 < e(this).length ? 0 : -1
			},
			execCommand: function(a, b) {
				var d;
				d = e(this);
				h(d[0]).setBackground(d, b)
			}
		};
		UE.commands.cleartablebackground = {
			queryCommandState: function() {
				var a = e(this);
				if (!a.length) return -1;
				for (var b = 0, d; d = a[b++];)
					if ("" !== d.style.backgroundColor) return 0;
				return -1
			},
			execCommand: function() {
				var a = e(this);
				h(a[0]).removeBackground(a)
			}
		};
		UE.commands.interlacetable = UE.commands.uninterlacetable = {
			queryCommandState: function(a) {
				var d = b(this).table;
				if (!d) return -1;
				d = d.getAttribute("interlaced");
				return "interlacetable" == a ? "enabled" === d ? -1 : 0 : d && "disabled" !== d ? 0 : -1
			},
			execCommand: function(a, d) {
				var c = b(this).table;
				"interlacetable" == a ? (c.setAttribute("interlaced", "enabled"), this.fireEvent("interlacetable", c, d)) : (c.setAttribute("interlaced", "disabled"), this.fireEvent("uninterlacetable", c))
			}
		};
		UE.commands.setbordervisible = {
			queryCommandState: function(a) {
				return b(this).table ? 0 : -1
			},
			execCommand: function() {
				var a = b(this).table;
				console.log(a);
				console.log('a ========');

				$(a).find('td,th').css('border','1px solid #000');
				$(a).find('caption').css('border','1px dashed #000')

			}
		}
		UE.commands.setborder = {
			queryCommandState: function(a) {
				return b(this).table ? 0 : -1
			},
			execCommand: function() {

				var a = b(this).table;
				$(a).find('td,th').css('border','');
				$(a).find('caption').css('border','');

			}
		}
		
	})();
	UE.plugins.table = function() {
		function c(b, d) {
			a(b, "width", !0);
			a(b, "height", !0)
		}

		function a(a, b, d) {
			a.style[b] && (d && a.setAttribute(b, parseInt(a.style[b], 10)), a.style[b] = "")
		}

		function e(a) {
			if ("TD" == a.tagName || "TH" == a.tagName) return a;
			var b;
			return (b = g.findParentByTagName(a, "td", !0) || g.findParentByTagName(a, "th", !0)) ? b : null
		}

		function d(a) {
			var b = new RegExp(g.fillChar, "g");
			if (0 < a[t.ie ? "innerText" : "textContent"].replace(/^\s*$/, "").replace(b, "").length) return 0;
			for (var d in y.$isNotEmpty)
				if (a.getElementsByTagName(d).length) return 0;
			return 1
		}

		function b(a) {
			return a.pageX || a.pageY ? {
				x: a.pageX,
				y: a.pageY
			} : {
				x: a.clientX + z.document.body.scrollLeft - z.document.body.clientLeft,
				y: a.clientY + z.document.body.scrollTop - z.document.body.clientTop
			}
		}

		function h(a) {
			if (!ea()) try {
				var d = e(a.target || a.srcElement),
					c;
				ca && (z.body.style.webkitUserSelect = "none", 10 < Math.abs(S.x - a.clientX) || 10 < Math.abs(S.y - a.clientY)) && (q(), ca = !1, T = 0, Q(a));
				if (Y && R)
					if (T = 0, z.body.style.webkitUserSelect = "none", z.selection.getNative()[t.ie9below ? "empty" : "removeAllRanges"](), c = b(a), n(z, !0, Y, c, d), "h" == Y) {
						var h = X.style,
							l;
						var d = R,
							r = P(d);
						if (r) {
							var u = r.getSameEndPosCells(d, "x")[0],
								x = r.getSameStartPosXCells(d)[0],
								v = b(a).x,
								w = (u ? g.getXY(u).x : g.getXY(r.table).x) + 20,
								p = x ? g.getXY(x).x + x.offsetWidth - 20 : z.body.offsetWidth + 5 || parseInt(g.getComputedStyle(z.body, "width"), 10),
								w = w + 5,
								p = p - 5;
							l = v < w ? w : v > p ? p : v
						} else l = void 0;
						h.left = l + "px"
					} else {
						if ("v" == Y) {
							var I = X.style,
								F;
							a: {
								try {
									var C = g.getXY(R).y,
										ja = b(a).y;
									F = ja < C ? C : ja;
									break a
								} catch (oa) {}
								F = void 0
							}
							I.top = F + "px"
						}
					}
				else if (d) {
					if (!0 !== z.fireEvent("excludetable", d)) {
						c = b(a);
						var K = m(d, c),
							B = g.findParentByTagName(d, "table", !0);
						k(B, d, a, !0) ? !0 !== z.fireEvent("excludetable", B) && (z.body.style.cursor = "url(" + z.options.cursorpath + "h.png),pointer") : k(B, d, a) ? !0 !== z.fireEvent("excludetable", B) && (z.body.style.cursor = "url(" + z.options.cursorpath + "v.png),pointer") : (z.body.style.cursor = "text", /\d/.test(K) && (K = K.replace(/\d/, ""), d = P(d).getPreviewCell(d, "v" == K)), n(z, d ? !!K : !1, d ? K : "", c, d))
					}
				} else f(!1, B, z)
			} catch (oa) {}
		}

		function f(a, b, d) {
			a ? l(b, d) : W || setTimeout(function() {
				!W && L && L.parentNode && L.parentNode.removeChild(L)
			}, 2E3)
		}

		function l(a, b) {
			function d(d, c) {
				clearTimeout(e);
				e = setTimeout(function() {
					b.fireEvent("tableClicked", a, c)
				}, 300)
			}
			var c = g.getXY(a),
				f = a.ownerDocument;
			if (L && L.parentNode) return L;
			L = f.createElement("div");
			L.contentEditable = !1;
			L.innerHTML = "";
			L.style.cssText = "width:15px;height:15px;background-image:url(" + b.options.UEDITOR_HOME_URL + "dialogs/table/dragicon.png);position: absolute;cursor:move;top:" + (c.y - 15) + "px;left:" + c.x + "px;";
			g.unSelectable(L);
			L.onmouseover = function(a) {
				W = !0
			};
			L.onmouseout = function(a) {
				W = !1
			};
			g.on(L, "click", function(a, b) {
				d(b, this)
			});
			g.on(L, "dblclick", function(d, c) {
				clearTimeout(e);
				var f = P(a),
					k = a.rows[0].cells[0],
					h = f.getLastCell(),
					h = f.getCellsRange(k, h);
				b.selection.getRange().setStart(k, 0).setCursor(!1, !0);
				f.setSelected(h)
			});
			g.on(L, "dragstart", function(a, b) {
				g.preventDefault(b)
			});
			var e;
			f.body.appendChild(L)
		}

		function k(a, d, c, f) {
			c = b(c);
			d = m(d, c);
			return f ? (f = (f = a.getElementsByTagName("caption")[0]) ? f.offsetHeight : 0, "v1" == d && 8 > c.y - g.getXY(a).y - f) : "h1" == d && 8 > c.x - g.getXY(a).x
		}

		function n(a, b, d, c, f) {
			try {
				a.body.style.cursor = "h" == d ? "col-resize" : "v" == d ? "row-resize" : "text", t.ie && (!d || aa || G.getUETableBySelected(a) ? B(a) : (C(a, a.document), ia(d, f))), V = b
			} catch (qa) {}
		}

		function m(a, b) {
			var d = g.getXY(a);
			return d ? 5 > d.x + a.offsetWidth - b.x ? "h" : 5 > b.x - d.x ? "h1" : 5 > d.y + a.offsetHeight - b.y ? "v" : 5 > b.y - d.y ? "v1" : "" : ""
		}

		function r(a, b) {
			if (!ea())
				if (S = {
						x: b.clientX,
						y: b.clientY
					}, 2 == b.button) {
					var d = G.getUETableBySelected(z),
						c = !1;
					if (d) {
						var f = O(z, b);
						p.each(d.selectedTds, function(a) {
							a === f && (c = !0)
						});
						c ? (f = d.selectedTds[0], setTimeout(function() {
							z.selection.getRange().setStart(f, 0).setCursor(!1, !0)
						}, 0)) : (G.removeSelectedClass(g.getElementsByTagName(z.body, "th td")), d.clearSelected())
					}
				} else u(b)
		}

		function v(a) {
			T = 0;
			a = a || z.window.event;
			var d = e(a.target || a.srcElement);
			if (d) {
				var c;
				if (c = m(d, b(a)))
					if (B(z), "h1" == c && (c = "h", k(g.findParentByTagName(d, "table"), d, a) ? z.execCommand("adaptbywindow") : (d = P(d).getPreviewCell(d)) && z.selection.getRange().selectNodeContents(d).setCursor(!0, !0)), "h" == c) {
						a = P(d);
						var f = J(d, a.table, !0),
							f = w(f, "left");
						a.width = a.offsetWidth;
						var h = [],
							l = [];
						p.each(f, function(a) {
							h.push(a.offsetWidth)
						});
						p.each(f, function(a) {
							a.removeAttribute("width")
						});
						window.setTimeout(function() {
							var a = !0;
							p.each(f, function(b, d) {
								var c = b.offsetWidth;
								if (c > h[d]) return a = !1;
								l.push(c)
							});
							var b = a ? l : h;
							p.each(f, function(a, d) {
								a.width = b[d] - K()
							})
						}, 0)
					}
			}
		}

		function u(a) {
			G.removeSelectedClass(g.getElementsByTagName(z.body, "td th"));
			p.each(z.document.getElementsByTagName("table"), function(a) {
				a.ueTable = null
			});
			if (N = O(z, a)) {
				var b = g.findParentByTagName(N, "table", !0);
				(ut = P(b)) && ut.clearSelected();
				V ? x(a) : (z.document.body.style.webkitUserSelect = "", aa = !0, z.addListener("mouseover", A))
			}
		}

		function x(a) {
			t.ie && (a = I(a));
			q();
			ca = !0;
			da = setTimeout(function() {
				Q(a)
			}, 360)
		}

		function w(a, b) {
			for (var d = [], c, f = 0, e = a.length; f < e; f++)(c = a[f][b]) && d.push(c);
			return d
		}

		function q() {
			da && clearTimeout(da);
			da = null
		}

		function I(a) {
			var b = "pageX pageY clientX clientY srcElement target".split(" "),
				d = {};
			if (a)
				for (var c = 0, f, e; f = b[c]; c++)(e = a[f]) && (d[f] = e);
			return d
		}

		function Q(a) {
			ca = !1;
			if (N = a.target || a.srcElement) a = m(N, b(a)), /\d/.test(a) && (a = a.replace(/\d/, ""), N = P(N).getPreviewCell(N, "v" == a)), B(z), C(z, z.document), z.fireEvent("saveScene"), ia(a, N), aa = !0, Y = a, R = N
		}

		function U(a, b) {
			if (!ea()) {
				q();
				ca = !1;
				if (V && (T = ++T % 3, S = {
						x: b.clientX,
						y: b.clientY
					}, setTimeout(function() {
						0 < T && T--
					}, 360), 2 === T)) {
					T = 0;
					v(b);
					return
				}
				if (2 != b.button) {
					var d = this.selection.getRange(),
						c = g.findParentByTagName(d.startContainer, "table", !0),
						f = g.findParentByTagName(d.endContainer, "table", !0);
					if (c || f) c === f ? (c = g.findParentByTagName(d.startContainer, ["td", "th", "caption"], !0), f = g.findParentByTagName(d.endContainer, ["td", "th", "caption"], !0), c !== f && this.selection.clearRange()) : this.selection.clearRange();
					aa = !1;
					this.document.body.style.webkitUserSelect = "";
					if (Y && R && (this.selection.getNative()[t.ie9below ? "empty" : "removeAllRanges"](), T = 0, X = this.document.getElementById("ue_tableDragLine"))) {
						d = g.getXY(R);
						c = g.getXY(X);
						switch (Y) {
							case "h":
								ma(R, c.x - d.x - $(R).width());
								break;
							case "v":
								M(R, c.y - d.y - R.offsetHeight)
						}
						Y = "";
						R = null;
						B(this);
						this.fireEvent("saveScene");
						return
					}
					if (N)(c = (d = P(N)) ? d.selectedTds[0] : null) ? (d = new E.Range(this.document), g.isEmptyBlock(c) ? d.setStart(c, 0).setCursor(!1, !0) : d.selectNodeContents(c).shrinkBoundary().setCursor(!1, !0)) : (d = this.selection.getRange().shrinkBoundary(), d.collapsed || (c = g.findParentByTagName(d.startContainer, ["td", "th"], !0), f = g.findParentByTagName(d.endContainer, ["td", "th"], !0), (c && !f || !c && f || c && f && c !== f) && d.setCursor(!1, !0))), N = null, this.removeListener("mouseover", A);
					else if ((c = g.findParentByTagName(b.target || b.srcElement, "td", !0)) || (c = g.findParentByTagName(b.target || b.srcElement, "th", !0)), c && ("TD" == c.tagName || "TH" == c.tagName)) {
						if (!0 === this.fireEvent("excludetable", c)) return;
						d = new E.Range(this.document);
						d.setStart(c, 0).setCursor(!1, !0)
					}
					this._selectionChange(250, b)
				}
			}
		}

		function A(a, b) {
			if (!ea()) {
				var d = b.target || b.srcElement;
				Z = g.findParentByTagName(d, "td", !0) || g.findParentByTagName(d, "th", !0);
				if (N && Z && ("TD" == N.tagName && "TD" == Z.tagName || "TH" == N.tagName && "TH" == Z.tagName) && g.findParentByTagName(N, "table") == g.findParentByTagName(Z, "table"))
					if (d = P(Z), N != Z) {
						this.document.body.style.webkitUserSelect = "none";
						this.selection.getNative()[t.ie9below ? "empty" : "removeAllRanges"]();
						var c = d.getCellsRange(N, Z);
						d.setSelected(c)
					} else this.document.body.style.webkitUserSelect = "", d.clearSelected();
				b.preventDefault ? b.preventDefault() : b.returnValue = !1
			}
		}

		function ma(a, b) {
			var d = P(a);
			if (d) {
				d = d.table;
				J(a, d);
				$(d).find("tr").each(function(a) {
					0 < a && $(this).find("td,th").removeAttr("width")
				});
				$(d).find("tr:first td,tr:first th").each(function() {
					$(this).attr("width", $(this).width())
				});
				var c = g.getNodeIndex(a);
				if (a.nextSibling) {
					var f = null;
					0 < $(d).find("tr:first").find("td").size() ? f = $(d).find("tr:first td:eq(" + c + ")") : 0 < $(d).find("tr:first").find("th").size() && (f = $(d).find("tr:first th:eq(" + c + ")"));
					f && (f.attr("width", parseInt(f.width()) + b), d = f.next(), d.attr("width", parseInt(d.width()) - b))
				}
			}
		}

		function ea() {
			return "false" === z.body.contentEditable
		}

		function M(a, b) {
			if (!(10 > Math.abs(b))) {
				var d = P(a);
				if (d)
					for (var d = d.getSameEndPosCells(a, "y"), c = d[0] ? d[0].offsetHeight : 0, f = 0, e; e = d[f++];) {
						var k = b,
							h = c,
							l = parseInt(g.getComputedStyle(e, "line-height"), 10),
							k = h + k;
						e.style.height && (e.style.height = "");
						1 == e.rowSpan ? e.setAttribute("height", k < l ? l : k) : e.removeAttribute && e.removeAttribute("height")
					}
			}
		}

		function J(a, b, d) {
			b || (b = g.findParentByTagName(a, "table"));
			if (!b) return null;
			g.getNodeIndex(a);
			b = b.rows;
			for (var c = 0; a;) 1 === a.nodeType && (c += a.colSpan || 1), a = a.previousSibling;
			a = null;
			var f = [];
			p.each(b, function(a) {
				var b = 0;
				p.each(a.cells, function(a) {
					b += a.colSpan || 1;
					if (b === c) return f.push({
						left: a,
						right: a.nextSibling || null
					}), !1;
					if (b > c) return d && f.push({
						left: a
					}), !1
				})
			});
			return f
		}

		function K() {
			if (void 0 === G.tabcellSpace) {
				var a = z.document.createElement("table"),
					b = z.document.createElement("tbody"),
					d = z.document.createElement("tr"),
					c = z.document.createElement("td"),
					f = null;
				c.style.cssText = "border: 0;";
				c.width = 1;
				d.appendChild(c);
				d.appendChild(f = c.cloneNode(!1));
				b.appendChild(d);
				a.appendChild(b);
				a.style.cssText = "visibility: hidden;";
				z.body.appendChild(a);
				G.paddingSpace = c.offsetWidth - 1;
				b = a.offsetWidth;
				c.style.cssText = "";
				f.style.cssText = "";
				G.borderWidth = (a.offsetWidth - b) / 3;
				G.tabcellSpace = G.paddingSpace + G.borderWidth;
				z.body.removeChild(a)
			}
			K = function() {
				return G.tabcellSpace
			};
			return G.tabcellSpace
		}

		function C(a, b) {
			aa || (X = a.document.createElement("div"), g.setAttributes(X, {
				id: "ue_tableDragLine",
				unselectable: "on",
				contenteditable: !1,
				onresizestart: "return false",
				ondragstart: "return false",
				onselectstart: "return false",
				style: "background-color:blue;position:absolute;padding:0;margin:0;background-image:none;border:0px none;opacity:0;filter:alpha(opacity=0)"
			}), a.body.appendChild(X))
		}

		function B(a) {
			if (!aa)
				for (var b; b = a.document.getElementById("ue_tableDragLine");) g.remove(b)
		}

		function ia(a, b) {
			if (b) {
				var d = g.findParentByTagName(b, "table"),
					c = d.getElementsByTagName("caption"),
					f = d.offsetWidth,
					e = d.offsetHeight - (0 < c.length ? c[0].offsetHeight : 0),
					d = g.getXY(d),
					k = g.getXY(b);
				switch (a) {
					case "h":
						c = "height:" + e + "px;top:" + (d.y + (0 < c.length ? c[0].offsetHeight : 0)) + "px;left:" + (k.x + b.offsetWidth);
						X.style.cssText = c + "px;position: absolute;display:block;background-color:blue;width:1px;border:0; color:blue;opacity:.3;filter:alpha(opacity=30)";
						break;
					case "v":
						c = "width:" + f + "px;left:" + d.x + "px;top:" + (k.y + b.offsetHeight), X.style.cssText = c + "px;overflow:hidden;position: absolute;display:block;background-color:blue;height:1px;border:0;color:blue;opacity:.2;filter:alpha(opacity=20)"
				}
			}
		}

		function D(a, b) {
			for (var d = g.getElementsByTagName(a.body, "table"), c, f = 0, e; e = d[f++];) c = g.getElementsByTagName(e, "td"), c[0] && (b ? (c = c[0].style.borderColor.replace(/\s/g, ""), /(#ffffff)|(rgb\(255,255,255\))/ig.test(c) && g.addClass(e, "noBorderTable")) : g.removeClasses(e, "noBorderTable"))
		}

		function H(a, b, d) {
			var c = a.body;
			return c.offsetWidth - (b ? 2 * parseInt(g.getComputedStyle(c, "margin-left"), 10) : 0) - 2 * d.tableBorder - (a.options.offsetWidth || 0)
		}

		function O(a, d) {
			var c = g.findParentByTagName(d.target || d.srcElement, ["td", "th"], !0),
				f;
			if (!c) return null;
			f = m(c, b(d));
			if (!c) return null;
			if ("h1" === f && c.previousSibling) {
				f = g.getXY(c);
				var e = c.offsetWidth;
				Math.abs(f.x + e - d.clientX) > e / 3 && (c = c.previousSibling)
			} else "v1" === f && c.parentNode.previousSibling && (f = g.getXY(c), e = c.offsetHeight, Math.abs(f.y + e - d.clientY) > e / 3 && (c = c.parentNode.previousSibling.firstChild));
			return c && !0 !== a.fireEvent("excludetable", c) ? c : null
		}
		var z = this,
			da = null,
			ca = !1,
			T = 0,
			S = null,
			G = UE.UETable,
			P = function(a) {
				return G.getUETable(a)
			};
		z.ready(function() {
			var a = this,
				b = a.selection.getText;
			a.selection.getText = function() {
				var d = G.getUETableBySelected(a);
				if (d) {
					var c = "";
					p.each(d.selectedTds, function(a) {
						c += a[t.ie ? "innerText" : "textContent"]
					});
					return c
				}
				return b.call(a.selection)
			}
		});
		var N = null,
			Z = null,
			Y = "",
			V = !1,
			L = null,
			W = !1,
			X = null,
			R = null,
			aa = !1;
		z.setOpt({
			maxColNum: 20,
			maxRowNum: 100,
			defaultCols: 5,
			defaultRows: 5,
			tdvalign: "top",
			cursorpath: z.options.UEDITOR_HOME_URL + "themes/default/images/cursor_",
			tableDragable: !1,
			classList: ["ue-table-interlace-color-single", "ue-table-interlace-color-double"]
		});
		z.getUETable = P;
		var ba = {
			deletetable: 1,
			inserttable: 1,
			cellvalign: 1,
			insertcaption: 1,
			deletecaption: 1,
			inserttitle: 1,
			deletetitle: 1,
			mergeright: 1,
			mergedown: 1,
			mergecells: 1,
			insertrow: 1,
			insertrownext: 1,
			deleterow: 1,
			insertcol: 1,
			insertcolnext: 1,
			deletecol: 1,
			splittocells: 1,
			splittorows: 1,
			splittocols: 1,
			adaptbytext: 1,
			adaptbywindow: 1,
			adaptbycustomer: 1,
			insertparagraph: 1,
			insertparagraphbeforetable: 1,
			averagedistributecol: 1,
			averagedistributerow: 1
		};
		z.ready(function() {
			var a, b, l;
			z.addListener("keydown", function(c, f) {
				var e = f.keyCode || f.which;
				if (8 == e) {
					var k = G.getUETableBySelected(this);
					k && k.selectedTds.length && (k.isFullCol() ? this.execCommand("deletecol") : k.isFullRow() ? this.execCommand("deleterow") : this.fireEvent("delcells"), g.preventDefault(f));
					var h = g.findParentByTagName(this.selection.getStart(), "caption", !0),
						m = this.selection.getRange();
					m.collapsed && h && d(h) && (this.fireEvent("saveScene"), k = h.parentNode, g.remove(h), k && m.setStart(k.rows[0].cells[0], 0).setCursor(!1, !0), this.fireEvent("saveScene"))
				}
				if (46 == e && (k = G.getUETableBySelected(this))) {
					this.fireEvent("saveScene");
					for (h = 0; m = k.selectedTds[h++];) g.fillNode(this.document, m);
					this.fireEvent("saveScene");
					g.preventDefault(f)
				}
				if (13 == e) {
					e = this.selection.getRange();
					if (h = g.findParentByTagName(e.startContainer, "caption", !0)) {
						k = g.findParentByTagName(h, "table");
						e.collapsed ? h && e.setStart(k.rows[0].cells[0], 0).setCursor(!1, !0) : (e.deleteContents(), this.fireEvent("saveScene"));
						g.preventDefault(f);
						return
					}
					e.collapsed && (k = g.findParentByTagName(e.startContainer, "table")) && (m = k.rows[0].cells[0], h = g.findParentByTagName(this.selection.getStart(), ["td", "th"], !0), k = k.previousSibling, m === h && (!k || 1 == k.nodeType && "TABLE" == k.tagName) && g.isStartInblock(e) && (e = g.findParent(this.selection.getStart(), function(a) {
						return g.isBlockElm(a)
					}, !0)) && (/t(h|d)/i.test(e.tagName) || e === h.firstChild) && (this.execCommand("insertparagraphbeforetable"), g.preventDefault(f)))
				}
				if ((f.ctrlKey || f.metaKey) && "67" == f.keyCode && (a = null, k = G.getUETableBySelected(this)))
					for (e = k.selectedTds, b = k.isFullCol(), l = k.isFullRow(), a = [
							[k.cloneCell(e[0], null, !0)]
						], h = 1; m = e[h]; h++) m.parentNode !== e[h - 1].parentNode ? a.push([k.cloneCell(m, null, !0)]) : a[a.length - 1].push(k.cloneCell(m, null, !0))
			});
			z.addListener("tablehasdeleted", function() {
				n(this, !1, "", null);
				L && g.remove(L)
			});
			z.addListener("beforepaste", function(f, e) {
				var k = this,
					h = k.selection.getRange();
				if (g.findParentByTagName(h.startContainer, "caption", !0)) h = k.document.createElement("div"), h.innerHTML = e.html, e.html = h[t.ie9below ? "innerText" : "textContent"];
				else {
					var m = G.getUETableBySelected(k);
					if (a) {
						k.fireEvent("saveScene");
						var h = k.selection.getRange(),
							n = g.findParentByTagName(h.startContainer, ["td", "th"], !0),
							r, u;
						if (n) {
							m = P(n);
							if (l) {
								var x = m.getCellInfo(n).rowIndex;
								"TH" == n.tagName && x++;
								for (var h = 0, v; v = a[h++];) {
									u = m.insertRow(x++, "td");
									for (var w = 0, q; q = v[w]; w++)(n = u.cells[w]) || (n = u.insertCell(w)), n.innerHTML = q.innerHTML, q.getAttribute("width") && n.setAttribute("width", q.getAttribute("width")), q.getAttribute("vAlign") && n.setAttribute("vAlign", q.getAttribute("vAlign")), q.getAttribute("align") && n.setAttribute("align", q.getAttribute("align")), q.style.cssText && (n.style.cssText = q.style.cssText);
									for (w = 0;
										(q = u.cells[w]) && v[w]; w++) q.innerHTML = v[w].innerHTML, v[w].getAttribute("width") && q.setAttribute("width", v[w].getAttribute("width")), v[w].getAttribute("vAlign") && q.setAttribute("vAlign", v[w].getAttribute("vAlign")), v[w].getAttribute("align") && q.setAttribute("align", v[w].getAttribute("align")), v[w].style.cssText && (q.style.cssText = v[w].style.cssText)
								}
							} else {
								if (b) {
									x = m.getCellInfo(n);
									w = n = 0;
									for (v = a[0]; q = v[w++];) n += q.colSpan || 1;
									k.__hasEnterExecCommand = !0;
									for (h = 0; h < n; h++) k.execCommand("insertcol");
									k.__hasEnterExecCommand = !1;
									n = m.table.rows[0].cells[x.cellIndex];
									"TH" == n.tagName && (n = m.table.rows[1].cells[x.cellIndex])
								}
								for (h = 0; v = a[h++];) {
									r = n;
									for (w = 0; q = v[w++];) n ? (n.innerHTML = q.innerHTML, q.getAttribute("width") && n.setAttribute("width", q.getAttribute("width")), q.getAttribute("vAlign") && n.setAttribute("vAlign", q.getAttribute("vAlign")), q.getAttribute("align") && n.setAttribute("align", q.getAttribute("align")), q.style.cssText && (n.style.cssText = q.style.cssText), u = n, n = n.nextSibling) : (x = q.cloneNode(!0), g.removeAttributes(x, ["class", "rowSpan", "colSpan"]), u.parentNode.appendChild(x));
									n = m.getNextCell(r, !0, !0);
									if (!a[h]) break;
									n || (x = m.getCellInfo(r), m.table.insertRow(m.table.rows.length), m.update(), n = m.getVSideCell(r, !0))
								}
							}
							m.update()
						} else {
							m = k.document.createElement("table");
							for (h = 0; v = a[h++];) {
								u = m.insertRow(m.rows.length);
								for (w = 0; q = v[w++];) x = G.cloneCell(q, null, !0), g.removeAttributes(x, ["class"]), u.appendChild(x);
								2 == w && 1 < x.rowSpan && (x.rowSpan = 1)
							}
							h = G.getDefaultValue(k, void 0);
							h = k.body.offsetWidth - 2 * parseInt(g.getComputedStyle(k.body, "margin-left"), 10) - 2 * h.tableBorder - (k.options.offsetWidth || 0);
							k.execCommand("insertHTML", "<table  " + (b && l ? 'width="' + h + '"' : "") + ">" + m.innerHTML.replace(/>\s*</g, "><").replace(/\bth\b/gi, "td") + "</table>")
						}
						k.fireEvent("contentchange");
						k.fireEvent("saveScene");
						e.html = "";
						return !0
					}
					h = k.document.createElement("div");
					h.innerHTML = e.html;
					v = h.getElementsByTagName("table");
					g.findParentByTagName(k.selection.getStart(), "table") ? (p.each(v, function(a) {
						g.remove(a)
					}), g.findParentByTagName(k.selection.getStart(), "caption", !0) && (h.innerHTML = h[t.ie ? "innerText" : "textContent"])) : p.each(v, function(a) {
						c(a, !0);
						g.removeAttributes(a, ["style", "border"]);
						p.each(g.getElementsByTagName(a, "td"), function(a) {
							d(a) && g.fillNode(k.document, a);
							c(a, !0)
						})
					});
					e.html = h.innerHTML
				}
			});
			z.addListener("afterpaste", function() {
				p.each(g.getElementsByTagName(z.body, "table"), function(a) {
					if (a.offsetWidth > z.body.offsetWidth) {
						var b = G.getDefaultValue(z, a);
						a.style.width = z.body.offsetWidth - 2 * parseInt(g.getComputedStyle(z.body, "margin-left"), 10) - 2 * b.tableBorder - (z.options.offsetWidth || 0) + "px"
					}
				})
			});
			z.addListener("blur", function() {
				a = null
			});
			var m;
			z.addListener("keydown", function() {
				clearTimeout(m);
				m = setTimeout(function() {
					var a = z.selection.getRange();
					if (a = g.findParentByTagName(a.startContainer, ["th", "td"], !0)) {
						var b = a.parentNode.parentNode.parentNode;
						b.offsetWidth > b.getAttribute("width") && (a.style.wordBreak = "break-all")
					}
				}, 100)
			});
			z.addListener("selectionchange", function() {
				n(z, !1, "", null)
			});
			z.addListener("contentchange", function() {
				var a = this;
				B(a);
				if (!G.getUETableBySelected(a)) {
					var b = a.selection.getRange().startContainer,
						b = g.findParentByTagName(b, ["td", "th"], !0);
					p.each(g.getElementsByTagName(a.document, "table"), function(b) {
						!0 !== a.fireEvent("excludetable", b) && (b.ueTable = new G(b), b.onmouseover = function() {
							a.fireEvent("tablemouseover", b)
						}, b.onmousemove = function() {
							a.fireEvent("tablemousemove", b);
							a.options.tableDragable && f(!0, this, a);
							p.defer(function() {
								a.fireEvent("contentchange", 50)
							}, !0)
						}, b.onmouseout = function() {
							a.fireEvent("tablemouseout", b);
							n(a, !1, "", null);
							B(a)
						}, b.onclick = function(b) {
							b = a.window.event || b;
							var d = e(b.target || b.srcElement);
							if (d) {
								var c = P(d),
									f = c.table,
									h = c.getCellInfo(d),
									g = a.selection.getRange();
								k(f, d, b, !0) ? (f = c.getCell(c.indexTable[c.rowsNum - 1][h.colIndex].rowIndex, c.indexTable[c.rowsNum - 1][h.colIndex].cellIndex), b.shiftKey && c.selectedTds.length ? c.selectedTds[0] !== f ? (b = c.getCellsRange(c.selectedTds[0], f), c.setSelected(b)) : g && g.selectNodeContents(f).select() : d !== f ? (b = c.getCellsRange(d, f), c.setSelected(b)) : g && g.selectNodeContents(f).select()) : k(f, d, b) && (f = c.getCell(c.indexTable[h.rowIndex][c.colsNum - 1].rowIndex, c.indexTable[h.rowIndex][c.colsNum - 1].cellIndex), b.shiftKey && c.selectedTds.length ? c.selectedTds[0] !== f ? (b = c.getCellsRange(c.selectedTds[0], f), c.setSelected(b)) : g && g.selectNodeContents(f).select() : d !== f ? (b = c.getCellsRange(d, f), c.setSelected(b)) : g && g.selectNodeContents(f).select())
							}
						})
					});
					D(a, !0)
				}
			});
			g.on(z.document, "mousemove", h);
			g.on(z.document, "mouseout", function(a) {
				"TABLE" == (a.target || a.srcElement).tagName && n(z, !1, "", null)
			});
			z.addListener("interlacetable", function(a, b, d) {
				if (b) {
					a = b.rows;
					b = a.length;
					for (var c = 0; c < b; c++) {
						var f = d || this.options.classList;
						a[c].className = f[c] ? f[c] : f[c % f.length]
					}
				}
			});
			z.addListener("uninterlacetable", function(a, b) {
				if (b)
					for (var d = b.rows, c = this.options.classList, f = d.length, e = 0; e < f; e++) g.removeClasses(d[e], c)
			});
			z.addListener("mousedown", r);
			z.addListener("mouseup", U);
			g.on(z.body, "dragstart", function(a) {
				U.call(z, "dragstart", a)
			});
			z.addOutputRule(function(a) {
				p.each(a.getNodesByTagName("div"), function(a) {
					"ue_tableDragLine" == a.getAttr("id") && a.parentNode.removeChild(a)
				})
			});
			var u = 0;
			z.addListener("mousedown", function() {
				u = 0
			});
			z.addListener("tabkeydown", function() {
				var a = this.selection.getRange(),
					b = a.getCommonAncestor(!0, !0),
					c = g.findParentByTagName(b, "table");
				if (c) {
					if (g.findParentByTagName(b, "caption", !0))(b = g.getElementsByTagName(c, "th td")) && b.length && a.setStart(b[0], 0).setCursor(!1, !0);
					else {
						var b = g.findParentByTagName(b, ["td", "th"], !0),
							f = P(b);
						u = 1 < b.rowSpan ? u : f.getCellInfo(b).rowIndex;
						(b = f.getTabNextCell(b, u)) ? d(b) ? a.setStart(b, 0).setCursor(!1, !0) : a.selectNodeContents(b).select(): (z.fireEvent("saveScene"), z.__hasEnterExecCommand = !0, this.execCommand("insertrownext"), z.__hasEnterExecCommand = !1, a = this.selection.getRange(), a.setStart(c.rows[c.rows.length - 1].cells[0], 0).setCursor(), z.fireEvent("saveScene"))
					}
					return !0
				}
			});
			t.ie && z.addListener("selectionchange", function() {
				n(this, !1, "", null)
			});
			z.addListener("keydown", function(a, b) {
				var d = b.keyCode || b.which;
				if (8 != d && 46 != d) {
					(d = !b.ctrlKey && !b.metaKey && !b.shiftKey && !b.altKey) && G.removeSelectedClass(g.getElementsByTagName(this.body, "td"));
					var c = G.getUETableBySelected(this);
					c && d && c.clearSelected()
				}
			});
			z.addListener("beforegetcontent", function() {
				D(this, !1);
				t.ie && p.each(this.document.getElementsByTagName("caption"), function(a) {
					g.isEmptyNode(a) && (a.innerHTML = "&nbsp;")
				})
			});
			z.addListener("aftergetcontent", function() {
				D(this, !0)
			});
			z.addListener("getAllHtml", function() {
				G.removeSelectedClass(z.document.getElementsByTagName("td"))
			});
			z.addListener("fullscreenchanged", function(a, b) {
				if (!b) {
					var d = this.body.offsetWidth / document.body.offsetWidth,
						c = g.getElementsByTagName(this.body, "table");
					p.each(c, function(a) {
						if (a.offsetWidth < z.body.offsetWidth) return !1;
						var b = g.getElementsByTagName(a, "td"),
							c = [];
						p.each(b, function(a) {
							c.push(a.offsetWidth)
						});
						for (var f = 0, e; e = b[f]; f++) e.setAttribute("width", Math.floor(c[f] * d));
						a.setAttribute("width", Math.floor(H(z, !0, G.getDefaultValue(z, void 0))))
					})
				}
			});
			var x = z.execCommand;
			z.execCommand = function(a, b) {
				a = a.toLowerCase();
				var c = G.getUETableBySelected(this),
					f = new E.Range(this.document),
					e = this.commands[a] || UE.commands[a],
					k;
				if (e) {
					if (!c || ba[a] || e.notNeedUndo || this.__hasEnterExecCommand) k = x.apply(this, arguments);
					else {
						this.__hasEnterExecCommand = !0;
						this.fireEvent("beforeexeccommand", a);
						for (var c = c.selectedTds, h = e = -2, l, m, n = 0, r; r = c[n]; n++)
							if (d(r) ? f.setStart(r, 0).setCursor(!1, !0) : f.selectNode(r).select(!0), m = this.queryCommandState(a), l = this.queryCommandValue(a), -1 != m) {
								if (e !== m || h !== l) this._ignoreContentChange = !0, k = x.apply(this, arguments), this._ignoreContentChange = !1;
								e = this.queryCommandState(a);
								h = this.queryCommandValue(a);
								g.isEmptyBlock(r) && g.fillNode(this.document, r)
							}
						f.setStart(c[0], 0).shrinkBoundary(!0).setCursor(!1, !0);
						this.fireEvent("contentchange");
						this.fireEvent("afterexeccommand", a);
						this.__hasEnterExecCommand = !1;
						this._selectionChange()
					}
					return k
				}
			}
		})
	};
	UE.UETable.prototype.sortTable = function(c, a) {
		var e = this.table,
			d = e.rows,
			b = [],
			h = "TH" === d[0].cells[0].tagName,
			f = 0;
		if (this.selectedTds.length) {
			for (var g = this.cellsRange, k = g.endRowIndex + 1, n = g.beginRowIndex; n < k; n++) b[n] = d[n];
			b.splice(0, g.beginRowIndex);
			f = g.endRowIndex + 1 === this.rowsNum ? 0 : g.endRowIndex + 1
		} else
			for (n = 0, k = d.length; n < k; n++) b[n] = d[n];
		var m = {
			reversecurrent: function(a, b) {
				return 1
			},
			orderbyasc: function(a, b) {
				return (a.innerText || a.textContent).localeCompare(b.innerText || b.textContent)
			},
			reversebyasc: function(a, b) {
				return b.innerHTML.localeCompare(a.innerHTML)
			},
			orderbynum: function(a, b) {
				var d = a[t.ie ? "innerText" : "textContent"].match(/\d+/),
					c = b[t.ie ? "innerText" : "textContent"].match(/\d+/);
				d && (d = +d[0]);
				c && (c = +c[0]);
				return (d || 0) - (c || 0)
			},
			reversebynum: function(a, b) {
				var d = a[t.ie ? "innerText" : "textContent"].match(/\d+/),
					c = b[t.ie ? "innerText" : "textContent"].match(/\d+/);
				d && (d = +d[0]);
				c && (c = +c[0]);
				return (c || 0) - (d || 0)
			}
		};
		e.setAttribute("data-sort-type", a && "string" === typeof a && m[a] ? a : "");
		h && b.splice(0, 1);
		b = p.sort(b, function(b, d) {
			return a && "function" === typeof a ? a.call(this, b.cells[c], d.cells[c]) : a && "number" === typeof a ? 1 : a && "string" === typeof a && m[a] ? m[a].call(this, b.cells[c], d.cells[c]) : m.orderbyasc.call(this, b.cells[c], d.cells[c])
		});
		h = e.ownerDocument.createDocumentFragment();
		n = 0;
		for (k = b.length; n < k; n++) h.appendChild(b[n]);
		e = e.getElementsByTagName("tbody")[0];
		f ? e.insertBefore(h, d[f - g.endRowIndex + g.beginRowIndex - 1]) : e.appendChild(h)
	};
	UE.plugins.tablesort = function() {
		var c = this,
			a = UE.UETable;
		c.ready(function() {
			p.cssRule("tablesort", "table.sortEnabled tr.firstRow th,table.sortEnabled tr.firstRow td{padding-right:20px;background-repeat: no-repeat;background-position: center right;   background-image:url(" + c.options.themePath + c.options.theme + "/images/sortable.png);}", c.document);
			c.addListener("afterexeccommand", function(a, d) {
				"mergeright" != d && "mergedown" != d && "mergecells" != d || this.execCommand("disablesort")
			})
		});
		UE.commands.sorttable = {
			queryCommandState: function() {
				var c = a.getTableItemsByRange(this);
				if (!c.cell) return -1;
				for (var c = c.table.getElementsByTagName("td"), d = 0, b; b = c[d++];)
					if (1 != b.rowSpan || 1 != b.colSpan) return -1;
				return 0
			},
			execCommand: function(c, d) {
				var b = this.selection.getRange(),
					e = b.createBookmark(!0),
					f = a.getTableItemsByRange(this),
					g = f.cell,
					f = a.getUETable(f.table),
					g = f.getCellInfo(g);
				f.sortTable(g.cellIndex, d);
				b.moveToBookmark(e);
				try {
					b.select()
				} catch (k) {}
			}
		};
		UE.commands.enablesort = UE.commands.disablesort = {
			queryCommandState: function(c) {
				var d = a.getTableItemsByRange(this).table;
				if (d && "enablesort" == c)
					for (var b = g.getElementsByTagName(d, "th td"), e = 0; e < b.length; e++)
						if (1 < b[e].getAttribute("colspan") || 1 < b[e].getAttribute("rowspan")) return -1;
				return d ? "enablesort" == c ^ "sortEnabled" != d.getAttribute("data-sort") ? -1 : 0 : -1
			},
			execCommand: function(c) {
				var d = a.getTableItemsByRange(this).table;
				d.setAttribute("data-sort", "enablesort" == c ? "sortEnabled" : "sortDisabled");
				"enablesort" == c ? g.addClass(d, "sortEnabled") : g.removeClasses(d, "sortEnabled")
			}
		}
	};
	UE.plugins.contextmenu = function() {
		var c = this;
		c.setOpt("enableContextMenu", !0);
		if (!1 !== c.getOpt("enableContextMenu")) {
			var a = c.getLang("contextMenu"),
				e, d = c.options.contextMenu || [{
					label: a.selectall,
					cmdName: "selectall"
				}, {
					label: a.cleardoc,
					cmdName: "cleardoc",
					exec: function() {
						confirm(a.confirmclear) && this.execCommand("cleardoc")
					}
				}, "-", {
					label: a.unlink,
					cmdName: "unlink"
				}, "-", {
					group: a.paragraph,
					icon: "justifyjustify",
					subMenu: [{
						label: a.justifyleft,
						cmdName: "justify",
						value: "left"
					}, {
						label: a.justifyright,
						cmdName: "justify",
						value: "right"
					}, {
						label: a.justifycenter,
						cmdName: "justify",
						value: "center"
					}, {
						label: a.justifyjustify,
						cmdName: "justify",
						value: "justify"
					}]
				}, "-", {
					group: a.table,
					icon: "table",
					subMenu: [{
						label: a.inserttable,
						cmdName: "inserttable"
					}, {
						label: a.deletetable,
						cmdName: "deletetable"
					}, "-", {
						label: a.deleterow,
						cmdName: "deleterow"
					}, {
						label: a.deletecol,
						cmdName: "deletecol"
					}, {
						label: a.insertcol,
						cmdName: "insertcol"
					}, {
						label: a.insertcolnext,
						cmdName: "insertcolnext"
					}, {
						label: a.insertrow,
						cmdName: "insertrow"
					}, {
						label: a.insertrownext,
						cmdName: "insertrownext"
					}, "-", {
						label: a.insertcaption,
						cmdName: "insertcaption"
					}, {
						label: a.deletecaption,
						cmdName: "deletecaption"
					}, {
						label: a.inserttitle,
						cmdName: "inserttitle"
					}, {
						label: a.deletetitle,
						cmdName: "deletetitle"
					}, {
						label: a.inserttitlecol,
						cmdName: "inserttitlecol"
					}, {
						label: a.deletetitlecol,
						cmdName: "deletetitlecol"
					}, "-", {
						label: a.mergecells,
						cmdName: "mergecells"
					}, {
						label: a.mergeright,
						cmdName: "mergeright"
					}, {
						label: a.mergedown,
						cmdName: "mergedown"
					}, "-", {
						label: a.splittorows,
						cmdName: "splittorows"
					}, {
						label: a.splittocols,
						cmdName: "splittocols"
					}, {
						label: a.splittocells,
						cmdName: "splittocells"
					}, "-", {
						label: a.averageDiseRow,
						cmdName: "averagedistributerow"
					}, {
						label: a.averageDisCol,
						cmdName: "averagedistributecol"
					}, "-", {
						label: a.edittd,
						cmdName: "edittd",
						exec: function() {
							UE.ui.edittd && new UE.ui.edittd(this);
							this.getDialog("edittd").open()
						}
					}, {
						label: a.edittable,
						cmdName: "edittable",
						exec: function() {
							UE.ui.edittable && new UE.ui.edittable(this);
							this.getDialog("edittable").open()
						}
					}, {
						label: a.setbordervisible,
						cmdName: "setbordervisible"
					},{
						label: a.setborder,
						cmdName: "setborder"
					}]
				}, {
					group: a.tablesort,
					icon: "tablesort",
					subMenu: [{
						label: a.enablesort,
						cmdName: "enablesort"
					}, {
						label: a.disablesort,
						cmdName: "disablesort"
					}, "-", {
						label: a.reversecurrent,
						cmdName: "sorttable",
						value: "reversecurrent"
					}, {
						label: a.orderbyasc,
						cmdName: "sorttable",
						value: "orderbyasc"
					}, {
						label: a.reversebyasc,
						cmdName: "sorttable",
						value: "reversebyasc"
					}, {
						label: a.orderbynum,
						cmdName: "sorttable",
						value: "orderbynum"
					}, {
						label: a.reversebynum,
						cmdName: "sorttable",
						value: "reversebynum"
					}]
				}, {
					group: a.borderbk,
					icon: "borderBack",
					subMenu: [{
						label: a.setcolor,
						cmdName: "interlacetable",
						exec: function() {
							this.execCommand("interlacetable")
						}
					}, {
						label: a.unsetcolor,
						cmdName: "uninterlacetable",
						exec: function() {
							this.execCommand("uninterlacetable")
						}
					}, {
						label: a.setbackground,
						cmdName: "settablebackground",
						exec: function() {
							this.execCommand("settablebackground", {
								repeat: !0,
								colorList: ["#bbb", "#ccc"]
							})
						}
					}, {
						label: a.unsetbackground,
						cmdName: "cleartablebackground",
						exec: function() {
							this.execCommand("cleartablebackground")
						}
					}, {
						label: a.redandblue,
						cmdName: "settablebackground",
						exec: function() {
							this.execCommand("settablebackground", {
								repeat: !0,
								colorList: ["red", "blue"]
							})
						}
					}, {
						label: a.threecolorgradient,
						cmdName: "settablebackground",
						exec: function() {
							this.execCommand("settablebackground", {
								repeat: !0,
								colorList: ["#aaa", "#bbb", "#ccc"]
							})
						}
					}]
				}, {
					group: a.aligntd,
					icon: "aligntd",
					subMenu: [{
						cmdName: "cellalignment",
						value: {
							align: "left",
							vAlign: "top"
						}
					}, {
						cmdName: "cellalignment",
						value: {
							align: "center",
							vAlign: "top"
						}
					}, {
						cmdName: "cellalignment",
						value: {
							align: "right",
							vAlign: "top"
						}
					}, {
						cmdName: "cellalignment",
						value: {
							align: "left",
							vAlign: "middle"
						}
					}, {
						cmdName: "cellalignment",
						value: {
							align: "center",
							vAlign: "middle"
						}
					}, {
						cmdName: "cellalignment",
						value: {
							align: "right",
							vAlign: "middle"
						}
					}, {
						cmdName: "cellalignment",
						value: {
							align: "left",
							vAlign: "bottom"
						}
					}, {
						cmdName: "cellalignment",
						value: {
							align: "center",
							vAlign: "bottom"
						}
					}, {
						cmdName: "cellalignment",
						value: {
							align: "right",
							vAlign: "bottom"
						}
					}]
				}, {
					group: a.aligntable,
					icon: "aligntable",
					subMenu: [{
						cmdName: "tablealignment",
						className: "left",
						label: a.tableleft,
						value: "left"
					}, {
						cmdName: "tablealignment",
						className: "center",
						label: a.tablecenter,
						value: "center"
					}, {
						cmdName: "tablealignment",
						className: "right",
						label: a.tableright,
						value: "right"
					}]
				}];
			if (d.length) {
				var b = UE.ui.uiUtils;
				c.addListener("contextmenu", function(h, f) {
					var l = b.getViewportOffsetByEvent(f);
					c.fireEvent("beforeselectionchange");
					e && e.destroy();
					for (var k = 0, n, m = []; n = d[k]; k++) {
						var r;
						(function(b) {
							if ("-" == b)(r = m[m.length - 1]) && "-" !== r && m.push("-");
							else if (b.hasOwnProperty("group")) {
								for (var d = 0, f, e = []; f = b.subMenu[d]; d++)(function(a) {
									"-" == a ? (r = e[e.length - 1]) && "-" !== r ? e.push("-") : e.splice(e.length - 1) : (c.commands[a.cmdName] || UE.commands[a.cmdName] || a.query) && -1 < (a.query ? a.query() : c.queryCommandState(a.cmdName)) && e.push({
										label: a.label || c.getLang("contextMenu." + a.cmdName + (a.value || "")) || "",
										className: "edui-for-" + a.cmdName + (a.className ? " edui-for-" + a.cmdName + "-" + a.className : ""),
										onclick: a.exec ?
											function() {
												a.exec.call(c)
											} : function() {
												c.execCommand(a.cmdName, a.value)
											}
									})
								})(f);
								e.length && m.push({
									label: function() {
										switch (b.icon) {
											case "table":
												return c.getLang("contextMenu.table");
											case "justifyjustify":
												return c.getLang("contextMenu.paragraph");
											case "aligntd":
												return c.getLang("contextMenu.aligntd");
											case "aligntable":
												return c.getLang("contextMenu.aligntable");
											case "tablesort":
												return a.tablesort;
											case "borderBack":
												return a.borderbk;
											default:
												return ""
										}
									}(),
									className: "edui-for-" + b.icon,
									subMenu: {
										items: e,
										editor: c
									}
								})
							} else(c.commands[b.cmdName] || UE.commands[b.cmdName] || b.query) && -1 < (b.query ? b.query.call(c) : c.queryCommandState(b.cmdName)) && m.push({
								label: b.label || c.getLang("contextMenu." + b.cmdName),
								className: "edui-for-" + (b.icon ? b.icon : b.cmdName + (b.value || "")),
								onclick: b.exec ?
									function() {
										b.exec.call(c)
									} : function() {
										c.execCommand(b.cmdName, b.value)
									}
							})
						})(n)
					}
					"-" == m[m.length - 1] && m.pop();
					e = new UE.ui.Menu({
						items: m,
						className: "edui-contextmenu",
						editor: c
					});
					e.render();
					e.showAt(l);
					c.fireEvent("aftershowcontextmenu", e);
					g.preventDefault(f);
					if (t.ie) {
						var v;
						try {
							v = c.selection.getNative().createRange()
						} catch (u) {
							return
						}
						v.item && (new E.Range(c.document)).selectNode(v.item(0)).select(!0, !0)
					}
				});
				c.addListener("aftershowcontextmenu", function(a, b) {
					if (c.zeroclipboard) {
						var d = b.items,
							f;
						for (f in d) "edui-for-copy" == d[f].className && c.zeroclipboard.clip(d[f].getDom())
					}
				})
			}
		}
	};
	UE.plugins.shortcutmenu = function() {
		var c = this,
			a, e = c.options.shortcutMenu || [];
		e.length && (c.addListener("mousedown", function(a, b) {
			b.shiftKey || b.ctrlKey || b.altKey || c.selection.clearRange()
		}), c.addListener("mouseup", function(d, b) {
			var c = this,
				f = {
					type: d,
					target: b.target || b.srcElement,
					screenX: b.screenX,
					screenY: b.screenY,
					clientX: b.clientX,
					clientY: b.clientY
				};
			setTimeout(function() {
				var k = c.selection.getRange();
				if (!1 === k.collapsed || "contextmenu" == d) k = k.getClosedNode(), k && "IMG" == k.tagName || (a || (a = new q.editor.ui.ShortCutMenu({
					editor: c,
					items: e,
					theme: c.options.theme,
					className: "edui-shortcutmenu"
				}), a.render(), c.fireEvent("afterrendershortcutmenu", a)), q.editor.ui.Popup.postHide(b), a.show(f, !!UE.plugins.contextmenu))
			});
			if ("contextmenu" == d && (g.preventDefault(b), t.ie9below)) {
				var l;
				try {
					l = c.selection.getNative().createRange()
				} catch (k) {
					return
				}
				l.item && (new E.Range(c.document)).selectNode(l.item(0)).select(!0, !0)
			}
		}), c.addListener("keydown", function(d) {
			"keydown" == d && a && !a.isHidden && a.hide()
		}))
	};
	UE.plugins.basestyle = function() {
		var c = {
				bold: ["strong", "b"],
				italic: ["em", "i"],
				subscript: ["sub"],
				superscript: ["sup"]
			},
			a = function(a, d) {
				return g.filterNodeList(a.selection.getStartElementPath(), d)
			},
			e = this;
		e.addshortcutkey({
			Bold: "ctrl+66",
			Italic: "ctrl+73",
			Underline: "ctrl+85"
		});
		e.addInputRule(function(a) {
			p.each(a.getNodesByTagName("b i"), function(a) {
				switch (a.tagName) {
					case "b":
						a.tagName = "strong";
						break;
					case "i":
						a.tagName = "em"
				}
			})
		});
		for (var d in c)(function(b, d) {
			e.commands[b] = {
				execCommand: function(b) {
					var c = e.selection.getRange(),
						f = a(this, d);
					if (c.collapsed) {
						if (f) b = e.document.createTextNode(""), c.insertNode(b).removeInlineStyle(d), c.setStartBefore(b), g.remove(b);
						else {
							f = c.document.createElement(d[0]);
							if ("superscript" == b || "subscript" == b) b = e.document.createTextNode(""), c.insertNode(b).removeInlineStyle(["sub", "sup"]).setStartBefore(b).collapse(!0);
							c.insertNode(f).setStart(f, 0)
						}
						c.collapse(!0)
					} else {
						if ("superscript" == b || "subscript" == b) f && f.tagName.toLowerCase() == b || c.removeInlineStyle(["sub", "sup"]);
						f ? c.removeInlineStyle(d) : c.applyInlineStyle(d[0])
					}
					c.select()
				},
				queryCommandState: function() {
					return a(this, d) ? 1 : 0
				}
			}
		})(d, c[d])
	};
	UE.plugins.elementpath = function() {
		var c, a, e = this;
		e.setOpt("elementPathEnabled", !0);
		e.options.elementPathEnabled && (e.commands.elementpath = {
			execCommand: function(d, b) {
				var h = a[b],
					f = e.selection.getRange();
				c = 1 * b;
				f.selectNode(h).select()
			},
			queryCommandValue: function() {
				var d = [].concat(this.selection.getStartElementPath()).reverse(),
					b = [];
				a = d;
				for (var e = 0, f; f = d[e]; e++)
					if (3 != f.nodeType) {
						var g = f.tagName.toLowerCase();
						"img" == g && f.getAttribute("anchorname") && (g = "anchor");
						b[e] = g;
						if (c == e) {
							c = -1;
							break
						}
					}
				return b
			}
		})
	};
	UE.plugins.formatmatch = function() {
		function c(h, f) {
			if (t.webkit) var l = "IMG" == f.target.tagName ? f.target : null;
			a.undoManger && a.undoManger.save();
			var k = a.selection.getRange(),
				l = l || k.getClosedNode();
			if (d && l && "IMG" == l.tagName) l.style.cssText += ";float:" + (d.style.cssFloat || d.style.styleFloat || "none") + ";display:" + (d.style.display || "inline"), d = null;
			else if (!d) {
				if (k.collapsed) {
					var n = a.document.createTextNode("match");
					k.insertNode(n).select()
				}
				a.__hasEnterExecCommand = !0;
				k = a.options.removeFormatAttributes;
				a.options.removeFormatAttributes = "";
				a.execCommand("removeformat");
				a.options.removeFormatAttributes = k;
				a.__hasEnterExecCommand = !1;
				k = a.selection.getRange();
				e.length && (l = k, n && l.selectNode(n), l.applyInlineStyle(e[e.length - 1].tagName, null, e));
				n && k.setStartBefore(n).collapse(!0);
				k.select();
				n && g.remove(n)
			}
			a.undoManger && a.undoManger.save();
			a.removeListener("mouseup", c);
			b = 0
		}
		var a = this,
			e = [],
			d, b = 0;
		a.addListener("reset", function() {
			e = [];
			b = 0
		});
		a.commands.formatmatch = {
			execCommand: function(h) {
				if (b) b = 0, e = [], a.removeListener("mouseup", c);
				else {
					h = a.selection.getRange();
					d = h.getClosedNode();
					if (!d || "IMG" != d.tagName) {
						h.collapse(!0).shrinkBoundary();
						e = g.findParents(h.startContainer, !0, function(a) {
							return !g.isBlockElm(a) && 1 == a.nodeType
						});
						h = 0;
						for (var f; f = e[h]; h++)
							if ("A" == f.tagName) {
								e.splice(h, 1);
								break
							}
					}
					a.addListener("mouseup", c);
					b = 1
				}
			},
			queryCommandState: function() {
				return b
			},
			notNeedUndo: 1
		}
	};
	UE.plugin.register("searchreplace", function() {
		function c(a) {
			return (3 == a.nodeType ? a.nodeValue : a[t.ie ? "innerText" : "textContent"]).replace(g.fillChar, "")
		}

		function a(b, d, e) {
			var f = 0;
			b = b.firstChild;
			for (var k; b;) {
				if (3 == b.nodeType) {
					if (k = c(b).replace(/(^[\t\r\n]+)|([\t\r\n]+$)/, "").length, f += k, f >= d) return {
						node: b,
						index: k - (f - d)
					}
				} else if (!y.$empty[b.tagName] && (k = c(b).replace(/(^[\t\r\n]+)|([\t\r\n]+$)/, "").length, f += k, f >= d && (k = a(b, k - (f - d), e)))) return k;
				b = g.getNextDomNode(b)
			}
		}

		function e(f, e) {
			var k = h || f.selection.getRange(),
				l, m = e.searchStr,
				r = f.document.createElement("span");
			r.innerHTML = "$$ueditor_searchreplace_key$$";
			k.shrinkBoundary(!0);
			if (!k.collapsed) {
				k.select();
				var v = f.selection.getText();
				if ((new RegExp("^" + e.searchStr + "$", e.casesensitive ? "" : "i")).test(v)) {
					if (void 0 != e.replaceStr) return m = e.replaceStr, m = d.document.createTextNode(m), k.deleteContents().insertNode(m), k.select(), !0;
					k.collapse(-1 == e.dir)
				}
			}
			k.insertNode(r);
			k.enlargeToBlockElm(!0);
			l = k.startContainer;
			v = c(l).indexOf("$$ueditor_searchreplace_key$$");
			k.setStartBefore(r);
			g.remove(r);
			a: {
				var r = l,
					u;
				l = e.all || 1 == e.dir ? "getNextDomNode" : "getPreDomNode";
				g.isBody(r) && (r = r.firstChild);
				for (; r;) {
					u = c(r);
					b: {
						var x = u;
						u = v;
						var w = e.searchStr,
							p = new RegExp(w, "g" + (e.casesensitive ? "" : "i"));
						if (-1 == e.dir) {
							if (x = x.substr(0, u), x = x.split("").reverse().join(""), w = w.split("").reverse().join(""), x = p.exec(x)) {
								u = u - x.index - w.length;
								break b
							}
						} else if (x = x.substr(u), x = p.exec(x)) {
							u = x.index + u;
							break b
						}
						u = -1
					}
					if (-1 != u) {
						v = {
							node: r,
							index: u
						};
						break a
					}
					for (r = g[l](r); r && b[r.nodeName.toLowerCase()];) r = g[l](r, !0);
					r && (v = -1 == e.dir ? c(r).length : 0)
				}
				v = void 0
			}
			if (v) return r = a(v.node, v.index, m),
				m = a(v.node, v.index + m.length, m),
				k.setStart(r.node, r.index).setEnd(m.node, m.index),
				void 0 !== e.replaceStr && (m = e.replaceStr, m = d.document.createTextNode(m), k.deleteContents().insertNode(m)),
				k.select(), !0;
			k.setCursor()
		}
		var d = this,
			b = {
				table: 1,
				tbody: 1,
				tr: 1,
				ol: 1,
				ul: 1
			},
			h = null;
		return {
			commands: {
				searchreplace: {
					execCommand: function(a, b) {
						p.extend(b, {
							all: !1,
							casesensitive: !1,
							dir: 1
						}, !0);
						var c = 0;
						if (b.all) {
							h = null;
							var f = d.selection.getRange(),
								g = d.body.firstChild;
							g && 1 == g.nodeType ? (f.setStart(g, 0), f.shrinkBoundary(!0)) : 3 == g.nodeType && f.setStartBefore(g);
							f.collapse(!0).select(!0);
							for (void 0 !== b.replaceStr && d.fireEvent("saveScene"); e(this, b);) c++, h = d.selection.getRange(), h.collapse(-1 == b.dir)
						} else void 0 !== b.replaceStr && d.fireEvent("saveScene"), e(this, b) && (c++, h = d.selection.getRange(), h.collapse(-1 == b.dir));
						c && d.fireEvent("saveScene");
						return c
					},
					notNeedUndo: 1
				}
			},
			bindEvents: {
				clearlastSearchResult: function() {
					h = null
				}
			}
		}
	});
	UE.commands.insertparagraph = {
		execCommand: function(c, a) {
			for (var e = this.selection.getRange(), d = e.startContainer, b; d && !g.isBody(d);) b = d, d = d.parentNode;
			if (b) {
				d = this.document.createElement("section");
				d.setAttribute("class", "_135editor");
				d.setAttribute("data-role", "paragraph");
				var h = this.document.createElement("p");
				h.appendChild(this.document.createElement("br"));
				d.appendChild(h);
				a ? b.parentNode.insertBefore(d, b) : b.parentNode.insertBefore(d, b.nextSibling);
				e.setStart(h, 0).setCursor(!1, !0)
			}
		}
	};
	UE.plugin.register("autoupload", function() {
		return;
		function c(a, c) {
			var d, b, e, f, l, k, n, m, r = /image\/\w+/i.test(a.type) ? "image" : "file",
				v = "loading_" + (+new Date).toString(36);
			d = c.getOpt(r + "FieldName");
			b = c.getOpt(r + "UrlPrefix");
			e = c.getOpt(r + "MaxSize");
			f = c.getOpt(r + "AllowFiles");
			l = c.getActionUrl(c.getOpt(r + "ActionName"));
			n = function(a) {
				var b = c.document.getElementById(v);
				b && g.remove(b);
				c.fireEvent("showmessage", {
					id: v,
					content: a,
					type: "error",
					timeout: 4E3
				})
			};
			"image" == r ? (k = '<img class="loadingclass" id="' + v + '" src="' + c.options.themePath + c.options.theme + '/images/spacer.gif">', m = function(a) {
				var d = b + a.url,
					f = c.document.getElementById(v);
				f && (g.removeClasses(f, "loadingclass"), f.setAttribute("src", d), f.setAttribute("_src", d), f.setAttribute("alt", a.original || ""), f.removeAttribute("id"), c.trigger("contentchange", f))
			}) : (k = '<p><img class="loadingclass" id="' + v + '" src="' + c.options.themePath + c.options.theme + '/images/spacer.gif"></p>', m = function(a) {
				a = b + a.url;
				var d = c.document.getElementById(v),
					f = c.selection.getRange(),
					e = f.createBookmark();
				f.selectNode(d).select();
				c.execCommand("insertfile", {
					url: a
				});
				f.moveToBookmark(e).select()
			});
			c.execCommand("inserthtml", k);
			c.getOpt(r + "ActionName") ? a.size > e ? n(c.getLang("autoupload.exceedSizeError")) : (e = a.name ? a.name.substr(a.name.lastIndexOf(".")) : "") && "image" != r || f && -1 == (f.join("") + ".").indexOf(e.toLowerCase() + ".") ? n(c.getLang("autoupload.exceedTypeError")) : (f = new XMLHttpRequest, r = new FormData, e = p.serializeParam(c.queryCommandValue("serverparam")) || "", l = p.formatUrl(l + (-1 == l.indexOf("?") ? "?" : "&") + e), r.append(d, a, a.name || "blob." + a.type.substr(6)), r.append("type", "ajax"), f.open("post", l, !0), f.setRequestHeader("X-Requested-With", "XMLHttpRequest"), f.addEventListener("load", function(a) {
				try {
					var b = (new Function("return " + p.trim(a.target.response)))();
					"SUCCESS" == b.state && b.url ? m(b) : n(b.state)
				} catch (w) {
					n(c.getLang("autoupload.loadError"))
				}
			}), f.send(r)) : n(c.getLang("autoupload.errorLoadConfig"))
		}
		return {
			outputRule: function(a) {
				p.each(a.getNodesByTagName("img"), function(a) {
					/\b(loaderrorclass)|(bloaderrorclass)\b/.test(a.getAttr("class")) && a.parentNode.removeChild(a)
				});
				p.each(a.getNodesByTagName("p"), function(a) {
					/\bloadpara\b/.test(a.getAttr("class")) && a.parentNode.removeChild(a)
				})
			},
			bindEvents: {
				defaultOptions: {
					enableDragUpload: !0,
					enablePasteUpload: !0
				},
				ready: function(a) {
					var e = this;
					if (window.FormData && window.FileReader) {
						a = function(a) {
							var b = !1,
								d;
							if (d = "paste" == a.type ? a.clipboardData && a.clipboardData.items && 1 == a.clipboardData.items.length && /^image\//.test(a.clipboardData.items[0].type) ? a.clipboardData.items : null : a.dataTransfer && a.dataTransfer.files ? a.dataTransfer.files : null) {
								for (var f = d.length, g; f--;) g = d[f], g.getAsFile && (g = g.getAsFile()), g && 0 < g.size && (c(g, e), b = !0);
								b && a.preventDefault()
							}
						};
						if (!1 !== e.getOpt("enablePasteUpload")) g.on(e.body, "paste ", a);
						if (!1 !== e.getOpt("enableDragUpload")) g.on(e.body, "drop", a), g.on(e.body, "dragover", function(a) {
							"Files" == a.dataTransfer.types[0] && a.preventDefault()
						});
						else if (t.gecko) g.on(e.body, "drop", function(a) {
							a.dataTransfer && a.dataTransfer.files && a.dataTransfer.files && a.preventDefault()
						});
						p.cssRule("loading", ".loadingclass{display:inline-block;cursor:default;background: url('" + this.options.themePath + this.options.theme + "/images/loading.gif') no-repeat center center transparent;border:1px solid #cccccc;margin-left:1px;height: 22px;width: 22px;}\n.loaderrorclass{display:inline-block;cursor:default;background: url('" + this.options.themePath + this.options.theme + "/images/loaderror.png') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}", this.document)
					}
				}
			}
		}
	});
	UE.plugin.register("autosave", function() {
		function c(b) {
			var c;
			20 > new Date - e || (b.hasContents() ? (e = new Date, b._saveFlag = null, c = a.body.innerHTML, !1 !== b.fireEvent("beforeautosave", {
				content: c
			}) && (a.setPreferences(d, c), b.fireEvent("afterautosave", {
				content: c
			}))) : d && a.removePreferences(d))
		}
		var a = this,
			e = new Date,
			d = null;
		return {
			defaultOptions: {
				saveInterval: 500,
				enableAutoSave: !0
			},
			bindEvents: {
				ready: function() {
					var b;
					b = a.key ? a.key + "-drafts-data" : (a.container.parentNode.id || "ue-common") + "-drafts-data";
					d = (location.protocol + location.host + location.pathname).replace(/[.:\/]/g, "_") + b
				},
				contentchange: function() {
					a.getOpt("enableAutoSave") && d && (a._saveFlag && window.clearTimeout(a._saveFlag), 0 < a.options.saveInterval ? a._saveFlag = window.setTimeout(function() {
						c(a)
					}, a.options.saveInterval) : c(a))
				}
			},
			commands: {
				clearlocaldata: {
					execCommand: function(b, c) {
						d && a.getPreferences(d) && a.removePreferences(d)
					},
					notNeedUndo: !0,
					ignoreContentChange: !0
				},
				getlocaldata: {
					execCommand: function(b, c) {
						return d ? a.getPreferences(d) || "" : ""
					},
					notNeedUndo: !0,
					ignoreContentChange: !0
				},
				drafts: {
					execCommand: function(b, c) {
						d && (a.body.innerHTML = a.getPreferences(d) || "<p>" + g.fillHtml + "</p>", a.focus(!0))
					},
					queryCommandState: function() {
						return d ? null === a.getPreferences(d) ? -1 : 0 : -1
					},
					notNeedUndo: !0,
					ignoreContentChange: !0
				}
			}
		}
	});
	UE.plugin.register("section", function() {
		function c(a) {
			this.tag = "";
			this.level = -1;
			this.parentSection = this.previousSection = this.nextSection = this.dom = null;
			this.startAddress = [];
			this.endAddress = [];
			this.children = []
		}

		function a(a) {
			var b = new c;
			return p.extend(b, a)
		}

		function e(a, d) {
			for (var b = d, c = 0; c < a.length; c++) {
				if (!b.childNodes) return null;
				b = b.childNodes[a[c]]
			}
			return b
		}
		var d = this;
		return {
			bindMultiEvents: {
				type: "aftersetcontent afterscencerestore",
				handler: function() {
					d.fireEvent("updateSections")
				}
			},
			bindEvents: {
				ready: function() {
					d.fireEvent("updateSections");
					g.on(d.body, "drop paste", function() {
						d.fireEvent("updateSections")
					})
				},
				afterexeccommand: function(a, c) {
					"paragraph" == c && d.fireEvent("updateSections")
				},
				keyup: function(a, d) {
					if (1 != this.selection.getRange().collapsed) this.fireEvent("updateSections");
					else {
						var b = d.keyCode || d.which;
						13 != b && 8 != b && 46 != b || this.fireEvent("updateSections")
					}
				}
			},
			commands: {
				getsections: {
					execCommand: function(b, d) {
						function c(b, d) {
							for (var f, k = null, l, m = b.childNodes, n = 0, r = m.length; n < r; n++) {
								l = m[n];
								a: {
									f = l;
									for (var v = 0; v < e.length; v++)
										if (e[v](f)) {
											f = v;
											break a
										}
									f = -1
								}
								if (0 <= f) {
									k = h.selection.getRange().selectNode(l).createAddress(!0).startAddress;
									k = a({
										tag: l.tagName,
										title: l.innerText || l.textContent || "",
										level: f,
										dom: l,
										startAddress: p.clone(k, []),
										endAddress: p.clone(k, []),
										children: []
									});
									g.nextSection = k;
									for (l = k.previousSection = g; f <= l.level;) l = l.parentSection;
									k.parentSection = l;
									l.children.push(k);
									k = g = k
								} else 1 === l.nodeType && c(l, d),
									k && k.endAddress[k.endAddress.length - 1]++
							}
						}
						for (var e = d || "h1 h2 h3 h4 h5 h6".split(" "), k = 0; k < e.length; k++) "string" == typeof e[k] ? e[k] = function(a) {
							return function(b) {
								return b.tagName == a.toUpperCase()
							}
						}(e[k]) : "function" != typeof e[k] && (e[k] = function(a) {
							return null
						});
						var h = this,
							g = k = a({
								level: -1,
								title: "root"
							});
						c(h.body, k);
						return k
					},
					notNeedUndo: !0
				},
				movesection: {
					execCommand: function(a, d, c, l) {
						if (d && c && -1 != c.level) {
							c = l ? c.endAddress : c.startAddress;
							a = e(c, this.body);
							var b;
							if (!(b = !c || !a)) {
								b = d.startAddress;
								for (var f = !1, h = !1, r = 0; r < b.length && !(r >= c.length); r++)
									if (c[r] > b[r]) {
										f = !0;
										break
									} else if (c[r] < b[r]) break;
								for (r = 0; r < d.endAddress.length && !(r >= c.length); r++)
									if (c[r] < b[r]) {
										h = !0;
										break
									} else if (c[r] > b[r]) break;
								b = f && h
							}
							if (!b) {
								c = e(d.startAddress, this.body);
								d = e(d.endAddress, this.body);
								if (l)
									for (l = d; l && !(g.getPosition(c, l) & g.POSITION_FOLLOWING);) {
										b = l.previousSibling;
										g.insertAfter(a, l);
										if (l == c) break;
										l = b
									} else
										for (l = c; l && !(g.getPosition(l, d) & g.POSITION_FOLLOWING);) {
											b = l.nextSibling;
											a.parentNode.insertBefore(l, a);
											if (l == d) break;
											l = b
										}
								this.fireEvent("updateSections")
							}
						}
					}
				},
				deletesection: {
					execCommand: function(a, c, d) {
						function b(a) {
							for (var b = f.body, c = 0; c < a.length; c++) {
								if (!b.childNodes) return null;
								b = b.childNodes[a[c]]
							}
							return b
						}
						var f = this;
						if (c) {
							a = b(c.startAddress);
							c = b(c.endAddress);
							if (d) g.remove(a);
							else
								for (; a && g.inDoc(c, f.document) && !(g.getPosition(a, c) & g.POSITION_FOLLOWING);) d = a.nextSibling, g.remove(a), a = d;
							f.fireEvent("updateSections")
						}
					}
				},
				selectsection: {
					execCommand: function(a, c) {
						if (!c && !c.dom) return !1;
						var b = this.selection.getRange(),
							d = {
								startAddress: p.clone(c.startAddress, []),
								endAddress: p.clone(c.endAddress, [])
							};
						d.endAddress[d.endAddress.length - 1]++;
						b.moveToAddress(d).select().scrollToView();
						return !0
					},
					notNeedUndo: !0
				},
				scrolltosection: {
					execCommand: function(a, c) {
						if (!c && !c.dom) return !1;
						var b = this.selection.getRange(),
							d = {
								startAddress: c.startAddress,
								endAddress: c.endAddress
							};
						d.endAddress[d.endAddress.length - 1]++;
						b.moveToAddress(d).scrollToView();
						return !0
					},
					notNeedUndo: !0
				}
			}
		}
	});
	UE.plugin.register("simpleupload", function() {
		function c() {
			var b = d.offsetWidth || 20,
				c = d.offsetHeight || 20,
				f = document.createElement("iframe"),
				l = "display:block;width:" + b + "px;height:" + c + "px;overflow:hidden;border:0;margin:0;padding:0;position:absolute;top:0;left:0;filter:alpha(opacity=0);-moz-opacity:0;-khtml-opacity: 0;opacity: 0;cursor:pointer;";
			g.on(f, "load", function() {
				var d = (+new Date).toString(36),
					h, m, r;
				m = f.contentDocument || f.contentWindow.document;
				r = m.body;
				h = m.createElement("div");
				var v = '<form id="edui_form_' + d + '" target="edui_iframe_' + d + '" method="POST" enctype="multipart/form-data" action="' + a.getOpt("serverUrl") + '" style="' + l + '">';
				if (a.options.uploadFormData && "object" == typeof a.options.uploadFormData)
					for (var u in a.options.uploadFormData) v += '<input type="hidden" name="' + u + '" value="' + a.options.uploadFormData[u] + '">';
				v = v + '<input id="edui_input_' + d + '" type="file" accept="image/gif,image/jpg,image/jpeg,image/png"  name="' + a.options.imageFieldName + '" style="' + l + '">';
				h.innerHTML = v + '</form><iframe id="edui_iframe_' + d + '" name="edui_iframe_' + d + '" style="display:none;width:0;height:0;border:0;margin:0;padding:0;position:absolute;"></iframe>';
				h.className = "edui-" + a.options.theme;
				h.id = a.ui.id + "_iframeupload";
				r.style.cssText = l;
				r.style.width = b + "px";
				r.style.height = c + "px";
				r.appendChild(h);
				r.parentNode && (r.parentNode.style.width = b + "px", r.parentNode.style.height = b + "px");
				var x = m.getElementById("edui_form_" + d),
					w = m.getElementById("edui_input_" + d),
					q = m.getElementById("edui_iframe_" + d);
				g.on(w, "change", function() {
					function b() {
						try {
							var f, e, k, h = (q.contentDocument || q.contentWindow.document).body;
							e = p.str2json(h.innerText || h.textContent || "");
							f = a.options.imageUrlPrefix + e.url;
							"SUCCESS" == e.state && e.url ? (k = a.document.getElementById(d), g.removeClasses(k, "loadingclass"), k.setAttribute("src", f), k.setAttribute("_src", f), k.setAttribute("alt", e.original || ""), e.aid && (k.setAttribute("aid", "attachimg_" + e.aid), k.setAttribute("id", "aimg_" + e.aid)), a.options.uploadCallback && "function" == typeof a.options.uploadCallback && a.options.uploadCallback(e), k.removeAttribute("id")) : c && c(e.state)
						} catch (pa) {
							c && c(a.getLang("simpleupload.loadError"))
						}
						x.reset();
						g.un(q, "load", b)
					}

					function c(b) {
						if (d) {
							var c = a.document.getElementById(d);
							c && g.remove(c);
							a.fireEvent("showmessage", {
								id: d,
								content: b,
								type: "error",
								timeout: 4E3
							})
						}
					}
					if (w.value) {
						var d = "loading_" + (+new Date).toString(36),
							f = p.serializeParam(a.queryCommandValue("serverparam")) || "",
							e = a.getActionUrl(a.getOpt("imageActionName")),
							k = a.getOpt("imageAllowFiles");
						a.focus();
						a.execCommand("inserthtml", '<img class="loadingclass" id="' + d + '" src="' + a.options.themePath + a.options.theme + '/images/spacer.gif">');
						if (a.getOpt("imageActionName")) {
							var h = w.value,
								h = h ? h.substr(h.lastIndexOf(".")) : "";
							!h || k && -1 == (k.join("") + ".").indexOf(h.toLowerCase() + ".") ? c(a.getLang("simpleupload.exceedTypeError")) : (k = w.files[0]) && k.size > a.getOpt("imageMaxSize") ? (w.value = "", c(a.getLang("simpleupload.exceedSizeError"))) : (g.on(q, "load", b), x.action = p.formatUrl(e + (-1 == e.indexOf("?") ? "?domain=1&" : "&domain=1&") + f), x.submit())
						} else errorHandler(a.getLang("autoupload.errorLoadConfig"))
					}
				});
				var t;
				a.addListener("selectionchange", function() {
					clearTimeout(t);
					t = setTimeout(function() {
						-1 == a.queryCommandState("simpleupload") ? w.disabled = "disabled" : w.disabled = !1
					}, 400)
				});
				e = !0
			});
			f.style.cssText = l;
			d.appendChild(f)
		}
		var a = this,
			e = !1,
			d;
		return {
			bindEvents: {
				ready: function() {
					p.cssRule("loading", ".loadingclass{display:inline-block;cursor:default;background: url('" + this.options.themePath + this.options.theme + "/images/loading.gif') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}\n.loaderrorclass{display:inline-block;cursor:default;background: url('" + this.options.themePath + this.options.theme + "/images/loaderror.png') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}", this.document)
				},
				simpleuploadbtnready: function(b, e) {
					d = e;
					a.afterConfigReady(c)
				}
			},
			outputRule: function(a) {
				p.each(a.getNodesByTagName("img"), function(a) {
					/\b(loaderrorclass)|(bloaderrorclass)\b/.test(a.getAttr("class")) && a.parentNode.removeChild(a)
				})
			},
			commands: {
				simpleupload: {
					queryCommandState: function() {
						return e ? 0 : -1
					}
				}
			}
		}
	});
	UE.plugin.register("serverparam", function() {
		var c = {};
		return {
			commands: {
				serverparam: {
					execCommand: function(a, e, d) {
						void 0 === e || null === e ? c = {} : p.isString(e) ? void 0 === d || null === d ? delete c[e] : c[e] = d : p.isObject(e) ? p.extend(c, e, !1) : p.isFunction(e) && p.extend(c, e(), !1)
					},
					queryCommandValue: function() {
						return c || {}
					}
				}
			}
		}
	});



	/**
	 * @description
	 * 简单上传:点击按钮,直接选择文件上传
	 * @author Jinqn
	 * @date 2014-03-31
	 */
	UE.plugin.register('uploadword', function (){
	    var me = this,
	        isLoaded = false,
	        containerBtn;
	    function initUploadBtn(){
	        var w = containerBtn.offsetWidth || 20,
	            h = containerBtn.offsetHeight || 20,
	            btnIframe = document.createElement('iframe'),
	            btnStyle = 'display:block;width:' + w + 'px;height:' + h + 'px;overflow:hidden;border:0;margin:0;padding:0;position:absolute;top:0;left:0;filter:alpha(opacity=0);-moz-opacity:0;-khtml-opacity: 0;opacity: 0;cursor:pointer;';

	        domUtils.on(btnIframe, 'load', function(){
	            var timestrap = (+new Date()).toString(36),
	                wrapper,
	                btnIframeDoc,
	                btnIframeBody;

	            btnIframeDoc = (btnIframe.contentDocument || btnIframe.contentWindow.document);
	            btnIframeBody = btnIframeDoc.body;
	            wrapper = btnIframeDoc.createElement('div');

	            wrapper.innerHTML = '<form id="edui_form_' + timestrap + '" target="edui_iframe_' + timestrap + '" method="POST" enctype="multipart/form-data" action="' + me.getOpt('serverUrl') + '" ' +
	            'style="' + btnStyle + '">' +
	            '<input id="edui_input_' + timestrap + '" type="file" accept="application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.openxmlformats-officedocument.presentationml.presentation,application/rtf" name="' + me.options.imageFieldName + '" ' +
	            'style="' + btnStyle + '">' +
	            '</form>' +
	            '<iframe id="edui_iframe_' + timestrap + '" name="edui_iframe_' + timestrap + '" style="display:none;width:0;height:0;border:0;margin:0;padding:0;position:absolute;"></iframe>';

	            wrapper.className = 'edui-' + me.options.theme;
	            wrapper.id = me.ui.id + '_iframeupload';
	            btnIframeBody.style.cssText = btnStyle;
	            btnIframeBody.style.width = w + 'px';
	            btnIframeBody.style.height = h + 'px';
	            btnIframeBody.appendChild(wrapper);

	            if (btnIframeBody.parentNode) {
	                btnIframeBody.parentNode.style.width = w + 'px';
	                btnIframeBody.parentNode.style.height = w + 'px';
	            }

	            var form = btnIframeDoc.getElementById('edui_form_' + timestrap);
	            var input = btnIframeDoc.getElementById('edui_input_' + timestrap);
	            var iframe = btnIframeDoc.getElementById('edui_iframe_' + timestrap);

	            domUtils.on(input, 'change', function(){
	                if(!input.value) return;
	                var loadingId = 'loading_' + (+new Date()).toString(36);
	                var params = utils.serializeParam(me.queryCommandValue('serverparam')) || '';

	                var imageActionUrl = me.getActionUrl(me.getOpt('imageActionName'));
	                var allowFiles = me.getOpt('imageAllowFiles');

	                me.focus();
	                me.execCommand('inserthtml', '<img class="loadingclass" id="' + loadingId + '" src="' + me.options.themePath + me.options.theme +'/images/spacer.gif" title="' + (me.getLang('simpleupload.loading') || '') + '" >');

	                function callback(){
	                    try{
	                        var link, json, loader,
	                            body = (iframe.contentDocument || iframe.contentWindow.document).body,
	                            result = body.innerText || body.textContent || '';
	                        json = (new Function("return " + result))();
	                        link = me.options.imageUrlPrefix + json.url;
	                        if(json.state == 'SUCCESS' && json.url) {
	                            loader = me.document.getElementById(loadingId);
	                            loader.setAttribute('src', link);
	                            loader.setAttribute('_src', link);
	                            loader.setAttribute('title', json.title || '');
	                            loader.setAttribute('alt', json.original || '');
	                            loader.removeAttribute('id');
	                            domUtils.removeClasses(loader, 'loadingclass');
	                        } else {
	                            showErrorLoader && showErrorLoader(json.state);
	                        }
	                    }catch(er){
	                        showErrorLoader && showErrorLoader(me.getLang('simpleupload.loadError'));
	                    }
	                    form.reset();
	                    domUtils.un(iframe, 'load', callback);
	                }
	                function showErrorLoader(title){
	                    if(loadingId) {
	                        var loader = me.document.getElementById(loadingId);
	                        loader && domUtils.remove(loader);
	                        me.fireEvent('showmessage', {
	                            'id': loadingId,
	                            'content': title,
	                            'type': 'error',
	                            'timeout': 4000
	                        });
	                    }
	                }

	                /* 判断后端配置是否没有加载成功 */
	                // if (!me.getOpt('imageActionName')) {
	                //     errorHandler(me.getLang('autoupload.errorLoadConfig'));
	                //     return;
	                // }
	                // 判断文件格式是否错误
	                var filename = input.value,
	                    fileext = filename ? filename.substr(filename.lastIndexOf('.')):'';
	                if (!fileext || (allowFiles && (allowFiles.join('') + '.').indexOf(fileext.toLowerCase() + '.') == -1)) {
	                    showErrorLoader(me.getLang('simpleupload.exceedTypeError'));
	                    return;
	                }

	                domUtils.on(iframe, 'load', callback);
	                form.action = utils.formatUrl(imageActionUrl + (imageActionUrl.indexOf('?') == -1 ? '?':'&') + params);

	                var file = jQuery(btnIframeBody).find('#edui_input_' + timestrap )[0];
   
                    var fd = new FormData();
				    fd.append("file", file.files[0]);
				    uploadUrl = URL+'/document/parse';
				    jQuery.ajax({
						    url: uploadUrl,
						    type: 'POST',
						    cache: false,
						    headers:{
						    	tenantId : tenantId,
						    	access_token : window.access_token
						    },
						    data:fd,
						    processData: false,
						    contentType: false
						}).success(function(res) {
								console.log('成功');
								console.log(res);
							isLoaded = false;
							if(res.state == 200){
								me.execCommand('inserthtml',res.data[0]);
								console.log(me);
								console.log(document);
								 $(document.getElementById('ueditor_0').contentWindow.document.body).find('#'+loadingId).remove();
							}else{
								showErrorLoader(res.message);
							}
						}).fail(function(res) {
							console.log('word上传失败')
						});

				    function uploadVideoComplete(fileNum, evt) {
				    }
				    function uploadViedoFailed(e){
				    	console.log('错误')
				    }
	                console.log('form');
	                //form.submit();
	            });
				// var b = new h.Button({
				// 	className: "edui-for-uploadword",
				// 	title: "文档导入",
				// 	onclick: function() {},
				// 	theme: a.options.theme,
				// 	showText: !1
				// });
				// h.buttons.uploadword = b;
	// 		
	            var stateTimer;
	            me.addListener('selectionchange', function () {
	                clearTimeout(stateTimer);
	                stateTimer = setTimeout(function() {
	                    var state = me.queryCommandState('uploadword');
	                    if (state == -1) {
	                        input.disabled = 'disabled';
	                    } else {
	                        input.disabled = false;
	                    }
	                }, 400);
	            });
	            isLoaded = true;
	        });
			

	        btnIframe.style.cssText = btnStyle;
	        containerBtn.appendChild(btnIframe);
	    }

		var a = this,
		e = !1,
		d, b = q.editor.utils,
		h = q.editor.ui,
		f = q.editor.dom.domUtils;
		// h.uploadword = function(a) {
		// 	var b = new q.editor.ui.Button({
		// 		className: "edui-for-uploadword",
		// 		title: "文档导入",
		// 		onclick: function() {},
		// 		theme: a.options.theme,
		// 		showText: !1
		// 	});
		// 	h.buttons.uploadword = b;
		// 	a.addListener("ready", function() {
		// 		var d = b.getDom("body").children[0];
		// 		a.fireEvent("uploadwordbtnready", d)
		// 	});
		// 	a.addListener("selectionchange", function(d, c, f) {
		// 		//d = a.queryCommandState("uploadword"); - 1 == d ? (b.setDisabled(!0), b.setChecked(!1)) : f || (b.setDisabled(!1), b.setChecked(d))
		// 	});
		// 	return b
		// };

	    return {
	        bindEvents:{
	            'ready': function() {
	                //设置loading的样式
	                // utils.cssRule('loading',
	                //     '.loadingclass{display:inline-block;cursor:default;background: url(\''
	                //     + this.options.themePath
	                //     + this.options.theme +'/images/loading.gif\') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}\n' +
	                //     '.loaderrorclass{display:inline-block;cursor:default;background: url(\''
	                //     + this.options.themePath
	                //     + this.options.theme +'/images/loaderror.png\') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;' +
	                //     '}',
	                //     this.document);

	                utils.cssRule("loading", ".loadingclass{display:inline-block;cursor:default;background: url('" + this.options.themePath + this.options.theme + "/images/loading.gif') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}\n.loaderrorclass{display:inline-block;cursor:default;background: url('" + this.options.themePath + this.options.theme + "/images/loaderror.png') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}", this.document)
	            },
	            /* 初始化简单上传按钮 */
	            'uploadwordbtnready': function(type, container) {
	                containerBtn = container;
	                initUploadBtn();
	                //me.afterConfigReady(initUploadBtn);
	            }
	        },
	        outputRule: function(root){
	            utils.each(root.getNodesByTagName('img'),function(n){
	                if (/\b(loaderrorclass)|(bloaderrorclass)\b/.test(n.getAttr('class'))) {
	                    n.parentNode.removeChild(n);
	                }
	            });
	        },
	        commands: {
	            'uploadwordbtnready': {
	                queryCommandState: function () {
	                    return isLoaded ? 0:-1;
	                }
	            }
	        }
	    }
	});

		/**
	 * @description
	 * 简单上传:点击按钮,直接选择文件上传
	 * @author Jinqn
	 * @date 2014-03-31
	 */
	UE.plugin.register('uploadpdf', function (){
	    var me = this,
	        isLoaded = false,
	        containerBtn;
	    function initUploadBtn1(){
	        var w = containerBtn.offsetWidth || 20,
	            h = containerBtn.offsetHeight || 20,
	            btnIframe = document.createElement('iframe'),
	            btnStyle = 'display:block;width:' + w + 'px;height:' + h + 'px;overflow:hidden;border:0;margin:0;padding:0;position:absolute;top:0;left:0;filter:alpha(opacity=0);-moz-opacity:0;-khtml-opacity: 0;opacity: 0;cursor:pointer;';

	        domUtils.on(btnIframe, 'load', function(){
	            var timestrap = (+new Date()).toString(36),
	                wrapper,
	                btnIframeDoc,
	                btnIframeBody;

	            btnIframeDoc = (btnIframe.contentDocument || btnIframe.contentWindow.document);
	            btnIframeBody = btnIframeDoc.body;
	            wrapper = btnIframeDoc.createElement('div');

	            wrapper.innerHTML = '<form id="edui_form_' + timestrap + '" target="edui_iframe_' + timestrap + '" method="POST" enctype="multipart/form-data" action="' + me.getOpt('serverUrl') + '" ' +
	            'style="' + btnStyle + '">' +
	            '<input id="edui_input_' + timestrap + '" type="file" accept="application/pdf"  name="' + me.options.imageFieldName + '" ' +
	            'style="' + btnStyle + '">' +
	            '</form>' +
	            '<iframe id="edui_iframe_' + timestrap + '" name="edui_iframe_' + timestrap + '" style="display:none;width:0;height:0;border:0;margin:0;padding:0;position:absolute;"></iframe>';

	            wrapper.className = 'edui-' + me.options.theme;
	            wrapper.id = me.ui.id + '_iframeupload';
	            btnIframeBody.style.cssText = btnStyle;
	            btnIframeBody.style.width = w + 'px';
	            btnIframeBody.style.height = h + 'px';
	            btnIframeBody.appendChild(wrapper);

	            if (btnIframeBody.parentNode) {
	                btnIframeBody.parentNode.style.width = w + 'px';
	                btnIframeBody.parentNode.style.height = w + 'px';
	            }

	            var form = btnIframeDoc.getElementById('edui_form_' + timestrap);
	            var input = btnIframeDoc.getElementById('edui_input_' + timestrap);
	            var iframe = btnIframeDoc.getElementById('edui_iframe_' + timestrap);

	            domUtils.on(input, 'change', function(){
	                if(!input.value) return;
	                var loadingId = 'loading_' + (+new Date()).toString(36);
	                var params = utils.serializeParam(me.queryCommandValue('serverparam')) || '';

	                var imageActionUrl = me.getActionUrl(me.getOpt('imageActionName'));
	                var allowFiles = me.getOpt('imageAllowFiles');

	                me.focus();
	                me.execCommand('inserthtml', '<img class="loadingclass" id="' + loadingId + '" src="' + me.options.themePath + me.options.theme +'/images/spacer.gif" title="' + (me.getLang('simpleupload.loading') || '') + '" >');

	                function callback(){
	                    try{
	                        var link, json, loader,
	                            body = (iframe.contentDocument || iframe.contentWindow.document).body,
	                            result = body.innerText || body.textContent || '';
	                        json = (new Function("return " + result))();
	                        link = me.options.imageUrlPrefix + json.url;
	                        if(json.state == 'SUCCESS' && json.url) {
	                            loader = me.document.getElementById(loadingId);
	                            loader.setAttribute('src', link);
	                            loader.setAttribute('_src', link);
	                            loader.setAttribute('title', json.title || '');
	                            loader.setAttribute('alt', json.original || '');
	                            loader.removeAttribute('id');
	                            domUtils.removeClasses(loader, 'loadingclass');
	                        } else {
	                            showErrorLoader && showErrorLoader(json.state);
	                        }
	                    }catch(er){
	                        showErrorLoader && showErrorLoader(me.getLang('simpleupload.loadError'));
	                    }
	                    form.reset();
	                    domUtils.un(iframe, 'load', callback);
	                }
	                function showErrorLoader(title){
	                    if(loadingId) {
	                        var loader = me.document.getElementById(loadingId);
	                        loader && domUtils.remove(loader);
	                        me.fireEvent('showmessage', {
	                            'id': loadingId,
	                            'content': title,
	                            'type': 'error',
	                            'timeout': 4000
	                        });
	                    }
	                }

	                /* 判断后端配置是否没有加载成功 */
	                // if (!me.getOpt('imageActionName')) {
	                //     errorHandler(me.getLang('autoupload.errorLoadConfig'));
	                //     return;
	                // }
	                // 判断文件格式是否错误
	                var filename = input.value,
	                    fileext = filename ? filename.substr(filename.lastIndexOf('.')):'';
	                if (!fileext || (allowFiles && (allowFiles.join('') + '.').indexOf(fileext.toLowerCase() + '.') == -1)) {
	                    showErrorLoader(me.getLang('simpleupload.exceedTypeError'));
	                    return;
	                }

	                domUtils.on(iframe, 'load', callback);
	                form.action = utils.formatUrl(imageActionUrl + (imageActionUrl.indexOf('?') == -1 ? '?':'&') + params);
	                console.log(jQuery('form'));

	                var file = jQuery(btnIframeBody).find('#edui_input_' + timestrap )[0];
                    console.log(file.files);
                    console.log('file')
                    var fd = new FormData();
				    fd.append("file", file.files[0]);
				    uploadUrl = URL+'/document/parse';
				    jQuery.ajax({
						    url: uploadUrl,
						    type: 'POST',
						    cache: false,
						    headers:{
						    	tenantId : tenantId,
						    	access_token : window.access_token
						    },
						    data:fd,
						    processData: false,
						    contentType: false
						}).success(function(res) {
								console.log('成功');
								console.log(res);
							isLoaded = false;
							if(res.state == 200){
								me.execCommand('inserthtml',res.data[0]);
								console.log(me);
								console.log(document);
								 $(document.getElementById('ueditor_0').contentWindow.document.body).find('#'+loadingId).remove();
							}else{
								showErrorLoader(res.message);
							}
						}).fail(function(res) {
							console.log('pdf上传失败')
						});

				    function uploadVideoComplete(fileNum, evt) {
				    	console.log(6666666)
				    }
				    function uploadViedoFailed(e){
				    	console.log('错误')
				    }
	                console.log('form');
	                //form.submit();
	            });
				// var b = new h.Button({
				// 	className: "edui-for-uploadword",
				// 	title: "文档导入",
				// 	onclick: function() {},
				// 	theme: a.options.theme,
				// 	showText: !1
				// });
				// h.buttons.uploadword = b;
	            var stateTimer;
	            me.addListener('selectionchange', function () {
	                clearTimeout(stateTimer);
	                stateTimer = setTimeout(function() {
	                    var state = me.queryCommandState('uploadword');
	                    if (state == -1) {
	                        input.disabled = 'disabled';
	                    } else {
	                        input.disabled = false;
	                    }
	                }, 400);
	            });
	            isLoaded = true;
	        });
			

	        btnIframe.style.cssText = btnStyle;
	        containerBtn.appendChild(btnIframe);
	    }

		var a = this,
		e = !1,
		d, b = q.editor.utils,
		h = q.editor.ui,
		f = q.editor.dom.domUtils;
		// h.uploadword = function(a) {
		// 	var b = new q.editor.ui.Button({
		// 		className: "edui-for-uploadword",
		// 		title: "文档导入",
		// 		onclick: function() {},
		// 		theme: a.options.theme,
		// 		showText: !1
		// 	});
		// 	h.buttons.uploadword = b;
		// 	a.addListener("ready", function() {
		// 		var d = b.getDom("body").children[0];
		// 		a.fireEvent("uploadwordbtnready", d)
		// 	});
		// 	a.addListener("selectionchange", function(d, c, f) {
		// 		//d = a.queryCommandState("uploadword"); - 1 == d ? (b.setDisabled(!0), b.setChecked(!1)) : f || (b.setDisabled(!1), b.setChecked(d))
		// 	});
		// 	return b
		// };

	    return {
	        bindEvents:{
	            'ready': function() {
	                //设置loading的样式
	                // utils.cssRule('loading',
	                //     '.loadingclass{display:inline-block;cursor:default;background: url(\''
	                //     + this.options.themePath
	                //     + this.options.theme +'/images/loading.gif\') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}\n' +
	                //     '.loaderrorclass{display:inline-block;cursor:default;background: url(\''
	                //     + this.options.themePath
	                //     + this.options.theme +'/images/loaderror.png\') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;' +
	                //     '}',
	                //     this.document);

	                utils.cssRule("loading", ".loadingclass{display:inline-block;cursor:default;background: url('" + this.options.themePath + this.options.theme + "/images/loading.gif') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}\n.loaderrorclass{display:inline-block;cursor:default;background: url('" + this.options.themePath + this.options.theme + "/images/loaderror.png') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}", this.document)
	            },
	            /* 初始化简单上传按钮 */
	            'uploadpdfbtnready': function(type, container) {
	                containerBtn = container;
	                initUploadBtn1();
	                //me.afterConfigReady(initUploadBtn);
	            }
	        },
	        outputRule: function(root){
	            utils.each(root.getNodesByTagName('img'),function(n){
	                if (/\b(loaderrorclass)|(bloaderrorclass)\b/.test(n.getAttr('class'))) {
	                    n.parentNode.removeChild(n);
	                }
	            });
	        },
	        commands: {
	            'uploadpdf': {
	                queryCommandState: function () {
	                    return isLoaded ? 0:-1;
	                }
	            }
	        }
	    }
	});

	UE.plugins.catchremoteimage = function() {
		var c = this,
			a = UE.ajax;
		!1 !== c.options.catchRemoteImageEnable && (c.setOpt({
			catchRemoteImageEnable: !1
		}), c.addListener("afterpaste", function() {
			c.fireEvent("catchRemoteImage")
		}), c.addListener("catchRemoteImage", function() {
			function e(b, d) {
				var e = p.serializeParam(c.queryCommandValue("serverparam")) || "",
					e = p.formatUrl(h + (-1 == h.indexOf("?") ? "?" : "&") + e),
					g = p.isCrossDomainUrl(e),
					m = [];
				m.push(b);
				g = {
					method: "POST",
					dataType: g ? "jsonp" : "",
					timeout: 6E4,
					onsuccess: function(a) {
						try {
							var e = void 0 !== a.state ? a : eval("(" + a.responseText + ")")
						} catch (B) {
							return
						}
						var h, g = e.list;
						if (g && 0 < g.length) {
							for (e = 0; e < g.length; e++)
								if (h = g[e], a = d.getAttribute("style"), (b == h.source || b == h.source.replace("&amp;", "&")) && "SUCCESS" == h.state) {
									e = f + h.url;
									d.setAttribute("style", a.replace(b, e));
									break
								}
							n++;
							c.getOpt("open_editor") && c.fireEvent("showmessage", {
								id: "catchimage-msg",
								content: "有" + n + "张远程图片成功保存，共" + k + "张",
								type: "success",
								timeout: 3E3
							})
						}
					},
					onerror: function() {
						c.fireEvent("catchremoteerror")
					}
				};
				g[l] = m;
				a.request(e, g)
			}

			function d(b, d) {
				var f = p.serializeParam(c.queryCommandValue("serverparam")) || "",
					f = p.formatUrl(h + (-1 == h.indexOf("?") ? "?" : "&") + f),
					e = {
						method: "POST",
						dataType: p.isCrossDomainUrl(f) ? "jsonp" : "",
						timeout: 6E4,
						onsuccess: d.success,
						onerror: d.error
					};
				e[l] = b;
				a.request(f, e)
			}
			for (var b = c.getOpt("catcherLocalDomain"), h = c.getActionUrl("catchimage"), f = c.getOpt("catcherUrlPrefix"), l = c.getOpt("catcherFieldName"), k = 0, n = 0, m = function(a, b) {
					if (-1 != a.indexOf(location.host) || /(^\.)|(^\/)/.test(a)) return !0;
					if (b)
						for (var d = 0, c; c = b[d++];)
							if (-1 !== a.indexOf(c)) return !0;
					return !1
				}, r = g.getElementsByTagName(c.document, "section"), v = 0, u; u = r[v++];) {
				var x = "",
					w = u.getAttribute("style");
				if (w) {
					var w = w.replace("&amp;", "&"),
						q = /['|"]\s*(http[s]?:\/\/[^;\)]+?)['|"]/i;
					(q = w.match(q)) && q[0] ? x = q[1] : (q = /\(\s*(http[s]?:\/\/[^;\)\s]+?)\)/i, (q = w.match(q)) && q[0] && (x = q[1]));
					"" != x && /^(https?|ftp):/i.test(x) && !m(x, b) && (k++, e(x, u))
				}
			}
			for (var r = [], t = g.getElementsByTagName(c.document, "img"), v = 0; u = t[v++];) u.getAttribute("word_img") || (u.removeAttribute("data-src"), u = u.getAttribute("_src") || u.src || "", "" != u && /^(https?|ftp):/i.test(u) && !m(u, b) && r.push(u));
			k += r.length;
			if (r.length)
				for (b = {
						success: function(a) {
							try {
								var b = void 0 !== a.state ? a : eval("(" + a.responseText + ")")
							} catch (J) {
								return
							}
							var d, e, h, l = b.list;
							if (l && 0 < l.length) {
								for (a = 0; a < t.length; a++)
									for (b = t[a], h = b.getAttribute("_src") || b.src || "", d = 0; d < l.length; d++)
										if (e = l[d], (h == e.source || h.replace("&amp;", "&") == e.source.replace("&amp;", "&")) && "SUCCESS" == e.state) {
											d = f + e.url;
											g.setAttributes(b, {
												src: d,
												_src: d
											});
											break
										}
								n++;
								c.getOpt("open_editor") && c.fireEvent("showmessage", {
									id: "catchimage-msg",
									content: "有" + n + "张远程图片成功保存，共" + k + "张",
									type: "success",
									timeout: 3E3
								})
							}
						},
						error: function() {
							c.fireEvent("catchremoteerror")
						}
					}, v = 0; v < r.length; v++) m = [], m.push(r[v]), d(m, b);
			c.getOpt("open_editor") && 0 < k && c.fireEvent("showmessage", {
				id: "catchimage-msg",
				content: "有" + k + "张远程图片需要保存",
				type: "success",
				timeout: 3E3
			})
		}))
	};
	q = q || {};
	q.editor = q.editor || {};
	UE.ui = q.editor.ui = {};
	(function() {
		function c() {
			var a = document.getElementById("edui_fixedlayer");
			h.setViewportOffset(a, {
				left: 0,
				top: 0
			})
		}
		var a = q.editor.browser,
			e = q.editor.dom.domUtils,
			d = window.$EDITORUI = {},
			b = 0,
			h = q.editor.ui.uiUtils = {
				uid: function(a) {
					return a ? a.ID$EDITORUI || (a.ID$EDITORUI = ++b) : ++b
				},
				hook: function(a, b) {
					var d;
					a && a._callbacks ? d = a : (d = function() {
						var b;
						a && (b = a.apply(this, arguments));
						for (var c = d._callbacks, f = c.length; f--;) {
							var e = c[f].apply(this, arguments);
							void 0 === b && (b = e)
						}
						return b
					}, d._callbacks = []);
					d._callbacks.push(b);
					return d
				},
				createElementByHtml: function(a) {
					var b = document.createElement("div");
					b.innerHTML = a;
					b = b.firstChild;
					b.parentNode.removeChild(b);
					return b
				},
				getViewportElement: function() {
					return a.ie && a.quirks ? document.body : document.documentElement
				},
				getClientRect: function(a) {
					var b;
					try {
						b = a.getBoundingClientRect()
					} catch (m) {
						b = {
							left: 0,
							top: 0,
							height: 0,
							width: 0
						}
					}
					for (var d = {
							left: Math.round(b.left),
							top: Math.round(b.top),
							height: Math.round(b.bottom - b.top),
							width: Math.round(b.right - b.left)
						}, c;
						(c = a.ownerDocument) !== document && (a = e.getWindow(c).frameElement);) b = a.getBoundingClientRect(), d.left += b.left, d.top += b.top;
					d.bottom = d.top + d.height;
					d.right = d.left + d.width;
					return d
				},
				getViewportRect: function() {
					var a = h.getViewportElement(),
						b = (window.innerWidth || a.clientWidth) | 0,
						a = (window.innerHeight || a.clientHeight) | 0;
					return {
						left: 0,
						top: 0,
						height: a,
						width: b,
						bottom: a,
						right: b
					}
				},
				setViewportOffset: function(a, b) {
					var d = h.getFixedLayer();
					a.parentNode === d ? (a.style.left = b.left + "px", a.style.top = b.top + "px") : e.setViewportOffset(a, b)
				},
				getEventOffset: function(a) {
					var b = h.getClientRect(a.target || a.srcElement);
					a = h.getViewportOffsetByEvent(a);
					return {
						left: a.left - b.left,
						top: a.top - b.top
					}
				},
				getViewportOffsetByEvent: function(a) {
					var b = a.target || a.srcElement,
						d = e.getWindow(b).frameElement;
					a = {
						left: a.clientX,
						top: a.clientY
					};
					d && b.ownerDocument !== document && (b = h.getClientRect(d), a.left += b.left, a.top += b.top);
					return a
				},
				setGlobal: function(a, b) {
					d[a] = b;
					return '$EDITORUI["' + a + '"]'
				},
				unsetGlobal: function(a) {
					delete d[a]
				},
				copyAttributes: function(b, d) {
					for (var c = d.attributes, f = c.length; f--;) {
						var h = c[f];
						"style" == h.nodeName || "class" == h.nodeName || a.ie && !h.specified || b.setAttribute(h.nodeName, h.nodeValue)
					}
					d.className && e.addClass(b, d.className);
					d.style.cssText && (b.style.cssText += ";" + d.style.cssText)
				},
				removeStyle: function(a, b) {
					if (a.style.removeProperty) a.style.removeProperty(b);
					else if (a.style.removeAttribute) a.style.removeAttribute(b);
					else throw "";
				},
				contains: function(a, b) {
					return a && b && (a === b ? !1 : a.contains ? a.contains(b) : a.compareDocumentPosition(b) & 16)
				},
				startDrag: function(a, b, d) {
					function c(a) {
						b.ondragmove(a.clientX - e, a.clientY - f, a);
						a.stopPropagation ? a.stopPropagation() : a.cancelBubble = !0
					}
					d = d || document;
					var e = a.clientX,
						f = a.clientY;
					if (d.addEventListener) {
						var k = function(a) {
							d.removeEventListener("mousemove", c, !0);
							d.removeEventListener("mouseup", k, !0);
							window.removeEventListener("mouseup", k, !0);
							b.ondragstop()
						};
						d.addEventListener("mousemove", c, !0);
						d.addEventListener("mouseup", k, !0);
						window.addEventListener("mouseup", k, !0);
						a.preventDefault()
					} else {
						var h = function() {
								g.releaseCapture();
								g.detachEvent("onmousemove", c);
								g.detachEvent("onmouseup", h);
								g.detachEvent("onlosecaptrue", h);
								b.ondragstop()
							},
							g = a.srcElement;
						g.setCapture();
						g.attachEvent("onmousemove", c);
						g.attachEvent("onmouseup", h);
						g.attachEvent("onlosecaptrue", h);
						a.returnValue = !1
					}
					b.ondragstart()
				},
				getFixedLayer: function() {
					var b = document.getElementById("edui_fixedlayer");
					null == b && (b = document.createElement("div"), b.id = "edui_fixedlayer", document.body.appendChild(b), a.ie && 8 >= a.version ? (b.style.position = "absolute", e.on(window, "scroll", c), e.on(window, "resize", q.editor.utils.defer(c, 0, !0)), setTimeout(c)) : b.style.position = "fixed", b.style.left = "0", b.style.top = "0", b.style.width = "0", b.style.height = "0");
					return b
				},
				makeUnselectable: function(b) {
					if (a.opera || a.ie && 9 > a.version) {
						if (b.unselectable = "on", b.hasChildNodes())
							for (var d = 0; d < b.childNodes.length; d++) 1 == b.childNodes[d].nodeType && h.makeUnselectable(b.childNodes[d])
					} else void 0 !== b.style.MozUserSelect ? b.style.MozUserSelect = "none" : void 0 !== b.style.WebkitUserSelect ? b.style.WebkitUserSelect = "none" : void 0 !== b.style.KhtmlUserSelect && (b.style.KhtmlUserSelect = "none")
				}
			}
	})();
	(function() {
		var c = q.editor.utils,
			a = q.editor.ui.uiUtils,
			e = q.editor.EventBase,
			d = q.editor.ui.UIBase = function() {};
		d.prototype = {
			className: "",
			uiName: "",
			initOptions: function(b) {
				for (var d in b) this[d] = b[d];
				this.id = this.id || "edui" + a.uid()
			},
			initUIBase: function() {
				this._globalKey = c.unhtml(a.setGlobal(this.id, this))
			},
			render: function(b) {
				for (var d = this.renderHtml(), d = a.createElementByHtml(d), c = g.getElementsByTagName(d, "*"), e = "edui-" + (this.theme || this.editor.options.theme), k = document.getElementById("edui_fixedlayer"), n = 0, m; m = c[n++];) g.addClass(m, e);
				g.addClass(d, e);
				k && (k.className = "", g.addClass(k, e));
				c = this.getDom();
				null != c ? (c.parentNode.replaceChild(d, c), a.copyAttributes(d, c)) : ("string" == typeof b && (b = document.getElementById(b)), b = b || a.getFixedLayer(), g.addClass(b, e), b.appendChild(d));
				this.postRender()
			},
			getDom: function(a) {
				return a ? document.getElementById(this.id + "_" + a) : document.getElementById(this.id)
			},
			postRender: function() {
				this.fireEvent("postrender")
			},
			getHtmlTpl: function() {
				return ""
			},
			formatHtml: function(a) {
				var b = "edui-" + this.uiName;
				return a.replace(/##/g, this.id).replace(/%%-/g, this.uiName ? b + "-" : "").replace(/%%/g, (this.uiName ? b : "") + " " + this.className).replace(/\$\$/g, this._globalKey)
			},
			renderHtml: function() {
				return this.formatHtml(this.getHtmlTpl())
			},
			dispose: function() {
				var b = this.getDom();
				b && q.editor.dom.domUtils.remove(b);
				a.unsetGlobal(this.id)
			}
		};
		c.inherits(d, e)
	})();
	(function() {
		var c = q.editor.utils,
			a = q.editor.ui.UIBase,
			e = q.editor.ui.Separator = function(a) {
				this.initOptions(a);
				this.initSeparator()
			};
		e.prototype = {
			uiName: "separator",
			initSeparator: function() {
				this.initUIBase()
			},
			getHtmlTpl: function() {
				return '<div id="##" class="edui-box %%"></div>'
			}
		};
		c.inherits(e, a)
	})();
	(function() {
		var c = q.editor.utils,
			a = q.editor.dom.domUtils,
			e = q.editor.ui.UIBase,
			d = q.editor.ui.uiUtils,
			b = q.editor.ui.Mask = function(a) {
				this.initOptions(a);
				this.initUIBase()
			};
		b.prototype = {
			getHtmlTpl: function() {
				return '<div id="##" class="edui-mask %%" onclick="return $$._onClick(event, this);" onmousedown="return $$._onMouseDown(event, this);"></div>'
			},
			postRender: function() {
				var b = this;
				a.on(window, "resize", function() {
					setTimeout(function() {
						b.isHidden() || b._fill()
					})
				})
			},
			show: function(a) {
				this._fill();
				this.getDom().style.display = "";
				this.getDom().style.zIndex = a
			},
			hide: function() {
				this.getDom().style.display = "none";
				this.getDom().style.zIndex = ""
			},
			isHidden: function() {
				return "none" == this.getDom().style.display
			},
			_onMouseDown: function() {
				return !1
			},
			_onClick: function(a, b) {
				this.fireEvent("click", a, b)
			},
			_fill: function() {
				var a = this.getDom(),
					b = d.getViewportRect();
				a.style.width = b.width + "px";
				a.style.height = b.height + "px"
			}
		};
		c.inherits(b, e)
	})();
	(function() {
		function c(a, b) {
			for (var d = 0; d < f.length; d++) {
				var c = f[d];
				if (!c.isHidden() && !1 !== c.queryAutoHide(b)) {
					if (a && /scroll/ig.test(a.type) && "edui-wordpastepop" == c.className) return;
					c.hide()
				}
			}
			f.length && c.editor.fireEvent("afterhidepop")
		}
		var a = q.editor.utils,
			e = q.editor.ui.uiUtils,
			d = q.editor.dom.domUtils,
			b = q.editor.ui.UIBase,
			h = q.editor.ui.Popup = function(a) {
				this.initOptions(a);
				this.initPopup()
			},
			f = [];
		h.postHide = c;
		var g = ["edui-anchor-topleft", "edui-anchor-topright", "edui-anchor-bottomleft", "edui-anchor-bottomright"];
		h.prototype = {
			SHADOW_RADIUS: 5,
			content: null,
			_hidden: !1,
			autoRender: !0,
			canSideLeft: !0,
			canSideUp: !0,
			initPopup: function() {
				this.initUIBase();
				f.push(this)
			},
			getHtmlTpl: function() {
				return '<div id="##" class="edui-popup %%"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">' + this.getContentHtmlTpl() + "  </div> </div></div>"
			},
			getContentHtmlTpl: function() {
				return this.content ? "string" == typeof this.content ? this.content : this.content.renderHtml() : ""
			},
			_UIBase_postRender: b.prototype.postRender,
			postRender: function() {
				this.content instanceof b && this.content.postRender();
				if (this.captureWheel && !this.captured) {
					this.captured = !0;
					var a = (document.documentElement.clientHeight || document.body.clientHeight) - 80,
						c = this.getDom().offsetHeight,
						f = e.getClientRect(this.combox.getDom()).top,
						h = this.getDom("content"),
						g = this.getDom("body").getElementsByTagName("iframe"),
						l = this;
					for (g.length && (g = g[0]); f + c > a;) c -= 30;
					h.style.height = c + "px";
					g && (g.style.height = c + "px");
					if (window.XMLHttpRequest) d.on(h, "onmousewheel" in document.body ? "mousewheel" : "DOMMouseScroll", function(a) {
						a.preventDefault ? a.preventDefault() : a.returnValue = !1;
						h.scrollTop = a.wheelDelta ? h.scrollTop - a.wheelDelta / 120 * 60 : h.scrollTop - a.detail / -3 * 60
					});
					else d.on(this.getDom(), "mousewheel", function(a) {
						a.returnValue = !1;
						l.getDom("content").scrollTop -= a.wheelDelta / 120 * 60
					})
				}
				this.fireEvent("postRenderAfter");
				this.hide(!0);
				this._UIBase_postRender()
			},
			_doAutoRender: function() {
				!this.getDom() && this.autoRender && this.render()
			},
			mesureSize: function() {
				var a = this.getDom("content");
				return e.getClientRect(a)
			},
			fitSize: function() {
				if (this.captureWheel && this.sized) return this.__size;
				this.sized = !0;
				var a = this.getDom("body");
				a.style.width = "";
				a.style.height = "";
				var b = this.mesureSize();
				if (this.captureWheel) {
					a.style.width = -(-20 - b.width) + "px";
					var d = parseInt(this.getDom("content").style.height, 10);
					!window.isNaN(d) && (b.height = d)
				} else a.style.width = b.width + "px";
				a.style.height = b.height + "px";
				this.__size = b;
				this.captureWheel && (this.getDom("content").style.overflow = "auto");
				return b
			},
			showAnchor: function(a, b) {
				this.showAnchorRect(e.getClientRect(a), b)
			},
			showAnchorRect: function(a, b, c) {
				this._doAutoRender();
				var f = e.getViewportRect();
				this.getDom().style.visibility = "hidden";
				this._show();
				c = this.fitSize();
				var k;
				b ? (b = this.canSideLeft && a.right + c.width > f.right && a.left > c.width, f = this.canSideUp && a.top + c.height > f.bottom && a.bottom > c.height, k = b ? a.left - c.width : a.right, a = f ? a.bottom - c.height : a.top) : (b = this.canSideLeft && a.right + c.width > f.right && a.left > c.width, f = this.canSideUp && a.top + c.height > f.bottom && a.bottom > c.height, k = b ? a.right - c.width : a.left, a = f ? a.top - c.height : a.bottom);
				c = this.getDom();
				e.setViewportOffset(c, {
					left: k,
					top: a + 5
				});
				d.removeClasses(c, g);
				c.className += " " + g[2 * (f ? 1 : 0) + (b ? 1 : 0)];
				this.editor && (c.style.zIndex = 1 * this.editor.container.style.zIndex + 10, q.editor.ui.uiUtils.getFixedLayer().style.zIndex = c.style.zIndex - 1);
				this.getDom().style.visibility = "visible"
			},
			showAt: function(a) {
				var b = a.left;
				a = a.top;
				this.showAnchorRect({
					left: b,
					top: a,
					right: b,
					bottom: a,
					height: 0,
					width: 0
				}, !1, !0)
			},
			_show: function() {
				this._hidden && (this.getDom().style.display = "", this._hidden = !1, this.fireEvent("show"))
			},
			isHidden: function() {
				return this._hidden
			},
			show: function() {
				this._doAutoRender();
				this._show()
			},
			hide: function(a) {
				!this._hidden && this.getDom() && (this.getDom().style.display = "none", this._hidden = !0, a || this.fireEvent("hide"))
			},
			queryAutoHide: function(a) {
				return !a || !e.contains(this.getDom(), a)
			}
		};
		a.inherits(h, b);
		d.on(document, "mousedown", function(a) {
			c(a, a.target || a.srcElement)
		});
		d.on(window, "scroll", function(a, b) {
			c(a, b)
		})
	})();
	(function() {
		var c = q.editor.utils,
			a = q.editor.ui.UIBase,
			e = q.editor.ui.ColorPicker = function(a) {
				this.initOptions(a);
				this.noColorText = this.noColorText || this.editor.getLang("clearColor");
				this.initUIBase();
				a = this.storekey = "__ue_recentlycolor_" + (a.storekey || "");
				this.recentlyColor = a = (a = this.editor.getPreferences(a)) ? a.split(",").slice(0, d) : ["#000"]
			},
			d = 9;
		e.prototype = {
			getHtmlTpl: function() {
				var a = this.noColorText,
					d = this.editor,
					c = '<div id="##" class="edui-colorpicker %%"><div class="ue_colorpicker_hd">' + d.getLang("recentlyColor") + '</div><div class="ue_colorpicker_bd" onclick="return $$._onRecentClick(event, this);" id="##_recently_color" >',
					e = this.recentlyColor;
				if (e && 0 < e.length)
					for (var g = 0, m = e.length; m > g; g++) var r = e[g].substr(1),
						c = c + ('<span onclick="return false;" title="#' + r + '" data-color="#' + r + '" class="ue_colorpicker_square" style="background-color:#' + r + '"></span>');
				c = c + "</div>" + ('<div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div><div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">' + a + '</div></div><table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0"><tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#8d8d8d;padding-top: 2px"><td colspan="10">' + d.getLang("themeColor") + '</td> </tr><tr class="edui-colorpicker-tablefirstrow" >');
				for (a = 0; a < b.length; a++) a && 0 === a % 10 && (c += "</tr>" + (60 == a ? '<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#8d8d8d;"><td colspan="10">' + d.getLang("standardColor") + "</td></tr>" : "") + "<tr" + (60 == a ? ' class="edui-colorpicker-tablefirstrow"' : "") + ">"), c += 70 > a ? '<td style="padding: 0 2px;"><a hidefocus title="' + b[a] + '" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell" data-color="#' + b[a] + '" style="background-color:#' + b[a] + ";border:solid #ccc;" + (10 > a || 60 <= a ? "border-width:1px;" : 10 <= a && 20 > a ? "border-width:1px 1px 0 1px;" : "border-width:0 1px 0 1px;") + '"></a></td>' : "";
				return c = c + "</tr></table></div>" + ('<div class="ue_colorpicker_toolbar"><span class="ue_colorpicker_square" id="##_colorinput_preview" style="background-color:#f00"></span><a href="javascript:void(0);" onclick="return $$._onBtnClick(event, this);" class="btn_ue_colorpicker">' + d.getLang("ok") + '</a><span class="ue_colorpicker_input_box"><span class="ue_colorpicker_input_append">#</span><span class="ue_colorpicker_input_inner"><input id="##_colorinput" value="ff0000" style="width: 60px;border:0 none;" type="text" onkeyup="return $$._onInputKeyup(event, this);" onclick="return $$._onInputClick(event, this);"></span></span></div></div>')
			},
			_onTableClick: function(a) {
				if (a = (a.target || a.srcElement).getAttribute("data-color")) this._saveColor(a), this.fireEvent("pickcolor", a)
			},
			_onRecentClick: function(a) {
				(a = (a.target || a.srcElement).getAttribute("data-color")) && this.fireEvent("pickcolor", a)
			},
			_onInputKeyup: function(a) {
				var b = this.getDom("colorinput_preview"),
					d = this._getColor();
				a = a.keyCode || a.which;
				b.style.backgroundColor = d ? d : "#fff";
				d && 13 == a && (this._saveColor(d), this.fireEvent("pickcolor", d))
			},
			_onInputClick: function(a) {
				a.stopPropagation ? (a.stopPropagation(), a.preventDefault()) : a.cancelBubble = !0
			},
			_saveColor: function(a) {
				for (var b = this.recentlyColor || ["#000"], c = [], e = 0, g = b.length; g > e; ++e) {
					var h = b[e];
					h != a && c.push(h)
				}
				c.unshift(a);
				this.recentlyColor = b = c.slice(0, d);
				this.editor.setPreferences(this.storekey, b.join(","));
				html = "";
				e = 0;
				for (g = b.length; g > e; e++) h = b[e].substr(1), html += '<span onclick="return false;" title="#' + h + '" data-color="#' + h + '" class="ue_colorpicker_square" style="background-color:#' + h + '"></span>';
				this.getDom("recently_color").innerHTML = html
			},
			_getColor: function() {
				var a = this.getDom("colorinput").value || "",
					a = a.toLowerCase(),
					b = a.split(""),
					d = b.length;
				if (3 != d && 6 != d) return !1;
				for (var c = 0; d > c; ++c) {
					var e = b[c];
					if (!("0" <= e && "9" >= e || "a" <= e && "f" >= e)) return !1
				}
				return "#" + a
			},
			_onBtnClick: function(a) {
				var b = this._getColor();
				return b && (this._saveColor(b), this.fireEvent("pickcolor", b)), a.stopPropagation ? (a.stopPropagation(), a.preventDefault()) : a.cancelBubble = !0, !1
			},
			_onTableOver: function(a) {
				if (a = (a.target || a.srcElement).getAttribute("data-color")) this.getDom("preview").style.backgroundColor = a
			},
			_onTableOut: function() {
				this.getDom("preview").style.backgroundColor = ""
			},
			_onPickNoColor: function() {
				this.fireEvent("picknocolor")
			}
		};
		c.inherits(e, a);
		var b = "ffffff 000000 eeece1 1f497d 4f81bd c0504d 9bbb59 8064a2 4bacc6 f79646 f2f2f2 7f7f7f ddd9c3 c6d9f0 dbe5f1 f2dcdb ebf1dd e5e0ec dbeef3 fdeada d8d8d8 595959 c4bd97 8db3e2 b8cce4 e5b9b7 d7e3bc ccc1d9 b7dde8 fbd5b5 bfbfbf 3f3f3f 938953 548dd4 95b3d7 d99694 c3d69b b2a2c7 92cddc fac08f a5a5a5 262626 494429 17365d 366092 953734 76923c 5f497a 31859b e36c09 7f7f7f 0c0c0c 1d1b10 0f243e 244061 632423 4f6128 3f3151 205867 974806 c00000 ff0000 ffc000 ffff00 92d050 00b050 00b0f0 0070c0 002060 7030a0 ".split(" ")
	})();
	(function() {
		var c = q.editor.dom.domUtils,
			a = q.editor.utils,
			e = q.editor.ui.UIBase,
			d = q.editor.ui.RemoteContent = function(a) {
				this.initOptions(a);
				this.initUIBase()
			};
		d.prototype = {
			getHtmlTpl: function() {
				var a = this.editor;
				return '<div id="##" class="edui-remotecontent %%">' + ('<div class="ue_remotecontent_toolbar"><span class="ue_remotecontent_input_box"><span class="ue_remotecontent_input_inner"><input id="##_urlinput" placeholder="请输入文章内容页网址链接，包含http(s)://" value="" style="border:0 none;" type="text"></span></span><a href="javascript:void(0);" onclick="return $$._onBtnClick(event, this);" class="btn_ue_remotecontent">' + a.getLang("ok") + '</a><a href="javascript:void(0);" onclick="return $$.hide();" class="btn_ue_remotecontent">' + a.getLang("cancel") + '</a><p style="font-size: 12px;margin:5px 0;">从网址导入文章内容，避免复制不全或复制多余部分造成格式排版错乱。目前已支持<strong>微信公众号文章、QQ公众号文章、今日头条、一点资讯、百度百家、新浪看点、凤凰博客、网易号、知乎专栏</strong>，更多地址的支持请联系管理员。</p></div></div>')
			},
			showErrorMsg: function(a) {
				var b = this.editor,
					d = b.document.getElementById("remotecontent-msg");
				d && c.remove(d);
				b.fireEvent("showmessage", {
					id: "remotecontent-msg",
					content: a,
					type: "error",
					timeout: 6E3
				})
			},
			_onBtnClick: function(a) {
				a = this.getDom("urlinput");
				a = a.value || "";
				if ("" == a) alert("url不能为空");
				else {
					var b = this,
						d = this.editor,
						c = "//" + d.options.plat_host + "/downloads/getRemoteContent";
					d.options.appkey && (c += "?appkey=" + d.options.appkey);
					UE.ajax.request(c, {
						method: "POST",
						dataType: "jsonp",
						data: {
							uri: a
						},
						onsuccess: function(a) {
							if (a.error) b.showErrorMsg(a.error);
							else if (d.setContent(a.data.content), d.execCommand("selectall"), d.fireEvent("catchRemoteImage"), b.ongetremotesuccess) b.ongetremotesuccess()
						},
						onerror: function(a) {
							b.showErrorMsg("请求失败，请重试或检查网络")
						}
					})
				}
			}
		};
		a.inherits(d, e)
	})();
	(function() {
		var c = q.editor.utils,
			a = q.editor.ui.uiUtils,
			e = q.editor.ui.UIBase,
			d = q.editor.ui.TablePicker = function(a) {
				this.initOptions(a);
				this.initTablePicker()
			};
		d.prototype = {
			defaultNumRows: 10,
			defaultNumCols: 10,
			maxNumRows: 20,
			maxNumCols: 20,
			numRows: 10,
			numCols: 10,
			lengthOfCellSide: 22,
			initTablePicker: function() {
				this.initUIBase()
			},
			getHtmlTpl: function() {
				return '<div id="##" class="edui-tablepicker %%"><div class="edui-tablepicker-body"><div class="edui-infoarea"><span id="##_label" class="edui-label"></span></div><div class="edui-pickarea" onmousemove="$$._onMouseMove(event, this);" onmouseover="$$._onMouseOver(event, this);" onmouseout="$$._onMouseOut(event, this);" onclick="$$._onClick(event, this);"><div id="##_overlay" class="edui-overlay"></div></div></div></div>'
			},
			_UIBase_render: e.prototype.render,
			render: function(a) {
				this._UIBase_render(a);
				this.getDom("label").innerHTML = "0" + this.editor.getLang("t_row") + " x 0" + this.editor.getLang("t_col")
			},
			_track: function(a, d) {
				var b = this.getDom("overlay").style,
					c = this.lengthOfCellSide;
				b.width = a * c + "px";
				b.height = d * c + "px";
				this.getDom("label").innerHTML = a + this.editor.getLang("t_col") + " x " + d + this.editor.getLang("t_row");
				this.numCols = a;
				this.numRows = d
			},
			_onMouseOver: function(b, d) {
				var c = b.relatedTarget || b.fromElement;
				a.contains(d, c) || d === c || (this.getDom("label").innerHTML = "0" + this.editor.getLang("t_col") + " x 0" + this.editor.getLang("t_row"), this.getDom("overlay").style.visibility = "")
			},
			_onMouseOut: function(b, d) {
				var c = b.relatedTarget || b.toElement;
				a.contains(d, c) || d === c || (this.getDom("label").innerHTML = "0" + this.editor.getLang("t_col") + " x 0" + this.editor.getLang("t_row"), this.getDom("overlay").style.visibility = "hidden")
			},
			_onMouseMove: function(b, d) {
				this.getDom("overlay");
				var c = a.getEventOffset(b),
					e = this.lengthOfCellSide;
				this._track(Math.ceil(c.left / e), Math.ceil(c.top / e))
			},
			_onClick: function() {
				this.fireEvent("picktable", this.numCols, this.numRows)
			}
		};
		c.inherits(d, e)
	})();
	(function() {
		var c = q.editor.dom.domUtils,
			a = q.editor.ui.uiUtils,
			e = 'onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"' + (q.editor.browser.ie ? ' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"' : ' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"');
		q.editor.ui.Stateful = {
			alwalysHoverable: !1,
			target: null,
			Stateful_init: function() {
				this._Stateful_dGetHtmlTpl = this.getHtmlTpl;
				this.getHtmlTpl = this.Stateful_getHtmlTpl
			},
			Stateful_getHtmlTpl: function() {
				return this._Stateful_dGetHtmlTpl().replace(/stateful/g, function() {
					return e
				})
			},
			Stateful_onMouseEnter: function(a, b) {
				this.target = b;
				if (!this.isDisabled() || this.alwalysHoverable) this.addState("hover"), this.fireEvent("over")
			},
			Stateful_onMouseLeave: function(a, b) {
				if (!this.isDisabled() || this.alwalysHoverable) this.removeState("hover"), this.removeState("active"), this.fireEvent("out")
			},
			Stateful_onMouseOver: function(d, b) {
				var c = d.relatedTarget;
				a.contains(b, c) || b === c || this.Stateful_onMouseEnter(d, b)
			},
			Stateful_onMouseOut: function(d, b) {
				var c = d.relatedTarget;
				a.contains(b, c) || b === c || this.Stateful_onMouseLeave(d, b)
			},
			Stateful_onMouseDown: function(a, b) {
				this.isDisabled() || this.addState("active")
			},
			Stateful_onMouseUp: function(a, b) {
				this.isDisabled() || this.removeState("active")
			},
			Stateful_postRender: function() {
				this.disabled && !this.hasState("disabled") && this.addState("disabled")
			},
			hasState: function(a) {
				return c.hasClass(this.getStateDom(), "edui-state-" + a)
			},
			addState: function(a) {
				this.hasState(a) || (this.getStateDom().className += " edui-state-" + a)
			},
			removeState: function(a) {
				this.hasState(a) && c.removeClasses(this.getStateDom(), ["edui-state-" + a])
			},
			getStateDom: function() {
				return this.getDom("state")
			},
			isChecked: function() {
				return this.hasState("checked")
			},
			setChecked: function(a) {
				!this.isDisabled() && a ? this.addState("checked") : this.removeState("checked")
			},
			isDisabled: function() {
				return this.hasState("disabled")
			},
			setDisabled: function(a) {
				a ? (this.removeState("hover"), this.removeState("checked"), this.removeState("active"), this.addState("disabled")) : this.removeState("disabled")
			}
		}
	})();
	(function() {
		var c = q.editor.utils,
			a = q.editor.ui.UIBase,
			e = q.editor.ui.Stateful,
			d = q.editor.ui.Button = function(a) {
				if (a.name) {
					var b = a.name,
						d = a.cssRules;
					a.className || (a.className = "edui-for-" + b);
					a.cssRules = ".edui-" + (a.theme || "default") + " .edui-toolbar .edui-button.edui-for-" + b + " .edui-icon {" + d + "}"
				}
				this.initOptions(a);
				this.initButton()
			};
		d.prototype = {
			uiName: "button",
			label: "",
			title: "",
			showIcon: !0,
			showText: !0,
			cssRules: "",
			initButton: function() {
				this.initUIBase();
				this.Stateful_init();
				this.cssRules && c.cssRule("edui-customize-" + this.name + "-style", this.cssRules)
			},
			getHtmlTpl: function() {
				return '<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" ' + (this.title ? 'title="' + this.title + '"' : "") + ' class="%%-body" onmousedown="return $$._onMouseDown(event, this);" onclick="return $$._onClick(event, this);">' + (this.showIcon ? '<div class="edui-box edui-icon"></div>' : "") + (this.showText ? '<div class="edui-box edui-label">' + this.label + "</div>" : "") + "</div></div></div></div>"
			},
			postRender: function() {
				this.Stateful_postRender();
				this.setDisabled(this.disabled)
			},
			_onMouseDown: function(a) {
				a = (a = a.target || a.srcElement) && a.tagName && a.tagName.toLowerCase();
				if ("input" == a || "object" == a || "object" == a) return !1
			},
			_onClick: function() {
				this.isDisabled() || this.fireEvent("click")
			},
			setTitle: function(a) {
				this.getDom("label").innerHTML = a
			}
		};
		c.inherits(d, a);
		c.extend(d.prototype, e)
	})();
	(function() {
		var c = q.editor.utils,
			a = q.editor.ui.uiUtils,
			e = q.editor.ui.UIBase,
			d = q.editor.ui.Stateful,
			b = q.editor.ui.SplitButton = function(a) {
				this.initOptions(a);
				this.initSplitButton()
			};
		b.prototype = {
			popup: null,
			uiName: "splitbutton",
			title: "",
			initSplitButton: function() {
				this.initUIBase();
				this.Stateful_init();
				if (null != this.popup) {
					var a = this.popup;
					this.popup = null;
					this.setPopup(a)
				}
			},
			_UIBase_postRender: e.prototype.postRender,
			postRender: function() {
				this.Stateful_postRender();
				this._UIBase_postRender()
			},
			setPopup: function(b) {
				this.popup !== b && (null != this.popup && this.popup.dispose(), b.addListener("show", c.bind(this._onPopupShow, this)), b.addListener("hide", c.bind(this._onPopupHide, this)), b.addListener("postrender", c.bind(function() {
					b.getDom("body").appendChild(a.createElementByHtml('<div id="' + this.popup.id + '_bordereraser" class="edui-bordereraser edui-background" style="width:' + (a.getClientRect(this.getDom()).width + 20) + 'px"></div>'));
					b.getDom().className += " " + this.className
				}, this)), this.popup = b)
			},
			_onPopupShow: function() {
				this.addState("opened")
			},
			_onPopupHide: function() {
				this.removeState("opened")
			},
			getHtmlTpl: function() {
				var a = '<div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"><div class="edui-box edui-icon"></div></div>';
				this.useInput && (a = '<div id="##_button_body" class="edui-box edui-button-body"><input id="##_wx_input" class="edui-box edui-wx-input " type="text"  onkeydown="$$._onInputKeydown(event, this);" onclick="$$._onInputClick(event, this);" onblur="$$._onInputBlur(event, this);"></div>');
				return '<div id="##" class="edui-box %%"><div ' + (this.title ? 'data-tooltip="' + this.title + '"' : "") + ' id="##_state" stateful class="js_tooltip"><div class="%%-body">' + a + '<div class="edui-box edui-splitborder"></div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div></div></div></div>'
			},
			showPopup: function() {
				var b = a.getClientRect(this.getDom());
				b.top -= this.popup.SHADOW_RADIUS;
				b.height += this.popup.SHADOW_RADIUS;
				this.popup.showAnchorRect(b)
			},
			_onArrowClick: function(a, b) {
				this.isDisabled() || this.showPopup()
			},
			_onInputClick: function() {
				this.isDisabled() || this.fireEvent("inputclick")
			},
			_onInputBlur: function(a) {
				this.isDisabled() || this.fireEvent("inputblur");
				a.stopPropagation ? (a.stopPropagation(), a.preventDefault()) : a.cancelBubble = !0
			},
			_onInputKeydown: function(a) {
				this.isDisabled() || this.fireEvent("inputkeydown", a)
			},
			_onButtonClick: function() {
				this.isDisabled() || this.fireEvent("buttonclick")
			}
		};
		c.inherits(b, e);
		c.extend(b.prototype, d, !0)
	})();
	(function() {
		var c = q.editor.utils,
			a = q.editor.ui.uiUtils,
			e = q.editor.ui.ColorPicker,
			d = q.editor.ui.Popup,
			b = q.editor.ui.SplitButton,
			g = q.editor.ui.ColorButton = function(a) {
				this.initOptions(a);
				this.initColorButton()
			};
		g.prototype = {
			initColorButton: function() {
				var a = this;
				this.popup = new d({
					content: new e({
						noColorText: a.editor.getLang("clearColor"),
						editor: a.editor,
						onpickcolor: function(b, d) {
							a._onPickColor(d)
						},
						onpicknocolor: function(b, d) {
							a._onPickNoColor(d)
						}
					}),
					editor: a.editor
				});
				this.initSplitButton()
			},
			_SplitButton_postRender: b.prototype.postRender,
			postRender: function() {
				this._SplitButton_postRender();
				this.getDom("button_body").appendChild(a.createElementByHtml('<div id="' + this.id + '_colorlump" class="edui-colorlump"></div>'));
				this.getDom().className += " edui-colorbutton"
			},
			setColor: function(a) {
				this.color = this.getDom("colorlump").style.backgroundColor = a
			},
			_onPickColor: function(a) {
				!1 !== this.fireEvent("pickcolor", a) && (this.setColor(a), this.popup.hide())
			},
			_onPickNoColor: function(a) {
				!1 !== this.fireEvent("picknocolor") && this.popup.hide()
			}
		};
		c.inherits(g, b)
	})();
	(function() {
		var c = q.editor.utils,
			a = q.editor.ui.Popup,
			e = q.editor.ui.TablePicker,
			d = q.editor.ui.SplitButton,
			b = q.editor.ui.TableButton = function(a) {
				this.initOptions(a);
				this.initTableButton()
			};
		b.prototype = {
			initTableButton: function() {
				var b = this;
				this.popup = new a({
					content: new e({
						editor: b.editor,
						onpicktable: function(a, d, c) {
							b._onPickTable(d, c)
						}
					}),
					editor: b.editor
				});
				this.initSplitButton()
			},
			_onPickTable: function(a, b) {
				!1 !== this.fireEvent("picktable", a, b) && this.popup.hide()
			}
		};
		c.inherits(b, d)
	})();
	(function() {
		var c = q.editor.utils,
			a = q.editor.ui.UIBase,
			e = q.editor.ui.AutoTypeSetPicker = function(a) {
				this.initOptions(a);
				this.initAutoTypeSetPicker()
			};
		e.prototype = {
			initAutoTypeSetPicker: function() {
				this.initUIBase()
			},
			getHtmlTpl: function() {
				var a = this.editor,
					b = a.options.autotypeset,
					c = a.getLang("autoTypeSet"),
					e = "textAlignValue" + a.uid,
					g = "imageBlockLineValue" + a.uid,
					k = "symbolConverValue" + a.uid;
				return '<div id="##" class="edui-autotypesetpicker %%"><div class="edui-autotypesetpicker-body"><table ><tr><td nowrap><input type="checkbox" name="mergeEmptyline" ' + (b.mergeEmptyline ? "checked" : "") + ">" + c.mergeLine + '</td><td colspan="2"><input type="checkbox" name="removeEmptyline" ' + (b.removeEmptyline ? "checked" : "") + ">" + c.delLine + '</td></tr><tr><td nowrap><input type="checkbox" name="removeClass" ' + (b.removeClass ? "checked" : "") + ">" + c.removeFormat + '</td><td colspan="2"><input type="checkbox" name="indent" ' + (b.indent ? "checked" : "") + ">" + c.indent + '</td></tr><tr><td nowrap><input type="checkbox" name="clearFontSize" ' + (b.clearFontSize ? "checked" : "") + ">" + c.removeFontsize + '</td><td colspan="2"><input type="checkbox" name="clearFontFamily" ' + (b.clearFontFamily ? "checked" : "") + ">" + c.removeFontFamily + '</td></tr><tr><td nowrap><input type="checkbox" name="textAlign" ' + (b.textAlign ? "checked" : "") + ">" + c.alignment + '</td><td colspan="2" id="' + e + '"><input type="radio" name="' + e + '" value="left" ' + (b.textAlign && "left" == b.textAlign ? "checked" : "") + ">" + a.getLang("justifyleft") + '<input type="radio" name="' + e + '" value="center" ' + (b.textAlign && "center" == b.textAlign ? "checked" : "") + ">" + a.getLang("justifycenter") + '<input type="radio" name="' + e + '" value="right" ' + (b.textAlign && "right" == b.textAlign ? "checked" : "") + ">" + a.getLang("justifyright") + '</td></tr><tr><td nowrap><input type="checkbox" name="imageBlockLine" ' + (b.imageBlockLine ? "checked" : "") + ">" + c.imageFloat + '</td><td nowrap id="' + g + '"><input type="radio" name="' + g + '" value="none" ' + (b.imageBlockLine && "none" == b.imageBlockLine ? "checked" : "") + ">" + a.getLang("default") + '<input type="radio" name="' + g + '" value="left" ' + (b.imageBlockLine && "left" == b.imageBlockLine ? "checked" : "") + ">" + a.getLang("justifyleft") + '<input type="radio" name="' + g + '" value="center" ' + (b.imageBlockLine && "center" == b.imageBlockLine ? "checked" : "") + ">" + a.getLang("justifycenter") + '<input type="radio" name="' + g + '" value="right" ' + (b.imageBlockLine && "right" == b.imageBlockLine ? "checked" : "") + ">" + a.getLang("justifyright") + '</td></tr><tr><td nowrap><input type="checkbox" name="symbolConver" ' + (b.bdc2sb || b.tobdc ? "checked" : "") + ">" + c.symbol + '</td><td id="' + k + '"><input type="radio" name="bdc" value="bdc2sb" ' + (b.bdc2sb ? "checked" : "") + ">" + c.bdc2sb + '<input type="radio" name="bdc" value="tobdc" ' + (b.tobdc ? "checked" : "") + ">" + c.tobdc + '</td><td nowrap align="right"><button >' + c.run + "</button></td></tr></table></div></div>"
			},
			_UIBase_render: a.prototype.render
		};
		c.inherits(e, a)
	})();
	(function() {
		function c(b) {
			for (var c = {}, d = b.getDom(), e = b.editor.uid, f, h = g.getElementsByTagName(d, "input"), v = h.length - 1, u; u = h[v--];)
				if (f = u.getAttribute("type"), "checkbox" == f)
					if (f = u.getAttribute("name"), c[f] && delete c[f], u.checked)
						if (u = document.getElementById(f + "Value" + e))
							if (/input/ig.test(u.tagName)) c[f] = u.value;
							else {
								u = u.getElementsByTagName("input");
								for (var x = u.length - 1, w; w = u[x--];)
									if (w.checked) {
										c[f] = w.value;
										break
									}
							}
			else c[f] = !0;
			else c[f] = !1;
			else c[u.getAttribute("value")] = u.checked;
			d = g.getElementsByTagName(d, "select");
			for (v = 0; e = d[v++];) h = e.getAttribute("name"), c[h] = c[h] ? e.value : "";
			a.extend(b.editor.options.autotypeset, c);
			b.editor.setPreferences("autotypeset", c)
		}
		var a = q.editor.utils,
			e = q.editor.ui.Popup,
			d = q.editor.ui.AutoTypeSetPicker,
			b = q.editor.ui.SplitButton,
			h = q.editor.ui.AutoTypeSetButton = function(a) {
				this.initOptions(a);
				this.initAutoTypeSetButton()
			};
		h.prototype = {
			initAutoTypeSetButton: function() {
				var a = this;
				this.popup = new e({
					content: new d({
						editor: a.editor
					}),
					editor: a.editor,
					hide: function() {
						!this._hidden && this.getDom() && (c(this), this.getDom().style.display = "none", this._hidden = !0, this.fireEvent("hide"))
					}
				});
				var b = 0;
				this.popup.addListener("postRenderAfter", function() {
					var d = this;
					if (!b) {
						var e = this.getDom();
						e.getElementsByTagName("button")[0].onclick = function() {
							c(d);
							a.editor.execCommand("autotypeset");
							d.hide()
						};
						g.on(e, "click", function(b) {
							b = b.target || b.srcElement;
							var e = a.editor.uid;
							if (b && "INPUT" == b.tagName) {
								if ("imageBlockLine" == b.name || "textAlign" == b.name || "symbolConver" == b.name)
									for (var f = b.checked, k = document.getElementById(b.name + "Value" + e).getElementsByTagName("input"), g = {
											imageBlockLine: "none",
											textAlign: "left",
											symbolConver: "tobdc"
										}, h = 0; h < k.length; h++) f ? k[h].value == g[b.name] && (k[h].checked = "checked") : k[h].checked = !1;
								(b.name == "imageBlockLineValue" + e || b.name == "textAlignValue" + e || "bdc" == b.name) && (b = b.parentNode.previousSibling.getElementsByTagName("input")) && (b[0].checked = !0);
								c(d)
							}
						});
						b = 1
					}
				});
				this.initSplitButton()
			}
		};
		a.inherits(h, b)
	})();
	(function() {
		var c = q.editor.utils,
			a = q.editor.ui.Popup,
			e = q.editor.ui.Stateful,
			d = q.editor.ui.UIBase,
			b = q.editor.ui.CellAlignPicker = function(a) {
				this.initOptions(a);
				this.initSelected();
				this.initCellAlignPicker()
			};
		b.prototype = {
			initSelected: function() {
				var a = {
						top: 0,
						middle: 1,
						bottom: 2
					},
					b = {
						left: 0,
						center: 1,
						right: 2
					};
				this.selected && (this.selectedIndex = 3 * a[this.selected.valign] + b[this.selected.align])
			},
			initCellAlignPicker: function() {
				this.initUIBase();
				this.Stateful_init()
			},
			getHtmlTpl: function() {
				for (var a = ["left", "center", "right"], b, c, d = [], e = 0; 9 > e; e++) b = this.selectedIndex === e ? ' class="edui-cellalign-selected" ' : "", c = e % 3, 0 === c && d.push("<tr>"), d.push('<td index="' + e + '" ' + b + ' stateful><div class="edui-icon edui-' + a[c] + '"></div></td>'), 2 === c && d.push("</tr>");
				return '<div id="##" class="edui-cellalignpicker %%"><div class="edui-cellalignpicker-body"><table onclick="$$._onClick(event);">' + d.join("") + "</table></div></div>"
			},
			getStateDom: function() {
				return this.target
			},
			_onClick: function(b) {
				var c = b.target || b.srcElement;
				/icon/.test(c.className) && (this.items[c.parentNode.getAttribute("index")].onclick(), a.postHide(b))
			},
			_UIBase_render: d.prototype.render
		};
		c.inherits(b, d);
		c.extend(b.prototype, e, !0)
	})();
	(function() {
		var c = q.editor.utils,
			a = q.editor.ui.Stateful,
			e = q.editor.ui.uiUtils,
			d = q.editor.ui.UIBase,
			b = q.editor.ui.PastePicker = function(a) {
				this.initOptions(a);
				this.initPastePicker()
			};
		b.prototype = {
			initPastePicker: function() {
				this.initUIBase();
				this.Stateful_init()
			},
			getHtmlTpl: function() {
				return '<div class="edui-pasteicon" onclick="$$._onClick(this)"></div><div class="edui-pastecontainer"><div class="edui-title">' + this.editor.getLang("pasteOpt") + '</div><div class="edui-button"><div title="' + this.editor.getLang("pasteSourceFormat") + '" onclick="$$.format(false)" stateful><div class="edui-richtxticon"></div></div><div title="' + this.editor.getLang("tagFormat") + '" onclick="$$.format(2)" stateful><div class="edui-tagicon"></div></div><div title="' + this.editor.getLang("pasteTextFormat") + '" onclick="$$.format(true)" stateful><div class="edui-plaintxticon"></div></div></div></div></div>'
			},
			getStateDom: function() {
				return this.target
			},
			format: function(a) {
				this.editor.ui._isTransfer = !0;
				this.editor.fireEvent("pasteTransfer", a)
			},
			_onClick: function(a) {
				var b = g.getNextDomNode(a),
					c = e.getViewportRect().height,
					d = e.getClientRect(b);
				b.style.top = d.top + d.height > c ? -d.height - a.offsetHeight + "px" : "";
				/hidden/ig.test(g.getComputedStyle(b, "visibility")) ? (b.style.visibility = "visible", g.addClass(a, "edui-state-opened")) : (b.style.visibility = "hidden", g.removeClasses(a, "edui-state-opened"))
			},
			_UIBase_render: d.prototype.render
		};
		c.inherits(b, d);
		c.extend(b.prototype, a, !0)
	})();
	(function() {
		var c = q.editor.utils,
			a = q.editor.ui.uiUtils,
			e = q.editor.ui.UIBase,
			d = q.editor.ui.Toolbar = function(a) {
				this.initOptions(a);
				this.initToolbar()
			};
		d.prototype = {
			items: null,
			initToolbar: function() {
				this.items = this.items || [];
				this.initUIBase()
			},
			add: function(a, c) {
				void 0 === c ? this.items.push(a) : this.items.splice(c, 0, a)
			},
			getHtmlTpl: function() {
				for (var a = [], c = 0; c < this.items.length; c++) a[c] = this.items[c].renderHtml();
				return '<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">' + a.join("") + "</div>"
			},
			postRender: function() {
				for (var b = this.getDom(), c = 0; c < this.items.length; c++) this.items[c].postRender();
				a.makeUnselectable(b)
			},
			_onMouseDown: function(a) {
				a = (a = a.target || a.srcElement) && a.tagName && a.tagName.toLowerCase();
				if ("input" == a || "object" == a || "object" == a) return !1
			}
		};
		c.inherits(d, e)
	})();
	(function() {
		var c = q.editor.utils,
			a = q.editor.dom.domUtils,
			e = q.editor.ui.uiUtils,
			d = q.editor.ui.UIBase,
			b = q.editor.ui.Popup,
			g = q.editor.ui.Stateful,
			f = q.editor.ui.CellAlignPicker,
			l = q.editor.ui.Menu = function(a) {
				this.initOptions(a);
				this.initMenu()
			},
			k = {
				renderHtml: function() {
					return '<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'
				},
				postRender: function() {},
				queryAutoHide: function() {
					return !0
				}
			};
		l.prototype = {
			items: null,
			uiName: "menu",
			initMenu: function() {
				this.items = this.items || [];
				this.initPopup();
				this.initItems()
			},
			initItems: function() {
				for (var a = 0; a < this.items.length; a++) {
					var b = this.items[a];
					"-" == b ? this.items[a] = this.getSeparator() : b instanceof n || (b.editor = this.editor, b.theme = this.editor.options.theme, this.items[a] = this.createItem(b))
				}
			},
			getSeparator: function() {
				return k
			},
			createItem: function(a) {
				a.menu = this;
				return new n(a)
			},
			_Popup_getContentHtmlTpl: b.prototype.getContentHtmlTpl,
			getContentHtmlTpl: function() {
				if (0 == this.items.length) return this._Popup_getContentHtmlTpl();
				for (var a = [], b = 0; b < this.items.length; b++) a[b] = this.items[b].renderHtml();
				return '<div class="%%-body">' + a.join("") + "</div>"
			},
			_Popup_postRender: b.prototype.postRender,
			postRender: function() {
				for (var b = this, c = 0; c < this.items.length; c++) {
					var d = this.items[c];
					d.ownerMenu = this;
					d.postRender()
				}
				a.on(this.getDom(), "mouseover", function(a) {
					a = a || event;
					a = a.relatedTarget || a.fromElement;
					var c = b.getDom();
					e.contains(c, a) || c === a || b.fireEvent("over")
				});
				this._Popup_postRender()
			},
			queryAutoHide: function(a) {
				if (a) {
					if (e.contains(this.getDom(), a)) return !1;
					for (var b = 0; b < this.items.length; b++)
						if (!1 === this.items[b].queryAutoHide(a)) return !1
				}
			},
			clearItems: function() {
				for (var a = 0; a < this.items.length; a++) {
					var b = this.items[a];
					clearTimeout(b._showingTimer);
					clearTimeout(b._closingTimer);
					b.subMenu && b.subMenu.destroy()
				}
				this.items = []
			},
			destroy: function() {
				this.getDom() && a.remove(this.getDom());
				this.clearItems()
			},
			dispose: function() {
				this.destroy()
			}
		};
		c.inherits(l, b);
		var n = q.editor.ui.MenuItem = function(c) {
			this.initOptions(c);
			this.initUIBase();
			this.Stateful_init();
			if (this.subMenu && !(this.subMenu instanceof l))
				if (c.className && -1 != c.className.indexOf("aligntd")) {
					var d = this;
					this.subMenu.selected = this.editor.queryCommandValue("cellalignment");
					this.subMenu = new b({
						content: new f(this.subMenu),
						parentMenu: d,
						editor: d.editor,
						destroy: function() {
							this.getDom() && a.remove(this.getDom())
						}
					});
					this.subMenu.addListener("postRenderAfter", function() {
						a.on(this.getDom(), "mouseover", function() {
							d.addState("opened")
						})
					})
				} else this.subMenu = new l(this.subMenu)
		};
		n.prototype = {
			label: "",
			subMenu: null,
			ownerMenu: null,
			uiName: "menuitem",
			alwalysHoverable: !0,
			getHtmlTpl: function() {
				return '<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">' + this.renderLabelHtml() + "</div></div>"
			},
			postRender: function() {
				var a = this;
				this.addListener("over", function() {
					a.ownerMenu.fireEvent("submenuover", a);
					a.subMenu && a.delayShowSubMenu()
				});
				this.subMenu && (this.getDom().className += " edui-hassubmenu", this.subMenu.render(), this.addListener("out", function() {
					a.delayHideSubMenu()
				}), this.subMenu.addListener("over", function() {
					clearTimeout(a._closingTimer);
					a._closingTimer = null;
					a.addState("opened")
				}), this.ownerMenu.addListener("hide", function() {
					a.hideSubMenu()
				}), this.ownerMenu.addListener("submenuover", function(b, c) {
					c !== a && a.delayHideSubMenu()
				}), this.subMenu._bakQueryAutoHide = this.subMenu.queryAutoHide, this.subMenu.queryAutoHide = function(b) {
					return b && e.contains(a.getDom(), b) ? !1 : this._bakQueryAutoHide(b)
				});
				this.getDom().style.tabIndex = "-1";
				e.makeUnselectable(this.getDom());
				this.Stateful_postRender()
			},
			delayShowSubMenu: function() {
				var a = this;
				a.isDisabled() || (a.addState("opened"), clearTimeout(a._showingTimer), clearTimeout(a._closingTimer), a._closingTimer = null, a._showingTimer = setTimeout(function() {
					a.showSubMenu()
				}, 250))
			},
			delayHideSubMenu: function() {
				var a = this;
				a.isDisabled() || (a.removeState("opened"), clearTimeout(a._showingTimer), a._closingTimer || (a._closingTimer = setTimeout(function() {
					a.hasState("opened") || a.hideSubMenu();
					a._closingTimer = null
				}, 400)))
			},
			renderLabelHtml: function() {
				return '<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">' + (this.label || "") + "</div>"
			},
			getStateDom: function() {
				return this.getDom()
			},
			queryAutoHide: function(a) {
				if (this.subMenu && this.hasState("opened")) return this.subMenu.queryAutoHide(a)
			},
			_onClick: function(a, c) {
				this.hasState("disabled") || !1 !== this.fireEvent("click", a, c) && (this.subMenu ? this.showSubMenu() : b.postHide(a))
			},
			showSubMenu: function() {
				var a = e.getClientRect(this.getDom());
				a.right -= 5;
				a.left += 2;
				a.width -= 7;
				a.top -= 4;
				a.bottom += 4;
				a.height += 8;
				this.subMenu.showAnchorRect(a, !0, !0)
			},
			hideSubMenu: function() {
				this.subMenu.hide()
			}
		};
		c.inherits(n, d);
		c.extend(n.prototype, g, !0)
	})();
	(function() {
		var c = q.editor.utils,
			a = q.editor.ui.uiUtils,
			e = q.editor.ui.Menu,
			d = q.editor.ui.SplitButton,
			b = q.editor.ui.Combox = function(a) {
				this.initOptions(a);
				this.initCombox()
			};
		b.prototype = {
			uiName: "combox",
			onbuttonclick: function() {
				this.showPopup()
			},
			initCombox: function() {
				var a = this;
				this.items = this.items || [];
				for (var b = 0; b < this.items.length; b++) {
					var c = this.items[b];
					c.uiName = "listitem";
					c.index = b;
					"undefined" == typeof c.onclick && (c.onclick = function() {
						a.selectByIndex(this.index)
					})
				}
				this.popup = new e({
					items: this.items,
					uiName: "list",
					editor: this.editor,
					captureWheel: !0,
					combox: this
				});
				this.initSplitButton()
			},
			_SplitButton_postRender: d.prototype.postRender,
			postRender: function() {
				this._SplitButton_postRender();
				this.setLabel(this.label || "");
				this.setValue(this.initValue || "")
			},
			showPopup: function() {
				var b = a.getClientRect(this.getDom());
				b.top += 1;
				--b.bottom;
				b.height -= 2;
				this.popup.showAnchorRect(b)
			},
			getValue: function() {
				return this.value
			},
			setValue: function(a) {
				var b = this.indexByValue(a); - 1 != b ? (this.selectedIndex = b, this.setLabel(this.items[b].label), this.value = this.items[b].value) : (this.selectedIndex = -1, this.setLabel(this.getLabelForUnknowValue(a)), this.value = a)
			},
			setLabel: function(a) {
				this.useInput ? this.getDom("wx_input").value = a : this.getDom("button_body").innerHTML = a;
				this.label = a
			},
			getLabelForUnknowValue: function(a) {
				return a
			},
			indexByValue: function(a) {
				for (var b = 0; b < this.items.length; b++)
					if (a == this.items[b].value) return b;
				return -1
			},
			getItem: function(a) {
				return this.items[a]
			},
			selectByIndex: function(a) {
				a < this.items.length && !1 !== this.fireEvent("select", a) && (this.selectedIndex = a, this.value = this.items[a].value, this.setLabel(this.items[a].label))
			}
		};
		c.inherits(b, d)
	})();
	(function() {
		var c = q.editor.utils,
			a = q.editor.dom.domUtils,
			e = q.editor.ui.uiUtils,
			d = q.editor.ui.Mask,
			b = q.editor.ui.UIBase,
			g = q.editor.ui.Button,
			f = q.editor.ui.Dialog = function(a) {
				if (a.name) {
					var b = a.name,
						d = a.cssRules;
					a.className || (a.className = "edui-for-" + b);
					d && (a.cssRules = ".edui-default .edui-for-" + b + " .edui-dialog-content  {" + d + "}")
				}
				this.initOptions(c.extend({
					autoReset: !0,
					draggable: !0,
					onok: function() {},
					oncancel: function() {},
					onclose: function(a, b) {
						return b ? this.onok() : this.oncancel()
					},
					holdScroll: !1
				}, a));
				this.initDialog()
			},
			l, k, n;
		f.prototype = {
			draggable: !1,
			uiName: "dialog",
			initDialog: function() {
				var a = this,
					b = this.editor.options.theme;
				this.cssRules && c.cssRule("edui-customize-" + this.name + "-style", this.cssRules);
				this.initUIBase();
				this.modalMask = l || (l = new d({
					className: "edui-dialog-modalmask",
					theme: b,
					onclick: function() {
						n && n.close(!1)
					}
				}));
				this.dragMask = k || (k = new d({
					className: "edui-dialog-dragmask",
					theme: b
				}));
				this.closeButton = new g({
					className: "edui-dialog-closebutton",
					title: a.closeDialog,
					theme: b,
					onclick: function() {
						a.close(!1)
					}
				});
				this.fullscreen && this.initResizeEvent();
				if (this.buttons)
					for (b = 0; b < this.buttons.length; b++) this.buttons[b] instanceof g || (this.buttons[b] = new g(c.extend(this.buttons[b], {
						editor: this.editor
					}, !0)))
			},
			initResizeEvent: function() {
				var b = this;
				a.on(window, "resize", function() {
					b._hidden || void 0 === b._hidden || (b.__resizeTimer && window.clearTimeout(b.__resizeTimer), b.__resizeTimer = window.setTimeout(function() {
						b.__resizeTimer = null;
						var a = b.getDom(),
							c = b.getDom("content"),
							d = UE.ui.uiUtils.getClientRect(a),
							f = UE.ui.uiUtils.getClientRect(c),
							k = e.getViewportRect();
						c.style.width = k.width - d.width + f.width + "px";
						c.style.height = k.height - d.height + f.height + "px";
						a.style.width = k.width + "px";
						a.style.height = k.height + "px";
						b.fireEvent("resize")
					}, 100))
				})
			},
			fitSize: function() {
				var a = this.getDom("body"),
					b = this.mesureSize();
				a.style.width = b.width + "px";
				a.style.height = b.height + "px";
				return b
			},
			safeSetOffset: function(a) {
				var b = this.getDom(),
					c = e.getViewportRect(),
					d = e.getClientRect(b),
					f = a.left;
				f + d.width > c.right && (f = c.right - d.width);
				a = a.top;
				a + d.height > c.bottom && (a = c.bottom - d.height);
				b.style.left = Math.max(f, 0) + "px";
				b.style.top = Math.max(a, 0) + "px"
			},
			showAtCenter: function() {
				var b = e.getViewportRect();
				if (this.fullscreen) {
					var c = this.getDom(),
						d = this.getDom("content");
					c.style.display = "block";
					var f = UE.ui.uiUtils.getClientRect(c),
						k = UE.ui.uiUtils.getClientRect(d);
					c.style.left = "-100000px";
					d.style.width = b.width - f.width + k.width + "px";
					d.style.height = b.height - f.height + k.height + "px";
					c.style.width = b.width + "px";
					c.style.height = b.height + "px";
					c.style.left = 0;
					this._originalContext = {
						html: {
							overflowX: document.documentElement.style.overflowX,
							overflowY: document.documentElement.style.overflowY
						},
						body: {
							overflowX: document.body.style.overflowX,
							overflowY: document.body.style.overflowY
						}
					};
					document.documentElement.style.overflowX = "hidden";
					document.documentElement.style.overflowY = "hidden";
					document.body.style.overflowX = "hidden";
					document.body.style.overflowY = "hidden"
				} else this.getDom().style.display = "", d = this.fitSize(), f = this.getDom("titlebar").offsetHeight | 0, c = b.width / 2 - d.width / 2, b = b.height / 2 - (d.height - f) / 2 - f, d = this.getDom(), this.safeSetOffset({
					left: Math.max(c | 0, 0),
					top: Math.max(b | 0, 0)
				}), a.hasClass(d, "edui-state-centered") || (d.className += " edui-state-centered");
				this._show()
			},
			getContentHtml: function() {
				var a = "";
				"string" == typeof this.content ? a = this.content : this.iframeUrl && (a = '<span id="' + this.id + '_contmask" class="dialogcontmask"></span><iframe id="' + this.id + '_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="' + this.iframeUrl + '"></iframe>');
				return a
			},
			getHtmlTpl: function() {
				var a = "";
				if (this.buttons) {
					for (var a = [], b = 0; b < this.buttons.length; b++) a[b] = this.buttons[b].renderHtml();
					a = '<div class="%%-foot"><div id="##_buttons" class="%%-buttons">' + a.join("") + "</div></div>"
				}
				return '<div id="##" class="%%"><div ' + (this.fullscreen ? 'class="%%-wrap edui-dialog-fullscreen-flag"' : 'class="%%"') + '><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">' + (this.title || "") + "</span></div>" + this.closeButton.renderHtml() + '</div><div id="##_content" class="%%-content">' + (this.autoReset ? "" : this.getContentHtml()) + "</div>" + a + "</div></div></div>"
			},
			postRender: function() {
				this.modalMask.getDom() || (this.modalMask.render(), this.modalMask.hide());
				this.dragMask.getDom() || (this.dragMask.render(), this.dragMask.hide());
				var b = this;
				this.addListener("show", function() {
					b.modalMask.show(this.getDom().style.zIndex - 2)
				});
				this.addListener("hide", function() {
					b.modalMask.hide()
				});
				if (this.buttons)
					for (var c = 0; c < this.buttons.length; c++) this.buttons[c].postRender();
				a.on(window, "resize", function() {
					setTimeout(function() {
						b.isHidden() || b.safeSetOffset(e.getClientRect(b.getDom()))
					})
				});
				this._hide()
			},
			mesureSize: function() {
				var a = this.getDom("body"),
					b = e.getClientRect(this.getDom("content")).width;
				a.style.width = b;
				return e.getClientRect(a)
			},
			_onTitlebarMouseDown: function(b, c) {
				if (this.draggable) {
					var d;
					e.getViewportRect();
					var f = this;
					e.startDrag(b, {
						ondragstart: function() {
							d = e.getClientRect(f.getDom());
							f.getDom("contmask").style.visibility = "visible";
							f.dragMask.show(f.getDom().style.zIndex - 1)
						},
						ondragmove: function(a, b) {
							f.safeSetOffset({
								left: d.left + a,
								top: d.top + b
							})
						},
						ondragstop: function() {
							f.getDom("contmask").style.visibility = "hidden";
							a.removeClasses(f.getDom(), ["edui-state-centered"]);
							f.dragMask.hide()
						}
					})
				}
			},
			reset: function() {
				this.getDom("content").innerHTML = this.getContentHtml();
				this.fireEvent("dialogafterreset")
			},
			_show: function() {
				this._hidden && (this.getDom().style.display = "", this.editor.container.style.zIndex && (this.getDom().style.zIndex = 1 * this.editor.container.style.zIndex + 10), this._hidden = !1, this.fireEvent("show"), q.editor.ui.uiUtils.getFixedLayer().style.zIndex = this.getDom().style.zIndex - 4)
			},
			isHidden: function() {
				return this._hidden
			},
			_hide: function() {
				if (!this._hidden) {
					var a = this.getDom();
					a.style.display = "none";
					a.style.zIndex = "";
					a.style.width = "";
					a.style.height = "";
					this._hidden = !0;
					this.fireEvent("hide")
				}
			},
			open: function() {
				if (this.autoReset) try {
					this.reset()
				} catch (m) {
					this.render(), this.open()
				}
				this.showAtCenter();
				if (this.iframeUrl) try {
					this.getDom("iframe").focus()
				} catch (m) {}
				n = this
			},
			_onCloseButtonClick: function(a, b) {
				this.close(!1)
			},
			close: function(b) {
				if (!1 !== this.fireEvent("close", b)) {
					this.fullscreen && (document.documentElement.style.overflowX = this._originalContext.html.overflowX, document.documentElement.style.overflowY = this._originalContext.html.overflowY, document.body.style.overflowX = this._originalContext.body.overflowX, document.body.style.overflowY = this._originalContext.body.overflowY, delete this._originalContext);
					this._hide();
					b = this.getDom("content");
					var c = this.getDom("iframe");
					b && c && ((c = c.contentDocument || c.contentWindow.document) && (c.body.innerHTML = ""), a.remove(b))
				}
			}
		};
		c.inherits(f, b)
	})();
	(function() {
		var c = q.editor.utils,
			a = q.editor.ui.Menu,
			e = q.editor.ui.SplitButton,
			d = q.editor.ui.MenuButton = function(a) {
				this.initOptions(a);
				this.initMenuButton()
			};
		d.prototype = {
			initMenuButton: function() {
				var b = this;
				this.uiName = "menubutton";
				this.popup = new a({
					items: b.items,
					className: b.className,
					editor: b.editor
				});
				this.popup.addListener("show", function() {
					for (var a = 0; a < this.items.length; a++) this.items[a].removeState("checked"), this.items[a].value == b._value && (this.items[a].addState("checked"), this.value = b._value)
				});
				this.initSplitButton()
			},
			setValue: function(a) {
				this._value = a
			}
		};
		c.inherits(d, e)
	})();
	(function() {
		var c = q.editor.utils,
			a = q.editor.ui.Popup,
			e = q.editor.ui.SplitButton,
			d = q.editor.ui.MultiMenuPop = function(a) {
				this.initOptions(a);
				this.initMultiMenu()
			};
		d.prototype = {
			initMultiMenu: function() {
				var b = this;
				this.popup = new a({
					content: "",
					editor: b.editor,
					iframe_rendered: !1,
					onshow: function() {
						this.iframe_rendered || (this.iframe_rendered = !0, this.getDom("content").innerHTML = '<iframe id="' + b.id + '_iframe" src="' + b.iframeUrl + '" frameborder="0"></iframe>', b.editor.container.style.zIndex && (this.getDom().style.zIndex = 1 * b.editor.container.style.zIndex + 1))
					}
				});
				this.onbuttonclick = function() {
					this.showPopup()
				};
				this.initSplitButton()
			}
		};
		c.inherits(d, e)
	})();
	(function() {
		function c(a) {
			if (!g.findParent(a.target || a.srcElement, function(a) {
					return g.hasClass(a, "edui-shortcutmenu") || g.hasClass(a, "edui-popup")
				}, !0)) {
				a = 0;
				for (var b; b = f[a++];) b.hide()
			}
		}
		var a = q.editor.ui,
			e = a.UIBase,
			d = a.uiUtils,
			b = q.editor.utils,
			g = q.editor.dom.domUtils,
			f = [],
			l = !1,
			k = a.ShortCutMenu = function(a) {
				this.initOptions(a);
				this.initShortCutMenu()
			};
		k.postHide = c;
		k.prototype = {
			isHidden: !0,
			SPACE: 5,
			initShortCutMenu: function() {
				this.items = this.items || [];
				this.initUIBase();
				this.initItems();
				this.initEvent();
				f.push(this)
			},
			initEvent: function() {
				var a = this;
				g.on(a.editor.document, "mousemove", function(b) {
					!1 !== a.isHidden || a.getSubMenuMark() || "contextmenu" == a.eventType || a.getDom()
				});
				a.editor.addListener("afterhidepop", function() {
					a.isHidden || (l = !0)
				})
			},
			initItems: function() {
				if (b.isArray(this.items))
					for (var c = 0, d = this.items.length; c < d; c++) {
						var e = this.items[c].toLowerCase();
						a[e] && (this.items[c] = new a[e](this.editor), this.items[c].className += " edui-shortcutsubmenu ")
					}
			},
			setOpacity: function(a, b) {
				t.ie && 9 > t.version ? a.style.filter = "alpha(opacity = " + 100 * parseFloat(b) + ");" : a.style.opacity = b
			},
			getSubMenuMark: function() {
				l = !1;
				for (var a = d.getFixedLayer(), a = g.getElementsByTagName(a, "div", function(a) {
						return g.hasClass(a, "edui-shortcutsubmenu edui-popup")
					}), b = 0, c; c = a[b++];) "none" != c.style.display && (l = !0);
				return l
			},
			show: function(a, b) {
				function c(a) {
					0 > a.left && (a.left = 0);
					0 > a.top && (a.top = 0);
					k.style.cssText = "position:absolute;left:" + a.left + "px;top:" + a.top + "px;"
				}

				function e(a) {
					a.tagName || (a = a.getDom());
					f.left = parseInt(a.style.left);
					f.top = parseInt(a.style.top);
					f.top -= k.offsetHeight + 15;
					c(f)
				}
				var f = {},
					k = this.getDom(),
					h = d.getFixedLayer();
				this.eventType = a.type;
				k.style.cssText = "display:block;left:-9999px";
				if ("contextmenu" == a.type && b) {
					var l = g.getElementsByTagName(h, "div", "edui-contextmenu")[0];
					l ? e(l) : this.editor.addListener("aftershowcontextmenu", function(a, b) {
						e(b)
					})
				} else f = d.getViewportOffsetByEvent(a), f.top -= k.offsetHeight + this.SPACE + 15, f.left += this.SPACE + 15, f.left > window.document.body.offsetWidth - 320 && (f.left = window.document.body.offsetWidth - 330), 100 > f.top && (f.top += k.offsetHeight + 2 * (this.SPACE + 15)), c(f), this.setOpacity(k, .2);
				this.isHidden = !1;
				this.left = a.screenX + k.offsetWidth / 2 - this.SPACE;
				this.top = a.screenY - k.offsetHeight / 2 - this.SPACE;
				this.editor && (k.style.zIndex = 1 * this.editor.container.style.zIndex + 10, h.style.zIndex = k.style.zIndex - 1)
			},
			hide: function() {
				this.getDom() && (this.getDom().style.display = "none");
				this.isHidden = !0
			},
			postRender: function() {
				if (b.isArray(this.items))
					for (var a = 0, c; c = this.items[a++];) "function" == typeof c.renderHtml && c.postRender()
			},
			getHtmlTpl: function() {
				var a;
				if (b.isArray(this.items)) {
					a = [];
					for (var c = 0; c < this.items.length; c++)
						if ("function" == typeof this.items[c].renderHtml) a[c] = this.items[c].renderHtml();
						else if ("|" == this.items[c] || "<br>" == this.items[c]) a[c] = "<br/>";
					a = a.join("")
				} else a = this.items;
				return '<div id="##" class="%% edui-toolbar" data-src="shortcutmenu" onmousedown="return false;" onselectstart="return false;" >' + a + "</div>"
			}
		};
		b.inherits(k, e);
		g.on(document, "mousedown", function(a) {
			c(a)
		});
		g.on(window, "scroll", function(a) {
			c(a)
		})
	})();
	(function() {
		var c = q.editor.utils,
			a = q.editor.ui.UIBase,
			e = q.editor.ui.Breakline = function(a) {
				this.initOptions(a);
				this.initSeparator()
			};
		e.prototype = {
			uiName: "Breakline",
			initSeparator: function() {
				this.initUIBase()
			},
			getHtmlTpl: function() {
				return "<br/>"
			}
		};
		c.inherits(e, a)
	})();
	(function() {
		var c = q.editor.utils,
			a = q.editor.dom.domUtils,
			e = q.editor.ui.UIBase,
			d = q.editor.ui.Message = function(a) {
				this.initOptions(a);
				this.initMessage()
			};
		d.prototype = {
			initMessage: function() {
				this.initUIBase()
			},
			getHtmlTpl: function() {
				return '<div id="##" class="edui-message %%"> <div id="##_closer" class="edui-message-closer">×</div> <div id="##_body" class="edui-message-body edui-message-type-info"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-message-content">  </div> </div></div>'
			},
			reset: function(a) {
				var b = this;
				a.keepshow || (clearTimeout(this.timer), b.timer = setTimeout(function() {
					b.hide()
				}, a.timeout || 4E3));
				void 0 !== a.content && b.setContent(a.content);
				void 0 !== a.type && b.setType(a.type);
				b.show()
			},
			postRender: function() {
				var b = this,
					c = this.getDom("closer");
				c && a.on(c, "click", function() {
					b.hide()
				})
			},
			setContent: function(a) {
				this.getDom("content").innerHTML = a
			},
			setType: function(a) {
				a = a || "info";
				var b = this.getDom("body");
				b.className = b.className.replace(/edui-message-type-[\w-]+/, "edui-message-type-" + a)
			},
			getContent: function() {
				return this.getDom("content").innerHTML
			},
			getType: function() {
				var a = this.getDom("body").match(/edui-message-type-([\w-]+)/);
				return a ? a[1] : ""
			},
			show: function() {
				this.getDom().style.display = "block"
			},
			hide: function() {
				var a = this.getDom();
				a && (a.style.display = "none", a.parentNode && a.parentNode.removeChild(a))
			}
		};
		c.inherits(d, e)
	})();
	(function() {
		var c = q.editor.utils,
			a = q.editor.ui.uiUtils,
			e = q.editor.ui.RemoteContent,
			d = q.editor.ui.Popup,
			b = q.editor.ui.SplitButton,
			g = q.editor.ui.RemoteButton = function(a) {
				this.initOptions(a);
				this.initRemoteButton()
			};
		g.prototype = {
			initRemoteButton: function() {
				var a = this;
				this.popup = new d({
					content: new e({
						editor: a.editor,
						ongetremotesuccess: function(b) {
							a.popup.hide()
						}
					}),
					editor: a.editor
				});
				this.initSplitButton()
			},
			_SplitButton_postRender: b.prototype.postRender,
			postRender: function() {
				this._SplitButton_postRender();
				this.getDom("button_body").appendChild(a.createElementByHtml('<div id="' + this.id + '_colorlump" class="edui-colorlump"></div>'));
				this.getDom().className += " edui-remotebutton"
			}
		};
		c.inherits(g, b)
	})();
	(function() {
		var c = q.editor.utils,
			a = q.editor.ui,
			e = a.Dialog;
		a.buttons = {};
		a.Dialog = function(a) {
			var b = new e(a);
			b.addListener("hide", function() {
				if (b.editor) {
					var a = b.editor;
					try {
						if (t.gecko) {
							var c = a.window.scrollY,
								d = a.window.scrollX;
							a.body.focus();
							a.window.scrollTo(d, c)
						} else a.focus()
					} catch (u) {}
				}
			});
			return b
		};
		for (var d = {
				anchor: "~/dialogs/anchor/anchor.html",
				insertimage: "~/dialogs/image/image.html",
				imgstyle: "~/dialogs/135editor/imgstyle.html",
				link: "~/dialogs/link/link.html",
				spechars: "~/dialogs/spechars/spechars.html",
				searchreplace: "~/dialogs/searchreplace/searchreplace.html",
				map: "~/dialogs/map/map.html",
				gmap: "~/dialogs/gmap/gmap.html",
				insertvideo: "~/dialogs/video/video.html",
				help: "~/dialogs/help/help.html",
				preview: "~/dialogs/preview/preview.html",
				emotion: "~/dialogs/emotion/emotion.html",
				wordimage: "~/dialogs/wordimage/wordimage.html",
				attachment: "~/dialogs/attachment/attachment.html",
				insertframe: "~/dialogs/insertframe/insertframe.html",
				edittip: "~/dialogs/table/edittip.html",
				edittable: "~/dialogs/table/edittable.html",
				edittd: "~/dialogs/table/edittd.html",
				webapp: "~/dialogs/webapp/webapp.html",
				snapscreen: "~/dialogs/snapscreen/snapscreen.html",
				scrawl: "~/dialogs/scrawl/scrawl.html",
				music: "~/dialogs/music/music.html",
				template: "~/dialogs/template/template.html",
				background: "~/dialogs/background/background.html",
				charts: "~/dialogs/charts/charts.html"
			}, b = "undo redo formatmatch bold italic underline fontborder touppercase tolowercase strikethrough subscript superscript source indent outdent blockquote pasteplain pagebreak selectall print horizontal removeformat time date unlink insertparagraph insertparagraphbeforetable insertrow insertcol mergeright mergedown deleterow deletecol splittorows splittocols splittocells mergecells deletetable drafts".split(" "), g = 0, f; f = b[g++];) f = f.toLowerCase(), a[f] = function(b) {
			return function(c) {
				var d = new a.Button({
					className: "edui-for-" + b,
					title: c.options.labelMap[b] || c.getLang("labelMap." + b) || "",
					onclick: function() {
						c.execCommand(b)
					},
					theme: c.options.theme,
					showText: !1
				});
				a.buttons[b] = d;
				c.addListener("selectionchange", function(a, e, f) {
					a = c.queryCommandState(b); - 1 == a ? (d.setDisabled(!0), d.setChecked(!1)) : f || (d.setDisabled(!1), d.setChecked(a))
				});
				return d
			}
		}(f);
		a.cleardoc = function(b) {
			var c = new a.Button({
				className: "edui-for-cleardoc",
				title: b.options.labelMap.cleardoc || b.getLang("labelMap.cleardoc") || "",
				theme: b.options.theme,
				onclick: function() {
					confirm(b.getLang("confirmClear")) && b.execCommand("cleardoc")
				}
			});
			a.buttons.cleardoc = c;
			b.addListener("selectionchange", function() {
				c.setDisabled(-1 == b.queryCommandState("cleardoc"))
			});
			return c
		};
		var b = {
				justify: ["left", "right", "center", "justify"],
				imagefloat: ["none", "left", "center", "right"],
				directionality: ["ltr", "rtl"]
			},
			l;
		for (l in b)(function(b, c) {
			for (var d = 0, e; e = c[d++];)(function(c) {
				a[b.replace("float", "") + c] = function(d) {
					var e = new a.Button({
						className: "edui-for-" + b.replace("float", "") + c,
						title: d.options.labelMap[b.replace("float", "") + c] || d.getLang("labelMap." + b.replace("float", "") + c) || "",
						theme: d.options.theme,
						onclick: function() {
							d.execCommand(b, c)
						}
					});
					a.buttons[b] = e;
					d.addListener("selectionchange", function(a, f, k) {
						e.setDisabled(-1 == d.queryCommandState(b));
						e.setChecked(d.queryCommandValue(b) == c && !k)
					});
					return e
				}
			})(e)
		})(l, b[l]);
		for (g = 0; f = ["backcolor", "forecolor"][g++];) a[f] = function(b) {
			return function(c) {
				var d = new a.ColorButton({
					className: "edui-for-" + b,
					color: "default",
					title: c.options.labelMap[b] || c.getLang("labelMap." + b) || "",
					editor: c,
					onpickcolor: function(a, d) {
						c.execCommand(b, d)
					},
					onpicknocolor: function() {
						c.execCommand(b, "default");
						this.setColor("transparent");
						this.color = "default"
					},
					onbuttonclick: function() {
						c.execCommand(b, this.color)
					}
				});
				a.buttons[b] = d;
				c.addListener("selectionchange", function() {
					d.setDisabled(-1 == c.queryCommandState(b))
				});
				return d
			}
		}(f);
		b = {
			noOk: ["searchreplace", "help", "imgstyle", "webapp", "preview"],
			ok: "attachment anchor link insertimage map gmap insertframe wordimage insertvideo insertframe edittip edittable edittd scrawl template music background charts".split(" ")
		};
		for (l in b)(function(b, e) {
			for (var f = 0, k; k = e[f++];) t.opera && "searchreplace" === k ||
				function(e) {
					a[e] = function(f, k, g) {
						k = k || (f.options.iframeUrlMap || {})[e] || d[e];
						g = f.options.labelMap[e] || f.getLang("labelMap." + e) || "";
						var h;
						k && (h = new a.Dialog(c.extend({
							iframeUrl: f.ui.mapUrl(k),
							editor: f,
							className: "edui-for-" + e,
							title: g,
							holdScroll: "insertimage" === e,
							fullscreen: /charts/.test(e),
							closeDialog: f.getLang("closeDialog")
						}, "ok" == b ? {
							buttons: [{
								className: "edui-okbutton",
								label: f.getLang("ok"),
								editor: f,
								onclick: function() {
									h.close(!0)
								}
							}, {
								className: "edui-cancelbutton",
								label: f.getLang("cancel"),
								editor: f,
								onclick: function() {
									h.close(!1)
								}
							}]
						} : {})), f.ui._dialogs[e + "Dialog"] = h);
						var l = new a.Button({
							className: "edui-for-" + e,
							title: g,
							onclick: function() {
								if (h) switch (e) {
									case "wordimage":
										var a = f.execCommand("wordimage");
										a && a.length && (h.render(), h.open());
										break;
									case "scrawl":
										-1 != f.queryCommandState("scrawl") && (h.render(), h.open());
										break;
									default:
										h.render(), h.open()
								}
							},
							theme: f.options.theme,
							disabled: "scrawl" == e && -1 == f.queryCommandState("scrawl") || "charts" == e
						});
						a.buttons[e] = l;
						f.addListener("selectionchange", function() {
							if (!(e in {
									edittable: 1
								})) {
								var a = f.queryCommandState(e);
								l.getDom() && (l.setDisabled(-1 == a), l.setChecked(a))
							}
						});
						return l
					}
				}(k.toLowerCase())
		})(l, b[l]);
		a.snapscreen = function(b, c, e) {
			e = b.options.labelMap.snapscreen || b.getLang("labelMap.snapscreen") || "";
			var f = new a.Button({
				className: "edui-for-snapscreen",
				title: e,
				onclick: function() {
					b.execCommand("snapscreen")
				},
				theme: b.options.theme
			});
			a.buttons.snapscreen = f;
			if (c = c || (b.options.iframeUrlMap || {}).snapscreen || d.snapscreen) {
				var g = new a.Dialog({
					iframeUrl: b.ui.mapUrl(c),
					editor: b,
					className: "edui-for-snapscreen",
					title: e,
					buttons: [{
						className: "edui-okbutton",
						label: b.getLang("ok"),
						editor: b,
						onclick: function() {
							g.close(!0)
						}
					}, {
						className: "edui-cancelbutton",
						label: b.getLang("cancel"),
						editor: b,
						onclick: function() {
							g.close(!1)
						}
					}]
				});
				g.render();
				b.ui._dialogs.snapscreenDialog = g
			}
			b.addListener("selectionchange", function() {
				f.setDisabled(-1 == b.queryCommandState("snapscreen"))
			});
			return f
		};
		a.insertcode = function(b, d, e) {
			d = b.options.insertcode || [];
			e = b.options.labelMap.insertcode || b.getLang("labelMap.insertcode") || "";
			var f = [];
			c.each(d, function(a, c) {
				f.push({
					label: a,
					value: c,
					theme: b.options.theme,
					renderLabelHtml: function() {
						return '<div class="edui-label %%-label" >' + (this.label || "") + "</div>"
					}
				})
			});
			var g = new a.Combox({
				editor: b,
				items: f,
				onselect: function(a, c) {
					b.execCommand("insertcode", this.items[c].value)
				},
				onbuttonclick: function() {
					this.showPopup()
				},
				title: e,
				initValue: e,
				className: "edui-for-insertcode",
				indexByValue: function(a) {
					if (a)
						for (var b = 0, c; c = this.items[b]; b++)
							if (-1 != c.value.indexOf(a)) return b;
					return -1
				}
			});
			a.buttons.insertcode = g;
			b.addListener("selectionchange", function(a, c, d) {
				d || (-1 == b.queryCommandState("insertcode") ? g.setDisabled(!0) : (g.setDisabled(!1), (a = b.queryCommandValue("insertcode")) ? (a && (a = a.replace(/['"]/g, "").split(",")[0]), g.setValue(a)) : g.setValue(e)))
			});
			return g
		};
		a.fontfamily = function(b, d, e) {
			d = b.options.fontfamily || [];
			e = b.options.labelMap.fontfamily || b.getLang("labelMap.fontfamily") || "";
			if (d.length) {
				for (var f = 0, g, k = []; g = d[f]; f++) {
					var h = b.getLang("fontfamily")[g.name] || "";
					(function(a, d) {
						k.push({
							label: a,
							value: d,
							theme: b.options.theme,
							renderLabelHtml: function() {
								return '<div class="edui-label %%-label" style="font-family:' + c.unhtml(this.value) + '">' + (this.label || "") + "</div>"
							}
						})
					})(g.label || h, g.val)
				}
				b.options.open_editor || k.push({
					value: "more-fonts",
					onclick: function() {},
					theme: b.options.theme,
					renderLabelHtml: function() {
						return '<div class="edui-label"><a href="http://www.135editor.com/user_settings/setting?type=fonts" target="_blank">选择更多字体</a></div>'
					}
				});
				var l = new a.Combox({
					editor: b,
					items: k,
					onselect: function(a, c) {
						b.execCommand("FontFamily", this.items[c].value)
					},
					onbuttonclick: function() {
						this.showPopup()
					},
					title: e,
					initValue: e,
					className: "edui-for-fontfamily",
					indexByValue: function(a) {
						if (a)
							for (var b = 0, c; c = this.items[b]; b++)
								if (-1 != c.value.indexOf(a)) return b;
						return -1
					}
				});
				a.buttons.fontfamily = l;
				b.addListener("selectionchange", function(a, c, d) {
					d || (-1 == b.queryCommandState("FontFamily") ? l.setDisabled(!0) : (l.setDisabled(!1), (a = b.queryCommandValue("FontFamily")) && (a = a.replace(/['"]/g, "").split(",")[0]), l.setValue(a)))
				});
				return l
			}
		};
		a.fontsize = function(b, c, d) {
			d = b.options.labelMap.fontsize || b.getLang("labelMap.fontsize") || "";
			c = c || b.options.fontsize || [];
			 var fonhtx = b.options.fontsizehtx; //编辑器字号修改成小五之类的...
			if (c.length) {
				for (var e = [], f = 0; f < c.length; f++) {
					var g = c[f] + "px";
					var ghtx = fonhtx[f];
					e.push({
						label: ghtx,
						value: g,
						theme: b.options.theme,
						renderLabelHtml: function() {
							return '<div class="edui-label %%-label" style="line-height:1;font-size:' + this.value + '">' + (this.label || "") + "</div>"
						}
					})
				}
				var k = new a.Combox({
					editor: b,
					items: e,
					title: d,
					useInput: t.ie && 9 > t.version ? !1 : !0,
					initValue: d,
					onselect: function(a, c) {
						b.execCommand("FontSize", this.items[c].value)
					},
					onbuttonclick: function() {
						this.showPopup()
					},
					oninputclick: function() {
						var a = this;
						setTimeout(function() {
							var b = a.getDom("wx_input"),
								c = (parseInt(this.value), b.value);
							parseInt(c);
							t.ie ? (b.value = "", b.focus()) : (b.focus(), b.select())
						}, 100)
					},
					oninputblur: function() {
						var a = this.getDom("wx_input"),
							c = a.value,
							d = parseInt(c),
							e = parseInt(this.value);
						return "" == c ? (a.value = e + "px", !1) : (10 > d && (d = 10), 72 < d && (d = 72), e == d ? !1 : void b.execCommand("FontSize", d + "px"))
					},
					oninputkeydown: function(a, b) {
						var c = b.keyCode || b.which,
							d = this.getDom("wx_input");
						13 == c && (d.blur(), b.stopPropagation ? (b.stopPropagation(), b.preventDefault()) : b.cancelBubble = !0)
					},
					className: "edui-for-fontsize"
				});
				a.buttons.fontsize = k;
				b.addListener("selectionchange", function(a, c, d) {
					d || (-1 == b.queryCommandState("FontSize") ? k.setDisabled(!0) : (k.setDisabled(!1), k.setValue(b.queryCommandValue("FontSize"))))
				});
				return k
			}
		};
		a.paragraph = function(b, d, e) {
			e = b.options.labelMap.paragraph || b.getLang("labelMap.paragraph") || "";
			d = b.options.paragraph || [];
			if (!c.isEmptyObject(d)) {
				var f = [],
					g;
				for (g in d) f.push({
					value: g,
					label: d[g] || b.getLang("paragraph")[g],
					theme: b.options.theme,
					renderLabelHtml: function() {
						return '<div class="edui-label %%-label"><span class="edui-for-' + this.value + '">' + (this.label || "") + "</span></div>"
					}
				});
				var k = new a.Combox({
					editor: b,
					items: f,
					title: e,
					initValue: e,
					className: "edui-for-paragraph",
					onselect: function(a, c) {
						b.execCommand("Paragraph", this.items[c].value)
					},
					onbuttonclick: function() {
						this.showPopup()
					}
				});
				a.buttons.paragraph = k;
				b.addListener("selectionchange", function(a, c, d) {
					d || (-1 == b.queryCommandState("Paragraph") ? k.setDisabled(!0) : (k.setDisabled(!1), a = b.queryCommandValue("Paragraph"), -1 != k.indexByValue(a) ? k.setValue(a) : k.setValue(k.initValue)))
				});
				return k
			}
		};
		a.customstyle = function(b) {
			var c = b.options.customstyle || [],
				d = b.options.labelMap.customstyle || b.getLang("labelMap.customstyle") || "";
			if (c.length) {
				for (var e = b.getLang("customstyle"), f = 0, g = [], k; k = c[f++];)(function(a) {
					var c = {};
					c.label = a.label ? a.label : e[a.name];
					c.style = a.style;
					c.className = a.className;
					c.tag = a.tag;
					g.push({
						label: c.label,
						value: c,
						theme: b.options.theme,
						renderLabelHtml: function() {
							return '<div class="edui-label %%-label"><' + c.tag + " " + (c.className ? ' class="' + c.className + '"' : "") + (c.style ? ' style="' + c.style + '"' : "") + ">" + c.label + "</" + c.tag + "></div>"
						}
					})
				})(k);
				var h = new a.Combox({
					editor: b,
					items: g,
					title: d,
					initValue: d,
					className: "edui-for-customstyle",
					onselect: function(a, c) {
						b.execCommand("customstyle", this.items[c].value)
					},
					onbuttonclick: function() {
						this.showPopup()
					},
					indexByValue: function(a) {
						for (var b = 0, c; c = this.items[b++];)
							if (c.label == a) return b - 1;
						return -1
					}
				});
				a.buttons.customstyle = h;
				b.addListener("selectionchange", function(a, c, d) {
					d || (-1 == b.queryCommandState("customstyle") ? h.setDisabled(!0) : (h.setDisabled(!1), a = b.queryCommandValue("customstyle"), -1 != h.indexByValue(a) ? h.setValue(a) : h.setValue(h.initValue)))
				});
				return h
			}
		};
		a.inserttable = function(b, c, d) {
			d = b.options.labelMap.inserttable || b.getLang("labelMap.inserttable") || "";
			var e = new a.TableButton({
				editor: b,
				title: d,
				className: "edui-for-inserttable",
				onpicktable: function(a, c, d) {
					b.execCommand("InsertTable", {
						numRows: d,
						numCols: c,
						border: 1
					})
				},
				onbuttonclick: function() {
					this.showPopup()
				}
			});
			a.buttons.inserttable = e;
			b.addListener("selectionchange", function() {
				e.setDisabled(-1 == b.queryCommandState("inserttable"))
			});
			return e
		};
		a.lineheight = function(b) {
			var c = b.options.lineheight || [];
			if (c.length) {
				for (var d = 0, e, f = []; e = c[d++];) f.push({
					label: e,
					value: e,
					theme: b.options.theme,
					onclick: function() {
						b.execCommand("lineheight", this.value)
					}
				});
				var g = new a.MenuButton({
					editor: b,
					className: "edui-for-lineheight",
					title: b.options.labelMap.lineheight || b.getLang("labelMap.lineheight") || "",
					items: f,
					onbuttonclick: function() {
						var a = b.queryCommandValue("LineHeight") || this.value;
						b.execCommand("LineHeight", a)
					}
				});
				a.buttons.lineheight = g;
				b.addListener("selectionchange", function() {
					var a = b.queryCommandState("LineHeight");
					if (-1 == a) g.setDisabled(!0);
					else {
						g.setDisabled(!1);
						var c = b.queryCommandValue("LineHeight");
						c && g.setValue((c + "").replace(/cm/, ""));
						g.setChecked(a)
					}
				});
				return g
			}
		};
		a.letterspacing = function(b) {
			var c = b.options.letterspacing || [];
			if (c.length) {
				for (var d = 0, e, f = []; d < c.length; d++) e = "" + c[d], f.push({
					label: e,
					value: e,
					theme: b.options.theme,
					onclick: function() {
						b.execCommand("letterspacing", this.value)
					}
				});
				var g = new a.MenuButton({
					editor: b,
					className: "edui-for-letterspacing",
					title: b.options.labelMap.letterspacing || b.getLang("labelMap.letterspacing") || "",
					items: f,
					onbuttonclick: function() {
						var a = b.queryCommandValue("LetterSpacing") || this.value;
						b.execCommand("LetterSpacing", a)
					}
				});
				a.buttons.letterspacing = g;
				b.addListener("selectionchange", function() {
					var a = b.queryCommandState("LetterSpacing");
					if (-1 == a) g.setDisabled(!0);
					else {
						g.setDisabled(!1);
						var c = b.queryCommandValue("LetterSpacing");
						c && g.setValue((c + "").replace(/cm/, ""));
						g.setChecked(a)
					}
				});
				return g
			}
		};
		a.outpadding = function(b) {
			var c = b.options.outpadding || [];
			if (c.length) {
				for (var d = 0, e, f = []; d < c.length; d++) e = "" + c[d], f.push({
					label: e,
					value: e,
					theme: b.options.theme,
					onclick: function() {
						b.execCommand("outpadding", this.value)
					}
				});
				var g = new a.MenuButton({
					editor: b,
					className: "edui-for-outpadding",
					title: b.options.labelMap.outpadding || b.getLang("labelMap.outpadding") || "",
					items: f,
					onbuttonclick: function() {
						var a = b.queryCommandValue("outpadding") || this.value;
						b.execCommand("outpadding", a)
					}
				});
				a.buttons.outpadding = g;
				b.addListener("selectionchange", function() {
					var a = b.queryCommandState("outpadding");
					if (-1 == a) g.setDisabled(!0);
					else {
						g.setDisabled(!1);
						var c = b.queryCommandValue("outpadding");
						c && g.setValue((c + "").replace(/cm/, ""));
						g.setChecked(a)
					}
				});
				return g
			}
		};
		l = ["top", "bottom"];
		for (b = 0; g = l[b++];)(function(b) {
			a["rowspacing" + b] = function(c) {
				var d = c.options["rowspacing" + b] || [];
				if (!d.length) return null;
				for (var e = 0, f, g = []; f = d[e++];) g.push({
					label: f,
					value: f,
					theme: c.options.theme,
					onclick: function() {
						c.execCommand("rowspacing", this.value, b)
					}
				});
				var k = new a.MenuButton({
					editor: c,
					className: "edui-for-rowspacing" + b,
					title: c.options.labelMap["rowspacing" + b] || c.getLang("labelMap.rowspacing" + b) || "",
					items: g,
					onbuttonclick: function() {
						var a = c.queryCommandValue("rowspacing", b) || this.value;
						c.execCommand("rowspacing", a, b)
					}
				});
				a.buttons[b] = k;
				c.addListener("selectionchange", function() {
					var a = c.queryCommandState("rowspacing", b);
					if (-1 == a) k.setDisabled(!0);
					else {
						k.setDisabled(!1);
						var d = c.queryCommandValue("rowspacing", b);
						d && k.setValue((d + "").replace(/%/, ""));
						k.setChecked(a)
					}
				});
				return k
			}
		})(g);
		l = ["insertorderedlist", "insertunorderedlist"];
		for (b = 0; g = l[b++];)(function(b) {
			a[b] = function(c) {
				var d = c.options[b],
					e = function() {
						c.execCommand(b, this.value)
					},
					f = [],
					g;
				for (g in d) f.push({
					label: d[g] || c.getLang()[b][g] || "",
					value: g,
					theme: c.options.theme,
					onclick: e
				});
				var k = new a.MenuButton({
					editor: c,
					className: "edui-for-" + b,
					title: c.getLang("labelMap." + b) || "",
					items: f,
					onbuttonclick: function() {
						var a = c.queryCommandValue(b) || this.value;
						c.execCommand(b, a)
					}
				});
				a.buttons[b] = k;
				c.addListener("selectionchange", function() {
					var a = c.queryCommandState(b);
					if (-1 == a) k.setDisabled(!0);
					else {
						k.setDisabled(!1);
						var d = c.queryCommandValue(b);
						k.setValue(d);
						k.setChecked(a)
					}
				});
				return k
			}
		})(g);
		a.fullscreen = function(b, c) {
			c = b.options.labelMap.fullscreen || b.getLang("labelMap.fullscreen") || "";
			var d = new a.Button({
				className: "edui-for-fullscreen",
				title: c,
				theme: b.options.theme,
				onclick: function() {
					b.ui && b.ui.setFullScreen(!b.ui.isFullScreen());
					this.setChecked(b.ui.isFullScreen())
				}
			});
			a.buttons.fullscreen = d;
			b.addListener("selectionchange", function() {
				var a = b.queryCommandState("fullscreen");
				d.setDisabled(-1 == a);
				d.setChecked(b.ui.isFullScreen())
			});
			return d
		};
		a.emotion = function(b, c) {
			var e = new a.MultiMenuPop({
				title: b.options.labelMap.emotion || b.getLang("labelMap.emotion") || "",
				editor: b,
				className: "edui-for-emotion",
				iframeUrl: b.ui.mapUrl(c || (b.options.iframeUrlMap || {}).emotion || d.emotion)
			});
			a.buttons.emotion = e;
			b.addListener("selectionchange", function() {
				e.setDisabled(-1 == b.queryCommandState("emotion"))
			});
			return e
		};
		a.spechars = function(b, c) {
			var e = new a.MultiMenuPop({
				title: b.options.labelMap.spechars || b.getLang("labelMap.spechars") || "",
				editor: b,
				className: "edui-for-spechars",
				iframeUrl: b.ui.mapUrl(c || (b.options.iframeUrlMap || {}).spechars || d.spechars)
			});
			a.buttons.spechars = e;
			b.addListener("selectionchange", function() {
				e.setDisabled(-1 == b.queryCommandState("spechars"))
			});
			return e
		};
		a.autotypeset = function(b) {
			var c = new a.AutoTypeSetButton({
				editor: b,
				title: b.options.labelMap.autotypeset || b.getLang("labelMap.autotypeset") || "",
				className: "edui-for-autotypeset",
				onbuttonclick: function() {
					b.execCommand("autotypeset")
				}
			});
			a.buttons.autotypeset = c;
			b.addListener("selectionchange", function() {
				c.setDisabled(-1 == b.queryCommandState("autotypeset"))
			});
			return c
		};
		a.simpleupload = function(b) {
			var c = new a.Button({
				className: "edui-for-simpleupload",
				title: b.options.labelMap.simpleupload || b.getLang("labelMap.simpleupload") || "",
				onclick: function() {},
				theme: b.options.theme,
				showText: !1
			});
			a.buttons.simpleupload = c;
			b.addListener("ready", function() {
				var a = c.getDom("body").children[0];
				b.fireEvent("simpleuploadbtnready", a)
			});
			b.addListener("selectionchange", function(a, d, e) {
				a = b.queryCommandState("simpleupload"); - 1 == a ? (c.setDisabled(!0), c.setChecked(!1)) : e || (c.setDisabled(!1), c.setChecked(a))
			});
			return c
		}

		a.abstract = function(b) {
			var c = new a.Button({
				className: "edui-for-abstract",
				title:'摘要提取',
				onclick: function() {},
				theme: b.options.theme,
				showText: !1
			});

			a.buttons.abstract = c;
			b.addListener("ready", function() {
				var a = c.getDom("body").children[0];
				b.fireEvent("simpleuploadbtnready", a)
			});
			// b.addListener("selectionchange", function(a, d, e) {
			// 	a = b.queryCommandState("simpleupload"); - 1 == a ? (c.setDisabled(!0), c.setChecked(!1)) : e || (c.setDisabled(!1), c.setChecked(a))
			// });
			return c
		}

		a.keyWords = function(b) {
			var c = new a.Button({
				className: "edui-for-keyWords",
				title:'摘要关键词',
				onclick: function() {},
				theme: b.options.theme,
				showText: !1
			});
			a.buttons.keyWords = c;
			b.addListener("ready", function() {
				var a = c.getDom("body").children[0];
				b.fireEvent("simpleuploadbtnready", a)
			});
			// b.addListener("selectionchange", function(a, d, e) {
			// 	a = b.queryCommandState("simpleupload"); - 1 == a ? (c.setDisabled(!0), c.setChecked(!1)) : e || (c.setDisabled(!1), c.setChecked(a))
			// });
			return c
		}

		

		a.uploadpdf = function(b) {
			var c = new a.Button({
				className: "edui-for-uploadpdf",
				title: "导入pdf",
				onclick: function() {},
				theme: b.options.theme,
				showText: !1
			});
			a.buttons.uploadword = c;
			b.addListener("ready", function() {
				var a = c.getDom("body").children[0];
				b.fireEvent("uploadpdfbtnready", a)
			});
			// b.addListener("selectionchange", function(d, c, f) {
			// 	d = a.queryCommandState("uploadword"); - 1 == d ? (b.setDisabled(!0), b.setChecked(!1)) : f || (b.setDisabled(!1), b.setChecked(d))
			// });
			return c
		};

		a.uploadword = function(b) {
			var c = new a.Button({
				className: "edui-for-uploadword",
				title: "word导入",
				onclick: function() {},
				theme: b.options.theme,
				showText: !1
			});
			a.buttons.uploadword = c;
			b.addListener("ready", function() {
				var a = c.getDom("body").children[0];
				b.fireEvent("uploadwordbtnready", a)
			});
			// b.addListener("selectionchange", function(d, c, f) {
			// 	d = a.queryCommandState("uploadword"); - 1 == d ? (b.setDisabled(!0), b.setChecked(!1)) : f || (b.setDisabled(!1), b.setChecked(d))
			// });
			return c
		};

	})();
	(function() {
		function c(a) {
			this.initOptions(a);
			this.initEditorUI()
		}
		var a = q.editor.utils,
			e = q.editor.ui.uiUtils,
			d = q.editor.ui.UIBase,
			b = q.editor.dom.domUtils,
			g = [];
		c.prototype = {
			uiName: "editor",
			initEditorUI: function() {
				function a(a, b) {
					a.setOpt({
						wordCount: !0,
						maximumWords: 1E4,
						wordCountMsg: a.options.wordCountMsg || a.getLang("wordCountMsg"),
						wordOverFlowMsg: a.options.wordOverFlowMsg || a.getLang("wordOverFlowMsg")
					});
					var c = a.options,
						d = c.maximumWords,
						e = c.wordCountMsg,
						f = c.wordOverFlowMsg,
						g = b.getDom("wordcount");
					if (c.wordCount)
						if (c = a.getContentLength(!0), c > d) g.innerHTML = f, a.fireEvent("wordcountoverflow");
						else {
							var f = a.getTagLength("img"),
								h = Math.ceil(c / 180 + f / 12);
							g.innerHTML = e.replace("{#images}", f).replace("{#minute}", h).replace("{#leave}", d - c).replace("{#count}", c)
						}
				}
				this.editor.ui = this;
				this._dialogs = {};
				this.initUIBase();
				this._initToolbars();
				var c = this.editor,
					d = this;
				c.addListener("ready", function() {
					c.getDialog = function(a) {
						return c.ui._dialogs[a + "Dialog"]
					};
					b.on(c.window, "scroll", function(a) {
						q.editor.ui.Popup.postHide(a)
					});
					c.ui._actualFrameWidth = c.options.initialFrameWidth;
					UE.browser.ie && 6 === UE.browser.version && c.container.ownerDocument.execCommand("BackgroundImageCache", !1, !0);
					c.options.elementPathEnabled && (c.ui.getDom("elementpath").innerHTML = '<div class="edui-editor-breadcrumb">' + c.getLang("elementPathTip") + ":</div>");
					c.options.wordCount && (b.on(c.document, "click", function() {
						a(c, d);
						b.un(c.document, "click", arguments.callee)
					}), c.ui.getDom("wordcount").innerHTML = c.getLang("wordCountTip"));
					c.ui._scale();
					c.options.scaleEnabled ? (c.autoHeightEnabled && c.disableAutoHeight(), d.enableScale()) : d.disableScale();
					c.options.elementPathEnabled || c.options.wordCount || c.options.scaleEnabled || (c.ui.getDom("elementpath").style.display = "none", c.ui.getDom("wordcount").style.display = "none", c.ui.getDom("scale").style.display = "none");
					c.selection.isFocus() && c.fireEvent("selectionchange", !1, !0)
				});
				c.addListener("mousedown", function(a, b) {
					q.editor.ui.Popup.postHide(b, b.target || b.srcElement);
					q.editor.ui.ShortCutMenu && q.editor.ui.ShortCutMenu.postHide(b)
				});
				c.addListener("delcells", function() {
					UE.ui.edittip && new UE.ui.edittip(c);
					c.getDialog("edittip").open()
				});
				var e, f = !1,
					g;
				c.addListener("afterpaste", function() {
					c.queryCommandState("pasteplain") || (q.editor.ui.PastePicker && (e = new q.editor.ui.Popup({
						content: new q.editor.ui.PastePicker({
							editor: c
						}),
						editor: c,
						className: "edui-wordpastepop"
					}), e.render()), f = !0)
				});
				c.addListener("afterinserthtml", function() {
					clearTimeout(g);
					g = setTimeout(function() {
						if (e && (f || c.ui._isTransfer)) {
							if (e.isHidden()) {
								var a = b.createElement(c.document, "span", {
									style: "line-height:0px;",
									innerHTML: "﻿"
								});
								c.selection.getRange().insertNode(a);
								var d = H(a, "firstChild", "previousSibling");
								d && e.showAnchor(3 == d.nodeType ? d.parentNode : d);
								b.remove(a)
							} else e.show();
							delete c.ui._isTransfer;
							f = !1
						}
					}, 200)
				});
				c.addListener("contextmenu", function(a, b) {
					q.editor.ui.Popup.postHide(b)
				});
				c.addListener("keydown", function(a, b) {
					e && e.dispose(b);
					var c = b.keyCode || b.which;
					if (b.altKey && 90 == c) UE.ui.buttons.fullscreen.onclick()
				});
				c.addListener("wordcount", function(b) {
					a(this, d)
				});
				c.addListener("selectionchange", function() {


					if (c.options.elementPathEnabled) d[(-1 == c.queryCommandState("elementpath") ? "dis" : "en") + "ableElementPath"]();
					if (c.options.scaleEnabled) d[(-1 == c.queryCommandState("scale") ? "dis" : "en") + "ableScale"]()
				});
				var h = new q.editor.ui.Popup({
					editor: c,
					content: "",
					className: "edui-bubble",
					_onEditButtonClick: function() {
						this.hide();
						c.ui._dialogs.linkDialog.open()
					},
					_onImgEditButtonClick: function(a) {
						this.hide();
						c.ui._dialogs[a] && c.ui._dialogs[a].open()
					},
					_onImgSquareClick: function(a) {
						this.hide();
						c.undoManger.save(!0);
						"IMG" == this.anchorEl.tagName && (a = $(this.anchorEl).parent(), "square" != a.attr("data-role") ? "circle" == a.attr("data-role") || "bgmirror" == a.attr("data-role") ? a.replaceWith('<section data-role="square" style="overflow: hidden;margin: 0 auto;width:100%;padding-bottom:100%;height:0px;background-image:url(' + this.anchorEl.src + ');background-position:50% 50%;background-size: cover;"><img src="' + this.anchorEl.src + '" style="opacity:0;width:100%;"></section>') : $(this.anchorEl).replaceWith('<section data-role="square" style="overflow: hidden;margin: 0 auto;width:100%;padding-bottom:100%;height:0px;background-image:url(' + this.anchorEl.src + ');background-position:50% 50%;background-size: cover;"><img src="' + this.anchorEl.src + '" style="opacity:0;width:100%;"></section>') : ($(this.anchorEl).css({
							opacity: "1"
						}), a.replaceWith($(this.anchorEl))));
						c.undoManger.save(!0)
					},
					_onImgRadiusClick: function(a) {
						this.hide();
						c.undoManger.save(!0);
						"IMG" == this.anchorEl.tagName && (a = $(this.anchorEl).parent(), "circle" != a.attr("data-role") ? "square" == a.attr("data-role") || "bgmirror" == a.attr("data-role") ? a.replaceWith('<section data-role="circle" style="border-radius: 100%;overflow: hidden;margin: 0 auto;width:100%;padding-bottom:100%;height:0px;background-image:url(' + this.anchorEl.src + ');background-position:50% 50%;background-size: cover;"><img src="' + this.anchorEl.src + '" style="opacity:0;width:100%;"></section>') : $(this.anchorEl).replaceWith('<section data-role="circle" style="border-radius: 100%;overflow: hidden;margin: 0 auto;width:100%;padding-bottom:100%;height:0px;background-image:url(' + this.anchorEl.src + ');background-position:50% 50%;background-size: cover;"><img src="' + this.anchorEl.src + '" style="opacity:0;width:100%;"></section>') : ($(this.anchorEl).css({
							opacity: "1"
						}), a.replaceWith($(this.anchorEl))));
						c.undoManger.save(!0)
					},
					_onImgDeleteClick: function(a) {
						this.hide();
						c.undoManger.save(!0);
						b.remove(this.anchorEl);
						c.undoManger.save(!0)
					},
					_onImgCropButtonClick: function(a) {
						this.hide();
						W = this.anchorEl;
						"toImage" == W.getAttribute("data-type") ? (a = W.getAttribute("data-id"), window.ajaxAction && window.ajaxAction("//" + c.options.plat_host + "/html_images/getHtml/" + a, null, null, function(a) {
							a.success && $(W).replaceWith(a.data.content)
						})) : "function" == typeof window.top.edit_image ? window.top.edit_image(a) : c.fireEvent("showmessage", {
							content: "Javascript function edit_image not defined.",
							timeout: 3E3
						})
					},
					_onImgSetFloat: function(a) {
						this.hide();
						c.execCommand("imagefloat", a)
					},
					_setIframeAlign: function(a) {
						var c = h.anchorEl,
							d = c.cloneNode(!0);
						switch (a) {
							case -2:
								d.setAttribute("align", "");
								break;
							case -1:
								d.setAttribute("align", "left");
								break;
							case 1:
								d.setAttribute("align", "right")
						}
						c.parentNode.insertBefore(d, c);
						b.remove(c);
						h.anchorEl = d;
						h.showAnchor(h.anchorEl)
					},
					_updateIframe: function() {
						var a = c._iframe = h.anchorEl;
						b.hasClass(a, "ueditor_baidumap") ? (c.selection.getRange().selectNode(a).select(), c.ui._dialogs.mapDialog.open()) : c.ui._dialogs.insertframeDialog.open();
						h.hide()
					},
					_onRemoveButtonClick: function(a) {
						c.execCommand(a);
						this.hide()
					},
					queryAutoHide: function(a) {
						return a && a.ownerDocument == c.document && ("img" == a.tagName.toLowerCase() || b.findParentByTagName(a, "a", !0)) ? a !== h.anchorEl : q.editor.ui.Popup.prototype.queryAutoHide.call(this, a)
					}
				});
				h.render();
				c.options.imagePopup && (c.addListener("mouseover", function(a, b) {

					b = b || window.event;
					var d = b.target || b.srcElement;
					if (c.ui._dialogs.insertframeDialog && /iframe/ig.test(d.tagName)) {
						var e = h.formatHtml("<nobr>" + c.getLang("property") + ': <span onclick=$$._setIframeAlign(-2) class="edui-clickable">' + c.getLang("default") + '</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">' + c.getLang("justifyleft") + '</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">' + c.getLang("justifyright") + '</span>&nbsp;&nbsp; <span onclick="$$._updateIframe( this);" class="edui-clickable">' + c.getLang("modify") + "</span></nobr>");
						e ? (h.getDom("content").innerHTML = e, h.anchorEl = d, h.showAnchor(h.anchorEl)) : h.hide()
					}
				}), c.addListener("selectionchange", function(a, d) {
					if (d) {
						var e = "",
							f, g = c.selection.getRange(),
							k = g.getClosedNode();
						f = c.ui._dialogs;
						if (!1 === g.collapsed && k && "IMG" == k.tagName) {
							g = "insertimageDialog";
							if (-1 != k.className.indexOf("edui-faked-video") || -1 != k.className.indexOf("edui-upload-video")) g = "insertvideoDialog"; - 1 != k.className.indexOf("edui-faked-webapp") && (g = "webappDialog"); - 1 != k.src.indexOf("http://api.map.baidu.com") && (g = "mapDialog"); - 1 != k.className.indexOf("edui-faked-music") && (g = "musicDialog"); - 1 != k.src.indexOf("http://maps.google.com/maps/api/staticmap") && (g = "gmapDialog");
							k.getAttribute("anchorname") && (g = "anchorDialog", e = h.formatHtml("<nobr>" + c.getLang("property") + ': <span onclick=$$._onImgEditButtonClick("anchorDialog") class="edui-clickable">' + c.getLang("modify") + "</span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick('anchor') class=\"edui-clickable\">" + c.getLang("delete") + "</span></nobr>"));
							if (k.getAttribute("word_img")) {
								c.word_img = [k.getAttribute("word_img")];
								return
							}
							if (b.hasClass(k, "loadingclass") || b.hasClass(k, "loaderrorclass")) g = "";
							console.log(f);
							console.log(g);
							if (!f[g]) return;
							f = k.src;
							0 <= f.indexOf("http://remote.wx135.com/oss/view") && (f = f.replace("&free=1", ""), f = decodeURIComponent(f.substr(35)));
							f = '<nobr><span onclick=$$._onImgSetFloat("none") class="edui-clickable">' + c.getLang("default") + '</span>&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable">' + c.getLang("justifyleft") + '</span>&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable">' + c.getLang("justifyright") + '</span>&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable">' + c.getLang("justifycenter") + "</span>&nbsp;<span onclick=\"$$._onImgEditButtonClick('" + g + '\');" class="edui-clickable">' + c.getLang("changeImage") + "</span>&nbsp;<span onclick=\"$$._onImgCropButtonClick('" + k.src + '\');" class="edui-clickable">' + c.getLang("edit") + '</span>&nbsp;<a href="' + f + '" rel="noreferrer" target="_blank" class="edui-clickable">' + c.getLang("labelMap.preview") + '</a><br/><span onclick=$$._onImgDeleteClick() class="edui-clickable">' + c.getLang("delete") + '</span>&nbsp;<span onclick="$$._onImgRadiusClick(this);" class="edui-clickable">' + c.getLang("radiusCircle") + '</span>&nbsp;<span onclick="$$._onImgSquareClick(this);" class="edui-clickable">' + c.getLang("imgSquare") + '</span>&nbsp;<span onclick="$$._onImgEditButtonClick(\'imgstyleDialog\');" class="edui-clickable">' + c.getLang("labelMap.imgstyle") + "</span>&nbsp;</nobr>";
							!e && (e = h.formatHtml(f))
							console.log('f S')
							console.log(f);
							console.log('f E')
						}
						if (c.ui._dialogs.linkDialog) {
							var l = c.queryCommandValue("link"),
								m;
							l && (m = l.getAttribute("_href") || l.getAttribute("href", 2)) && (f = m, 30 < m.length && (f = m.substring(0, 20) + "..."), e && (e += '<div style="height:5px;"></div>'), e += h.formatHtml("<nobr>" + c.getLang("anthorMsg") + ': <a target="_blank" href="' + m + '" title="' + m + '" >' + f + '</a> <span class="edui-clickable" onclick="$$._onEditButtonClick();">' + c.getLang("modify") + '</span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(\'unlink\');"> ' + c.getLang("clear") + "</span></nobr>"), h.showAnchor(l))
						}
						e ? (h.getDom("content").innerHTML = e, h.anchorEl = k || l, h.showAnchor(h.anchorEl)) : h.hide()
					}
				}))
			},
			_initToolbars: function() {
				for (var b = this.editor, c = this.toolbars || [], d = [], e = [], f = 0; f < c.length; f++) {
					for (var g = c[f], h = new q.editor.ui.Toolbar({
							theme: b.options.theme
						}), p = 0; p < g.length; p++) {
						var w = g[p],
							t = null;
						if ("string" == typeof w) {
							w = w.toLowerCase();
							"|" == w && (w = "Separator");
							"||" == w && (w = "Breakline");
							var y = q.editor.ui[w];
							if (y)
								if (a.isFunction(y)) t = new q.editor.ui[w](b);
								else {
									if (y.id && y.id != b.key) continue;
									if (w = y.execFn.call(b, b, w))
										if (void 0 === y.index) {
											h.add(w);
											continue
										} else e.push({
											index: y.index,
											itemUI: w
										})
								}
						} else t = w;
						t && t.id && h.add(t)
					}
					d[f] = h
				}
				a.each(e, function(a) {
					h.add(a.itemUI, a.index)
				});
				this.toolbars = d
			},
			getHtmlTpl: function() {
				return '<div id="##" class="%%"><div id="##_sidebar" class="%%-sidebar"></div><div id="##_mainbar" class="%%-mainbar"><div id="##_toolbarbox" style="display:none;" class="%%-toolbarbox">' + (this.toolbars.length ? '<div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">' + this.renderToolbarBoxHtml() + "</div></div>" : "") + '<div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">' + this.editor.getLang("clickToUpload") + '</div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div><div style="height:0;overflow:hidden;clear:both;"></div></div><div id="##_message_holder" class="%%-messageholder"></div></div><div id="##_iframeholder" class="%%-iframeholder"></div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"></td><td id="##_wordcount" class="%%-wordcount"></td><td id="##_scale" class="%%-scale"><div class="%%-icon"></div></td></tr></table></div><div id="##_scalelayer"></div></div></div>'
			},
			showWordImageDialog: function() {
				this._dialogs.wordimageDialog.open()
			},
			renderToolbarBoxHtml: function() {
				for (var a = [], b = 0; b < this.toolbars.length; b++) a.push(this.toolbars[b].renderHtml());
				return a.join("")
			},
			setFullScreen: function(a) {
				var b = this.editor,
					c = b.container.parentNode.parentNode;
				if (this._fullscreen != a) {
					this._fullscreen = a;
					this.editor.fireEvent("beforefullscreenchange", a);
					if (q.editor.browser.gecko) var d = b.selection.getRange().createBookmark();
					if (a) {
						for ($(c).parents("body").addClass("fullscreen");
							"BODY" != c.tagName;) {
							var e = q.editor.dom.domUtils.getComputedStyle(c, "position");
							g.push(e);
							c.style.position = "static";
							c = c.parentNode
						}
						this._bakHtmlOverflow = document.documentElement.style.overflow;
						this._bakBodyOverflow = document.body.style.overflow;
						this._bakAutoHeight = this.editor.autoHeightEnabled;
						this._bakScrollTop = Math.max(document.documentElement.scrollTop, document.body.scrollTop);
						this._bakEditorContaninerWidth = b.iframe.parentNode.offsetWidth;
						this._bakAutoHeight && (b.autoHeightEnabled = !1, this.editor.disableAutoHeight());
						document.documentElement.style.overflow = "hidden";
						window.scrollTo(0, window.scrollY);
						this._bakCssText = this.getDom().style.cssText;
						this._bakCssText1 = this.getDom("iframeholder").style.cssText;
						b.iframe.parentNode.style.width = "";
						this._updateFullScreen()
					} else {
						for ($(c).parents("body").removeClass("fullscreen");
							"BODY" != c.tagName;) c.style.position = g.shift(), c = c.parentNode;
						this.getDom().style.cssText = this._bakCssText;
						this.getDom("iframeholder").style.cssText = this._bakCssText1;
						this._bakAutoHeight && (b.autoHeightEnabled = !0, this.editor.enableAutoHeight());
						document.documentElement.style.overflow = this._bakHtmlOverflow;
						document.body.style.overflow = this._bakBodyOverflow;
						b.iframe.parentNode.style.width = this._bakEditorContaninerWidth + "px";
						window.scrollTo(0, this._bakScrollTop)
					}
					if (t.gecko && "true" === b.body.contentEditable) {
						var f = document.createElement("input");
						document.body.appendChild(f);
						b.body.contentEditable = !1;
						setTimeout(function() {
							f.focus();
							setTimeout(function() {
								b.body.contentEditable = !0;
								b.fireEvent("fullscreenchanged", a);
								b.selection.getRange().moveToBookmark(d).select(!0);
								q.editor.dom.domUtils.remove(f);
								a && window.scroll(0, 0)
							}, 0)
						}, 0)
					}
					"true" === b.body.contentEditable && (this.editor.fireEvent("fullscreenchanged", a), this.triggerLayout())
				}
			},
			_updateFullScreen: function() {
				if (this._fullscreen) {
					var a = e.getViewportRect();
					this.getDom().style.cssText = "border:0;position:absolute;left:0;top:" + (this.editor.options.topOffset || 0) + "px;width:" + a.width + "px;height:" + a.height + "px;z-index:" + (1 * this.getDom().style.zIndex + 100);
					e.setViewportOffset(this.getDom(), {
						left: 0,
						top: this.editor.options.topOffset || 0
					});
					this.editor.setHeight(a.height - this.getDom("toolbarbox").offsetHeight - this.getDom("bottombar").offsetHeight - (this.editor.options.topOffset || 0), !0);
					if (t.gecko) try {
						window.onresize()
					} catch (k) {}
				}
			},
			_updateElementPath: function() {
				var a = this.getDom("elementpath"),
					b;
				if (this.elementPathEnabled && (b = this.editor.queryCommandValue("elementpath"))) {
					for (var c = [], d = 0, e; e = b[d]; d++) c[d] = this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;' + d + '&quot;);">' + e + "</span>");
					a.innerHTML = '<div class="edui-editor-breadcrumb" onmousedown="return false;">' + this.editor.getLang("elementPathTip") + ": " + c.join(" &gt; ") + "</div>"
				} else a.style.display = "none"
			},
			disableElementPath: function() {
				var a = this.getDom("elementpath");
				a.innerHTML = "";
				a.style.display = "none";
				this.elementPathEnabled = !1
			},
			enableElementPath: function() {
				this.getDom("elementpath").style.display = "";
				this.elementPathEnabled = !0;
				this._updateElementPath()
			},
			_scale: function() {
				function a() {
					E = b.getXY(h);
					H || (H = g.options.minFrameHeight + p.offsetHeight + y.offsetHeight);
					A.style.cssText = "position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:" + h.offsetWidth + "px;height:" + h.offsetHeight + "px;z-index:" + (g.options.zIndex + 1);
					b.on(f, "mousemove", c);
					b.on(q, "mouseup", d);
					b.on(f, "mouseup", d)
				}

				function c(a) {
					e();
					a = a || window.event;
					M = a.pageX || f.documentElement.scrollLeft + a.clientX;
					J = a.pageY || f.documentElement.scrollTop + a.clientY;
					K = M - E.x;
					C = J - E.y;
					K >= O && (D = !0, A.style.width = K + "px");
					C >= H && (D = !0, A.style.height = C + "px")
				}

				function d() {
					D && (D = !1, g.ui._actualFrameWidth = A.offsetWidth - 2, h.style.width = g.ui._actualFrameWidth + "px", g.setHeight(A.offsetHeight - y.offsetHeight - p.offsetHeight - 2, !0));
					A && (A.style.display = "none");
					e();
					b.un(f, "mousemove", c);
					b.un(q, "mouseup", d);
					b.un(f, "mouseup", d)
				}

				function e() {
					t.ie ? f.selection.clear() : window.getSelection().removeAllRanges()
				}
				var f = document,
					g = this.editor,
					h = g.container,
					q = g.document,
					p = this.getDom("toolbarbox"),
					y = this.getDom("bottombar"),
					I = this.getDom("scale"),
					A = this.getDom("scalelayer"),
					D = !1,
					E = null,
					H = 0,
					O = g.options.minFrameWidth,
					M = 0,
					J = 0,
					K = 0,
					C = 0,
					B = this;
				this.editor.addListener("fullscreenchanged", function(a, c) {
					if (c) B.disableScale();
					else if (B.editor.options.scaleEnabled) {
						B.enableScale();
						var d = B.editor.document.createElement("span");
						B.editor.body.appendChild(d);
						B.editor.body.style.height = Math.max(b.getXY(d).y, B.editor.iframe.offsetHeight - 20) + "px";
						b.remove(d)
					}
				});
				this.enableScale = function() {
					1 != g.queryCommandState("source") && (I.style.display = "", this.scaleEnabled = !0, b.on(I, "mousedown", a))
				};
				this.disableScale = function() {
					I.style.display = "none";
					this.scaleEnabled = !1;
					b.un(I, "mousedown", a)
				}
			},
			isFullScreen: function() {
				return this._fullscreen
			},
			postRender: function() {
				d.prototype.postRender.call(this);
				for (var a = 0; a < this.toolbars.length; a++) this.toolbars[a].postRender();
				var b = this,
					c, e = q.editor.dom.domUtils,
					f = function() {
						clearTimeout(c);
						c = setTimeout(function() {
							b._updateFullScreen()
						})
					};
				e.on(window, "resize", f);
				b.addListener("destroy", function() {
					e.un(window, "resize", f);
					clearTimeout(c)
				})
			},
			showToolbarMsg: function(a, b) {
				this.getDom("toolbarmsg_label").innerHTML = a;
				this.getDom("toolbarmsg").style.display = "";
				b || (this.getDom("upload_dialog").style.display = "none")
			},
			hideToolbarMsg: function() {
				this.getDom("toolbarmsg").style.display = "none"
			},
			mapUrl: function(a) {
				return a ? a.replace("~/", this.editor.options.UEDITOR_HOME_URL || "") : ""
			},
			triggerLayout: function() {
				var a = this.getDom();
				a.style.zoom = "1" == a.style.zoom ? "100%" : "1"
			}
		};
		a.inherits(c, q.editor.ui.UIBase);
		var f = {};
		UE.ui.Editor = function(d) {
			var e = new UE.Editor(d);
			e.options.editor = e;
			a.loadFile(document, {
				href: e.options.editorCssUrl || e.options.themePath + e.options.theme + "/css/ueditor.min.css",
				tag: "link",
				type: "text/css",
				rel: "stylesheet"
			});
			var g = e.render;
			e.render = function(d) {
				d.constructor === String && (e.key = d, f[d] = e);
				a.domReady(function() {
					function a() {
						e.setOpt({
							labelMap: e.options.labelMap || e.getLang("labelMap")
						});
						new c(e.options);
						if (d && (d.constructor === String && (d = document.getElementById(d)), d && d.getAttribute("name") && (e.options.textarea = d.getAttribute("name")), d && /script|textarea/ig.test(d.tagName))) {
							var a = document.createElement("div");
							d.parentNode.insertBefore(a, d);
							var f = d.value || d.innerHTML;
							e.options.initialContent = /^[\t\r\n ]*$/.test(f) ? e.options.initialContent : f.replace(/>[\n\r\t]+([ ]{4})+/g, ">").replace(/[\n\r\t]+([ ]{4})+</g, "<").replace(/>[\n\r\t]+</g, "><");
							d.className && (a.className = d.className);
							d.style.cssText && (a.style.cssText = d.style.cssText);
							/textarea/i.test(d.tagName) ? (e.textarea = d, e.textarea.style.display = "none") : d.parentNode.removeChild(d);
							d.id && (a.id = d.id, b.removeAttributes(d, "id"));
							d = a;
							d.innerHTML = ""
						}
						b.addClass(d, "edui-" + e.options.theme);
						e.ui.render(d);
						a = e.options;
						e.container = e.ui.getDom();
						for (var f = b.findParents(d, !0), h = [], k = 0, l; l = f[k]; k++) h[k] = l.style.display, l.style.display = "block";
						a.initialFrameWidth ? a.minFrameWidth = a.initialFrameWidth : (a.minFrameWidth = a.initialFrameWidth = d.offsetWidth, k = d.style.width, /%$/.test(k) && (a.initialFrameWidth = k));
						a.initialFrameHeight ? a.minFrameHeight = a.initialFrameHeight : a.initialFrameHeight = a.minFrameHeight = d.offsetHeight;
						for (k = 0; l = f[k]; k++) l.style.display = h[k];
						d.style.height && (d.style.height = "");
						e.container.style.width = a.initialFrameWidth + (/%$/.test(a.initialFrameWidth) ? "" : "px");
						e.container.style.zIndex = a.zIndex;
						g.call(e, e.ui.getDom("iframeholder"));
						e.fireEvent("afteruiready")
					}
					e.langIsReady ? a() : e.addListener("langReady", a)
				})
			};
			return e
		};
		UE.getEditor = function(a, b) {
			var c = f[a];
			c || (c = f[a] = new UE.ui.Editor(b), c.render(a));
			return c
		};
		UE.delEditor = function(a) {
			var b;
			if (b = f[a]) b.key && b.destroy(), delete f[a]
		};
		UE.registerUI = function(b, c, d, e) {
			a.each(b.split(/\s+/), function(a) {
				q.editor.ui[a] = {
					id: e,
					execFn: c,
					index: d
				}
			})
		}
	})();
	UE.plugins.editor135 = function() {
		var c = this,
			a = this,
			e = q.editor.ui,
			d = q.editor.dom.domUtils,
			b = "shadowcolor";
		e[b] = function(a) {
			return function(b) {
				var c = new e.ColorButton({
					className: "edui-for-" + a,
					color: "default",
					title: "文字阴影色",
					editor: b,
					onpickcolor: function(c, d) {
						b.execCommand(a, d + " 2px 2px 10px")
					},
					onpicknocolor: function() {
						b.execCommand(a, "default");
						this.setColor("transparent");
						this.color = "default"
					},
					onbuttonclick: function() {
						b.execCommand(a, this.color + " 2px 2px 10px")
					}
				});
				e.buttons[a] = c;
				b.addListener("selectionchange", function() {
					c.setDisabled(-1 == b.queryCommandState(a))
				});
				return c
			}
		}(b);
		a.addListener("sourcemodechanged", function(b, c) {
			if (!c) {
				jQuery(a.document).find("#body-css").remove();
				var d = "";
				jQuery("[cdata_tag=style]", a.document).each(function() {
					d += jQuery(this).attr("cdata_data") + ";"
				});
				jQuery('<style id="body-css">').text(d).appendTo(jQuery("head", a.document))
			}
		});
		setTimeout(function() {
			a.fireEvent("sourcemodechanged", !1)
		}, 3E3);
		b = "remotecontent";
		e[b] = function(a) {
			return function(b) {
				var c = new e.RemoteButton({
					className: "edui-for-" + a,
					color: "default",
					title: "导入文章内容",
					editor: b,
					onbuttonclick: function() {
						this.showPopup()
					}
				});
				e.buttons[a] = c;
				b.addListener("selectionchange", function() {
					c.setDisabled(-1 == b.queryCommandState(a))
				});
				return c
			}
		}(b);
		b = "more";
		e[b] = function(a) {
			return function(b) {
				b.registerCommand(a, {
					execCommand: function() {
						var a = b.container;
						jQuery(a).hasClass("show-edui-more") ? (jQuery(a).removeClass("show-edui-more"), c.setPreferences("showmore", !1)) : (jQuery(a).addClass("show-edui-more"), c.setPreferences("showmore", !0));
						a = b.ui.getDom("toolbarbox");
						d.hasClass(a, "show-edui-more") ? d.removeClasses(a, "show-edui-more") : d.addClass(a, "show-edui-more")
					}
				});
				return new UE.ui.Button({
					name: a,
					title: "更多",
					onclick: function() {
						b.execCommand(a)
					}
				})
			}
		}(b);
		var g = new UE.ui.Dialog({
				iframeUrl: a.options.UEDITOR_HOME_URL + "dialogs/135editor/135BgDialog.html",
				editor: c,
				name: "135BgDialog",
				title: "背景图设置",
				cssRules: "width:600px;height:300px;",
				buttons: [{
					className: "edui-okbutton",
					label: "确定",
					onclick: function() {
						g.close(!0)
					}
				}, {
					className: "edui-cancelbutton",
					label: "取消",
					onclick: function() {
						g.close(!1)
					}
				}]
			}),
			f = new UE.ui.Dialog({
				iframeUrl: a.options.UEDITOR_HOME_URL + "dialogs/135editor/135BdBgDialog.html",
				editor: c,
				name: "135BdBgDialog",
				title: "边框底纹设置",
				cssRules: "width:800px;height:400px;",
				buttons: [{
					className: "edui-okbutton",
					label: "确定",
					onclick: function() {
						f.close(!0)
					}
				}, {
					className: "edui-cancelbutton",
					label: "取消",
					onclick: function() {
						f.close(!1)
					}
				}]
			}),
			l = new UE.ui.Dialog({
				iframeUrl: a.options.UEDITOR_HOME_URL + "dialogs/135editor/135Paragraph.html",
				editor: c,
				name: "135Paragraph",
				title: "段落设置",
				cssRules: "width:420px;height:240px;",
				buttons: []
			});
		setTimeout(function() {
			c.ui && c.ui._dialogs && (c.ui._dialogs._135BgDialog = g, c.ui._dialogs._135BdBgDialog = f, c.ui._dialogs._135ParaDialog = l)
		}, 2E3);
		"undefined" == typeof window.showSuccessMessage && (window.showSuccessMessage = function(a) {
			var b = c.document.getElementById("editor135_msg");
			b && d.remove(b);
			c.fireEvent("showmessage", {
				content: a,
				timeout: 3E3
			})
		});
		var k = null,
			n = new q.editor.ui.Popup({
				content: "",
				editor: c,
				className: "edui-bubble"
			});
		c.addListener("beforesetcontent", function(a, b, d) {
			b.html = c.parseInsertPasteSetHtml(b.html)
		});
		c.addListener("beforepaste", function(a, b, d) {
			b.html = c.parseInsertPasteSetHtml(b.html)
		});
		c.addListener("beforegetcontent", function(a) {
			jQuery(c.document).find(".135editor").removeClass("135editor").addClass("_135editor");
			"inner" == c.options.style_toolbar && (jQuery(k).find(".tool-border").remove(), jQuery(k).find(".otf-poptools").remove());
			jQuery(c.document).find("._135editor").each(function() {
				jQuery(this).find(".tool-border").remove();
				jQuery(this).removeClass("active")
			})
		});
		c.addListener("contentchange", function() {
			"" == c.getContentTxt() ? (k = c.selection.document, $(k).find("body").addClass("guide")) : $(k).find("body").removeClass("guide")
		});
		c.addListener("ready", function(a) {
			k = c.selection.document;
			a = c.getPreferences("editor135");
			(null == a || a && (null == a.showmore || 1 == a.showmore)) && c.execCommand("more");
			(a = d.findParent(c.iframe.parentNode, function(a) {
				return "FORM" == a.tagName
			}, !0)) && jQuery(a).submit(function() {
				c.sync()
			});
			jQuery(k).on("copy", function(a) {
				if (a.originalEvent) {
					var b = a.originalEvent.clipboardData,
						d = c.parseWxHtml(getSelectionHtml());
					console.log(d);
					b.setData("text/html", d);
					b.setData("text/plain", d);
					window.showSuccessMessage("已成功复制到剪切板");
					return a.preventDefault()
				}
				if (window.clipboardData) return b = window.clipboardData, d = c.parseWxHtml(getSelectionHtml()), b.setData("text/html", d), b.setData("text/plain", d), window.showSuccessMessage("已成功复制到剪切板"), a.preventDefault()
			});
			jQuery(k).keydown(function(a) {
				window.current_editor = c;
				27 == a.keyCode ? (clean_135helper(), n && n.hide()) : (a.ctrlKey || a.metaKey) && 65 == a.keyCode ? (window.replace_full_color = !0, clean_135helper(), "function" == typeof showColorPlan && showColorPlan(), 0 < jQuery("#replace-color-all").size() && jQuery("#replace-color-all").prop("checked", !0), clearInterval(ha), ha = setTimeout(function() {
					window.replace_full_color = !1;
					0 < jQuery("#replace-color-all").size() && jQuery("#replace-color-all").prop("checked", !1);
					window.showSuccessMessage("全文换色模式已关闭")
				}, 3E4)) : (a.ctrlKey || a.metaKey) && 67 == a.keyCode && clean_135helper()
			});
			jQuery(document).on("dblclick", ".edui-editor-imagescale", function() {
				console.log("imagescale dblclick");
				jQuery(this).attr("word_img") ? c.ui._dialogs.wordimageDialog && c.ui._dialogs.wordimageDialog.open() : c.ui._dialogs.insertimageDialog && c.ui._dialogs.insertimageDialog.open()
			});
			jQuery(k).on("dblclick", "img", function() {
				console.log("img dblclick");
				jQuery(this).attr("word_img") ? c.ui._dialogs.wordimageDialog && c.ui._dialogs.wordimageDialog.open() : c.ui._dialogs.insertimageDialog && c.ui._dialogs.insertimageDialog.open()
			});
			jQuery(k).on("dblclick", "area", function() {
				c.ui._dialogs.insertimageDialog && c.ui._dialogs.insertimageDialog.open()
			})
		});
		c.addListener("keyup", function(a, b) {
			q.editor.ui.Popup.postHide(b)
		});

		c.addListener("click", function(b, d) {
			d = d || window.event;
			if (!(d.shiftKey || d.ctrlKey || d.altKey)) {
				var e = c.selection.getRange(),
					h = d.target || d.srcElement;
				//初始化h
				var initializeH = d.target || d.srcElement;
				// console.log('S ==')
				// console.log('c')
				// console.log(c);
				// console.log('e');
				// console.log(e);
				// console.log('h')
				// console.log(h);
				// console.log('tagName')
				// console.log(h.tagName)
				// console.log(d);
				// console.log('E ==')
				//jQuery('._135editor.active').removeClass('active');
				//console.log('====789====')
				//jQuery(c).find('section.active').removeClass();
				jQuery(document.getElementById('ueditor_0').contentWindow.document.body).find('section.active,video.active,img.active').removeClass('active')
				// console.log('====789==== E')
				// console.log(jQuery(h).parents(".otf-poptools"));
				if ("BODY" == h.tagName) {
					console.log('点击了body');
                    if($(window.parent.document).find("#Information").css('display') !='none'){
                        // window.showMessageBox('SensitiveWords');
                        hideMessageBox('Information');//影藏右侧详情框
                    }
					//hideMessageBox('Information');//影藏右侧详情框
					$('#UploadMaterialWrap').css({
		              'overflowY':'auto'
		          })
                    $('#AttributeWrap').css({
                        'overflowY':'auto'
                    })
					window.hideColorPlan();
					if (clean_135helper(), q.editor.ui.Popup.postHide(d), h = e.startContainer, jQuery(h).hasClass("_135editor") || 0 < jQuery(h).parents("._135editor").size()) jQuery(h).hasClass("_135editor") || (h = jQuery(h).parents("._135editor:first").get(0)), e = $.trim($(h).text()), e = e.replace(/​/g, ""), d.clientY > $(h).offset().top + $(h).height() - $(c.document).scrollTop() && "" != e && c.execCommand("insertparagraph")
				} else if (window.current_editor = c, "AREA" == h.tagName) {
                    if($(window.parent.document).find("#Information").css('display') !='none'){
                        // window.showMessageBox('SensitiveWords');
                        hideMessageBox('Information');//影藏右侧详情框
                    }
					//hideMessageBox('Information');//影藏右侧详情框
					var m = jQuery(h).parent("map").attr("id"),
						m = jQuery("img[usemap='#" + m + "']", k).get(0);
					e.selectNode(m);
					e.select();
				 } 
				else if($(h).attr('data') == 'audioBox'  || $(h).attr('data') == 'hd' || $(h).attr('data') == 'link'){
					// "touchstart" != d.type && (m = e.startContainer, 3 == m.nodeType && (m = m.parentNode), h = m), !(0 < jQuery(h).parents(".otf-poptools").size());
					// jQuery(h).hasClass("_135editor") || (h = jQuery(h).parents("._135editor:first").get(0));
					window.parent.current_active_135item = jQuery(h);
					showMessageBox('Information');//显示右侧详情框
					m = e.getClosedNode()
					m = jQuery(h).clone();
					m.find(".tool-border").remove();
					m = null;
					c.current_active_135item && !c.current_active_135item.is(h) && clean_135helper();
					c.current_active_135item = jQuery(h);
					c.current_active_135item.addClass("active");
					var p;
					console.log('c.options.style_toolbar');
					console.log("inner" == c.options.style_toolbar);
					console.log(n.getDom("content"));
					"inner" == c.options.style_toolbar ? m = c.current_active_135item.parents("body") : (n.render(), m = jQuery(n.getDom("content")));
						var videoHtml = ' <section class="otf-poptools" contenteditable="false" style="width:370px">'+
							'   <section>'+
							'    <span class="remove" title="删除本样式" stateful="">删除</span>'+
							'    <span class="moveup">↑上移</span>'+
							'    <span class="movedown">↓下移</span>'+
							'    <span class="_blank" title="样式之后插入空行" stateful="">后空行</span>'+
							'    <span class="_preblank" title="样式之前插入空行" stateful="">前空行</span>'+
							'    <span class="imagefloat _imgCenter"  type="center" title="图片居中" stateful="">居中</span>'+
							'    <span class="imagefloat _imgLeft" type="left" title="图片左对齐" stateful="">左对齐</span>'+
							'    <span class="imagefloat _imgRight" type="right" title="图片右对齐" stateful="">右对齐</span>'+
							'   </section>'+
							'  </section> ';
						//m = c.current_active_135item.parents("body");
						p = jQuery(videoHtml);
						0 == m.find(".otf-poptools").size() ? m.append(p) : p = m.find(".otf-poptools");
						if (!c.options.hide_style_popup) {
							"inner" == c.options.style_toolbar ? (m = jQuery(c.current_active_135item).offset(), p.css("top", m.top + jQuery(c.current_active_135item).height() + 5)) : (n.anchorEl = h, n.showAnchor(n.anchorEl), $(p).parents(".edui-popup-body").css("width", "auto"));
							m = jQuery(c.container).offset().top + d.clientY + jQuery(c.container).find(".edui-editor-toolbarbox").height();
							"function" == typeof showColorPlan && showColorPlan(m);
						}

						p.find('.imagefloat').unbind("click").click(function(a) {
							var type = $(this).attr('type')
							c.execCommand("justify", type);
							a.preventDefault();
							$(this).blur();
							return !1
						})

						p.find(".remove").unbind("click").click(function(a) {
							c.current_active_135item.remove();
							a.preventDefault();
							$(this).blur();
							"inner" == c.options.style_toolbar ? p.remove() : n.hide();
							return !1
						});
						//后空行
						p.find("._blank").unbind("click").click(function(a) {
							var b = c.selection.getRange(),
								d = jQuery('<p><br/></p>');
							d.insertAfter(c.current_active_135item);
							d = d.find("p").get(0);
							b.setStart(d, 0).setCursor(!1, !0);
							"inner" == c.options.style_toolbar ? p.remove() : n.hide();
							c.current_active_135item.removeClass("active").find(".tool-border").remove();
							a.preventDefault();
							$(this).blur();
							return !1
						});
						//前空行
						p.find("._preblank").unbind("click").click(function(a) {
							var b = c.selection.getRange(),
								d = jQuery('<p><br/></p>');
							d.insertBefore(c.current_active_135item);
							d = d.find("p").get(0);
							b.setStart(d, 0).setCursor(!1, !0);
							"inner" == c.options.style_toolbar ? p.remove() : n.hide();
							c.current_active_135item.removeClass("active").find(".tool-border").remove();
							a.preventDefault();
							$(this).blur();
							return !1
						});
						p.find(".moveup").unbind("click").click(function(a) {
							var b = c.current_active_135item,
								d = b.prev();
							if (0 < d.length && "BODY" != d.prop("tagName")) b.insertBefore(d);
							else {
								var e = jQuery(b).parent();
								if ("BODY" != e.prop("tagName") && !e.hasClass("article135"))
									for (d = e.prev(); 0 == d.length;)
										if (e = jQuery(e).parent(), 0 < e.length && "BODY" != e.prop("tagName")) d = e.prev();
										else break;
								0 < d.length && "BODY" != d.prop("tagName") ? b.insertBefore(d) : c.fireEvent("showmessage", {
									content: "前面没有内容了，无法再向上移动",
									timeout: 1E3
								})
							}
							b = jQuery(c.current_active_135item).offset();
							p.css("top", b.top + jQuery(c.current_active_135item).height() + 5);
							a.preventDefault();
							$(this).blur();
							return !1
						});
						p.find(".movedown").unbind("click").click(function(a) {
							var b = c.current_active_135item,
								d = b.next();
							if (0 < d.length) b.insertAfter(d);
							else {
								var e = jQuery(b).parent();
								if ("BODY" != e.prop("tagName") && !e.hasClass("article135"))
									for (d = e.next(); 0 == d.length;)
										if (e = jQuery(e).parent(), 0 < e.length) d = e.next();
										else break;
								0 < d.length ? b.insertAfter(d) : c.fireEvent("showmessage", {
									content: "后面没有内容了，无法再向下移动",
									timeout: 1E3
								})
							}
							b = jQuery(c.current_active_135item).offset();
							p.css("top", b.top + jQuery(c.current_active_135item).height() + 5);
							a.preventDefault();
							$(this).blur();
							return !1
						});

							var y = jQuery(h).find(".layout:first").parent(),
								A = y.find("> .layout").size();
							if (0 == A) {
								var t = jQuery(h).get(0).style.width,
									D = !0;
								0 <= t.indexOf("%") ? t = t.replace("%", "") : 0 <= t.indexOf("px") ? (D = !1, t = t.replace("px", ""), t = parseInt(100 * t / jQuery(h).width())) : t = 100;
								p.find("._135layout").attr("data-param-init-value", t).removeClass("hidden").on("inited", function(a, b) {
									jQuery(this).find(".complete").html(b + "%")
								}).slider({
									initAll: !1,
									initValue: t
								}).on("change", function(a, b) {
									if (D) jQuery(this).find(".complete").html(b + "%"), jQuery(h).css("margin", "0 auto").css("width", b + "%").attr("data-width", b + "%");
									else {
										var c = parseInt(jQuery(h).width() * b / 100);
										jQuery(this).find(".complete").html(c + "px");
										jQuery(h).css("margin", "0 auto").css("width", c + "px")
									}
								})
							}
				}
				else if ("VIDEO" == h.tagName){
					window.parent.current_active_135item = jQuery(h);
                    if($(window.parent.document).find("#Information").css('display') !='block'){
                        // window.showMessageBox('SensitiveWords');
                        showMessageBox('Information');
                    }
					// "touchstart" != d.type && (m = e.startContainer, 3 == m.nodeType && (m = m.parentNode), h = m), !(0 < jQuery(h).parents(".otf-poptools").size());
					// jQuery(h).hasClass("_135editor") || (h = jQuery(h).parents("._135editor:first").get(0));
					m = e.getClosedNode()
					m = jQuery(h).clone();
					m.find(".tool-border").remove();
					m = null;
					c.current_active_135item && !c.current_active_135item.is(h) && clean_135helper();
					c.current_active_135item = jQuery(h);
					c.current_active_135item.addClass("active");
					var p;
					console.log('c.options.style_toolbar');
					console.log("inner" == c.options.style_toolbar);
					console.log(n.getDom("content"));
					"inner" == c.options.style_toolbar ? m = c.current_active_135item.parents("body") : (n.render(), m = jQuery(n.getDom("content")));
						var videoHtml = ' <section class="otf-poptools" contenteditable="false" style="width:370px">'+
							'   <section>'+
							'    <span class="remove" title="删除本样式" stateful="">删除</span>'+
							'    <span class="_135bg hidden" title="设置背景图片" stateful="">背景图</span>'+
							'    <span class="_135video hidden" title="更换视频地址" stateful="">视频</span>'+
							'    <span class="moveup">↑上移</span>'+
							'    <span class="movedown">↓下移</span>'+
							'    <span class="_blank" title="样式之后插入空行" stateful="">后空行</span>'+
							'    <span class="_preblank" title="样式之前插入空行" stateful="">前空行</span>'+
							'    <span class="screenshots" title="样式之前插入空行" stateful="">截图</span>'+
							'   </section>'+
							'   <section>'+
							'    <section class="_135layout slider">'+
							'     <span style="float:right;z-index: 5;color: #333;line-height: 16px;font-size: 10px;" title="调整左右分栏宽度比例">调整宽度比例</span>'+
							'    </section>'+
							'    <section>'+
							'    </section>'+
							'   </section>'+
							'  </section> ';
						console.log(m);
						console.log('=====m')
						//m = c.current_active_135item.parents("body");
						p = jQuery(videoHtml);
						0 == m.find(".otf-poptools").size() ? m.append(p) : p = m.find(".otf-poptools");
						if (!c.options.hide_style_popup) {
							"inner" == c.options.style_toolbar ? (m = jQuery(c.current_active_135item).offset(), p.css("top", m.top + jQuery(c.current_active_135item).height() + 5)) : (n.anchorEl = h, n.showAnchor(n.anchorEl), $(p).parents(".edui-popup-body").css("width", "auto"));
							m = jQuery(c.container).offset().top + d.clientY + jQuery(c.container).find(".edui-editor-toolbarbox").height();
							"function" == typeof showColorPlan && showColorPlan(m);
						}
						p.find(".remove").unbind("click").click(function(a) {
							c.current_active_135item.remove();
							a.preventDefault();
							$(this).blur();
							"inner" == c.options.style_toolbar ? p.remove() : n.hide();
							return !1
						});
						//后空行
						p.find("._blank").unbind("click").click(function(a) {
							var b = c.selection.getRange(),
								d = jQuery('<p><br/></p>');
							d.insertAfter(c.current_active_135item);
							d = d.find("p").get(0);
							b.setStart(d, 0).setCursor(!1, !0);
							"inner" == c.options.style_toolbar ? p.remove() : n.hide();
							c.current_active_135item.removeClass("active").find(".tool-border").remove();
							a.preventDefault();
							$(this).blur();
							return !1
						});
						//前空行
						p.find("._preblank").unbind("click").click(function(a) {
							var b = c.selection.getRange(),
								d = jQuery('<p><br/></p>');
							d.insertBefore(c.current_active_135item);
							d = d.find("p").get(0);
							b.setStart(d, 0).setCursor(!1, !0);
							"inner" == c.options.style_toolbar ? p.remove() : n.hide();
							c.current_active_135item.removeClass("active").find(".tool-border").remove();
							a.preventDefault();
							$(this).blur();
							return !1
						});
						p.find(".moveup").unbind("click").click(function(a) {
							var b = c.current_active_135item,
								d = b.prev();
							if (0 < d.length && "BODY" != d.prop("tagName")) b.insertBefore(d);
							else {
								var e = jQuery(b).parent();
								if ("BODY" != e.prop("tagName") && !e.hasClass("article135"))
									for (d = e.prev(); 0 == d.length;)
										if (e = jQuery(e).parent(), 0 < e.length && "BODY" != e.prop("tagName")) d = e.prev();
										else break;
								0 < d.length && "BODY" != d.prop("tagName") ? b.insertBefore(d) : c.fireEvent("showmessage", {
									content: "前面没有内容了，无法再向上移动",
									timeout: 1E3
								})
							}
							b = jQuery(c.current_active_135item).offset();
							p.css("top", b.top + jQuery(c.current_active_135item).height() + 5);
							a.preventDefault();
							$(this).blur();
							return !1
						});
						p.find(".movedown").unbind("click").click(function(a) {
							var b = c.current_active_135item,
								d = b.next();
							if (0 < d.length) b.insertAfter(d);
							else {
								var e = jQuery(b).parent();
								if ("BODY" != e.prop("tagName") && !e.hasClass("article135"))
									for (d = e.next(); 0 == d.length;)
										if (e = jQuery(e).parent(), 0 < e.length) d = e.next();
										else break;
								0 < d.length ? b.insertAfter(d) : c.fireEvent("showmessage", {
									content: "后面没有内容了，无法再向下移动",
									timeout: 1E3
								})
							}
							b = jQuery(c.current_active_135item).offset();
							p.css("top", b.top + jQuery(c.current_active_135item).height() + 5);
							a.preventDefault();
							$(this).blur();
							return !1
						});

							var y = jQuery(h).find(".layout:first").parent(),
								A = y.find("> .layout").size();
							if (0 == A) {
								var t = jQuery(h).get(0).style.width,
									D = !0;
								0 <= t.indexOf("%") ? t = t.replace("%", "") : 0 <= t.indexOf("px") ? (D = !1, t = t.replace("px", ""), t = parseInt(100 * t / jQuery(h).width())) : t = 100;
								p.find("._135layout").attr("data-param-init-value", t).removeClass("hidden").on("inited", function(a, b) {
									jQuery(this).find(".complete").html(b + "%")
								}).slider({
									initAll: !1,
									initValue: t
								}).on("change", function(a, b) {
									if (D) jQuery(this).find(".complete").html(b + "%"), jQuery(h).css("margin", "0 auto").css("width", b + "%").attr("data-width", b + "%");
									else {
										var c = parseInt(jQuery(h).width() * b / 100);
										jQuery(this).find(".complete").html(c + "px");
										jQuery(h).css("margin", "0 auto").css("width", c + "px")
									}
								})
							}
				}
				else if ("IMG" == h.tagName){
					var isMyPic  = ($(h).attr('data-type') ? true : false)||($(h).attr('isLive')? true :false);
					window.parent.current_active_135item = jQuery(h);
					isMyPic && showMessageBox('Information');//显示右侧详情框
					// "touchstart" != d.type && (m = e.startContainer, 3 == m.nodeType && (m = m.parentNode), h = m), !(0 < jQuery(h).parents(".otf-poptools").size());
					// jQuery(h).hasClass("_135editor") || (h = jQuery(h).parents("._135editor:first").get(0));
					m = e.getClosedNode()
					m = jQuery(h).clone();
					m.find(".tool-border").remove();
					m = null;
					c.current_active_135item && !c.current_active_135item.is(h) && clean_135helper();
					c.current_active_135item = jQuery(h);
					
					c.current_active_135item.addClass("active");
					var p;
		
					var isLive = $(h).attr('isLive') == 'true' ? true : false;
					var type = $(h).attr('data-types') ||(isLive?'live':'');
					var liveUrl = $(h).attr('data-live');
					var livePic = $(h).attr('data-pic');
					"inner" == c.options.style_toolbar ? m = c.current_active_135item.parents("body") : (n.render(), m = jQuery(n.getDom("content")));
						var videoHtml = ' <section class="otf-poptools" contenteditable="false" style="width:370px">'+
							'   <section>'+
							'    <span class="remove" title="删除本样式" stateful="" style="display:'+(isMyPic?'inline-block':'none')+'">删除</span>'+
							'    <span class="moveup" style="display:'+(isMyPic?'inline-block':'none')+'">↑上移</span>'+
							'    <span class="movedown" style="display:'+(isMyPic?'inline-block':'none')+'">↓下移</span>'+
							'    <span class="_blank" style="display:'+(isMyPic?'inline-block':'none')+'" title="样式之后插入空行" stateful="">后空行</span>'+
							'    <span class="_preblank"  style="display:'+(isMyPic?'inline-block':'none')+'" title="样式之前插入空行" stateful="">前空行</span>'+
							'    <span class="imagefloat _imgCenter"  style="display:'+(isMyPic?'inline-block':'none')+'" type="center" title="图片居中" stateful="">居中</span>'+
							'    <span class="imagefloat _imgLeft"  style="display:'+(isMyPic?'inline-block':'none')+'" type="left" title="图片左对齐" stateful="">左对齐</span>'+
							'    <span class="imagefloat _imgRight" style="display:'+(isMyPic?'inline-block':'none')+'" type="right" title="图片右对齐" stateful="">右对齐</span>'+
							'    <span class="setcCover" title="选为封面" stateful="">选为封面</span>'+
							'    <span class="picEdit" title="编辑图片" style="display:'+(isLive?'none':'inline-block')+'" stateful="">编辑</span>'+
							'    <span class="videoLive" title="预览" islive="'+isLive+'" data-pic="'+livePic+'" data-live="'+liveUrl+'" data-type="'+type+'" style="display:'+(isLive?'inline-block':'none')+'" stateful="">预览</span>'+
							'   </section>'+
							'   <section style="display:'+(isMyPic?'block':'none')+'">'+
							'    <section class="_135layout slider">'+
							'     <span style="float:right;z-index: 5;color: #333;line-height: 16px;font-size: 10px;" title="调整左右分栏宽度比例">调整宽度比例</span>'+
							'    </section>'+
							'    <section>'+
							'    </section>'+
							'   </section>'+
							'  </section> ';
						console.log(m);
						console.log('=====m')

		
						//m = c.current_active_135item.parents("body");
						p = jQuery(videoHtml);
						0 == m.find(".otf-poptools").size() ? m.append(p) : p = m.find(".otf-poptools");
						if (!c.options.hide_style_popup) {
							"inner" == c.options.style_toolbar ? (m = jQuery(c.current_active_135item).offset(), p.css("top", m.top + jQuery(c.current_active_135item).height() + 5)) : (n.anchorEl = h, n.showAnchor(n.anchorEl), $(p).parents(".edui-popup-body").css("width", "auto"));
							m = jQuery(c.container).offset().top + d.clientY + jQuery(c.container).find(".edui-editor-toolbarbox").height();
							"function" == typeof showColorPlan && showColorPlan(m);
						}

						p.find('.imagefloat').unbind("click").click(function(a) {
							var type = $(this).attr('type')
							c.execCommand("imagefloat", type);
							a.preventDefault();
							$(this).blur();
							return !1
						})
						p.find(".movedown").unbind("click").click(function(a) {
							var b = c.current_active_135item,
								d = b.next();
							if (0 < d.length) b.insertAfter(d);
							else {
								var e = jQuery(b).parent();
								if ("BODY" != e.prop("tagName") && !e.hasClass("article135"))
									for (d = e.next(); 0 == d.length;)
										if (e = jQuery(e).parent(), 0 < e.length) d = e.next();
										else break;
								0 < d.length ? b.insertAfter(d) : c.fireEvent("showmessage", {
									content: "后面没有内容了，无法再向下移动",
									timeout: 1E3
								})
							}
							b = jQuery(c.current_active_135item).offset();
							p.css("top", b.top + jQuery(c.current_active_135item).height() + 5);
							a.preventDefault();
							$(this).blur();
							return !1
						});

						p.find(".remove").unbind("click").click(function(a) {
							c.current_active_135item.remove();
							a.preventDefault();
							$(this).blur();
							"inner" == c.options.style_toolbar ? p.remove() : n.hide();
							return !1
						});
						//后空行
						p.find("._blank").unbind("click").click(function(a) {
							var b = c.selection.getRange(),
								d = jQuery('<p><br/></p>');
							d.insertAfter(c.current_active_135item);
							d = d.find("p").get(0);
							b.setStart(d, 0).setCursor(!1, !0);
							"inner" == c.options.style_toolbar ? p.remove() : n.hide();
							c.current_active_135item.removeClass("active").find(".tool-border").remove();
							a.preventDefault();
							$(this).blur();
							return !1
						});
						//前空行
						p.find("._preblank").unbind("click").click(function(a) {
							var b = c.selection.getRange(),
								d = jQuery('<p><br/></p>');
							d.insertBefore(c.current_active_135item);
							d = d.find("p").get(0);
							b.setStart(d, 0).setCursor(!1, !0);
							"inner" == c.options.style_toolbar ? p.remove() : n.hide();
							c.current_active_135item.removeClass("active").find(".tool-border").remove();
							a.preventDefault();
							$(this).blur();
							return !1
						});
						p.find(".moveup").unbind("click").click(function(a) {
							var b = c.current_active_135item,
								d = b.prev();
							if (0 < d.length && "BODY" != d.prop("tagName")) b.insertBefore(d);
							else {
								var e = jQuery(b).parent();
								if ("BODY" != e.prop("tagName") && !e.hasClass("article135"))
									for (d = e.prev(); 0 == d.length;)
										if (e = jQuery(e).parent(), 0 < e.length && "BODY" != e.prop("tagName")) d = e.prev();
										else break;
								0 < d.length && "BODY" != d.prop("tagName") ? b.insertBefore(d) : c.fireEvent("showmessage", {
									content: "前面没有内容了，无法再向上移动",
									timeout: 1E3
								})
							}
							b = jQuery(c.current_active_135item).offset();
							p.css("top", b.top + jQuery(c.current_active_135item).height() + 5);
							a.preventDefault();
							$(this).blur();
							return !1
						});
						p.find(".movedown").unbind("click").click(function(a) {
							var b = c.current_active_135item,
								d = b.next();
							if (0 < d.length) b.insertAfter(d);
							else {
								var e = jQuery(b).parent();
								if ("BODY" != e.prop("tagName") && !e.hasClass("article135"))
									for (d = e.next(); 0 == d.length;)
										if (e = jQuery(e).parent(), 0 < e.length) d = e.next();
										else break;
								0 < d.length ? b.insertAfter(d) : c.fireEvent("showmessage", {
									content: "后面没有内容了，无法再向下移动",
									timeout: 1E3
								})
							}
							b = jQuery(c.current_active_135item).offset();
							p.css("top", b.top + jQuery(c.current_active_135item).height() + 5);
							a.preventDefault();
							$(this).blur();
							return !1
						});

							var y = jQuery(h).find(".layout:first").parent(),
								A = y.find("> .layout").size();
							if (0 == A) {
								var t = jQuery(h).get(0).style.width,
									D = !0;
								0 <= t.indexOf("%") ? t = t.replace("%", "") : 0 <= t.indexOf("px") ? (D = !1, t = t.replace("px", ""), t = parseInt(100 * t / jQuery(h).width())) : t = 100;
								p.find("._135layout").attr("data-param-init-value", t).removeClass("hidden").on("inited", function(a, b) {
									jQuery(this).find(".complete").html(b + "%")
								}).slider({
									initAll: !1,
									initValue: t
								}).on("change", function(a, b) {
									if (D) jQuery(this).find(".complete").html(b + "%"), jQuery(h).css("margin", "0 auto").css("width", b + "%").attr("data-width", b + "%");
									else {
										var c = parseInt(jQuery(h).width() * b / 100);
										jQuery(this).find(".complete").html(c + "px");
										jQuery(h).css("margin", "0 auto").css("width", c + "px")
									}
								})
							}
				}
				//如果是 IMG 则 m = e.getClosedNode(),  如果是文本节点则取父节点,否则取开始节点
				else if (m = e.getClosedNode(), "IMG" == h.tagName  ? window.current_edit_img = h : "touchstart" != d.type && (m = e.startContainer, 3 == m.nodeType && (m = m.parentNode), h = m), !(0 < jQuery(h).parents(".otf-poptools").size())){
					console.log(jQuery(h).parents(".otf-poptools").size());
				console.log(2);
				console.log('e.startContainer === ');
				//console.log(e.startContainer);
					console.log(m);
					console.log(d);
					console.log(6666666)

					//判断父级是否含有 _135editor  类
					if (jQuery(h).hasClass("_135editor") || 0 < jQuery(h).parents("._135editor").size()) {
						//找到最近的父级_135editor类
						jQuery(h).hasClass("_135editor") || (h = jQuery(h).parents("._135editor:first").get(0));
						// console.log(h.tagName)
						// console.log('h.tagName ')
						m = jQuery(h).clone();
						m.find(".tool-border").remove();
						m = null;
						c.current_active_135item && !c.current_active_135item.is(h) && clean_135helper();
						c.current_active_135item = jQuery(h);
						c.current_active_135item.addClass("active");
						var p;

						"inner" == c.options.style_toolbar ? m = c.current_active_135item.parents("body") : (n.render(), m = jQuery(n.getDom("content")));
						0 == m.find(".otf-poptools").size() ? (p = jQuery('<section class="otf-poptools" contenteditable="false" style="width:370px"><section><span class="copy" title="复制样式代码" stateful>复制</span><span class="select" title="选中后，可以将样式秒刷更换为别的样式" stateful>选中</span><span class="remove" title="删除本样式" stateful>删除</span><span class="_135autonum hidden" title="将所有出现的与本样式相同的样式序号从小到大编号" stateful>自动编号</span><span class="_135bg hidden" title="设置背景图片" stateful>背景图</span><span class="_135video hidden" title="更换视频地址" stateful>视频</span><span class="_135music hidden" title="编辑音乐地址" stateful>音乐</span><span class="_135bdbg hidden" title="设置边框类型" stateful>边框</span><span class="_135para" title="设置段落字体、缩进、行高、段落间距等。" stateful>段落</span><span class="_135colors" title="将换色与宽度调整应用到其它相同样式" stateful>传递</span><span class="moveup">↑上移</span><span class="movedown">↓下移</span></section><section><span class="_135clean hidden" title="清除样式" stateful>清除样式</span><span class="_135convertImage"  title="转为图片" stateful>转为图片</span><span class="_135saveTemplate"  title="保存为个人样式" stateful>保存</span><span class="_blank"  title="样式之后插入空行" stateful>后空行</span><span class="_preblank"  title="样式之前插入空行" stateful>前空行</span><section class="_135layout slider"><span style="float:right;z-index: 5;color: #333;line-height: 16px;font-size: 10px;" title="调整左右分栏宽度比例">调整宽度比例</span></section><section><input type="text" style="width:30px;float:right;border:0 none;height:16px;line-height:14px;color:#333;font-size:12px;text-align: right;padding:0 2px;" name="rotatez" placeholder="输入"><section class="_135rotate slider" style="margin-right:35px;"><span style="float:right;z-index: 5;color: #333;line-height: 16px;font-size: 10px;">旋转角度（-180~180）</span></section></section><section><input type="text" style="width:30px;float:right;border:0 none;height:16px;line-height:14px;color:#333;font-size:12px;text-align: right;padding:0 2px;" name="opacity" placeholder="输入"><section class="_135opacity slider" style="margin-right:35px;"><span style="float:right;z-index: 5;color: #333;line-height: 16px;font-size: 10px;">透明度（0~1）</span></section></section></section></section>'), m.append(p)) : p = m.find(".otf-poptools");

						if (!c.options.hide_style_popup) {
							"inner" == c.options.style_toolbar ? (m = jQuery(c.current_active_135item).offset(), p.css("top", m.top + jQuery(c.current_active_135item).height() + 5)) : (n.anchorEl = h, n.showAnchor(n.anchorEl), $(p).parents(".edui-popup-body").css("width", "auto"));
							m = jQuery(c.container).offset().top + d.clientY + jQuery(c.container).find(".edui-editor-toolbarbox").height();
							"function" == typeof showColorPlan && showColorPlan(m);
							p.find("._135clean").unbind("click").click(function(b) {
								console.log(c.current_active_135item);
								jQuery(c.current_active_135item).removeClass('_135editor');
								jQuery(c.current_active_135item).find('._135editor').removeClass('_135editor');
								c.current_active_135item.find(".tool-border").remove();
								window.ajaxAction && window.ajaxAction("//" + a.options.plat_host + "/html_parsers/clean", {
									html: jQuery(c.current_active_135item).prop("outerHTML")
								}, null, function(a) {
									a.success || 0 == a.ret ? (jQuery(c.current_active_135item).removeClass('_135editor').replaceWith(a.html), window.showSuccessMessage(a.msg)) : window.showErrorMessage(a.msg)
								});
								b.preventDefault();
								$(this).blur();
								return !1
							});
							p.find(".remove").unbind("click").click(function(a) {
								c.current_active_135item.remove();
								a.preventDefault();
								$(this).blur();
								"inner" == c.options.style_toolbar ? p.remove() : n.hide();
								return !1
							});
							p.find(".copy").unbind("click").click(function(a) {
								c.current_active_135item.find(".tool-border").remove();
								a.preventDefault();
								$(this).blur();
								return !1
							});
							p.find("._135convertImage").unbind("click").click(function(b) {
								c.current_active_135item.find(".tool-border").remove();
								window.ajaxAction && window.ajaxAction("//" + a.options.plat_host + "/html_images/save", {
									html: c.current_active_135item.prop("outerHTML")
								}, null, function(a) {
									0 == a.ret || a.success ? (c.current_active_135item.replaceWith(a.html), window.showSuccessMessage(a.msg)) : window.showErrorMessage(a.msg)
								});
								b.preventDefault();
								$(this).blur();
								return !1
							});
							p.find("._135saveTemplate").unbind("click").click(function(b) {
								c.current_active_135item.find(".tool-border").remove();
								window.ajaxAction && window.ajaxAction("//" + a.options.plat_host + "/user_styles/saveTemplate", {
									content: c.current_active_135item.prop("outerHTML")
								}, null, function(a) {
									0 == a.ret ? window.showSuccessMessage(a.msg) : window.showErrorMessage(a.msg)
								});
								b.preventDefault();
								$(this).blur();
								return !1
							});
							p.find(".select").unbind("click").click(function(b) {
								c.current_active_135item.find(".tool-border").remove();
								// window.ajaxAction && window.ajaxAction("//" + a.options.plat_host + "/user_styles/saveTemplate", {
								// 	content: c.current_active_135item.prop("outerHTML")
								// }, null, function(a) {
								// 	0 == a.ret ? window.showSuccessMessage(a.msg) : window.showErrorMessage(a.msg)
								// });
								var d = c.selection.getRange();
								d.selectNode(h);
								d.select();
								b.preventDefault();
								$(this).blur();
								return !1
							});
							//后空行
							p.find("._blank").unbind("click").click(function(a) {
								var b = c.selection.getRange(),
									d = jQuery('<p><br/></p>');
								d.insertAfter(c.current_active_135item);
								d = d.find("p").get(0);
								b.setStart(d, 0).setCursor(!1, !0);
								"inner" == c.options.style_toolbar ? p.remove() : n.hide();
								c.current_active_135item.removeClass("active").find(".tool-border").remove();
								a.preventDefault();
								$(this).blur();
								return !1
							});
							//前空行
							p.find("._preblank").unbind("click").click(function(a) {
								var b = c.selection.getRange(),
									d = jQuery('<p><br/></p>');
								d.insertBefore(c.current_active_135item);
								d = d.find("p").get(0);
								b.setStart(d, 0).setCursor(!1, !0);
								"inner" == c.options.style_toolbar ? p.remove() : n.hide();
								c.current_active_135item.removeClass("active").find(".tool-border").remove();
								a.preventDefault();
								$(this).blur();
								return !1
							});
							p.find(".moveup").unbind("click").click(function(a) {
								var b = c.current_active_135item,
									d = b.prev();
								if (0 < d.length && "BODY" != d.prop("tagName")) b.insertBefore(d);
								else {
									var e = jQuery(b).parent();
									if ("BODY" != e.prop("tagName") && !e.hasClass("article135"))
										for (d = e.prev(); 0 == d.length;)
											if (e = jQuery(e).parent(), 0 < e.length && "BODY" != e.prop("tagName")) d = e.prev();
											else break;
									0 < d.length && "BODY" != d.prop("tagName") ? b.insertBefore(d) : c.fireEvent("showmessage", {
										content: "前面没有内容了，无法再向上移动",
										timeout: 1E3
									})
								}
								b = jQuery(c.current_active_135item).offset();
								p.css("top", b.top + jQuery(c.current_active_135item).height() + 5);
								a.preventDefault();
								$(this).blur();
								return !1
							});
							p.find(".movedown").unbind("click").click(function(a) {
								var b = c.current_active_135item,
									d = b.next();
								if (0 < d.length) b.insertAfter(d);
								else {
									var e = jQuery(b).parent();
									if ("BODY" != e.prop("tagName") && !e.hasClass("article135"))
										for (d = e.next(); 0 == d.length;)
											if (e = jQuery(e).parent(), 0 < e.length) d = e.next();
											else break;
									0 < d.length ? b.insertAfter(d) : c.fireEvent("showmessage", {
										content: "后面没有内容了，无法再向下移动",
										timeout: 1E3
									})
								}
								b = jQuery(c.current_active_135item).offset();
								p.css("top", b.top + jQuery(c.current_active_135item).height() + 5);
								a.preventDefault();
								$(this).blur();
								return !1
							});
							p.find("._135colors").unbind("click").click(function(a) {
								var b = "id",
									d = jQuery(c.current_active_135item).data("id");
								"undefined" == typeof d && (b = "role", d = jQuery(c.current_active_135item).data("role"));
								var e = c.selection.document,
									f = jQuery(c.current_active_135item).attr("data-color"),
									g = jQuery("._135editor[data-" + b + "=" + d + "]", e).size() - 1;
								f && jQuery("._135editor[data-" + b + "=" + d + "]", e).each(function() {
									this != jQuery(c.current_active_135item).get(0) && f != jQuery(this).attr("data-color") && (parseObject(jQuery(this), f, "#FFF"), jQuery(this).attr("data-color", f), jQuery(this).attr("data-custom", f))
								});
								var h = [];
								if (0 < jQuery(c.current_active_135item).find(".layout").size()) {
									var k = jQuery(c.current_active_135item).find(".layout:first").parent();
									2 >= k.find("> .layout").size() && jQuery(c.current_active_135item).find(".layout:first").parents("._135editor:first").get(0) == jQuery(c.current_active_135item).get(0) && (h = k.find("> .layout"))
								}
								0 < h.length ? jQuery("._135editor[data-" + b + "=" + d + "]", e).each(function() {
									if (this != jQuery(c.current_active_135item).get(0)) {
										var a = jQuery(this).find(".layout:first").parent(),
											b = a.find("> .layout").size();
										2 != b && 1 != b || jQuery(this).find(".layout:first").parents("._135editor:first").get(0) != jQuery(this).get(0) || a.find("> .layout").each(function(a) {
											this.style.width = h.get(a).style.width;
											jQuery(this).attr("data-width", h.get(a).style.width)
										})
									}
								}) : jQuery(c.current_active_135item).get(0).style.width && jQuery("._135editor[data-" + b + "=" + d + "]", e).each(function() {
									this != jQuery(c.current_active_135item).get(0) && (this.style.width = jQuery(c.current_active_135item).get(0).style.width, this.style.margin = "0 auto", jQuery(this).attr("data-width", jQuery(c.current_active_135item).get(0).style.width))
								});
								0 < g ? (c.undoManger.save(), window.showSuccessMessage("为您同步变换了" + g + "个样式的颜色，节省时间" + 10 * g + "秒")) : window.showErrorMessage("未找到使用相同样式的内容");
								a.preventDefault();
								$(this).blur();
								return !1
							});
							p.find("._135autonum").unbind("click").click(function(a) {
								var b = jQuery(c.current_active_135item).data("id"),
									d = c.selection.document;
								if (b) {
									var e = 0;
									jQuery("._135editor[data-id=" + b + "]", d).each(function(a) {
										jQuery(this).find(".autonum:first").html(a + 1);
										e++
									});
									window.showSuccessMessage("为您自动编号了" + e + "个样式，节省时间" + 10 * e + "秒");
									c.undoManger.save()
								}
								a.preventDefault();
								$(this).blur();
								return !1
							});
							p.find("._135bg").unbind("click").click(function(a) {
								g.render();
								g.open();
								g.anchorEl = c.current_active_135item.get(0);
								a.preventDefault();
								$(this).blur();
								return !1
							});
							p.find("._135bdbg").unbind("click").click(function(a) {
								f.render();
								f.open();
								f.anchorEl = c.current_active_135item.get(0);
								a.preventDefault();
								$(this).blur();
								return !1
							});
							p.find("._135para").unbind("click").click(function(a) {
								l.render();
								l.open();
								l.anchorEl = c.current_active_135item.get(0);
								a.preventDefault();
								$(this).blur();
								return !1
							});
							p.find("._135music").unbind("click").click(function(a) {
								c.ui._dialogs.musicDialog && c.ui._dialogs.musicDialog.open();
								c.ui._dialogs.musicDialog.anchorEl = c.current_active_135item.get(0);
								a.preventDefault();
								$(this).blur();
								return !1
							});
							p.find("._135video").unbind("click").click(function(a) {
								c.ui._dialogs.insertvideoDialog && c.ui._dialogs.insertvideoDialog.open();
								c.ui._dialogs.insertvideoDialog.anchorEl = c.current_active_135item.get(0);
								a.preventDefault();
								$(this).blur();
								return !1
							});
							p.find("._135clean").removeClass("hidden");
							c.options.open_editor && (p.find("._135convertImage").addClass("hidden"), p.find("._135saveTemplate").addClass("hidden"));
							jQuery(h).find(".135bg").size() && p.find("._135bg").removeClass("hidden");
							jQuery(h).find(".autonum").size() && p.find("._135autonum").removeClass("hidden");
							jQuery(h).find("audio").size() && p.find("._135music").removeClass("hidden");
							jQuery(h).find(".video_iframe").size() && p.find("._135video").removeClass("hidden");
							var r = !1;
							jQuery(h).find("*").each(function() {
								if ($(this).hasClass("_135editor") || 0 < $(this).parents(".tool-border").length) return !0;
								if (this.style.background || this.style.border || this.style.borderBottom || this.style.borderTop || this.style.borderLeft || this.style.borderRight) r = !0
							});
							r && UE.browser.webkit && p.find("._135bdbg").removeClass("hidden");
							var t = h.style.transform;
							t && -1 < t.toLowerCase().indexOf("rotatez(") ? (t = parseInt(t.toLowerCase().replace("rotatez", "").replace("(", "").replace(")", "")), 180 < t ? t -= 360 : -180 > t && (t += 360)) : t = 0;
							t = 100 * (t + 180) / 360;
							p.find("._135rotate").attr("data-param-init-value", t).on("inited", function(a, b) {
								var c = parseInt(360 * b / 100 - 180);
								jQuery(this).find(".complete").html(c);
								p.find("input[name=rotatez]").val(c)
							}).slider({
								initAll: !1,
								initValue: t
							}).on("change", function(a, b) {
								var d = parseInt(360 * b / 100 - 180);
								jQuery(this).find(".complete").html(d);
								c.setElementTransform(h, "rotatez(" + d + "deg)");
								p.find("input[name=rotatez]").val(d)
							});
							p.find("input[name=rotatez]").on("keyup", function() {
								if ("" == this.value || "NaN" == parseInt(this.value)) this.value = 0;
								var a = parseInt(this.value) % 180;
								a != parseInt(this.value) && (this.value = a);
								p.find("._135rotate").find(".complete").html(this.value);
								a = parseInt(this.value) + 180;
								a = parseInt(100 * a / 360);
								p.find("._135rotate").data("slider").val(a);
								c.setElementTransform(h, "rotatez(" + this.value + "deg)")
							});
							t = 100 * jQuery(h).css("opacity");
							p.find("._135opacity").attr("data-param-init-value", t).on("inited", function(a, b) {
								var c = b / 100;
								p.find("input[name=opacity]").val(c)
							}).slider({
								initAll: !1,
								initValue: t
							}).on("change", function(a, b) {
								var c = b / 100;
								jQuery(h).css("opacity", c);
								p.find("input[name=opacity]").val(c)
							});
							p.find("input[name=opacity]").on("keyup", function() {
								if ("" == this.value || "NaN" == parseInt(this.value)) this.value = 0;
								jQuery(h).css("opacity", this.value);
								p.find("._135opacity").find(".complete").html(this.value);
								var a = 100 * this.value;
								p.find("._135opacity").data("slider").val(a)
							});

							var y = jQuery(h).find(".layout:first").parent(),
								A = y.find("> .layout").size();
							if (0 == A) {
								var t = jQuery(h).get(0).style.width,
									D = !0;
								0 <= t.indexOf("%") ? t = t.replace("%", "") : 0 <= t.indexOf("px") ? (D = !1, t = t.replace("px", ""), t = parseInt(100 * t / jQuery(h).width())) : t = 100;
								p.find("._135layout").attr("data-param-init-value", t).removeClass("hidden").on("inited", function(a, b) {
									jQuery(this).find(".complete").html(b + "%")
								}).slider({
									initAll: !1,
									initValue: t
								}).on("change", function(a, b) {
									if (D) jQuery(this).find(".complete").html(b + "%"), jQuery(h).css("margin", "0 auto").css("width", b + "%").attr("data-width", b + "%");
									else {
										var c = parseInt(jQuery(h).width() * b / 100);
										jQuery(this).find(".complete").html(c + "px");
										jQuery(h).css("margin", "0 auto").css("width", c + "px")
									}
								})
							}
							2 != A && 1 != A || jQuery(h).find(".layout:first").parents("._135editor:first").get(0) != jQuery(h).get(0) || (t = jQuery(h).find(".layout").get(0).style.width, D = !0, 0 <= t.indexOf("%") ? t = t.replace("%", "") : 0 <= t.indexOf("px") ? (D = !1, t = t.replace("px", ""), t = parseInt(100 * t / jQuery(h).width())) : t = 100, p.find("._135layout").attr("data-param-init-value", t).removeClass("hidden").on("inited", function(a, b) {
								jQuery(this).find(".complete").html(b + "%")
							}).slider({
								initAll: !1,
								initValue: t
							}).on("change", function(a, b) {
								if (D) jQuery(this).find(".complete").html(b + "%"), y.find("> .layout").eq(0).css("width", b + "%").attr("data-width", b + "%"), 2 == A && y.find("> .layout").eq(1).css("width", 100 - b + "%").attr("data-width", 100 - b + "%");
								else {
									var c = parseInt(jQuery(h).width() * b / 100);
									jQuery(this).find(".complete").html(c + "px");
									y.find("> .layout").eq(0).css("width", c + "px")
								}
							}));
							if ("inner" != c.options.style_toolbar) {
								var t = parseInt(n.getDom().style.top.replace("px", "")),
									E = jQuery(n.getDom("content")).height() + 16;
								if (t + E > jQuery(window).height()) e = jQuery(n.anchorEl).height(), 135 < t - e - E ? n.getDom().style.top = t - e - E + "px" : 135 < m - E - 135 ? n.getDom().style.top = m - E - 135 + "px" : n.getDom().style.top = m + E + 135 + "px";
								else if (E = d.target || d.srcElement, m = e.getClosedNode(), "IMG" == E.tagName || m && "IMG" == m.tagName) n.getDom().style.top = t + 60 + "px"
							}
							c.current_active_135item.attr("data-color") && (e = c.current_active_135item.attr("data-color"), jQuery("#custom-color-text").val(e).css("background-color", e));
							if ("undefined" == typeof ZeroClipboard) p.find(".copy").remove(), p.find(".cut").remove();
							else {
								var H = new ZeroClipboard(p.find(".copy"));
								H.on("ready", function(a) {
									H.on("copy", function(a) {
										jQuery(c.current_active_135item).find(".tool-border").remove();
										jQuery(c.current_active_135item).removeClass("active");
										a.clipboardData.setData("text/html", c.current_active_135item.prop("outerHTML"));
										window.showSuccessMessage("样式已成功复制到剪切板")
									})
								});
								var M = new ZeroClipboard(p.find(".cut"));
								M.on("ready", function(a) {
									M.on("copy", function(a) {
										jQuery(c.current_active_135item).find(".tool-border").remove();
										jQuery(c.current_active_135item).removeClass("active");
										a.clipboardData.setData("text/html", c.current_active_135item.prop("outerHTML"));
										jQuery(c.current_active_135item).remove();
										window.showSuccessMessage("样式已成功剪切到剪切板")
									})
								})
							}
						}
					}else clean_135helper(), c.current_active_135item && (c.current_active_135item = null)
				}

			}
		})
	};
	UE.registerUI("135editor", function(c, a) {
		var e = new UE.ui.Dialog({
			iframeUrl: "135editor/135EditorDialogPage.html",
			editor: c,
			name: a,
			title: "135编辑器"
		});
		e.fullscreen = !0;
		e.draggable = !1;
		return new UE.ui.Button({
			name: "dialogbutton" + a,
			className: "edui-for-135editor",
			title: "135编辑器",
			onclick: function() {
				e.render();
				e.open()
			}
		})
	});
	UE.registerUI("message", function(c) {
		function a() {
			if (d && g.ui) {
				var a = g.ui.getDom("toolbarbox");
				a && (d.style.top = a.offsetHeight + 3 + "px");
				d.style.zIndex = Math.max(g.options.zIndex, g.iframe.style.zIndex) + 1
			}
		}
		var e = q.editor.ui.Message,
			d, b = [],
			g = c;
		g.addListener("ready", function() {
			d = document.getElementById(g.ui.id + "_message_holder");
			a();
			setTimeout(function() {
				a()
			}, 500)
		});
		g.addListener("showmessage", function(c, h) {
			h = p.isString(h) ? {
				content: h
			} : h;
			var f = new e({
					timeout: h.timeout,
					type: h.type,
					content: h.content,
					keepshow: h.keepshow,
					editor: g
				}),
				l = h.id || "msg_" + (+new Date).toString(36);
			f.render(d);
			b[l] = f;
			f.reset(h);
			a();
			return l
		});
		g.addListener("updatemessage", function(a, c, e) {
			e = p.isString(e) ? {
				content: e
			} : e;
			a = b[c];
			a.render(d);
			a && a.reset(e)
		});
		g.addListener("hidemessage", function(a, c) {
			var d = b[c];
			d && d.hide()
		})
	});
	UE.registerUI("autosave", function(c) {
		var a = null,
			e = null;
		c.on("afterautosave", function() {
			clearTimeout(a);
			a = setTimeout(function() {
				e && c.trigger("hidemessage", e);
				e = c.trigger("showmessage", {
					content: c.getLang("autosave.success"),
					timeout: 2E3
				})
			}, 2E3)
		})
	})



})();

/**
 * 插入日期，默认格式：2013-08-30
 * @command date
 * @method execCommand
 * @param { String } cmd 命令字符串
 * @example
 * ```javascript
 * editor.execCommand( 'date');
 * ```
 */
UE.commands['time'] = UE.commands["date"] = {
    execCommand : function(cmd, format){
        var date = new Date;

        function formatTime(date, format) {
            var hh = ('0' + date.getHours()).slice(-2),
                ii = ('0' + date.getMinutes()).slice(-2),
                ss = ('0' + date.getSeconds()).slice(-2);
            format = format || 'hh:ii:ss';
            return format.replace(/hh/ig, hh).replace(/ii/ig, ii).replace(/ss/ig, ss);
        }
        function formatDate(date, format) {
            var yyyy = ('000' + date.getFullYear()).slice(-4),
                yy = yyyy.slice(-2),
                mm = ('0' + (date.getMonth()+1)).slice(-2),
                dd = ('0' + date.getDate()).slice(-2);
            format = format || 'yyyy-mm-dd';
            return format.replace(/yyyy/ig, yyyy).replace(/yy/ig, yy).replace(/mm/ig, mm).replace(/dd/ig, dd);
        }

        this.execCommand('insertHtml',cmd == "time" ? formatTime(date, format):formatDate(date, format) );
    }
};

UE.registerUI('button11',function(editor,uiName){
    //注册按钮执行时的command命令，使用命令默认就会带有回退操作
    editor.registerCommand(uiName,{
        execCommand:function(){
            alert('execCommand:' + uiName)
        }
    });

    //创建一个button
    var btn = new UE.ui.Button({
        //按钮的名字
        name:uiName,
        //提示
        title:uiName,
        //需要添加的额外样式，指定icon图标，这里默认使用一个重复的icon
        cssRules :'background-position: -500px 0;',
        //点击时执行的命令
        onclick:function () {
            //这里可以不用执行命令,做你自己的操作也可
           editor.execCommand(uiName);
        }
    });

    //当点到编辑内容上时，按钮要做的状态反射
    editor.addListener('selectionchange', function () {
        var state = editor.queryCommandState(uiName);
        if (state == -1) {
            btn.setDisabled(true);
            btn.setChecked(false);
        } else {
            btn.setDisabled(false);
            btn.setChecked(state);
        }
    });

    //因为你是添加button,所以需要返回这个button
    return btn;
}/*index 指定添加到工具栏上的那个位置，默认时追加到最后,editorId 指定这个UI是那个编辑器实例上的，默认是页面上所有的编辑器都会添加这个按钮*/);