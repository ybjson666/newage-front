(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{1177:function(e,t,a){},1223:function(e,t,a){"use strict";a.r(t);a(322);var n=a(181),i=(a(1113),a(1112)),r=(a(146),a(41)),s=(a(1108),a(1109)),l=(a(326),a(183)),c=(a(1114),a(1115)),o=(a(495),a(137)),d=(a(325),a(85)),u=(a(321),a(117)),m=a(174),p=a(175),h=a(177),g=a(176),v=a(179),f=a(178),y=(a(324),a(84)),E=(a(241),a(180)),b=(a(1110),a(1111)),D=a(0),S=a.n(D),I=a(147),w=(a(1177),a(489)),T=a(1152),k=(a(1137),a(1142)),C=(a(1118),a(1119)),x=(a(491),a(118)),O=(a(492),a(60)),N=(a(493),a(9)),A=(a(1116),a(1117)),L=a(236),R=(a(494),a(242)),M=(a(1123),a(1122)),j=a(1147),Y=a(1159),K=(a(1170),a(1163)),P=a(20),B=a.n(P),V=a(1150),z=a(1160),H=M.a.RangePicker,_=R.a.TabPane,q=b.a.confirm,U=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).onSelectChange=function(t){e.setState({selectedRowKeys:t})},e.onRowEvent=function(t){var a=[];a.push(t.id),e.setState({selectedRowKeys:a})},e.uploadSuccess=function(t){e.faceUrl=t.data},e.handleSubmit=function(t){t&&t.preventDefault();var a=e.props.type;e.faceUrl||"edit"===a?e.props.form.validateFieldsAndScroll((function(t,a){if(!t){var n={};n=2!=e.state.tabKey?Object.assign(a,e.position||{}):a;var i=e.faceUrl?e.faceUrl:"";if(i)n.cover=i;else{if("edit"!==e.props.type||i||!e.pageData.cover)return void u.a.error("\u8bf7\u4e0a\u4f20\u5c01\u9762!");n.cover=e.pageData.cover}if(a.rTime&&a.rTime[0]&&(a.rStartTime=B()(a.rTime[0]).valueOf(),a.rEndTime=B()(a.rTime[1]).valueOf(),delete a.rTime),a.aTime&&a.aTime[0]&&(a.aStartTime=B()(a.aTime[0]).valueOf(),a.aEndTime=B()(a.aTime[1]).valueOf(),delete a.aTime),a.aStartTime<a.rEndTime)return void u.a.error("\u62a5\u540d\u65f6\u95f4\u8981\u5728\u6d3b\u52a8\u65f6\u95f4\u524d!");"edit"===e.props.type?(!a.activityname&&e.pageData.activityname&&(a.activityname=e.pageData.activityname),a.activityrecruitid=e.pageData.activityrecruitid,a.userid=e.pageData.userid,e.onUpdate(a)):e.onSubmit(a)}})):u.a.error("\u8bf7\u4e0a\u4f20\u5c01\u9762!")},e.onSubmit=function(t){e.setState({loading:!0}),T.a(t).then((function(t){t.success&&(u.a.success("\u4fdd\u5b58\u6210\u529f"),"onOk"in e.props&&e.props.onOk())})).catch((function(e){u.a.error("\u4fdd\u5b58\u5931\u8d25")})).finally((function(t){e.setState({loading:!1})}))},e.onUpdate=function(t){e.setState({loading:!0}),T.h(t).then((function(t){t.success&&(u.a.success("\u4fdd\u5b58\u6210\u529f"),"onOk"in e.props&&e.props.onOk())})).catch((function(e){u.a.error("\u4fdd\u5b58\u5931\u8d25")})).finally((function(t){e.setState({loading:!1})}))},e.editAtivityName=function(){e.setState({nameEdit:!0})},e.tabChange=function(t){2==t&&(e.state.voluntes.length||e.fetchInviteVolun()),e.setState({tabKey:t})},e.disabledStartDate=function(e){var t=B()().subtract(1,"days").valueOf();return B()(e).valueOf()<t},e.range=function(e,t){for(var a=[],n=e;n<t;n++)a.push(n);return a},e.disabledStartDateTime=function(){var t=B()().hour(),a=B()().minute();return{disabledHours:function(){return e.range(0,24).splice(0,t)},disabledMinutes:function(){return e.range(0,60).splice(0,a)}}},e.disabledEndDate=function(t){var a=B()().endOf("day").valueOf(),n=B()(t).valueOf(),i=B()(n).valueOf(),r=e.props.form.getFieldValue("rTime"),s="";return r&&Array.isArray(r)&&r[1]&&(s=B()(r[1]).valueOf()),s?i<s:i<a},e.disabledEndDateTime=function(t,a){var n=e.props.form.getFieldValue("rTime"),i=B()(),r="";if(!(n&&Array.isArray(n)&&n[1]))return{};i=B()(n[1]),r=B()(n[1]).format("YYYY-MM-DD");var s,l,c,o=i.hour(),d=i.minute(),u=i.second();Array.isArray(t)&&"start"==a?(s=B()(t[0]).hour(),l=B()(t[0]).minute(),c=B()(t[0]).format("YYYY-MM-DD")):Array.isArray(t)&&"end"==a?(s=B()(t[1]).hour(),l=B()(t[1]).minute(),c=B()(t[1]).format("YYYY-MM-DD")):(s=B()(t).hour(),l=B()(t).minute(),c=B()(t).format("YYYY-MM-DD"));var m=B()(r).isSame(B()(c));return u+1>=60&&(u=0,(d+=1)>=60&&(o+=1,d=0)),{disabledHours:function(){return m?e.range(0,24).splice(0,o):e.range(0,24).splice(0,0)},disabledMinutes:function(){return m&&s==o?e.range(0,60).splice(0,d):e.range(0,60).splice(0,0)},disabledSeconds:function(){return m&&s==o&&l==d?e.range(0,60).splice(0,u):e.range(0,60).splice(0,0)}}},e.openModal=function(){var t=e.props.detailData;if("{}"!==JSON.stringify(t)){if(4==t.activityRecruit.state)return void u.a.error("\u8be5\u6d3b\u52a8\u5df2\u7ed3\u675f");var a=t.cusList.length,n=t.activityRecruit.recruitcount;n>0&&a>=n?q({title:"\u6dfb\u52a0\u5fd7\u613f\u8005",content:"\u8be5\u6d3b\u52a8\u5fd7\u613f\u8005\u5269\u4f59\u540d\u989d\u4e0d\u8db3,\u662f\u5426\u786e\u8ba4\u6dfb\u52a0?",onOk:function(){e.setState({showModal:!0})}}):e.setState({showModal:!0})}},e.closeModal=function(){e.setState({showModal:!1})},e.transChange=function(t,a,n){e.setState({targetKeys:t})},e.tranSelectChange=function(t,a){var n=[].concat(Object(L.a)(t),Object(L.a)(a));e.setState({selectedKeys:n})},e.handleDisable=function(t){e.setState({disabled:t})},e.fetchInviteVolun=function(){w.f(e.volunParamsData).then((function(t){if(200===t.state){var a=t.data.map((function(e,t){return{key:t,customerID:e.CustomerID,customerName:e.CustomerName}}));e.setState({voluntes:a})}else u.a.error(t.message)}))},e.sureAdd=function(){var t=e.state,a=t.targetKeys,n=t.voluntes,i=[];a.length?(a.forEach((function(e){n.forEach((function(t){t.key==e&&i.push(t.customerID)}))})),i=i.join(","),w.a({type:"1",ids:i,activityId:e.volunParamsData.activityId}).then((function(t){200===t.state?(u.a.success("\u6dfb\u52a0\u6210\u529f"),e.props.fetchInfo(e.volunParamsData.activityId),e.fetchInviteVolun(),e.setState({showModal:!1,selectedKeys:[],targetKeys:[]})):u.a.error(t.message)}))):u.a.error("\u8bf7\u6dfb\u52a0\u5fd7\u613f\u8005")},e.trasTimes=function(e){if(e<1)return"00:00:00";var t=parseInt(e),a=0,n=0,i="";return t>60&&(a=parseInt(t/60),t=parseInt(t%60),a>60&&(n=parseInt(a/60),a=parseInt(a%60))),i=t>=0&&t<10?"0"+parseInt(t):""+parseInt(t),i=a>=0&&a<10?"0"+parseInt(a)+":"+i:parseInt(a)+":"+i,i=n>=0&&n<10?"0"+parseInt(n)+":"+i:parseInt(n)+":"+i},e.tranStamp=function(e){if(e){var t=e.replace(/-/g,"/");return Date.parse(t)/1e3}return 0},e.state={selectedRowKeys:[],tableData:[],totalCount:0,loading:!1,nameEdit:!1,tabKey:"1",num:0,showModal:!1,targetKeys:[],selectedKeys:[],disabled:!1,voluntes:[]},e.volunParamsData={activityId:"",type:"1"},e.imgPrev=sessionStorage.getItem("imgPrev"),e}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.imgPrev=sessionStorage.getItem("imgPrev"),"edit"==this.props.type&&this.props.detailData&&(this.volunParamsData.activityId=this.props.detailData.activityRecruit&&this.props.detailData.activityRecruit.activityrecruitid||"")}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.state,l=a.targetKeys,c=a.selectedKeys,o=(a.disabled,[{title:"\u5fd7\u613f\u8005\u540d\u79f0",dataIndex:"customername",align:"left",render:function(e,t){return S.a.createElement(d.a,{placement:"topLeft",title:e},S.a.createElement("span",null,e))}},{title:"\u52a0\u5165\u65f6\u95f4",dataIndex:"subdate",align:"left",render:function(e,t){return S.a.createElement("span",null,e)}},{title:"\u7b7e\u5230\u65f6\u95f4",dataIndex:"signtime",align:"left",render:function(e,t){var a="";return a=e||"\u6682\u672a\u7b7e\u5230",S.a.createElement("span",null,a)}},{title:"\u7b7e\u9000\u65f6\u95f4",dataIndex:"signouttime",align:"left",render:function(e,t){var a="";return a=e||"\u6682\u672a\u7b7e\u9000",S.a.createElement("span",null,a)}},{title:"\u53c2\u4e0e\u65f6\u957f",dataIndex:"costTime",align:"left",render:function(t,a){var n=e.tranStamp(a.signtime),i=e.tranStamp(a.signouttime)-n,r=e.trasTimes(i);return S.a.createElement("span",null,r)}}]),u={labelCol:{xs:{span:12},sm:{span:4}},wrapperCol:{xs:{span:12},sm:{span:19}}},m=this.props,p=m.detailData,h=void 0===p?{}:p,g=m.serverArea,v=void 0===g?[]:g,f=m.serverType,D=void 0===f?[]:f,I=m.type;this.pageData="edit"===I?h.activityRecruit:{};var w=[];"edit"===I&&(w=h.cusList),"edit"===I&&4==this.pageData.state&&(this.cancleEdit=!0),"edit"!==I||this.position||(this.position={addresslatitude:this.pageData.addresslatitude,addresslongitude:this.pageData.addresslongitude});return S.a.createElement(S.a.Fragment,null,S.a.createElement(s.a,{className:"breadcrumbBox"},S.a.createElement(s.a.Item,null,S.a.createElement(j.a,{onClick:this.props.onOk,to:"/ActivityList"},this.props.navTitle)),S.a.createElement(s.a.Item,null,S.a.createElement(j.a,{to:"/ActivityList",className:"active"},"create"===this.props.type?"\u65b0\u5efa\u6d3b\u52a8":"\u6d3b\u52a8\u8be6\u60c5"))),S.a.createElement("div",{className:"eachPageBox detail-part"},S.a.createElement(n.a,{tip:"\u4fdd\u5b58\u4e2d...",spinning:this.state.loading},S.a.createElement(A.a,Object.assign({className:"form-part"},{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},{onSubmit:this.handleSubmit}),"create"!=I?S.a.createElement(R.a,{defaultActiveKey:"1",activeKey:this.state.tabKey,onChange:this.tabChange},S.a.createElement(_,{tab:"\u6d3b\u52a8\u4fe1\u606f",key:"1"}),S.a.createElement(_,{tab:"\u5fd7\u613f\u8005",key:"2"})):"",S.a.createElement("div",{className:"detail-panel-part-activity"},S.a.createElement("div",{className:"panel-part-title-activity"},"create"===this.props.type||"edit"===I&&this.state.nameEdit&&!this.cancleEdit?S.a.createElement(A.a.Item,Object.assign({style:{marginBottom:"0",width:"100%"}},{labelCol:{xs:{span:0},sm:{span:0}},wrapperCol:{xs:{span:24},sm:{span:24}}}),t("activityname",{initialValue:this.pageData.activityname||this.pageData.title||"",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6d3b\u52a8\u540d\u79f0\uff01"}]})(S.a.createElement(E.a,{maxLength:30,placeholder:"\u8bf7\u8f93\u5165\u6d3b\u52a8\u540d\u79f0"}))):S.a.createElement("span",{className:"title-show-part",role:"button",tabIndex:"-1",onClick:this.editAtivityName},this.pageData.activityname,"edit"!==I||this.cancleEdit?"":S.a.createElement(N.a,{className:"can-editButton",type:"edit",stlyle:{position:"relative"}}))),"1"==this.state.tabKey?S.a.createElement("div",{className:"has-img"},S.a.createElement("div",{className:"part-main"},S.a.createElement(Y.a,{type:"text",buttonText:"\u70b9\u51fb\u4e0a\u4f20\u5c01\u9762\u56fe",imgValue:this.pageData.cover?this.imgPrev+this.pageData.cover:"",disabled:this.cancleEdit,onChange:function(t){e.pageData.cover=t.data,e.faceUrl=t.data,e.setState({num:e.state.num+1})}}),S.a.createElement("p",{style:{textAlign:"center",margin:"10px 0"}},"\u5efa\u8bae\u4e0a\u4f2016:9\u7684jpg,png\u683c\u5f0f\u56fe\u7247,\u56fe\u7247\u5927\u5c0f\u4e0d\u8d85\u8fc75M"),S.a.createElement(x.a,{className:"row-content"},S.a.createElement(O.a,{span:12},S.a.createElement(A.a.Item,{label:"\u6d3b\u52a8\u5730\u533a"},t("areaid",{initialValue:this.pageData.areaid?this.pageData.areaid+"":void 0,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6d3b\u52a8\u5730\u533a!"}]})(S.a.createElement(y.a,{disabled:this.cancleEdit,onChange:function(e){},style:{width:"200px"},placeholder:"\u8bf7\u9009\u62e9\u6d3b\u52a8\u5730\u533a"},v.map((function(e,t){return S.a.createElement(y.a.Option,{key:t,value:e.dictionaryId+""},e.dictionaryValue)})))))),S.a.createElement(O.a,{span:12},S.a.createElement(A.a.Item,{label:"\u6d3b\u52a8\u5730\u5740"},t("address",{initialValue:this.pageData.address,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6d3b\u52a8\u5730\u5740\uff01"}]})(S.a.createElement(K.a,{disabled:this.cancleEdit,locationValue:this.pageData.address,locationPoint:{latitude:this.pageData.addresslatitude,longitude:this.pageData.addresslongitude},onChange:function(t,a){e.props.form.setFieldsValue({address:t}),e.position={addresslatitude:a.latitude,addresslongitude:a.longitude}}}))))),S.a.createElement(x.a,null,S.a.createElement(A.a.Item,Object.assign({label:"\u670d\u52a1\u7c7b\u578b"},u),t("activitytype",{initialValue:this.pageData.activitytype?this.pageData.activitytype+"":void 0,rules:[]})(S.a.createElement(y.a,{disabled:this.cancleEdit,style:{width:"200px"},placeholder:"\u8bf7\u9009\u62e9\u670d\u52a1\u7c7b\u578b"},D.map((function(e,t){return S.a.createElement(y.a.Option,{key:t,value:e.dictionaryId+""},e.dictionaryValue)})))))),S.a.createElement(x.a,null,S.a.createElement(O.a,{span:12},S.a.createElement(A.a.Item,{label:"\u62db\u52df\u4eba\u6570"},t("recruitcount",{initialValue:this.pageData.recruitcount,rules:[{required:!1,message:"\u8bf7\u8f93\u5165\u62db\u52df\u4eba\u6570\uff01"},{pattern:new RegExp(/^[0-9]\d*$/,"g"),message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u4eba\u6570"}]})(S.a.createElement(C.a,{disabled:this.cancleEdit,min:0,style:{width:"200px"},placeholder:"\u8bf7\u8f93\u5165\u62db\u52df\u4eba\u6570",max:99999})))),S.a.createElement(O.a,{span:12},S.a.createElement(A.a.Item,{label:"\u7b7e\u5230\u534a\u5f84"},t("checkrange",{initialValue:this.pageData.checkrange,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7b7e\u5230\u534a\u5f84!"}]})(S.a.createElement(C.a,{max:1e4,disabled:this.cancleEdit,min:1,style:{width:"200px"},placeholder:"\u8bf7\u586b\u5199\u7b7e\u5230\u534a\u5f84"}))," ",S.a.createElement("span",{style:{marginLeft:"5px"}},"\u7c73")))),S.a.createElement(x.a,null,S.a.createElement(A.a.Item,Object.assign({label:"\u62a5\u540d\u65f6\u95f4"},u),t("rTime",{initialValue:"launch"===I||"edit"===I?[B()(this.pageData.recruitstarttime),B()(this.pageData.recruitendtime)]:[],rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u62a5\u540d\u65f6\u95f4\uff01"}]})(S.a.createElement(H,{disabled:this.cancleEdit,showTime:{hideDisabledOptions:!0,defaultValue:[B()("00:00:00","HH:mm:ss"),B()("23:59:59","HH:mm:ss")]},onChange:function(t){e.props.form.setFieldsValue({aTime:[B()(B()(t[1]).add("1","seconds")),void 0]})},format:"YYYY-MM-DD HH:mm:ss",disabledDate:this.disabledStartDate,placeholder:["\u5f00\u59cb\u65f6\u95f4","\u7ed3\u675f\u65f6\u95f4"],style:{width:"380px"}})))),S.a.createElement(x.a,null,S.a.createElement(A.a.Item,Object.assign({label:"\u6d3b\u52a8\u65f6\u95f4"},u),t("aTime",{initialValue:"launch"===I||"edit"===I?[B()(this.pageData.activitystarttime),B()(this.pageData.activityendtime)]:[],rules:[{validator:function(e,t,a){t[1]||a("\u8bf7\u9009\u62e9\u7ed3\u675f\u65f6\u95f4"),t[0]&&t[1]&&a()},required:!0,message:"\u8bf7\u9009\u62e9\u6d3b\u52a8\u65f6\u95f4\uff01"}]})(S.a.createElement(H,{disabled:this.cancleEdit,format:"YYYY-MM-DD HH:mm:ss",disabledTime:this.disabledEndDateTime,disabledDate:this.disabledEndDate,showTime:{hideDisabledOptions:!0,defaultValue:[B()("00:00:00","HH:mm:ss"),B()("23:59:59","HH:mm:ss")]},placeholder:["\u5f00\u59cb\u65f6\u95f4","\u7ed3\u675f\u65f6\u95f4"],style:{width:"380px"}})))),S.a.createElement(x.a,null,S.a.createElement(A.a.Item,Object.assign({label:"\u6d3b\u52a8\u63cf\u8ff0",ref:function(t){t&&(e.formItem=t)}},{labelCol:{xs:{span:12},sm:{span:4}},wrapperCol:{xs:{span:12},sm:{span:20}}}),t("activitydesc",{initialValue:this.pageData.activitydesc||this.pageData.description,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6d3b\u52a8\u63cf\u8ff0\uff01"}]})(S.a.createElement(z.a,{className:"showText-area",limit:"501",disabled:this.cancleEdit,rows:4,placeholder:"\u4e3a\u907f\u514d\u6d3b\u52a8\u521b\u5efa\u5931\u8d25\uff0c\u5efa\u8bae\u6b64\u5904\u8f93\u5165\u5b57\u6570\u4e0d\u8d85\u8fc7500\u5b57!"})))),"edit"===I?S.a.createElement(x.a,null,S.a.createElement(A.a.Item,Object.assign({label:"\u6d3b\u52a8\u72b6\u6001"},u),V.d[this.pageData.state])):"","edit"===I?S.a.createElement(x.a,null,S.a.createElement(O.a,{span:12},S.a.createElement(A.a.Item,{label:"\u521b\u5efa\u4eba"},this.pageData.subuser)),S.a.createElement(O.a,{span:12},S.a.createElement(A.a.Item,{label:"\u521b\u5efa\u65f6\u95f4"},this.pageData.subdate))):"")):S.a.createElement("div",{className:"tableCont mainContentBox table-activity-detail",style:{height:"500px"}},S.a.createElement("div",{className:"add-volunteer-warper"},S.a.createElement("span",{onClick:this.openModal},"\u6dfb\u52a0\u5fd7\u613f\u8005")),S.a.createElement(i.a,{rowKey:"customername",columns:o,dataSource:w,pagination:!1,scroll:{x:"100%",y:"400px"}}))),S.a.createElement("div",{className:"button-part"},S.a.createElement(r.a,{onClick:this.props.back},"\u8fd4\u56de"),this.cancleEdit?"":S.a.createElement(r.a,{type:"primary",htmlType:"submit"},"\u4fdd\u5b58")))),S.a.createElement(b.a,{title:"\u6dfb\u52a0\u5fd7\u613f\u8005",visible:this.state.showModal,onCancel:this.closeModal,width:500,footer:null},S.a.createElement("div",{className:"add-box"},S.a.createElement(k.a,{dataSource:this.state.voluntes,titles:["\u5fd7\u613f\u8005","\u5df2\u9009\u62e9"],targetKeys:l,selectedKeys:c,onChange:this.transChange,onSelectChange:this.tranSelectChange,render:function(e){return e.customerName},selectAllLabels:["\u5168\u9009"]}),S.a.createElement("div",{className:"btn-block"},S.a.createElement("span",{onClick:this.sureAdd},"\u786e\u8ba4\u6dfb\u52a0"))))))}}]),t}(D.Component),F=A.a.create({name:"detailForm"})(U),J=Object(I.c)((function(e){var t=e.message,a=e.navTitle;return{listData:t.listData,listLoading:t.listLoading,navTitle:a.navTitle}}),(function(e){return{getList:e.message.getList}}))(F),$=a(323),G=a(182),Q=b.a.confirm,W=E.a.Search,X=y.a.Option,Z=function(e){function t(){var e;Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).fetchConfig=function(){T.j({}).then((function(t){200==t.state?e.setState({articleUrl:t.data}):u.a.error(t.message)}))},e.onSelectChange=function(t,a){var n=[],i=[];a.map((function(e){i.push(e),n.push(e.activityrecruitid)})),e.setState({selectedRowKeys:n,selectRows:i})},e.onRowEvent=function(t){var a=[],n=[];a.push(t.activityrecruitid),n.push(t),e.setState({selectedRowKeys:a,selectRows:n})},e.getDataList=function(){var t={};t.params=Object.assign(e.searchData,e.listData),e.setState({emptyTxt:"\u52a0\u8f7d\u4e2d",tableData:[],isLoad:!0}),T.i(t).then((function(t){var a=t&&t.data.data||[],n=Array.isArray(a)?a:[];e.setState({tableData:n,totalCount:t.data&&t.data.totalCount||0,isLoad:!1},(function(){e.state.tableData.length||e.setState({emptyTxt:"\u6682\u65e0\u6570\u636e"})}))}))},e.fetchParams=function(){T.k({}).then((function(t){200==t.state&&(e.callBackParams.cb=t.data.cb,e.callBackParams.sj=t.data.sj,e.callBackParams.zm=t.data.zm)}))},e.onShowSizeChange=function(t,a){e.listData.pageno=t,e.listData.pagesize=a,e.getDataList()},e.pageBack=function(){e.setState({pageType:!0})},e.getSearviceType=function(){w.h().then((function(t){var a=t&&Array.isArray(t.data)?t.data:[];localStorage.setItem("serverType",JSON.stringify(a)),e.setState({serverType:a})}))},e.getSearviceArea=function(){w.g().then((function(t){var a=t&&Array.isArray(t.data)?t.data:[];localStorage.setItem("serverArea",JSON.stringify(a)),e.setState({serverArea:a})}))},e.fetchTenantId=function(){T.m({}).then((function(t){200==t.state?e.setState({tenantId:t.data}):u.a.error(t.message)}))},e.confirm=function(t){var a=[];t.map((function(e){a.push(e.activityrecruitid)}));var n={ids:a.join(",")};T.d(n).then((function(a){200==a.state&&(u.a.success("\u5220\u9664\u6210\u529f\uff01"),t.length==e.state.tableData.length&&(e.listData.pageno=1),e.getDataList(),e.setState({selectRows:[],selectedRowKeys:[]}))}))},e.lookDetail=function(t){t.activityrecruitid&&e.fetchInfo(t.activityrecruitid)},e.fetchInfo=function(t){T.e({id:t}).then((function(t){t.success&&e.setState({currentDetail:t.data,pageType:"edit"})}))},e.onOk=function(){e.getDataList(),e.setState({pageType:!0})},e.mulpDelete=function(){if(!e.state.selectRows||e.state.selectRows.length<1)u.a.info("\u8bf7\u9009\u62e9\u9700\u8981\u5220\u9664\u7684\u6d3b\u52a8!");else{var t=Object(v.a)(e);Q({title:"\u5220\u9664\u786e\u8ba4",content:"\u6b64\u64cd\u4f5c\u4e0d\u53ef\u64a4\u56de,\u662f\u5426\u786e\u8ba4\u5220\u9664\u6240\u9009\u6d3b\u52a8?",onOk:function(){t.confirm(t.state.selectRows)}})}},e.createActivity=function(){e.setState({pageType:"create"})},e.enableChange=function(t,a){var n={enable:1==a?0:1,ids:t.join(",")};T.f(n).then((function(t){if(t&&t.success){var n=1==a?"\u7981\u7528\u6210\u529f":"\u542f\u7528\u6210\u529f";u.a.success(n),e.getDataList(),e.setState({selectRows:[],selectedRowKeys:[]})}}))},e.pubSummary=function(t){var a=e.state,n=a.articleUrl,i=a.tenantId,r={taskId:t.activityrecruitid,callbackFlag:"Y",callbackUrl:e.callBackParams.cb+"?type=1",editor_callback_url:e.callBackParams.zm,editor_type:"2",editor_tite:t.activityname,editor_id:t.activityrecruitid,editor_articleId:""},s=(new V.a).encode(JSON.stringify(r)),l="".concat(n,"?queryParam=").concat(s,"&version=cms2&tenantId=").concat(i,"&type=1#/");"H"===e.pageStag?window.top.postMessage({key:"editorArticle",value:s},"*"):window.open(l)},e.closeRecordModal=function(){e.setState({showRecord:!1,actvId:"",isLoading:!1,recordList:[]})},e.openRecordModal=function(t){e.setState({showRecord:!0,isLoading:!0,actvId:t.activityrecruitid,actvName:t.activityname},(function(){e.fetchRecords()}))},e.fetchRecords=function(){T.l({activityId:e.state.actvId,pageSize:99,pageNo:1}).then((function(t){if(200===t.state){var a=t.data;e.setState({recordList:a,isLoading:!1})}else u.a.error(t.message)}))},e.prevArticle=function(e){e&&window.open(e)},e.editArticle=function(t){var a=e.state,n=a.actvId,i=a.actvName,r=a.articleUrl,s=a.tenantId,l={taskId:n,callbackFlag:"Y",callbackUrl:e.callBackParams.cb+"?type=1",editor_callback_url:e.callBackParams.zm,editor_type:"2",editor_tite:i,editor_id:n,editor_articleId:t},c=(new V.a).encode(JSON.stringify(l)),o="".concat(r,"?queryParam=").concat(c,"&version=cms2&ArticleID=").concat(t,"&tenantId=").concat(s,"&type=1#/");"H"===e.pageStag?window.top.postMessage({key:"editorArticle",value:c},"*"):window.open(o)},e.state={selectedRowKeys:[],tableData:[],totalCount:0,emptyTxt:"\u52a0\u8f7d\u4e2d...",params:{pageSize:10,page:1},currentDetail:{},pageType:!0,serverType:JSON.parse(localStorage.getItem("serverType"))||[],serverArea:JSON.parse(localStorage.getItem("serverArea"))||[],zzmm:[],jxyl:[],searchData:{},actvId:"",actvName:"",recordList:[],isLoading:!1,articleUrl:"",isLoad:!1},e.listData={pageno:1,pagesize:10},e.searchData={},e.callBackParams={};var a=Object(G.a)(window.location.search);return a.stag?e.pageStag=a.stag.replace("/",""):e.pageStag="B",e}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.getList,this.state.params;if(this.props.location.query&&this.props.location.query.actvId){var t=this.props.location.query.actvId;this.fetchInfo(t)}var a=Object($.a)().login_chinamcloud_tid;a!==localStorage.getItem("login_tid")?(localStorage.setItem("login_tid",a),this.getSearviceType(),this.getSearviceArea()):(localStorage.getItem("serverType")||this.getSearviceType(),localStorage.getItem("serverArea")||this.getSearviceArea()),setTimeout((function(){e.fetchTenantId(),e.fetchConfig(),e.getDataList(),e.fetchParams()}))}},{key:"render",value:function(){var e=this,t=this.state.selectedRowKeys,a=this.listData,u={selectedRowKeys:t,onChange:this.onSelectChange},m={pageSize:a.pagesize,total:this.state.totalCount,current:a.pageno,showTotal:function(e){return"\u5171 ".concat(e," \u6761\u6570\u636e")},showSizeChanger:!0,onShowSizeChange:this.onShowSizeChange,onChange:this.onShowSizeChange},p=[{title:"\u6d3b\u52a8\u540d\u79f0",dataIndex:"activityname",align:"left",width:100,render:function(e,t){return S.a.createElement(d.a,{placement:"topLeft",title:e},S.a.createElement("span",null,e))}},{title:"\u6d3b\u52a8\u5730\u533a",dataIndex:"areaid",align:"left",width:80,render:function(t,a){var n="";return e.state.serverArea.length>0&&e.state.serverArea.map((function(e){e.dictionaryId==t&&(n=e.dictionaryValue)})),S.a.createElement("span",null,n)}},{title:"\u6d3b\u52a8\u670d\u52a1\u7c7b\u578b",dataIndex:"activitytype",align:"left",width:100,render:function(t,a){var n="";return e.state.serverType.map((function(e){e.dictionaryId==t&&(n=e.dictionaryValue)})),S.a.createElement("span",null,n)}},{title:"\u4e3e\u529e\u7ec4\u7ec7",dataIndex:"stationName",align:"left",width:120,render:function(e,t){var a="";return a="1"==t.userid?"\u5b9e\u8df5\u4e2d\u5fc3":t.userid,S.a.createElement(d.a,{placement:"topLeft",title:a},S.a.createElement("span",null,a))}},{title:"\u6d3b\u52a8\u5f00\u59cb\u65f6\u95f4",dataIndex:"activitystarttime",align:"left",width:150,render:function(e,t){var a=e&&B()(e).format("YYYY-MM-DD HH:mm:ss");return S.a.createElement("span",null,a)}},{title:"\u6d3b\u52a8\u7ed3\u675f\u65f6\u95f4",dataIndex:"activityendtime",align:"left",width:150,render:function(e,t){var a=e&&B()(e).format("YYYY-MM-DD HH:mm:ss");return S.a.createElement("span",null,a)}},{title:"\u6d3b\u52a8\u72b6\u6001",dataIndex:"state",align:"left",width:70,render:function(e,t){return S.a.createElement("span",null,V.d[e])}},{title:"\u64cd\u4f5c",align:"left",width:140,render:function(t,a){var n=S.a.createElement(o.a,null,S.a.createElement(o.a.Item,{key:"0"},S.a.createElement("a",{role:"button",className:"tableOperateButton",onClick:function(){e.openRecordModal(a)}},"\u603b\u7ed3\u8bb0\u5f55")),S.a.createElement(o.a.Item,{key:"1"},S.a.createElement("a",{role:"button",tabIndex:"0",className:"tableOperateButton",onClick:function(t){e.enableChange([a.activityrecruitid],a.enable)}},0==a.enable?"\u542f\u7528":"\u7981\u7528")),S.a.createElement(o.a.Item,{key:"2"},S.a.createElement(c.a,{placement:"right",title:"\u6b64\u64cd\u4f5c\u4e0d\u53ef\u64a4\u56de,\u662f\u5426\u786e\u8ba4\u5220\u9664\u6240\u9009\u6d3b\u52a8?",okType:"danger",onConfirm:function(){return e.confirm([a],1)},okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},S.a.createElement("a",{role:"button",className:"tableOperateButton",type:"link"},"\u5220\u9664"))));return S.a.createElement("div",{role:"button",className:"operate-wraps",tabIndex:"-1",style:{whiteSpace:"nowrap"},onClick:function(e){e&&e.preventDefault(),e&&e.stopPropagation()}},S.a.createElement("a",{role:"button",tabIndex:"0",className:"tableOperateButton",onClick:function(t){e.lookDetail(a||{})}},"\u67e5\u770b"),S.a.createElement("a",{role:"button",className:"tableOperateButton",onClick:function(){e.pubSummary(a)},style:{marginRight:10}},"\u53d1\u5e03\u603b\u7ed3"),S.a.createElement(l.a,{overlay:n},S.a.createElement("a",{className:"ant-dropdown-link",role:"button"},"\u66f4\u591a")))}}],h=[{title:"\u6587\u7a3f\u6807\u9898",dataIndex:"title",align:"left",render:function(e,t){return S.a.createElement(d.a,{placement:"topLeft",title:e},S.a.createElement("span",null,e))}},{title:"\u521b\u5efa\u65e5\u671f",dataIndex:"addTime",align:"left"},{title:"\u64cd\u4f5c",dataIndex:"operate",align:"left",render:function(t,a){return S.a.createElement("div",{className:"btn-groups"},S.a.createElement("a",{role:"button",className:"prev-btn",style:{marginRight:10},onClick:function(){e.prevArticle(a.pcPreview)}},"\u9884\u89c8"),S.a.createElement("a",{role:"button",className:"edit-btn",onClick:function(){e.editArticle(a.id)}},"\u7f16\u8f91"))}}];return 1==this.state.pageType?S.a.createElement(S.a.Fragment,null,S.a.createElement(s.a,{className:"breadcrumbBox"},S.a.createElement(s.a.Item,null,S.a.createElement("span",{className:"title-active"},this.props.navTitle))),S.a.createElement("div",{className:"eachPageBox"},S.a.createElement("div",{style:{height:"100%"}},S.a.createElement("div",{className:"navTopBox"},S.a.createElement("div",{className:"btnBox"},S.a.createElement(r.a,{type:"primary",onClick:this.createActivity},"\u65b0\u5efa\u6d3b\u52a8"),S.a.createElement(r.a,{type:"danger",ghost:!0,onClick:this.mulpDelete},"\u5220\u9664")),S.a.createElement("div",{className:"searchFatherBox searchLeftPadding"},S.a.createElement("div",{className:"searchBox "},S.a.createElement("span",{className:"item-search-part"},"\u6d3b\u52a8\u670d\u52a1\u7c7b\u578b\uff1a",S.a.createElement(y.a,{value:this.state.searchData.activityType,placeholder:"\u5168\u90e8",style:{width:120},onChange:function(t){e.listData.pageno=1,e.listData.pagesize=10,e.searchData.activityType=t,e.setState({searchData:e.searchData}),e.getDataList()}},S.a.createElement(X,{value:""},"\u5168\u90e8"),this.state.serverType.map((function(e,t){return S.a.createElement(X,{key:t,value:e.dictionaryId},e.dictionaryValue)})))),S.a.createElement("span",{className:"item-search-part"},"\u6d3b\u52a8\u5730\u533a\uff1a",S.a.createElement(y.a,{value:this.state.searchData.areaID,placeholder:"\u5168\u90e8",style:{width:120},onChange:function(t){e.listData.pageno=1,e.listData.pagesize=10,e.searchData.areaID=t,e.setState({searchData:e.searchData}),e.getDataList()}},S.a.createElement(X,{value:""},"\u5168\u90e8"),this.state.serverArea.map((function(e,t){return S.a.createElement(X,{key:t,value:e.dictionaryId},e.dictionaryValue)})))),S.a.createElement("span",{className:"item-search-part"},"\u6d3b\u52a8\u72b6\u6001\uff1a",S.a.createElement(y.a,{value:this.state.searchData.state,placeholder:"\u5168\u90e8",style:{width:120},onChange:function(t){e.listData.pageno=1,e.listData.pagesize=10,e.searchData.state=t,e.setState({searchData:e.searchData}),e.getDataList()}},S.a.createElement(X,{value:""},"\u5168\u90e8"),Object.keys(V.d).map((function(e,t){return S.a.createElement(X,{key:t,value:e},V.d[e])})))),S.a.createElement(W,{placeholder:"\u8bf7\u8f93\u5165\u6d3b\u52a8\u540d",enterButton:"\u641c\u7d22",value:this.state.searchData.activityname,onChange:function(t){e.searchData.activityname=t.target.value,e.setState({searchData:e.searchData})},onSearch:function(t){e.searchData.activityname=t,e.getDataList()},style:{width:240}})))),S.a.createElement("div",{className:"tableCont mainContentBox",style:{height:"calc(100% - 121px)"}},S.a.createElement(i.a,{rowKey:"activityrecruitid",columns:p,rowSelection:u,pagination:!this.state.isLoad&&m,dataSource:this.state.tableData,locale:{emptyText:this.state.emptyTxt},onRow:function(t,a){return{index:a,onClick:e.onRowEvent.bind(e,t)}},scroll:{x:"100%",y:"calc(100vh - 291px)"}}))),S.a.createElement(b.a,{title:"\u603b\u7ed3\u8bb0\u5f55",visible:this.state.showRecord,onCancel:this.closeRecordModal,footer:null,width:800},S.a.createElement("div",{className:"records-wraps"},S.a.createElement(n.a,{spinning:this.state.isLoading},S.a.createElement(i.a,{columns:h,dataSource:this.state.recordList,rowKey:"id",pagination:!1})))))):S.a.createElement(J,{type:this.state.pageType,serverArea:this.state.serverArea,serverType:this.state.serverType,detailData:this.state.currentDetail,fetchInfo:this.fetchInfo,onOk:this.onOk,back:this.pageBack})}}]),t}(D.Component);t.default=Object(I.c)((function(e){var t=e.message,a=e.navTitle;return{listData:t.listData,listLoading:t.listLoading,navTitle:a.navTitle}}),(function(e){return{getList:e.message.getList}}))(Z)}}]);